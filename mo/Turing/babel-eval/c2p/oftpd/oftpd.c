/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is false */

#line 216 "/usr/lib/gcc/x86_64-redhat-linux/5.1.1/include/stddef.h"
typedef unsigned long size_t;
#line 125 "/usr/include/bits/types.h"
typedef unsigned int __uid_t;
#line 126 "/usr/include/bits/types.h"
typedef unsigned int __gid_t;
#line 131 "/usr/include/bits/types.h"
typedef long __off_t;
#line 132 "/usr/include/bits/types.h"
typedef long __off64_t;
#line 133 "/usr/include/bits/types.h"
typedef int __pid_t;
#line 139 "/usr/include/bits/types.h"
typedef long __time_t;
#line 44 "/usr/include/stdio.h"
struct _IO_FILE;
#line 44
struct _IO_FILE;
#line 48 "/usr/include/stdio.h"
typedef struct _IO_FILE FILE;
#line 144 "/usr/include/libio.h"
struct _IO_FILE;
#line 154 "/usr/include/libio.h"
typedef void _IO_lock_t;
#line 160 "/usr/include/libio.h"
struct _IO_marker {
   struct _IO_marker *_next ;
   struct _IO_FILE *_sbuf ;
   int _pos ;
};
#line 245 "/usr/include/libio.h"
struct _IO_FILE {
   int _flags ;
   char *_IO_read_ptr ;
   char *_IO_read_end ;
   char *_IO_read_base ;
   char *_IO_write_base ;
   char *_IO_write_ptr ;
   char *_IO_write_end ;
   char *_IO_buf_base ;
   char *_IO_buf_end ;
   char *_IO_save_base ;
   char *_IO_backup_base ;
   char *_IO_save_end ;
   struct _IO_marker *_markers ;
   struct _IO_FILE *_chain ;
   int _fileno ;
   int _flags2 ;
   __off_t _old_offset ;
   unsigned short _cur_column ;
   signed char _vtable_offset ;
   char _shortbuf[1] ;
   _IO_lock_t *_lock ;
   __off64_t _offset ;
   void *__pad1 ;
   void *__pad2 ;
   void *__pad3 ;
   void *__pad4 ;
   size_t __pad5 ;
   int _mode ;
   char _unused2[(15UL * sizeof(int ) - 4UL * sizeof(void *)) - sizeof(size_t )] ;
};
#line 75 "/usr/include/time.h"
typedef __time_t time_t;
#line 27 "/usr/include/bits/sigset.h"
struct __anonstruct___sigset_t_9 {
   unsigned long __val[1024UL / (8UL * sizeof(unsigned long ))] ;
};
#line 27 "/usr/include/bits/sigset.h"
typedef struct __anonstruct___sigset_t_9 __sigset_t;
#line 37 "/usr/include/sys/select.h"
typedef __sigset_t sigset_t;
#line 60 "/usr/include/bits/pthreadtypes.h"
typedef unsigned long pthread_t;
#line 75 "/usr/include/bits/pthreadtypes.h"
struct __pthread_internal_list {
   struct __pthread_internal_list *__prev ;
   struct __pthread_internal_list *__next ;
};
#line 75 "/usr/include/bits/pthreadtypes.h"
typedef struct __pthread_internal_list __pthread_list_t;
#line 90 "/usr/include/bits/pthreadtypes.h"
struct __pthread_mutex_s {
   int __lock ;
   unsigned int __count ;
   int __owner ;
   unsigned int __nusers ;
   int __kind ;
   short __spins ;
   short __elision ;
   __pthread_list_t __list ;
};
#line 90 "/usr/include/bits/pthreadtypes.h"
union __anonunion_pthread_mutex_t_11 {
   struct __pthread_mutex_s __data ;
   char __size[40] ;
   long __align ;
};
#line 90 "/usr/include/bits/pthreadtypes.h"
typedef union __anonunion_pthread_mutex_t_11 pthread_mutex_t;
#line 139 "/usr/include/bits/pthreadtypes.h"
struct __anonstruct___data_14 {
   int __lock ;
   unsigned int __futex ;
   unsigned long long __total_seq ;
   unsigned long long __wakeup_seq ;
   unsigned long long __woken_seq ;
   void *__mutex ;
   unsigned int __nwaiters ;
   unsigned int __broadcast_seq ;
};
#line 139 "/usr/include/bits/pthreadtypes.h"
union __anonunion_pthread_cond_t_13 {
   struct __anonstruct___data_14 __data ;
   char __size[48] ;
   long long __align ;
};
#line 139 "/usr/include/bits/pthreadtypes.h"
typedef union __anonunion_pthread_cond_t_13 pthread_cond_t;
#line 85 "/usr/include/signal.h"
typedef void (*__sighandler_t)(int  );
#line 49 "/usr/include/pwd.h"
struct passwd {
   char *pw_name ;
   char *pw_passwd ;
   __uid_t pw_uid ;
   __gid_t pw_gid ;
   char *pw_gecos ;
   char *pw_dir ;
   char *pw_shell ;
};
#line 8 "error.h"
struct __anonstruct_error_t_63 {
   int error_code ;
   char desc[128] ;
};
#line 8 "error.h"
typedef struct __anonstruct_error_t_63 error_t;
#line 24 "watchdog.h"
struct watched {
   pthread_t watched_thread ;
   int in_list ;
   time_t alarm_time ;
   struct watched *older ;
   struct watched *newer ;
   void *watchdog ;
};
#line 24 "watchdog.h"
typedef struct watched watched_t;
#line 43 "watchdog.h"
struct __anonstruct_watchdog_t_64 {
   pthread_mutex_t mutex ;
   int inactivity_timeout ;
   watched_t *oldest ;
   watched_t *newest ;
};
#line 43 "watchdog.h"
typedef struct __anonstruct_watchdog_t_64 watchdog_t;
#line 15 "ftp_listener.h"
struct __anonstruct_ftp_listener_t_65 {
   int fd ;
   int max_connections ;
   int num_connections ;
   int inactivity_timeout ;
   watchdog_t watchdog ;
   pthread_mutex_t mutex ;
   char dir[4097] ;
   int listener_running ;
   pthread_t listener_thread ;
   int shutdown_request_send_fd ;
   int shutdown_request_recv_fd ;
   pthread_cond_t shutdown_cond ;
};
#line 15 "ftp_listener.h"
typedef struct __anonstruct_ftp_listener_t_65 ftp_listener_t;
#line 170 "/usr/include/stdio.h"
extern struct _IO_FILE *stderr ;
#line 356
extern int fprintf(FILE * __restrict  __stream , char const   * __restrict  __format 
                   , ...) ;
#line 386
extern  __attribute__((__nothrow__)) int ( /* format attribute */  snprintf)(char * __restrict  __s ,
                                                                             size_t __maxlen ,
                                                                             char const   * __restrict  __format 
                                                                             , ...) ;
#line 353 "/usr/include/unistd.h"
extern int close(int __fd ) ;
#line 497
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1), __leaf__)) chdir)(char const   *__path ) ;
#line 534
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) dup2)(int __fd ,
                                                                           int __fd2 ) ;
#line 619
extern  __attribute__((__nothrow__)) long ( __attribute__((__leaf__)) sysconf)(int __name ) ;
#line 628
extern  __attribute__((__nothrow__)) __pid_t ( __attribute__((__leaf__)) getpid)(void) ;
#line 667
extern  __attribute__((__nothrow__)) __pid_t ( __attribute__((__leaf__)) setsid)(void) ;
#line 678
extern  __attribute__((__nothrow__)) __uid_t ( __attribute__((__leaf__)) geteuid)(void) ;
#line 700
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) setuid)(__uid_t __uid ) ;
#line 717
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) setgid)(__gid_t __gid ) ;
#line 756
extern  __attribute__((__nothrow__)) __pid_t fork(void) ;
#line 944
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1), __leaf__)) chroot)(char const   *__path ) ;
#line 169 "/usr/include/fcntl.h"
extern int ( __attribute__((__nonnull__(1))) open)(char const   *__file , int __oflag 
                                                   , ...) ;
#line 398 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__nonnull__(1), __leaf__)) strlen)(char const   *__s )  __attribute__((__pure__)) ;
#line 412
extern  __attribute__((__nothrow__)) char *( __attribute__((__leaf__)) strerror)(int __errnum ) ;
#line 50 "/usr/include/bits/errno.h"
extern  __attribute__((__nothrow__)) int *( __attribute__((__leaf__)) __errno_location)(void)  __attribute__((__const__)) ;
#line 102 "/usr/include/signal.h"
extern  __attribute__((__nothrow__)) __sighandler_t ( __attribute__((__leaf__)) signal)(int __sig ,
                                                                                        void (*__handler)(int  ) ) ;
#line 215
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1), __leaf__)) sigemptyset)(sigset_t *__set ) ;
#line 221
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1), __leaf__)) sigaddset)(sigset_t *__set ,
                                                                                                int __signo ) ;
#line 270
extern int ( __attribute__((__nonnull__(1,2))) sigwait)(sigset_t const   * __restrict  __set ,
                                                        int * __restrict  __sig ) ;
#line 30 "/usr/include/bits/sigthread.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) pthread_sigmask)(int __how ,
                                                                                      __sigset_t const   * __restrict  __newmask ,
                                                                                      __sigset_t * __restrict  __oldmask ) ;
#line 116 "/usr/include/pwd.h"
extern struct passwd *getpwnam(char const   *__name ) ;
#line 181 "/usr/include/sys/syslog.h"
extern void openlog(char const   *__ident , int __option , int __facility ) ;
#line 190
extern void ( /* format attribute */  syslog)(int __pri , char const   *__fmt  , ...) ;
#line 183 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) long ( __attribute__((__nonnull__(1), __leaf__)) strtol)(char const   * __restrict  __nptr ,
                                                                                              char ** __restrict  __endptr ,
                                                                                              int __base ) ;
#line 543
extern  __attribute__((__nothrow__, __noreturn__)) void ( __attribute__((__leaf__)) exit)(int __status ) ;
#line 16 "error.h"
extern char const   *error_get_desc(error_t const   *err ) ;
#line 55 "ftp_listener.h"
extern int ftp_listener_init(ftp_listener_t *f , char *address , int port , int max_connections ,
                             int inactivity_timeout , error_t *err ) ;
#line 61
extern int ftp_listener_start(ftp_listener_t *f , error_t *err ) ;
#line 62
extern void ftp_listener_stop(ftp_listener_t *f ) ;
#line 23 "oftpd.c"
static char const   *exe_name  =    "oftpd";
#line 25
static void daemonize(void) ;
#line 26
static void print_usage(char const   *error ) ;
void daemonize_cil_lr_1(int max_fd , int fd ) ;
#line 28 "oftpd.c"
int main(int argc , char **argv ) 
{ 
  int i ;
  long num ;
  char *endptr ;
  int port ;
  int max_clients ;
  int log_facility ;
  char *user_ptr ;
  char *dir_ptr ;
  char *address ;
  char temp_buf[256] ;
  struct passwd *user_info ;
  error_t err ;
  ftp_listener_t ftp_listener ;
  int detach ;
  sigset_t term_signal ;
  int sig ;
  __uid_t tmp ;
  size_t __s1_len ;
  size_t __s2_len ;
  int tmp___1 ;
  int tmp___4 ;
  int tmp___5 ;
  int tmp___6 ;
  size_t __s1_len___0 ;
  size_t __s2_len___0 ;
  int tmp___8 ;
  int tmp___11 ;
  int tmp___12 ;
  int tmp___13 ;
  size_t __s1_len___1 ;
  size_t __s2_len___1 ;
  int tmp___15 ;
  int tmp___18 ;
  int tmp___19 ;
  int tmp___20 ;
  size_t __s1_len___2 ;
  size_t __s2_len___2 ;
  int tmp___22 ;
  int tmp___25 ;
  int tmp___26 ;
  int tmp___27 ;
  size_t __s1_len___3 ;
  size_t __s2_len___3 ;
  int tmp___29 ;
  int tmp___32 ;
  int tmp___33 ;
  int tmp___34 ;
  size_t __s1_len___4 ;
  size_t __s2_len___4 ;
  int tmp___36 ;
  int tmp___39 ;
  int tmp___40 ;
  int tmp___41 ;
  size_t __s1_len___5 ;
  size_t __s2_len___5 ;
  int tmp___43 ;
  int tmp___46 ;
  int tmp___47 ;
  int tmp___48 ;
  size_t __s1_len___6 ;
  size_t __s2_len___6 ;
  int tmp___50 ;
  int tmp___53 ;
  int tmp___54 ;
  int tmp___55 ;
  size_t __s1_len___7 ;
  size_t __s2_len___7 ;
  int tmp___57 ;
  int tmp___60 ;
  int tmp___61 ;
  int tmp___62 ;
  size_t __s1_len___8 ;
  size_t __s2_len___8 ;
  int tmp___64 ;
  int tmp___67 ;
  int tmp___68 ;
  int tmp___69 ;
  size_t __s1_len___9 ;
  size_t __s2_len___9 ;
  int tmp___71 ;
  int tmp___74 ;
  int tmp___75 ;
  int tmp___76 ;
  size_t __s1_len___10 ;
  size_t __s2_len___10 ;
  int tmp___78 ;
  int tmp___81 ;
  int tmp___82 ;
  int tmp___83 ;
  __pid_t tmp___84 ;
  int *tmp___85 ;
  char *tmp___86 ;
  int tmp___87 ;
  int *tmp___88 ;
  char *tmp___89 ;
  int tmp___90 ;
  char const   *tmp___91 ;
  int tmp___92 ;
  int *tmp___93 ;
  char *tmp___94 ;
  int tmp___95 ;
  int *tmp___96 ;
  char *tmp___97 ;
  int tmp___98 ;
  char const   *tmp___99 ;
  int tmp___100 ;

  {
#line 55
  if (argc > 0) {
#line 56
    exe_name = (char const   *)*(argv + 0);
  }
#line 60
  tmp = geteuid();
#line 60
  if (tmp != 0U) {
#line 61
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"%s: program needs root permission to run\n",
            exe_name);
#line 62
    exit(1);
  }
#line 66
  port = 0;
#line 67
  user_ptr = (char *)((void *)0);
#line 68
  dir_ptr = (char *)((void *)0);
#line 69
  address = (char *)((void *)0);
#line 70
  max_clients = 250;
#line 71
  detach = 1;
#line 72
  log_facility = 11 << 3;
#line 77
  i = 1;
#line 77
  while (i < argc) {
#line 80
    if ((int )*(*(argv + i) + 0) == 45) {
#line 81
      if (0) {
#line 81
        __s1_len___9 = strlen((char const   *)*(argv + i));
#line 81
        __s2_len___9 = strlen("-p");
#line 81
        if (! ((size_t )((void const   *)(*(argv + i) + 1)) - (size_t )((void const   *)*(argv + i)) == 1UL)) {
#line 81
          goto _L___23;
        } else
#line 81
        if (__s1_len___9 >= 4UL) {
          _L___23: /* CIL Label */ 
#line 81
          if (! ((size_t )((void const   *)("-p" + 1)) - (size_t )((void const   *)"-p") == 1UL)) {
#line 81
            tmp___76 = 1;
          } else
#line 81
          if (__s2_len___9 >= 4UL) {
#line 81
            tmp___76 = 1;
          } else {
#line 81
            tmp___76 = 0;
          }
        } else {
#line 81
          tmp___76 = 0;
        }
#line 81
        if (tmp___76) {
#line 81
          tmp___71 = __builtin_strcmp((char const   *)*(argv + i), "-p");
#line 81
          tmp___75 = tmp___71;
        } else {
#line 81
          tmp___74 = __builtin_strcmp((char const   *)*(argv + i), "-p");
#line 81
          tmp___75 = tmp___74;
        }
      } else {
#line 81
        tmp___74 = __builtin_strcmp((char const   *)*(argv + i), "-p");
#line 81
        tmp___75 = tmp___74;
      }
#line 82
      if (tmp___75 == 0) {
#line 82
        goto _L___26;
      } else {
#line 82
        if (0) {
#line 82
          __s1_len___10 = strlen((char const   *)*(argv + i));
#line 82
          __s2_len___10 = strlen("--port");
#line 82
          if (! ((size_t )((void const   *)(*(argv + i) + 1)) - (size_t )((void const   *)*(argv + i)) == 1UL)) {
#line 82
            goto _L___25;
          } else
#line 82
          if (__s1_len___10 >= 4UL) {
            _L___25: /* CIL Label */ 
#line 82
            if (! ((size_t )((void const   *)("--port" + 1)) - (size_t )((void const   *)"--port") == 1UL)) {
#line 82
              tmp___83 = 1;
            } else
#line 82
            if (__s2_len___10 >= 4UL) {
#line 82
              tmp___83 = 1;
            } else {
#line 82
              tmp___83 = 0;
            }
          } else {
#line 82
            tmp___83 = 0;
          }
#line 82
          if (tmp___83) {
#line 82
            tmp___78 = __builtin_strcmp((char const   *)*(argv + i), "--port");
#line 82
            tmp___82 = tmp___78;
          } else {
#line 82
            tmp___81 = __builtin_strcmp((char const   *)*(argv + i), "--port");
#line 82
            tmp___82 = tmp___81;
          }
        } else {
#line 82
          tmp___81 = __builtin_strcmp((char const   *)*(argv + i), "--port");
#line 82
          tmp___82 = tmp___81;
        }
#line 82
        if (tmp___82 == 0) {
          _L___26: /* CIL Label */ 
#line 83
          i ++;
#line 83
          if (i >= argc) {
#line 84
            print_usage("missing port number");
#line 85
            exit(1);
          }
#line 87
          num = strtol((char const   */* __restrict  */)*(argv + i), (char **/* __restrict  */)(& endptr),
                       0);
#line 88
          if (num < 0L) {
#line 90
            snprintf((char */* __restrict  */)(temp_buf), sizeof(temp_buf), (char const   */* __restrict  */)"port must be a number between %d and %d",
                     0, 65535);
#line 93
            print_usage((char const   *)(temp_buf));
#line 95
            exit(1);
          } else
#line 88
          if (num > 65535L) {
#line 90
            snprintf((char */* __restrict  */)(temp_buf), sizeof(temp_buf), (char const   */* __restrict  */)"port must be a number between %d and %d",
                     0, 65535);
#line 93
            print_usage((char const   *)(temp_buf));
#line 95
            exit(1);
          } else
#line 88
          if ((int )*endptr != 0) {
#line 90
            snprintf((char */* __restrict  */)(temp_buf), sizeof(temp_buf), (char const   */* __restrict  */)"port must be a number between %d and %d",
                     0, 65535);
#line 93
            print_usage((char const   *)(temp_buf));
#line 95
            exit(1);
          }
#line 97
          port = (int )num;
        } else {
#line 98
          if (0) {
#line 98
            __s1_len___7 = strlen((char const   *)*(argv + i));
#line 98
            __s2_len___7 = strlen("-h");
#line 98
            if (! ((size_t )((void const   *)(*(argv + i) + 1)) - (size_t )((void const   *)*(argv + i)) == 1UL)) {
#line 98
              goto _L___19;
            } else
#line 98
            if (__s1_len___7 >= 4UL) {
              _L___19: /* CIL Label */ 
#line 98
              if (! ((size_t )((void const   *)("-h" + 1)) - (size_t )((void const   *)"-h") == 1UL)) {
#line 98
                tmp___62 = 1;
              } else
#line 98
              if (__s2_len___7 >= 4UL) {
#line 98
                tmp___62 = 1;
              } else {
#line 98
                tmp___62 = 0;
              }
            } else {
#line 98
              tmp___62 = 0;
            }
#line 98
            if (tmp___62) {
#line 98
              tmp___57 = __builtin_strcmp((char const   *)*(argv + i), "-h");
#line 98
              tmp___61 = tmp___57;
            } else {
#line 98
              tmp___60 = __builtin_strcmp((char const   *)*(argv + i), "-h");
#line 98
              tmp___61 = tmp___60;
            }
          } else {
#line 98
            tmp___60 = __builtin_strcmp((char const   *)*(argv + i), "-h");
#line 98
            tmp___61 = tmp___60;
          }
#line 99
          if (tmp___61 == 0) {
#line 100
            print_usage((char const   *)((void *)0));
#line 101
            exit(0);
          } else {
#line 99
            if (0) {
#line 99
              __s1_len___8 = strlen((char const   *)*(argv + i));
#line 99
              __s2_len___8 = strlen("--help");
#line 99
              if (! ((size_t )((void const   *)(*(argv + i) + 1)) - (size_t )((void const   *)*(argv + i)) == 1UL)) {
#line 99
                goto _L___21;
              } else
#line 99
              if (__s1_len___8 >= 4UL) {
                _L___21: /* CIL Label */ 
#line 99
                if (! ((size_t )((void const   *)("--help" + 1)) - (size_t )((void const   *)"--help") == 1UL)) {
#line 99
                  tmp___69 = 1;
                } else
#line 99
                if (__s2_len___8 >= 4UL) {
#line 99
                  tmp___69 = 1;
                } else {
#line 99
                  tmp___69 = 0;
                }
              } else {
#line 99
                tmp___69 = 0;
              }
#line 99
              if (tmp___69) {
#line 99
                tmp___64 = __builtin_strcmp((char const   *)*(argv + i), "--help");
#line 99
                tmp___68 = tmp___64;
              } else {
#line 99
                tmp___67 = __builtin_strcmp((char const   *)*(argv + i), "--help");
#line 99
                tmp___68 = tmp___67;
              }
            } else {
#line 99
              tmp___67 = __builtin_strcmp((char const   *)*(argv + i), "--help");
#line 99
              tmp___68 = tmp___67;
            }
#line 99
            if (tmp___68 == 0) {
#line 100
              print_usage((char const   *)((void *)0));
#line 101
              exit(0);
            } else {
#line 102
              if (0) {
#line 102
                __s1_len___5 = strlen((char const   *)*(argv + i));
#line 102
                __s2_len___5 = strlen("-i");
#line 102
                if (! ((size_t )((void const   *)(*(argv + i) + 1)) - (size_t )((void const   *)*(argv + i)) == 1UL)) {
#line 102
                  goto _L___14;
                } else
#line 102
                if (__s1_len___5 >= 4UL) {
                  _L___14: /* CIL Label */ 
#line 102
                  if (! ((size_t )((void const   *)("-i" + 1)) - (size_t )((void const   *)"-i") == 1UL)) {
#line 102
                    tmp___48 = 1;
                  } else
#line 102
                  if (__s2_len___5 >= 4UL) {
#line 102
                    tmp___48 = 1;
                  } else {
#line 102
                    tmp___48 = 0;
                  }
                } else {
#line 102
                  tmp___48 = 0;
                }
#line 102
                if (tmp___48) {
#line 102
                  tmp___43 = __builtin_strcmp((char const   *)*(argv + i), "-i");
#line 102
                  tmp___47 = tmp___43;
                } else {
#line 102
                  tmp___46 = __builtin_strcmp((char const   *)*(argv + i), "-i");
#line 102
                  tmp___47 = tmp___46;
                }
              } else {
#line 102
                tmp___46 = __builtin_strcmp((char const   *)*(argv + i), "-i");
#line 102
                tmp___47 = tmp___46;
              }
#line 103
              if (tmp___47 == 0) {
#line 103
                goto _L___17;
              } else {
#line 103
                if (0) {
#line 103
                  __s1_len___6 = strlen((char const   *)*(argv + i));
#line 103
                  __s2_len___6 = strlen("--interface");
#line 103
                  if (! ((size_t )((void const   *)(*(argv + i) + 1)) - (size_t )((void const   *)*(argv + i)) == 1UL)) {
#line 103
                    goto _L___16;
                  } else
#line 103
                  if (__s1_len___6 >= 4UL) {
                    _L___16: /* CIL Label */ 
#line 103
                    if (! ((size_t )((void const   *)("--interface" + 1)) - (size_t )((void const   *)"--interface") == 1UL)) {
#line 103
                      tmp___55 = 1;
                    } else
#line 103
                    if (__s2_len___6 >= 4UL) {
#line 103
                      tmp___55 = 1;
                    } else {
#line 103
                      tmp___55 = 0;
                    }
                  } else {
#line 103
                    tmp___55 = 0;
                  }
#line 103
                  if (tmp___55) {
#line 103
                    tmp___50 = __builtin_strcmp((char const   *)*(argv + i), "--interface");
#line 103
                    tmp___54 = tmp___50;
                  } else {
#line 103
                    tmp___53 = __builtin_strcmp((char const   *)*(argv + i), "--interface");
#line 103
                    tmp___54 = tmp___53;
                  }
                } else {
#line 103
                  tmp___53 = __builtin_strcmp((char const   *)*(argv + i), "--interface");
#line 103
                  tmp___54 = tmp___53;
                }
#line 103
                if (tmp___54 == 0) {
                  _L___17: /* CIL Label */ 
#line 104
                  i ++;
#line 104
                  if (i >= argc) {
#line 105
                    print_usage("missing interface");
#line 106
                    exit(1);
                  }
#line 108
                  address = *(argv + i);
                } else {
#line 109
                  if (0) {
#line 109
                    __s1_len___3 = strlen((char const   *)*(argv + i));
#line 109
                    __s2_len___3 = strlen("-m");
#line 109
                    if (! ((size_t )((void const   *)(*(argv + i) + 1)) - (size_t )((void const   *)*(argv + i)) == 1UL)) {
#line 109
                      goto _L___9;
                    } else
#line 109
                    if (__s1_len___3 >= 4UL) {
                      _L___9: /* CIL Label */ 
#line 109
                      if (! ((size_t )((void const   *)("-m" + 1)) - (size_t )((void const   *)"-m") == 1UL)) {
#line 109
                        tmp___34 = 1;
                      } else
#line 109
                      if (__s2_len___3 >= 4UL) {
#line 109
                        tmp___34 = 1;
                      } else {
#line 109
                        tmp___34 = 0;
                      }
                    } else {
#line 109
                      tmp___34 = 0;
                    }
#line 109
                    if (tmp___34) {
#line 109
                      tmp___29 = __builtin_strcmp((char const   *)*(argv + i), "-m");
#line 109
                      tmp___33 = tmp___29;
                    } else {
#line 109
                      tmp___32 = __builtin_strcmp((char const   *)*(argv + i), "-m");
#line 109
                      tmp___33 = tmp___32;
                    }
                  } else {
#line 109
                    tmp___32 = __builtin_strcmp((char const   *)*(argv + i), "-m");
#line 109
                    tmp___33 = tmp___32;
                  }
#line 110
                  if (tmp___33 == 0) {
#line 110
                    goto _L___12;
                  } else {
#line 110
                    if (0) {
#line 110
                      __s1_len___4 = strlen((char const   *)*(argv + i));
#line 110
                      __s2_len___4 = strlen("--max-clients");
#line 110
                      if (! ((size_t )((void const   *)(*(argv + i) + 1)) - (size_t )((void const   *)*(argv + i)) == 1UL)) {
#line 110
                        goto _L___11;
                      } else
#line 110
                      if (__s1_len___4 >= 4UL) {
                        _L___11: /* CIL Label */ 
#line 110
                        if (! ((size_t )((void const   *)("--max-clients" + 1)) - (size_t )((void const   *)"--max-clients") == 1UL)) {
#line 110
                          tmp___41 = 1;
                        } else
#line 110
                        if (__s2_len___4 >= 4UL) {
#line 110
                          tmp___41 = 1;
                        } else {
#line 110
                          tmp___41 = 0;
                        }
                      } else {
#line 110
                        tmp___41 = 0;
                      }
#line 110
                      if (tmp___41) {
#line 110
                        tmp___36 = __builtin_strcmp((char const   *)*(argv + i), "--max-clients");
#line 110
                        tmp___40 = tmp___36;
                      } else {
#line 110
                        tmp___39 = __builtin_strcmp((char const   *)*(argv + i), "--max-clients");
#line 110
                        tmp___40 = tmp___39;
                      }
                    } else {
#line 110
                      tmp___39 = __builtin_strcmp((char const   *)*(argv + i), "--max-clients");
#line 110
                      tmp___40 = tmp___39;
                    }
#line 110
                    if (tmp___40 == 0) {
                      _L___12: /* CIL Label */ 
#line 111
                      i ++;
#line 111
                      if (i >= argc) {
#line 112
                        print_usage("missing number of max clients");
#line 113
                        exit(1);
                      }
#line 115
                      num = strtol((char const   */* __restrict  */)*(argv + i), (char **/* __restrict  */)(& endptr),
                                   0);
#line 116
                      if (num < 1L) {
#line 119
                        snprintf((char */* __restrict  */)(temp_buf), sizeof(temp_buf),
                                 (char const   */* __restrict  */)"max clients must be a number between %d and %d",
                                 1, 300);
#line 122
                        print_usage((char const   *)(temp_buf));
#line 124
                        exit(1);
                      } else
#line 116
                      if (num > 300L) {
#line 119
                        snprintf((char */* __restrict  */)(temp_buf), sizeof(temp_buf),
                                 (char const   */* __restrict  */)"max clients must be a number between %d and %d",
                                 1, 300);
#line 122
                        print_usage((char const   *)(temp_buf));
#line 124
                        exit(1);
                      } else
#line 116
                      if ((int )*endptr != 0) {
#line 119
                        snprintf((char */* __restrict  */)(temp_buf), sizeof(temp_buf),
                                 (char const   */* __restrict  */)"max clients must be a number between %d and %d",
                                 1, 300);
#line 122
                        print_usage((char const   *)(temp_buf));
#line 124
                        exit(1);
                      }
#line 126
                      max_clients = (int )num;
                    } else {
#line 127
                      if (0) {
#line 127
                        __s1_len___1 = strlen((char const   *)*(argv + i));
#line 127
                        __s2_len___1 = strlen("-N");
#line 127
                        if (! ((size_t )((void const   *)(*(argv + i) + 1)) - (size_t )((void const   *)*(argv + i)) == 1UL)) {
#line 127
                          goto _L___5;
                        } else
#line 127
                        if (__s1_len___1 >= 4UL) {
                          _L___5: /* CIL Label */ 
#line 127
                          if (! ((size_t )((void const   *)("-N" + 1)) - (size_t )((void const   *)"-N") == 1UL)) {
#line 127
                            tmp___20 = 1;
                          } else
#line 127
                          if (__s2_len___1 >= 4UL) {
#line 127
                            tmp___20 = 1;
                          } else {
#line 127
                            tmp___20 = 0;
                          }
                        } else {
#line 127
                          tmp___20 = 0;
                        }
#line 127
                        if (tmp___20) {
#line 127
                          tmp___15 = __builtin_strcmp((char const   *)*(argv + i),
                                                      "-N");
#line 127
                          tmp___19 = tmp___15;
                        } else {
#line 127
                          tmp___18 = __builtin_strcmp((char const   *)*(argv + i),
                                                      "-N");
#line 127
                          tmp___19 = tmp___18;
                        }
                      } else {
#line 127
                        tmp___18 = __builtin_strcmp((char const   *)*(argv + i), "-N");
#line 127
                        tmp___19 = tmp___18;
                      }
#line 128
                      if (tmp___19 == 0) {
#line 129
                        detach = 0;
                      } else {
#line 128
                        if (0) {
#line 128
                          __s1_len___2 = strlen((char const   *)*(argv + i));
#line 128
                          __s2_len___2 = strlen("--nodetach");
#line 128
                          if (! ((size_t )((void const   *)(*(argv + i) + 1)) - (size_t )((void const   *)*(argv + i)) == 1UL)) {
#line 128
                            goto _L___7;
                          } else
#line 128
                          if (__s1_len___2 >= 4UL) {
                            _L___7: /* CIL Label */ 
#line 128
                            if (! ((size_t )((void const   *)("--nodetach" + 1)) - (size_t )((void const   *)"--nodetach") == 1UL)) {
#line 128
                              tmp___27 = 1;
                            } else
#line 128
                            if (__s2_len___2 >= 4UL) {
#line 128
                              tmp___27 = 1;
                            } else {
#line 128
                              tmp___27 = 0;
                            }
                          } else {
#line 128
                            tmp___27 = 0;
                          }
#line 128
                          if (tmp___27) {
#line 128
                            tmp___22 = __builtin_strcmp((char const   *)*(argv + i),
                                                        "--nodetach");
#line 128
                            tmp___26 = tmp___22;
                          } else {
#line 128
                            tmp___25 = __builtin_strcmp((char const   *)*(argv + i),
                                                        "--nodetach");
#line 128
                            tmp___26 = tmp___25;
                          }
                        } else {
#line 128
                          tmp___25 = __builtin_strcmp((char const   *)*(argv + i),
                                                      "--nodetach");
#line 128
                          tmp___26 = tmp___25;
                        }
#line 128
                        if (tmp___26 == 0) {
#line 129
                          detach = 0;
                        } else {
#line 130
                          if (0) {
#line 130
                            __s1_len = strlen((char const   *)*(argv + i));
#line 130
                            __s2_len = strlen("-l");
#line 130
                            if (! ((size_t )((void const   *)(*(argv + i) + 1)) - (size_t )((void const   *)*(argv + i)) == 1UL)) {
#line 130
                              goto _L___0;
                            } else
#line 130
                            if (__s1_len >= 4UL) {
                              _L___0: /* CIL Label */ 
#line 130
                              if (! ((size_t )((void const   *)("-l" + 1)) - (size_t )((void const   *)"-l") == 1UL)) {
#line 130
                                tmp___6 = 1;
                              } else
#line 130
                              if (__s2_len >= 4UL) {
#line 130
                                tmp___6 = 1;
                              } else {
#line 130
                                tmp___6 = 0;
                              }
                            } else {
#line 130
                              tmp___6 = 0;
                            }
#line 130
                            if (tmp___6) {
#line 130
                              tmp___1 = __builtin_strcmp((char const   *)*(argv + i),
                                                         "-l");
#line 130
                              tmp___5 = tmp___1;
                            } else {
#line 130
                              tmp___4 = __builtin_strcmp((char const   *)*(argv + i),
                                                         "-l");
#line 130
                              tmp___5 = tmp___4;
                            }
                          } else {
#line 130
                            tmp___4 = __builtin_strcmp((char const   *)*(argv + i),
                                                       "-l");
#line 130
                            tmp___5 = tmp___4;
                          }
#line 131
                          if (tmp___5 == 0) {
#line 131
                            goto _L___3;
                          } else {
#line 131
                            if (0) {
#line 131
                              __s1_len___0 = strlen((char const   *)*(argv + i));
#line 131
                              __s2_len___0 = strlen("--local");
#line 131
                              if (! ((size_t )((void const   *)(*(argv + i) + 1)) - (size_t )((void const   *)*(argv + i)) == 1UL)) {
#line 131
                                goto _L___2;
                              } else
#line 131
                              if (__s1_len___0 >= 4UL) {
                                _L___2: /* CIL Label */ 
#line 131
                                if (! ((size_t )((void const   *)("--local" + 1)) - (size_t )((void const   *)"--local") == 1UL)) {
#line 131
                                  tmp___13 = 1;
                                } else
#line 131
                                if (__s2_len___0 >= 4UL) {
#line 131
                                  tmp___13 = 1;
                                } else {
#line 131
                                  tmp___13 = 0;
                                }
                              } else {
#line 131
                                tmp___13 = 0;
                              }
#line 131
                              if (tmp___13) {
#line 131
                                tmp___8 = __builtin_strcmp((char const   *)*(argv + i),
                                                           "--local");
#line 131
                                tmp___12 = tmp___8;
                              } else {
#line 131
                                tmp___11 = __builtin_strcmp((char const   *)*(argv + i),
                                                            "--local");
#line 131
                                tmp___12 = tmp___11;
                              }
                            } else {
#line 131
                              tmp___11 = __builtin_strcmp((char const   *)*(argv + i),
                                                          "--local");
#line 131
                              tmp___12 = tmp___11;
                            }
#line 131
                            if (tmp___12 == 0) {
                              _L___3: /* CIL Label */ 
#line 132
                              i ++;
#line 132
                              if (i >= argc) {
#line 133
                                print_usage("missing number for local facility logging");
#line 134
                                exit(1);
                              }
#line 136
                              switch ((int )*(*(argv + i) + 0)) {
                              case 48: 
#line 138
                              log_facility = 16 << 3;
#line 139
                              break;
                              case 49: 
#line 141
                              log_facility = 17 << 3;
#line 142
                              break;
                              case 50: 
#line 144
                              log_facility = 18 << 3;
#line 145
                              break;
                              case 51: 
#line 147
                              log_facility = 19 << 3;
#line 148
                              break;
                              case 52: 
#line 150
                              log_facility = 20 << 3;
#line 151
                              break;
                              case 53: 
#line 153
                              log_facility = 21 << 3;
#line 154
                              break;
                              case 54: 
#line 156
                              log_facility = 22 << 3;
#line 157
                              break;
                              case 55: 
#line 159
                              log_facility = 23 << 3;
#line 160
                              break;
                              }
                            } else {
#line 163
                              print_usage("unknown option");
#line 164
                              exit(1);
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    } else
#line 169
    if ((unsigned long )user_ptr == (unsigned long )((void *)0)) {
#line 170
      user_ptr = *(argv + i);
    } else
#line 171
    if ((unsigned long )dir_ptr == (unsigned long )((void *)0)) {
#line 172
      dir_ptr = *(argv + i);
    } else {
#line 174
      print_usage("too many arguments on the command line");
#line 175
      exit(1);
    }
#line 77
    i ++;
  }
#line 179
  if ((unsigned long )user_ptr == (unsigned long )((void *)0)) {
#line 180
    print_usage("missing user and/or directory name");
#line 181
    exit(1);
  } else
#line 179
  if ((unsigned long )dir_ptr == (unsigned long )((void *)0)) {
#line 180
    print_usage("missing user and/or directory name");
#line 181
    exit(1);
  }
#line 184
  user_info = getpwnam((char const   *)user_ptr);
#line 185
  if ((unsigned long )user_info == (unsigned long )((void *)0)) {
#line 186
    fprintf((FILE */* __restrict  */)stderr, (char const   */* __restrict  */)"%s: invalid user name\n",
            exe_name);
#line 187
    exit(1);
  }
#line 191
  if (detach) {
#line 192
    daemonize();
  }
#line 196
  signal(13, (void (*)(int  ))1);
#line 199
  openlog((char const   *)((void *)0), 8, log_facility);
#line 200
  tmp___84 = getpid();
#line 200
  syslog(6, "Starting, version %s, as PID %d", "0.3.7", tmp___84);
#line 203
  tmp___87 = chroot((char const   *)dir_ptr);
#line 203
  if (tmp___87 != 0) {
#line 204
    tmp___85 = __errno_location();
#line 204
    tmp___86 = strerror(*tmp___85);
#line 204
    syslog(3, "error with root directory; %s\n", exe_name, tmp___86);
#line 206
    exit(1);
  }
#line 208
  tmp___90 = chdir("/");
#line 208
  if (tmp___90 != 0) {
#line 209
    tmp___88 = __errno_location();
#line 209
    tmp___89 = strerror(*tmp___88);
#line 209
    syslog(3, "error changing directory; %s\n", tmp___89);
#line 210
    exit(1);
  }
#line 214
  tmp___92 = ftp_listener_init(& ftp_listener, address, port, max_clients, 900, & err);
#line 214
  if (! tmp___92) {
#line 221
    tmp___91 = error_get_desc((error_t const   *)(& err));
#line 221
    syslog(3, "error initializing FTP listener; %s", tmp___91);
#line 223
    exit(1);
  }
#line 227
  tmp___95 = setgid(user_info->pw_gid);
#line 227
  if (tmp___95 != 0) {
#line 228
    tmp___93 = __errno_location();
#line 228
    tmp___94 = strerror(*tmp___93);
#line 228
    syslog(3, "error changing group; %s", tmp___94);
#line 229
    exit(1);
  }
#line 231
  tmp___98 = setuid(user_info->pw_uid);
#line 231
  if (tmp___98 != 0) {
#line 232
    tmp___96 = __errno_location();
#line 232
    tmp___97 = strerror(*tmp___96);
#line 232
    syslog(3, "error changing group; %s", tmp___97);
#line 233
    exit(1);
  }
#line 237
  tmp___100 = ftp_listener_start(& ftp_listener, & err);
#line 237
  if (tmp___100 == 0) {
#line 238
    tmp___99 = error_get_desc((error_t const   *)(& err));
#line 238
    syslog(3, "error starting FTP service; %s", tmp___99);
#line 239
    exit(1);
  }
#line 243
  sigemptyset(& term_signal);
#line 244
  sigaddset(& term_signal, 15);
#line 245
  sigaddset(& term_signal, 2);
#line 246
  pthread_sigmask(0, (__sigset_t const   */* __restrict  */)(& term_signal), (__sigset_t */* __restrict  */)((void *)0));
#line 247
  sigwait((sigset_t const   */* __restrict  */)(& term_signal), (int */* __restrict  */)(& sig));
#line 248
  if (sig == 15) {
#line 249
    syslog(6, "SIGTERM received, shutting down");
  } else {
#line 251
    syslog(6, "SIGINT received, shutting down");
  }
#line 253
  ftp_listener_stop(& ftp_listener);
#line 254
  syslog(6, "all connections finished, FTP server exiting");
#line 255
  exit(0);
}
}
#line 258 "oftpd.c"
static void print_usage(char const   *error ) 
{ 
  struct _IO_FILE **__cil_gp_stderr  = & stderr;
  char const   **__cil_gp_exe_name  = & exe_name;
  int __cil_tmp4 ;
  struct _IO_FILE *__cil_tmp5 ;
  char const   *__cil_tmp6 ;
  struct _IO_FILE *__cil_tmp7 ;
  char const   *__cil_tmp8 ;
  struct _IO_FILE *__cil_tmp9 ;

  {
  {
#line 260
  __cil_tmp4 = (unsigned long )error != (unsigned long )((void *)0);
#line 260
  if (__cil_tmp4) {
    {
#line 261
    __cil_tmp5 = *__cil_gp_stderr;
#line 261
    __cil_tmp6 = *__cil_gp_exe_name;
#line 261
    fprintf((FILE */* __restrict  */)__cil_tmp5, (char const   */* __restrict  */)"%s: %s\n",
            __cil_tmp6, error);
    }
  } else {

  }
  }
  {
#line 263
  __cil_tmp7 = *__cil_gp_stderr;
#line 263
  __cil_tmp8 = *__cil_gp_exe_name;
#line 263
  fprintf((FILE */* __restrict  */)__cil_tmp7, (char const   */* __restrict  */)" Syntax: %s [ options... ] user_name root_directory\n",
          __cil_tmp8);
#line 265
  __cil_tmp9 = *__cil_gp_stderr;
#line 265
  fprintf((FILE */* __restrict  */)__cil_tmp9, (char const   */* __restrict  */)" Options:\n -p, --port <num>\n     Set the port to listen on (Default: %d)\n -i, --interface <IP Address>\n     Set the interface to listen on (Default: all)\n -m, --max-clients <num>\n     Set the number of clients allowed at one time (Default: %d)\n-l, --local <local-logging>\n     Use LOCAL facility for syslog, local-logging is 0 to 7\n -N, --nodetach\n     Do not detach from TTY and become a daemon\n",
          21, 250);
  }
#line 278
  return;
}
}
#line 280 "oftpd.c"
static void daemonize(void) 
{ 
  struct _IO_FILE **__cil_gp_stderr  = & stderr;
  char const   **__cil_gp_exe_name  = & exe_name;
  int null_fd_ssa_1 ;
  int *tmp_ssa_1 ;
  char *tmp___0_ssa_1 ;
  long tmp___1_ssa_1 ;
  int max_fd_ssa_1 ;
  int *tmp___2_ssa_1 ;
  char *tmp___3_ssa_1 ;
  int fork_ret_ssa_1 ;
  int *tmp___4_ssa_1 ;
  char *tmp___5_ssa_1 ;
  __pid_t tmp___8_ssa_1 ;
  int *tmp___6_ssa_1 ;
  char *tmp___7_ssa_1 ;
  int fork_ret_ssa_2 ;
  int *tmp___9_ssa_1 ;
  char *tmp___10_ssa_1 ;
  int tmp___13_ssa_1 ;
  int *tmp___11_ssa_1 ;
  char *tmp___12_ssa_1 ;
  int tmp___16_ssa_1 ;
  int *tmp___14_ssa_1 ;
  char *tmp___15_ssa_1 ;
  int tmp___19_ssa_1 ;
  int *tmp___17_ssa_1 ;
  char *tmp___18_ssa_1 ;
  int fd_ssa_1 ;
  int __cil_tmp54 ;
  int __cil_tmp55 ;
  int __cil_tmp56 ;
  int __cil_tmp57 ;
  int __cil_tmp58 ;
  int __cil_tmp59 ;
  int __cil_tmp60 ;
  int __cil_tmp61 ;
  int __cil_tmp62 ;
  int __cil_tmp63 ;
  int __cil_tmp64 ;
  struct _IO_FILE *__cil_tmp65 ;
  char const   *__cil_tmp66 ;
  int __cil_tmp67 ;
  struct _IO_FILE *__cil_tmp68 ;
  char const   *__cil_tmp69 ;
  int __cil_tmp70 ;
  struct _IO_FILE *__cil_tmp71 ;
  char const   *__cil_tmp72 ;
  int __cil_tmp73 ;
  struct _IO_FILE *__cil_tmp74 ;
  char const   *__cil_tmp75 ;
  int __cil_tmp76 ;
  struct _IO_FILE *__cil_tmp77 ;
  char const   *__cil_tmp78 ;
  int __cil_tmp79 ;
  int __cil_tmp80 ;
  int __cil_tmp81 ;

  {
  {
#line 287
  null_fd_ssa_1 = open("/dev/null", 2);
  }
  {
#line 288
  __cil_tmp54 = null_fd_ssa_1 == -1;
#line 288
  if (__cil_tmp54) {
    {
#line 289
    tmp_ssa_1 = __errno_location();
#line 289
    __cil_tmp64 = *tmp_ssa_1;
#line 289
    tmp___0_ssa_1 = strerror(__cil_tmp64);
#line 289
    __cil_tmp65 = *__cil_gp_stderr;
#line 289
    __cil_tmp66 = *__cil_gp_exe_name;
#line 289
    fprintf((FILE */* __restrict  */)__cil_tmp65, (char const   */* __restrict  */)"%s: error opening null output device; %s\n",
            __cil_tmp66, tmp___0_ssa_1);
#line 291
    exit(1);
    }
  } else {

  }
  }
  {
#line 294
  tmp___1_ssa_1 = sysconf(4);
#line 294
  max_fd_ssa_1 = (int )tmp___1_ssa_1;
  }
  {
#line 295
  __cil_tmp55 = max_fd_ssa_1 == -1;
#line 295
  if (__cil_tmp55) {
    {
#line 296
    tmp___2_ssa_1 = __errno_location();
#line 296
    __cil_tmp67 = *tmp___2_ssa_1;
#line 296
    tmp___3_ssa_1 = strerror(__cil_tmp67);
#line 296
    __cil_tmp68 = *__cil_gp_stderr;
#line 296
    __cil_tmp69 = *__cil_gp_exe_name;
#line 296
    fprintf((FILE */* __restrict  */)__cil_tmp68, (char const   */* __restrict  */)"%s: error getting maximum open file; %s\n",
            __cil_tmp69, tmp___3_ssa_1);
#line 298
    exit(1);
    }
  } else {

  }
  }
  {
#line 302
  fork_ret_ssa_1 = fork();
  }
  {
#line 303
  __cil_tmp56 = fork_ret_ssa_1 == -1;
#line 303
  if (__cil_tmp56) {
    {
#line 304
    tmp___4_ssa_1 = __errno_location();
#line 304
    __cil_tmp70 = *tmp___4_ssa_1;
#line 304
    tmp___5_ssa_1 = strerror(__cil_tmp70);
#line 304
    __cil_tmp71 = *__cil_gp_stderr;
#line 304
    __cil_tmp72 = *__cil_gp_exe_name;
#line 304
    fprintf((FILE */* __restrict  */)__cil_tmp71, (char const   */* __restrict  */)"%s: error forking; %s\n",
            __cil_tmp72, tmp___5_ssa_1);
#line 305
    exit(1);
    }
  } else {

  }
  }
  {
#line 307
  __cil_tmp57 = fork_ret_ssa_1 != 0;
#line 307
  if (__cil_tmp57) {
    {
#line 308
    exit(0);
    }
  } else {

  }
  }
  {
#line 310
  tmp___8_ssa_1 = setsid();
  }
  {
#line 310
  __cil_tmp58 = tmp___8_ssa_1 == -1;
#line 310
  if (__cil_tmp58) {
    {
#line 311
    tmp___6_ssa_1 = __errno_location();
#line 311
    __cil_tmp73 = *tmp___6_ssa_1;
#line 311
    tmp___7_ssa_1 = strerror(__cil_tmp73);
#line 311
    __cil_tmp74 = *__cil_gp_stderr;
#line 311
    __cil_tmp75 = *__cil_gp_exe_name;
#line 311
    fprintf((FILE */* __restrict  */)__cil_tmp74, (char const   */* __restrict  */)"%s: error creating process group; %s\n",
            __cil_tmp75, tmp___7_ssa_1);
#line 313
    exit(1);
    }
  } else {

  }
  }
  {
#line 315
  fork_ret_ssa_2 = fork();
  }
  {
#line 316
  __cil_tmp59 = fork_ret_ssa_2 == -1;
#line 316
  if (__cil_tmp59) {
    {
#line 317
    tmp___9_ssa_1 = __errno_location();
#line 317
    __cil_tmp76 = *tmp___9_ssa_1;
#line 317
    tmp___10_ssa_1 = strerror(__cil_tmp76);
#line 317
    __cil_tmp77 = *__cil_gp_stderr;
#line 317
    __cil_tmp78 = *__cil_gp_exe_name;
#line 317
    fprintf((FILE */* __restrict  */)__cil_tmp77, (char const   */* __restrict  */)"%s: error forking; %s\n",
            __cil_tmp78, tmp___10_ssa_1);
#line 318
    exit(1);
    }
  } else {

  }
  }
  {
#line 320
  __cil_tmp60 = fork_ret_ssa_2 != 0;
#line 320
  if (__cil_tmp60) {
    {
#line 321
    exit(0);
    }
  } else {

  }
  }
  {
#line 323
  tmp___13_ssa_1 = dup2(null_fd_ssa_1, 0);
  }
  {
#line 323
  __cil_tmp61 = tmp___13_ssa_1 == -1;
#line 323
  if (__cil_tmp61) {
    {
#line 324
    tmp___11_ssa_1 = __errno_location();
#line 324
    __cil_tmp79 = *tmp___11_ssa_1;
#line 324
    tmp___12_ssa_1 = strerror(__cil_tmp79);
#line 324
    syslog(3, "error setting input to null; %s", tmp___12_ssa_1);
#line 326
    exit(1);
    }
  } else {

  }
  }
  {
#line 328
  tmp___16_ssa_1 = dup2(null_fd_ssa_1, 1);
  }
  {
#line 328
  __cil_tmp62 = tmp___16_ssa_1 == -1;
#line 328
  if (__cil_tmp62) {
    {
#line 329
    tmp___14_ssa_1 = __errno_location();
#line 329
    __cil_tmp80 = *tmp___14_ssa_1;
#line 329
    tmp___15_ssa_1 = strerror(__cil_tmp80);
#line 329
    syslog(3, "error setting output to null; %s", tmp___15_ssa_1);
#line 331
    exit(1);
    }
  } else {

  }
  }
  {
#line 333
  tmp___19_ssa_1 = dup2(null_fd_ssa_1, 2);
  }
  {
#line 333
  __cil_tmp63 = tmp___19_ssa_1 == -1;
#line 333
  if (__cil_tmp63) {
    {
#line 334
    tmp___17_ssa_1 = __errno_location();
#line 334
    __cil_tmp81 = *tmp___17_ssa_1;
#line 334
    tmp___18_ssa_1 = strerror(__cil_tmp81);
#line 334
    syslog(3, "error setting error output to null; %s", tmp___18_ssa_1);
#line 336
    exit(1);
    }
  } else {

  }
  }
  {
#line 338
  fd_ssa_1 = 3;
  }
  {
#line 338
  daemonize_cil_lr_1(max_fd_ssa_1, fd_ssa_1);
  }
#line 341
  return;
}
}
void daemonize_cil_lr_1(int max_fd , int fd ) 
{ 
  int fd_ssa_1 ;
  int __cil_tmp4 ;

  {
  {
#line 338
  __cil_tmp4 = fd < max_fd;
#line 338
  if (__cil_tmp4) {
    {
#line 339
    close(fd);
#line 338
    fd_ssa_1 = fd + 1;
    }
    {
    daemonize_cil_lr_1(max_fd, fd_ssa_1);
    }
    return;
  } else {
    return;
  }
  }
}
}
