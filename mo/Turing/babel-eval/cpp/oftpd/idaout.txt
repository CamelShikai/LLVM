USE32

section .text

global __init_proc

__init_proc:
4201688    sub     rsp, 8
4201692    mov     rax, [cs:__gmon_start___ptr]
4201699    test    rax, rax
4201702    jz      loc_401CED
4201704    call    ___gmon_start__
loc_401CED:
4201709    add     rsp, 8
4201713    retn    
USE32

section .text

global _main

_main:
4203392    push    r15
4203394    mov     r15, rsi
4203397    push    r14
4203399    push    r13
4203401    push    r12
4203403    mov     r12d, edi
4203406    push    rbp
4203407    push    rbx
4203408    sub     rsp, 1228h
4203415    mov     rax, [fs:28h]
4203424    mov     [rsp+1218h], rax
4203432    xor     eax, eax
4203434    test    edi, edi
4203436    jle     loc_4023B8
4203438    mov     rax, [rsi]
4203441    mov     [cs:exe_name], rax
loc_4023B8:
4203448    call    _geteuid
4203453    test    eax, eax
4203455    jnz     loc_40264B
4203461    cmp     r12d, 1
4203465    jle     loc_402677
4203471    mov     dword [rsp+1Ch], 1
4203479    mov     qword [rsp+8], 0
4203488    xor     r14d, r14d
4203491    xor     r13d, r13d
4203494    mov     dword [rsp+14h], 58h
4203502    mov     dword [rsp+18h], 0FAh
4203510    xor     r10d, r10d
4203513    mov     ebx, 1
4203518    jmp     loc_402421
loc_402400:
4203520    test    r13, r13
4203523    jz      loc_402590
4203529    test    r14, r14
4203532    jnz     loc_40268B
4203538    mov     r14, rbp
loc_402415:
4203541    add     ebx, 1
4203544    cmp     r12d, ebx
4203547    jle     loc_4024C6
loc_402421:
4203553    movsxd  rax, ebx
4203556    mov     rbp, [r15+rax*8]
4203560    lea     rdx, 0[rax*8]
4203568    cmp     byte [rbp+0], 2Dh
4203572    jnz     loc_402400
4203574    movzx   r11d, byte [rbp+1]
4203579    cmp     r11b, 70h
4203583    jz      loc_4025A0
loc_402445:
4203589    mov     esi, s2
4203594    mov     rdi, rbp
4203597    mov     [rsp+2Ch], r11d
4203602    mov     [rsp+20h], rdx
4203607    mov     [rsp+28h], r10d
4203612    call    _strcmp
4203617    test    eax, eax
4203619    mov     r10d, [rsp+28h]
4203624    mov     rdx, [rsp+20h]
4203629    mov     r11d, [rsp+2Ch]
4203634    jnz     loc_4025AF
4203640    nop     dword [rax+rax+00000000h]
loc_402480:
4203648    add     ebx, 1
4203651    cmp     r12d, ebx
4203654    jle     loc_402859
4203660    mov     rdi, [r15+rdx+8]
4203665    lea     rsi, [rsp+38h]
4203670    xor     edx, edx
4203672    call    _strtol
4203677    cmp     rax, 0FFFFh
4203683    ja      loc_4027AF
4203689    mov     rdx, [rsp+38h]
4203694    cmp     byte [rdx], 0
4203697    jnz     loc_4027AF
4203703    add     ebx, 1
4203706    mov     r10d, eax
4203709    cmp     r12d, ebx
4203712    jg      loc_402421
loc_4024C6:
4203718    test    r14, r14
4203721    mov     [rsp+28h], r10d
4203726    jz      loc_402677
4203732    test    r13, r13
4203735    jz      loc_402677
4203741    mov     rdi, r13
4203744    call    _getpwnam
4203749    test    rax, rax
4203752    mov     rbp, rax
4203755    mov     r10d, [rsp+28h]
4203760    jz      loc_402AAF
4203766    cmp     dword [rsp+1Ch], 0
4203771    jnz     loc_402883
loc_402501:
4203777    mov     esi, 1
4203782    mov     edi, 0Dh
4203787    mov     [rsp+1Ch], r10d
4203792    call    _signal
4203797    mov     edx, [rsp+14h]
4203801    xor     edi, edi
4203803    mov     esi, 8
4203808    call    _openlog
4203813    call    _getpid
4203818    mov     edx, a0_3_7
4203823    mov     ecx, eax
4203825    mov     esi, fmt
4203830    xor     eax, eax
4203832    mov     edi, 6
4203837    call    _syslog
4203842    mov     rdi, r14
4203845    call    _chroot
4203850    test    eax, eax
4203852    mov     r10d, [rsp+1Ch]
4203857    jz      loc_4027E7
4203863    call    ___errno_location
4203868    mov     edi, [rax]
4203870    call    _strerror
4203875    mov     rdx, [cs:exe_name]
4203882    mov     rcx, rax
4203885    mov     edi, 3
4203890    mov     esi, aErrorWithRootD
4203895    xor     eax, eax
4203897    call    _syslog
4203902    mov     edi, 1
4203907    call    _exit
4203912    align 10h
loc_402590:
4203920    mov     r13, rbp
4203923    jmp     loc_402415
4203928    align 20h
loc_4025A0:
4203936    cmp     byte [rbp+2], 0
4203940    jz      loc_402480
4203946    jmp     loc_402445
loc_4025AF:
4203951    cmp     r11b, 68h
4203955    jnz     loc_4025BF
4203957    cmp     byte [rbp+2], 0
4203961    jz      loc_4029A6
loc_4025BF:
4203967    mov     esi, aHelp
4203972    mov     rdi, rbp
4203975    mov     [rsp+2Ch], r11d
4203980    mov     [rsp+20h], rdx
4203985    mov     [rsp+28h], r10d
4203990    call    _strcmp
4203995    test    eax, eax
4203997    mov     r10d, [rsp+28h]
4204002    mov     rdx, [rsp+20h]
4204007    mov     r11d, [rsp+2Ch]
4204012    jz      loc_4029A6
4204018    cmp     r11b, 69h
4204022    jz      loc_40266F
loc_4025F8:
4204024    mov     esi, aInterface
4204029    mov     rdi, rbp
4204032    mov     [rsp+2Ch], r11d
4204037    mov     [rsp+20h], rdx
4204042    mov     [rsp+28h], r10d
4204047    call    _strcmp
4204052    test    eax, eax
4204054    mov     r10d, [rsp+28h]
4204059    mov     rdx, [rsp+20h]
4204064    mov     r11d, [rsp+2Ch]
4204069    jnz     loc_40269F
4204071    nop     word [rax+rax+00000000h]
loc_402630:
4204080    add     ebx, 1
4204083    cmp     r12d, ebx
4204086    jle     loc_402A6B
4204092    mov     rax, [r15+rdx+8]
4204097    mov     [rsp+8], rax
4204102    jmp     loc_402415
loc_40264B:
4204107    mov     rdx, [cs:exe_name]
4204114    mov     esi, format
loc_402657:
4204119    mov     rdi, [cs:stderr@@GLIBC_2_2_5]
4204126    xor     eax, eax
4204128    call    _fprintf
4204133    mov     edi, 1
4204138    call    _exit
loc_40266F:
4204143    cmp     byte [rbp+2], 0
4204147    jz      loc_402630
4204149    jmp     loc_4025F8
loc_402677:
4204151    mov     edi, aMissingUserAnd
4204156    call    _print_usage
4204161    mov     edi, 1
4204166    call    _exit
loc_40268B:
4204171    mov     edi, aTooManyArgumen
4204176    call    _print_usage
4204181    mov     edi, 1
4204186    call    _exit
loc_40269F:
4204191    cmp     r11b, 6Dh
4204195    jz      loc_402756
loc_4026A9:
4204201    mov     esi, aMaxClients
4204206    mov     rdi, rbp
4204209    mov     [rsp+2Ch], r11d
4204214    mov     [rsp+20h], rdx
4204219    mov     [rsp+28h], r10d
4204224    call    _strcmp
4204229    test    eax, eax
4204231    mov     r10d, [rsp+28h]
4204236    mov     rdx, [rsp+20h]
4204241    mov     r11d, [rsp+2Ch]
4204246    jz      loc_402760
4204252    cmp     r11b, 4Eh
4204256    jz      loc_402A7F
loc_4026E6:
4204262    mov     esi, aNodetach
4204267    mov     rdi, rbp
4204270    mov     [rsp+2Ch], r11d
4204275    mov     [rsp+20h], rdx
4204280    mov     [rsp+28h], r10d
4204285    call    _strcmp
4204290    test    eax, eax
4204292    mov     r10d, [rsp+28h]
4204297    mov     rdx, [rsp+20h]
4204302    mov     r11d, [rsp+2Ch]
4204307    jz      loc_402A89
4204313    cmp     r11b, 6Ch
4204317    jnz     loc_402AC0
4204323    cmp     byte [rbp+2], 0
4204327    jnz     loc_402AC0
loc_40272D:
4204333    add     ebx, 1
4204336    cmp     r12d, ebx
4204339    jle     loc_402BAC
4204345    mov     rax, [r15+rdx+8]
4204350    movzx   eax, byte [rax]
4204353    sub     eax, 30h
4204356    cmp     al, 7
4204358    ja      loc_402415
4204364    movzx   eax, al
4204367    jmp     off_40C870[rax*8]
loc_402756:
4204374    cmp     byte [rbp+2], 0
4204378    jnz     loc_4026A9
loc_402760:
4204384    add     ebx, 1
4204387    cmp     r12d, ebx
4204390    jle     loc_402B12
4204396    mov     rdi, [r15+rdx+8]
4204401    lea     rsi, [rsp+38h]
4204406    xor     edx, edx
4204408    mov     [rsp+18h], r10d
4204413    call    _strtol
4204418    lea     rdx, [rax-1]
4204422    cmp     rdx, 12Bh
4204429    ja      loc_402AFD
4204435    mov     rdx, [rsp+38h]
4204440    mov     r10d, [rsp+18h]
4204445    cmp     byte [rdx], 0
4204448    jnz     loc_402AFD
4204454    mov     [rsp+18h], eax
4204458    jmp     loc_402415
loc_4027AF:
4204463    mov     r8d, 0FFFFh
4204469    xor     ecx, ecx
4204471    mov     edx, aPortMustBeANum
loc_4027BC:
4204476    lea     rdi, [rsp+150h]
4204484    mov     esi, 100h
4204489    xor     eax, eax
4204491    call    _snprintf
4204496    lea     rdi, [rsp+150h]
4204504    call    _print_usage
4204509    mov     edi, 1
4204514    call    _exit
loc_4027E7:
4204519    mov     edi, path
4204524    mov     [rsp+14h], r10d
4204529    call    _chdir
4204534    test    eax, eax
4204536    mov     r10d, [rsp+14h]
4204541    jnz     loc_40286D
4204543    mov     ecx, [rsp+18h]
4204547    mov     rsi, [rsp+8]
4204552    lea     r9, [rsp+0C0h]
4204560    lea     rdi, [rsp+150h]
4204568    mov     r8d, 384h
4204574    mov     edx, r10d
4204577    call    _ftp_listener_init
4204582    test    eax, eax
4204584    jnz     loc_402A1C
4204590    lea     rdi, [rsp+0C0h]
4204598    call    _error_get_desc
4204603    mov     esi, aErrorInitializ
4204608    mov     rdx, rax
loc_402843:
4204611    mov     edi, 3
4204616    xor     eax, eax
4204618    call    _syslog
4204623    mov     edi, 1
4204628    call    _exit
loc_402859:
4204633    mov     edi, aMissingPortNum
4204638    call    _print_usage
4204643    mov     edi, 1
4204648    call    _exit
loc_40286D:
4204653    call    ___errno_location
4204658    mov     edi, [rax]
4204660    call    _strerror
4204665    mov     esi, aErrorChangingD
4204670    mov     rdx, rax
4204673    jmp     loc_402843
loc_402883:
4204675    xor     eax, eax
4204677    mov     esi, 2
4204682    mov     edi, file
4204687    mov     [rsp+1Ch], r10d
4204692    call    _open
4204697    cmp     eax, 0FFFFFFFFh
4204700    mov     r12d, eax
4204703    mov     r10d, [rsp+1Ch]
4204708    jz      loc_402C5B
4204714    mov     edi, 4
4204719    mov     [rsp+1Ch], r10d
4204724    call    _sysconf
4204729    mov     ebx, eax
4204731    add     eax, 1
4204734    mov     r10d, [rsp+1Ch]
4204739    jz      loc_402C3E
4204745    mov     [rsp+1Ch], r10d
4204750    call    _fork
4204755    cmp     eax, 0FFFFFFFFh
4204758    mov     r10d, [rsp+1Ch]
4204763    jz      loc_402C78
4204769    test    eax, eax
4204771    jnz     loc_402BA5
4204777    mov     [rsp+1Ch], r10d
4204782    call    _setsid
4204787    add     eax, 1
4204790    mov     r10d, [rsp+1Ch]
4204795    jz      loc_402C0B
4204801    mov     [rsp+1Ch], r10d
4204806    call    _fork
4204811    cmp     eax, 0FFFFFFFFh
4204814    mov     r10d, [rsp+1Ch]
4204819    jz      loc_402C78
4204825    test    eax, eax
4204827    mov     [rsp+1Ch], r10d
4204832    jnz     loc_402BA5
4204838    xor     esi, esi
4204840    mov     edi, r12d
4204843    call    _dup2
4204848    add     eax, 1
4204851    mov     r10d, [rsp+1Ch]
4204856    jz      loc_402BF2
4204862    mov     esi, 1
4204867    mov     edi, r12d
4204870    mov     [rsp+1Ch], r10d
4204875    call    _dup2
4204880    add     eax, 1
4204883    mov     r10d, [rsp+1Ch]
4204888    jz      loc_402BD9
4204894    mov     esi, 2
4204899    mov     edi, r12d
4204902    mov     [rsp+1Ch], r10d
4204907    call    _dup2
4204912    add     eax, 1
4204915    jz      loc_402BC0
4204921    mov     r12d, 3
4204927    mov     r10d, [rsp+1Ch]
4204932    jmp     loc_40299C
loc_402986:
4204934    mov     edi, r12d
4204937    mov     [rsp+1Ch], r10d
4204942    add     r12d, 1
4204946    call    _close
4204951    mov     r10d, [rsp+1Ch]
loc_40299C:
4204956    cmp     ebx, r12d
4204959    jg      loc_402986
4204961    jmp     loc_402501
loc_4029A6:
4204966    xor     edi, edi
4204968    call    _print_usage
4204973    xor     edi, edi
4204975    call    _exit
loc_4029B4:
4204980    mov     dword [rsp+14h], 0B0h
4204988    jmp     loc_402415
loc_4029C1:
4204993    mov     dword [rsp+14h], 0A8h
4205001    jmp     loc_402415
loc_4029CE:
4205006    mov     dword [rsp+14h], 0A0h
4205014    jmp     loc_402415
loc_4029DB:
4205019    mov     dword [rsp+14h], 98h
4205027    jmp     loc_402415
loc_4029E8:
4205032    mov     dword [rsp+14h], 90h
4205040    jmp     loc_402415
loc_4029F5:
4205045    mov     dword [rsp+14h], 88h
4205053    jmp     loc_402415
loc_402A02:
4205058    mov     dword [rsp+14h], 80h
4205066    jmp     loc_402415
loc_402A0F:
4205071    mov     dword [rsp+14h], 0B8h
4205079    jmp     loc_402415
loc_402A1C:
4205084    mov     edi, [rbp+14h]
4205087    call    _setgid
4205092    test    eax, eax
4205094    jnz     loc_402A96
4205096    mov     edi, [rbp+10h]
4205099    call    _setuid
4205104    test    eax, eax
4205106    jnz     loc_402A96
4205108    lea     rsi, [rsp+0C0h]
4205116    lea     rdi, [rsp+150h]
4205124    call    _ftp_listener_start
4205129    test    eax, eax
4205131    jnz     loc_402B26
4205137    lea     rdi, [rsp+0C0h]
4205145    call    _error_get_desc
4205150    mov     esi, aErrorStartingF
4205155    mov     rdx, rax
4205158    jmp     loc_402843
loc_402A6B:
4205163    mov     edi, aMissingInterfa
4205168    call    _print_usage
4205173    mov     edi, 1
4205178    call    _exit
loc_402A7F:
4205183    cmp     byte [rbp+2], 0
4205187    jnz     loc_4026E6
loc_402A89:
4205193    mov     dword [rsp+1Ch], 0
4205201    jmp     loc_402415
loc_402A96:
4205206    call    ___errno_location
4205211    mov     edi, [rax]
4205213    call    _strerror
4205218    mov     esi, aErrorChangingG
4205223    mov     rdx, rax
4205226    jmp     loc_402843
loc_402AAF:
4205231    mov     rdx, [cs:exe_name]
4205238    mov     esi, aSInvalidUserNa
4205243    jmp     loc_402657
loc_402AC0:
4205248    mov     esi, aLocal
4205253    mov     rdi, rbp
4205256    mov     [rsp+20h], rdx
4205261    mov     [rsp+28h], r10d
4205266    call    _strcmp
4205271    test    eax, eax
4205273    mov     r10d, [rsp+28h]
4205278    mov     rdx, [rsp+20h]
4205283    jz      loc_40272D
4205289    mov     edi, aUnknownOption
4205294    call    _print_usage
4205299    mov     edi, 1
4205304    call    _exit
loc_402AFD:
4205309    mov     r8d, 12Ch
4205315    mov     ecx, 1
4205320    mov     edx, aMaxClientsMust
4205325    jmp     loc_4027BC
loc_402B12:
4205330    mov     edi, aMissingNumberO
4205335    call    _print_usage
4205340    mov     edi, 1
4205345    call    _exit
loc_402B26:
4205350    lea     rdi, [rsp+40h]
4205355    call    _sigemptyset
4205360    lea     rdi, [rsp+40h]
4205365    mov     esi, 0Fh
4205370    call    _sigaddset
4205375    lea     rdi, [rsp+40h]
4205380    mov     esi, 2
4205385    call    _sigaddset
4205390    lea     rsi, [rsp+40h]
4205395    xor     edx, edx
4205397    xor     edi, edi
4205399    call    _pthread_sigmask
4205404    lea     rsi, [rsp+34h]
4205409    lea     rdi, [rsp+40h]
4205414    call    _sigwait
4205419    cmp     dword [rsp+34h], 0Fh
4205424    jz      loc_402C95
4205430    mov     esi, aSigintReceived
4205435    mov     edi, 6
4205440    xor     eax, eax
4205442    call    _syslog
loc_402B87:
4205447    lea     rdi, [rsp+150h]
4205455    call    _ftp_listener_stop
4205460    mov     esi, aAllConnections
4205465    mov     edi, 6
4205470    xor     eax, eax
4205472    call    _syslog
loc_402BA5:
4205477    xor     edi, edi
4205479    call    _exit
loc_402BAC:
4205484    mov     edi, aMissingNumberF
4205489    call    _print_usage
4205494    mov     edi, 1
4205499    call    _exit
loc_402BC0:
4205504    call    ___errno_location
4205509    mov     edi, [rax]
4205511    call    _strerror
4205516    mov     esi, aErrorSettingEr
4205521    mov     rdx, rax
4205524    jmp     loc_402843
loc_402BD9:
4205529    call    ___errno_location
4205534    mov     edi, [rax]
4205536    call    _strerror
4205541    mov     esi, aErrorSettingOu
4205546    mov     rdx, rax
4205549    jmp     loc_402843
loc_402BF2:
4205554    call    ___errno_location
4205559    mov     edi, [rax]
4205561    call    _strerror
4205566    mov     esi, aErrorSettingIn
4205571    mov     rdx, rax
4205574    jmp     loc_402843
loc_402C0B:
4205579    call    ___errno_location
4205584    mov     edi, [rax]
4205586    call    _strerror
4205591    mov     rdx, [cs:exe_name]
4205598    mov     rcx, rax
4205601    mov     esi, aSErrorCreating
loc_402C26:
4205606    mov     rdi, [cs:stderr@@GLIBC_2_2_5]
4205613    xor     eax, eax
4205615    call    _fprintf
4205620    mov     edi, 1
4205625    call    _exit
loc_402C3E:
4205630    call    ___errno_location
4205635    mov     edi, [rax]
4205637    call    _strerror
4205642    mov     rdx, [cs:exe_name]
4205649    mov     rcx, rax
4205652    mov     esi, aSErrorGettingM
4205657    jmp     loc_402C26
loc_402C5B:
4205659    call    ___errno_location
4205664    mov     edi, [rax]
4205666    call    _strerror
4205671    mov     rdx, [cs:exe_name]
4205678    mov     rcx, rax
4205681    mov     esi, aSErrorOpeningN
4205686    jmp     loc_402C26
loc_402C78:
4205688    call    ___errno_location
4205693    mov     edi, [rax]
4205695    call    _strerror
4205700    mov     rdx, [cs:exe_name]
4205707    mov     rcx, rax
4205710    mov     esi, aSErrorForkingS
4205715    jmp     loc_402C26
loc_402C95:
4205717    mov     esi, aSigtermReceive
4205722    mov     edi, 6
4205727    xor     eax, eax
4205729    call    _syslog
4205734    jmp     loc_402B87
USE32

section .text

global _deregister_tm_clones

_deregister_tm_clones:
4205792    mov     eax, 60F51Fh
4205797    push    rbp
4205798    sub     rax, 60F518h
4205804    cmp     rax, 0Eh
4205808    mov     rbp, rsp
4205811    ja      loc_402CF7
loc_402CF5:
4205813    pop     rbp
4205814    retn    
loc_402CF7:
4205815    mov     eax, 0
4205820    test    rax, rax
4205823    jz      loc_402CF5
4205825    pop     rbp
4205826    mov     edi, 60F518h
4205831    jmp     rax
USE32

section .text

global _register_tm_clones

_register_tm_clones:
4205840    mov     eax, 60F518h
4205845    push    rbp
4205846    sub     rax, 60F518h
4205852    sar     rax, 3
4205856    mov     rbp, rsp
4205859    mov     rdx, rax
4205862    shr     rdx, 3Fh
4205866    add     rax, rdx
4205869    sar     rax, 1
4205872    jnz     loc_402D34
loc_402D32:
4205874    pop     rbp
4205875    retn    
loc_402D34:
4205876    mov     edx, 0
4205881    test    rdx, rdx
4205884    jz      loc_402D32
4205886    pop     rbp
4205887    mov     rsi, rax
4205890    mov     edi, 60F518h
4205895    jmp     rdx
USE32

section .text

global _fdprintf

_fdprintf:
4205984    push    r12
4205986    mov     r12d, edi
4205989    push    rbp
4205990    push    rbx
4205991    sub     rsp, 10E0h
4205998    test    al, al
4206000    mov     [rsp+1040h], rdx
4206008    mov     [rsp+1048h], rcx
4206016    mov     [rsp+1050h], r8
4206024    mov     [rsp+1058h], r9
4206032    jz      loc_402E12
4206034    movaps  xmmword [rsp+1060h], xmm0
4206042    movaps  xmmword [rsp+1070h], xmm1
4206050    movaps  xmmword [rsp+1080h], xmm2
4206058    movaps  xmmword [rsp+1090h], xmm3
4206066    movaps  xmmword [rsp+10A0h], xmm4
4206074    movaps  xmmword [rsp+10B0h], xmm5
4206082    movaps  xmmword [rsp+10C0h], xmm6
4206090    movaps  xmmword [rsp+10D0h], xmm7
loc_402E12:
4206098    mov     rax, [fs:28h]
4206107    mov     [rsp+1028h], rax
4206115    xor     eax, eax
4206117    test    r12d, r12d
4206120    mov     rbx, rsi
4206123    js      loc_402ED8
loc_402E31:
4206129    test    rbx, rbx
4206132    jz      loc_402EF6
loc_402E3A:
4206138    lea     rax, [rsp+1100h]
4206146    lea     rcx, [rsp+8]
4206151    lea     rdi, [rsp+20h]
4206156    mov     rdx, rbx
4206159    mov     esi, 1001h
4206164    mov     dword [rsp+8], 10h
4206172    mov     [rsp+10h], rax
4206177    lea     rax, [rsp+1030h]
4206185    mov     dword [rsp+0Ch], 30h
4206193    mov     [rsp+18h], rax
4206198    call    _vsnprintf
4206203    test    eax, eax
4206205    mov     ebp, eax
4206207    jle     loc_402EB4
4206209    cmp     eax, 1001h
4206214    mov     eax, 1000h
4206219    cmovnb  ebp, eax
4206222    xor     ebx, ebx
loc_402E90:
4206224    lea     rax, [rsp+20h]
4206229    mov     edx, ebp
4206231    movsxd  rsi, ebx
4206234    sub     edx, ebx
4206236    mov     edi, r12d
4206239    add     rsi, rax
4206242    movsxd  rdx, edx
4206245    call    _write
4206250    test    eax, eax
4206252    jle     loc_402EB4
4206254    add     ebx, eax
4206256    cmp     ebp, ebx
4206258    jg      loc_402E90
loc_402EB4:
4206260    mov     rax, [rsp+1028h]
4206268    xor     rax, [fs:28h]
4206277    jnz     loc_402F14
4206279    add     rsp, 10E0h
4206286    pop     rbx
4206287    pop     rbp
4206288    pop     r12
4206290    retn    
4206291    align 8 
loc_402ED8:
4206296    mov     ecx, __func___4202
4206301    mov     edx, 174h
4206306    mov     esi, aFile_list_c
4206311    mov     edi, aFd0
4206316    call    _daemon_assert_fail
4206321    jmp     loc_402E31
loc_402EF6:
4206326    mov     ecx, __func___4202
4206331    mov     edx, 175h
4206336    mov     esi, aFile_list_c
4206341    mov     edi, aFmtVoid0
4206346    call    _daemon_assert_fail
4206351    jmp     loc_402E3A
loc_402F14:
4206356    call    ___stack_chk_fail
USE32

section .text

global _file_nlst

_file_nlst:
4206368    push    r15
4206370    push    r14
4206372    mov     r14d, edi
4206375    push    r13
4206377    push    r12
4206379    push    rbp
4206380    mov     rbp, rsi
4206383    push    rbx
4206384    mov     rbx, rdx
4206387    sub     rsp, 1068h
4206394    mov     rax, [fs:28h]
4206403    mov     [rsp+1058h], rax
4206411    xor     eax, eax
4206413    test    edi, edi
4206415    js      loc_403148
loc_402F55:
4206421    test    rbp, rbp
4206424    jz      loc_402F64
4206426    cmp     byte [rbp+0], 2Fh
4206430    jz      loc_403128
loc_402F64:
4206436    mov     ecx, __func___4145
4206441    mov     edx, 56h
4206446    mov     esi, aFile_list_c
4206451    mov     edi, aIs_valid_dirCu
4206456    call    _daemon_assert_fail
loc_402F7D:
4206461    test    rbx, rbx
4206464    jz      loc_4031A0
loc_402F86:
4206470    cmp     byte [rbx], 2Fh
4206473    jz      loc_403100
4206479    lea     r12, [rsp+50h]
4206484    mov     rsi, rbp
4206487    mov     rdi, r12
4206490    call    _stpcpy
4206495    cmp     byte [rbp+0], 2Fh
4206499    jz      loc_4030F0
loc_402FA9:
4206505    mov     edx, 2Fh
4206510    mov     [rax], dx
loc_402FB1:
4206513    mov     rdx, r12
loc_402FB4:
4206516    mov     ecx, [rdx]
4206518    add     rdx, 4
4206522    lea     eax, [rcx-1010101h]
4206528    not     ecx
4206530    and     eax, ecx
4206532    and     eax, 80808080h
4206537    jz      loc_402FB4
4206539    mov     ecx, eax
4206541    shr     ecx, 10h
4206544    test    eax, 8080h
4206549    cmovz   eax, ecx
4206552    lea     rcx, [rdx+2]
4206556    cmovz   rdx, rcx
4206560    add     al, al
4206562    sbb     rdx, 3
4206566    sub     rdx, r12
4206569    movsxd  r13, edx
4206572    add     edx, 1
4206575    movsxd  rbp, edx
loc_402FF2:
4206578    mov     rdi, rbx
4206581    call    _strlen
4206586    add     rax, rbp
4206589    cmp     rax, 1000h
4206595    ja      loc_403110
4206601    lea     r12, [rsp+50h]
4206606    mov     rsi, rbx
4206609    mov     r15, rsp
4206612    mov     rdi, r12
4206615    call    _strcat
4206620    xor     eax, eax
4206622    mov     ecx, 9
4206627    mov     rdi, rsp
4206630    rep stosq
4206633    xor     edx, edx
4206635    mov     rcx, rsp
4206638    mov     esi, 85h
4206643    mov     rdi, r12
4206646    call    _glob
4206651    cmp     eax, 1
4206654    jz      loc_4031C0
4206660    cmp     eax, 3
4206663    jz      loc_403170
4206669    cmp     eax, 2
4206672    jz      loc_4031E0
4206678    test    eax, eax
4206680    jnz     loc_403180
4206686    xor     eax, eax
4206688    cmp     qword [rsp], 0
4206693    mov     ebp, 1
4206698    jnz     loc_403076
4206700    jmp     loc_4030B3
4206702    align 10h
loc_403070:
4206704    mov     rax, rbp
4206707    mov     rbp, rdx
loc_403076:
4206710    mov     rdx, [rsp+8]
4206715    mov     rsi, r12
4206718    mov     rbx, [rdx+rax*8]
4206722    mov     rdx, r13
4206725    mov     rdi, rbx
4206728    call    _memcmp
4206733    lea     rdx, [rbx+r13]
4206737    test    eax, eax
4206739    mov     esi, aS
4206744    mov     edi, r14d
4206747    cmovz   rbx, rdx
4206751    xor     eax, eax
4206753    mov     rdx, rbx
4206756    call    _fdprintf
4206761    cmp     [rsp], rbp
4206765    lea     rdx, [rbp+1]
4206769    ja      loc_403070
loc_4030B3:
4206771    mov     rdi, r15
4206774    call    _globfree
4206779    mov     eax, 1
loc_4030C0:
4206784    mov     rcx, [rsp+1058h]
4206792    xor     rcx, [fs:28h]
4206801    jnz     loc_4031F6
4206807    add     rsp, 1068h
4206814    pop     rbx
4206815    pop     rbp
4206816    pop     r12
4206818    pop     r13
4206820    pop     r14
4206822    pop     r15
4206824    retn    
4206825    align 10h
loc_4030F0:
4206832    cmp     byte [rbp+1], 0
4206836    jz      loc_402FB1
4206842    jmp     loc_402FA9
4206847    align 20h
loc_403100:
4206848    mov     ebp, 1
4206853    xor     r13d, r13d
4206856    jmp     loc_402FF2
4206861    align 10h
loc_403110:
4206864    xor     eax, eax
4206866    mov     esi, aErrorPathNameT
4206871    mov     edi, r14d
4206874    call    _fdprintf
4206879    xor     eax, eax
4206881    jmp     loc_4030C0
4206883    align 8 
loc_403128:
4206888    mov     rdi, rbp
4206891    call    _strlen
4206896    cmp     rax, 1000h
4206902    jbe     loc_402F7D
4206908    jmp     loc_402F64
4206913    align 8 
loc_403148:
4206920    mov     ecx, __func___4145
4206925    mov     edx, 55h
4206930    mov     esi, aFile_list_c
4206935    mov     edi, aOut0
4206940    call    _daemon_assert_fail
4206945    jmp     loc_402F55
4206950    align 10h
loc_403170:
4206960    mov     eax, 1
4206965    jmp     loc_4030C0
4206970    align 20h
loc_403180:
4206976    mov     edx, eax
4206978    mov     esi, aErrorUnknownGl
4206983    xor     eax, eax
4206985    mov     edi, r14d
4206988    call    _fdprintf
4206993    xor     eax, eax
4206995    jmp     loc_4030C0
4207000    align 20h
loc_4031A0:
4207008    mov     ecx, __func___4145
4207013    mov     edx, 57h
4207018    mov     esi, aFile_list_c
4207023    mov     edi, aFilespecVoid0
4207028    call    _daemon_assert_fail
4207033    jmp     loc_402F86
4207038    align 20h
loc_4031C0:
4207040    xor     eax, eax
4207042    mov     esi, aErrorOutOfMemo
4207047    mov     edi, r14d
4207050    call    _fdprintf
4207055    xor     eax, eax
4207057    jmp     loc_4030C0
4207062    align 20h
loc_4031E0:
4207072    xor     eax, eax
4207074    mov     esi, aErrorReadError
4207079    mov     edi, r14d
4207082    call    _fdprintf
4207087    xor     eax, eax
4207089    jmp     loc_4030C0
loc_4031F6:
4207094    call    ___stack_chk_fail
USE32

section .text

global _file_list

_file_list:
4207104    push    rbp
4207105    mov     rbp, rsp
4207108    push    r15
4207110    mov     r15, rsi
4207113    push    r14
4207115    mov     r14, rdx
4207118    push    r13
4207120    push    r12
4207122    push    rbx
4207123    mov     ebx, edi
4207125    sub     rsp, 2108h
4207132    mov     rax, [fs:28h]
4207141    mov     [rbp-38h], rax
4207145    xor     eax, eax
4207147    test    edi, edi
4207149    js      loc_4039DC
loc_403233:
4207155    test    r15, r15
4207158    jz      loc_403242
4207160    cmp     byte [r15], 2Fh
4207164    jz      loc_403991
loc_403242:
4207170    mov     ecx, __func___4175
4207175    mov     edx, 0ABh
4207180    mov     esi, aFile_list_c
4207185    mov     edi, aIs_valid_dirCu
4207190    call    _daemon_assert_fail
loc_40325B:
4207195    test    r14, r14
4207198    jz      loc_4039FA
loc_403264:
4207204    movzx   eax, byte [r14]
4207208    cmp     al, 2Dh
4207210    jnz     loc_4032DF
4207212    nop     dword [rax+00h]
loc_403270:
4207216    movsx   r12, byte [r14+1]
4207221    lea     r13, [r14+1]
4207225    cmp     r12b, 2Dh
4207229    jz      loc_403370
4207235    test    r12b, r12b
4207238    jz      loc_4037DD
loc_40328C:
4207244    call    ___ctype_b_loc
4207249    mov     rdx, [rax]
4207252    jmp     loc_4032B2
4207254    align 20h
loc_4032A0:
4207264    add     r13, 1
4207268    movsx   r12, byte [r13+0]
4207273    test    r12b, r12b
4207276    jz      loc_403360
loc_4032B2:
4207282    test    byte [rdx+r12*2+1], 20h
4207288    jz      loc_4032A0
4207290    movzx   eax, byte [r13+0]
4207295    mov     r14, r13
4207298    jmp     loc_4032D0
4207300    align 8 
loc_4032C8:
4207304    add     r14, 1
4207308    movzx   eax, byte [r14]
loc_4032D0:
4207312    movsx   rcx, al
4207316    test    byte [rdx+rcx*2+1], 20h
4207321    jnz     loc_4032C8
4207323    cmp     al, 2Dh
4207325    jz      loc_403270
loc_4032DF:
4207327    cmp     al, 2Fh
4207329    jz      loc_4033AB
loc_4032E7:
4207335    lea     rax, [rbp-2050h]
4207342    mov     rsi, r15
4207345    mov     rdi, rax
4207348    mov     [rbp-2118h], rax
4207355    call    _stpcpy
4207360    cmp     byte [r15], 2Fh
4207364    jz      loc_4037EF
loc_40330A:
4207370    mov     edx, 2Fh
4207375    mov     [rax], dx
loc_403312:
4207378    mov     rdx, [rbp-2118h]
loc_403319:
4207385    mov     ecx, [rdx]
4207387    add     rdx, 4
4207391    lea     eax, [rcx-1010101h]
4207397    not     ecx
4207399    and     eax, ecx
4207401    and     eax, 80808080h
4207406    jz      loc_403319
4207408    mov     ecx, eax
4207410    shr     ecx, 10h
4207413    test    eax, 8080h
4207418    cmovz   eax, ecx
4207421    lea     rcx, [rdx+2]
4207425    cmovz   rdx, rcx
4207429    add     al, al
4207431    sbb     rdx, 3
4207435    sub     rdx, [rbp-2118h]
4207442    mov     r15d, edx
4207445    add     edx, 1
4207448    movsxd  r12, edx
4207451    jmp     loc_4033B4
4207453    align 20h
loc_403360:
4207456    mov     r14, r13
4207459    xor     eax, eax
4207461    jmp     loc_4032D0
4207466    align 10h
loc_403370:
4207472    cmp     byte [r14+2], 20h
4207477    jnz     loc_40328C
4207483    call    ___ctype_b_loc
4207488    add     r14, 3
4207492    mov     rcx, [rax]
4207495    jmp     loc_403394
4207497    align 10h
loc_403390:
4207504    add     r14, 1
loc_403394:
4207508    movzx   eax, byte [r14]
4207512    movsx   rdx, al
4207516    test    byte [rcx+rdx*2+1], 20h
4207521    jnz     loc_403390
4207523    cmp     al, 2Fh
4207525    jnz     loc_4032E7
loc_4033AB:
4207531    mov     r12d, 1
4207537    xor     r15d, r15d
loc_4033B4:
4207540    mov     rdi, r14
4207543    call    _strlen
4207548    add     rax, r12
4207551    cmp     rax, 1000h
4207557    ja      loc_4038C6
4207563    lea     rax, [rbp-2050h]
4207570    mov     rsi, r14
4207573    mov     rdi, rax
4207576    mov     r14, rax
4207579    mov     [rbp-2118h], rax
4207586    call    _strcat
4207591    lea     rdi, [rbp-20B0h]
4207598    xor     eax, eax
4207600    mov     ecx, 9
4207605    xor     edx, edx
4207607    mov     esi, 1
4207612    rep stosq
4207615    lea     rcx, [rbp-20B0h]
4207622    mov     rdi, r14
4207625    call    _glob
4207630    cmp     eax, 3
4207633    jz      loc_403A31
4207639    cmp     eax, 1
4207642    jz      loc_403A49
4207648    cmp     eax, 2
4207651    jz      loc_4039B0
4207657    test    eax, eax
4207659    jnz     loc_4039C5
4207665    mov     rax, [rbp-20B0h]
4207672    lea     rdx, [rax+rax*4]
4207676    shl     rdx, 5
4207680    add     rdx, 10h
4207684    sub     rsp, rdx
4207687    lea     rdi, [rsp+0Fh]
4207692    mov     [rbp-2120h], rdi
4207699    and     qword [rbp-2120h], 0FFFFFFFFFFFFFFF0h
4207707    test    rax, rax
4207710    jz      loc_40395F
4207716    movsxd  rax, r15d
4207719    mov     r13d, 1
4207725    xor     r14d, r14d
4207728    mov     [rbp-2128h], rax
4207735    mov     dword [rbp-210Ch], 0
4207745    jmp     loc_40348E
4207747    align 8 
loc_403488:
4207752    mov     r14, r13
4207755    mov     r13, rax
loc_40348E:
4207758    mov     rax, [rbp-20A8h]
4207765    mov     r15, [rbp-2128h]
4207772    mov     rsi, [rbp-2118h]
4207779    mov     rcx, [rax+r14*8]
4207783    mov     rdx, r15
4207786    mov     rdi, rcx
4207789    mov     [rbp-2108h], rcx
4207796    call    _memcmp
4207801    test    eax, eax
4207803    movsxd  rax, dword [rbp-210Ch]
4207810    mov     rcx, [rbp-2108h]
4207817    mov     rdi, [rbp-2120h]
4207824    lea     r15, [rcx+r15]
4207828    mov     rsi, rcx
4207831    lea     rax, [rax+rax*4]
4207835    cmovnz  r15, rcx
4207839    shl     rax, 5
4207843    lea     r12, [rdi+rax]
4207847    mov     edi, 1
4207852    lea     rdx, [r12+10h]
4207857    call    ___lxstat
4207862    test    eax, eax
4207864    jnz     loc_403515
4207866    mov     rax, [rbp-20A8h]
4207873    mov     [r12], r15
4207877    add     dword [rbp-210Ch], 1
4207884    mov     rax, [rax+r14*8]
4207888    mov     [r12+8], rax
loc_403515:
4207893    cmp     r13, [rbp-20B0h]
4207900    lea     rax, [r13+1]
4207904    jb      loc_403488
4207910    xor     edx, edx
4207912    mov     esi, aTotalLu
4207917    xor     eax, eax
4207919    mov     edi, ebx
4207921    call    _fdprintf
4207926    lea     rdi, [rbp-20F8h]
4207933    call    _time
4207938    mov     esi, [rbp-210Ch]
4207944    test    esi, esi
4207946    jz      loc_40397B
4207952    mov     eax, esi
4207954    mov     rdi, [rbp-2120h]
4207961    sub     eax, 1
4207964    lea     rax, [rax+rax*4]
4207968    lea     r13, [rdi+68h]
4207972    shl     rax, 5
4207976    lea     rax, [rdi+rax+108h]
4207984    mov     [rbp-2108h], rax
4207991    jmp     loc_403725
loc_40357C:
4207996    test    r12b, 40h
4208000    mov     eax, (offset aYMDHMS+0Bh)
4208005    mov     esi, (offset aSDSS+0Ch)
4208010    cmovz   rsi, rax
4208014    mov     edi, ebx
4208016    xor     eax, eax
4208018    call    _fdprintf
loc_403597:
4208023    test    r12b, 20h
4208027    mov     r15d, (offset a03d+4)
4208033    mov     esi, 40C2B2h
4208038    cmovz   rsi, r15
4208042    mov     edi, ebx
4208044    xor     eax, eax
4208046    call    _fdprintf
4208051    test    r12b, 10h
4208055    mov     esi, aW
4208060    mov     edi, ebx
4208062    cmovz   rsi, r15
4208066    xor     eax, eax
4208068    call    _fdprintf
4208073    test    r12d, 400h
4208080    jz      loc_40381B
4208086    test    r12b, 8
4208090    mov     eax, (offset aYMDHMS+0Bh)
4208095    mov     esi, (offset aSDSS+0Ch)
4208100    cmovz   rsi, rax
4208104    mov     edi, ebx
4208106    xor     eax, eax
4208108    call    _fdprintf
loc_4035F1:
4208113    test    r12b, 4
4208117    mov     r15d, (offset a03d+4)
4208123    mov     esi, 40C2B2h
4208128    cmovz   rsi, r15
4208132    mov     edi, ebx
4208134    xor     eax, eax
4208136    call    _fdprintf
4208141    test    r12b, 2
4208145    mov     esi, aW
4208150    mov     edi, ebx
4208152    cmovz   rsi, r15
4208156    xor     eax, eax
4208158    call    _fdprintf
4208163    test    r12d, 200h
4208170    jz      loc_403800
4208176    and     r12d, 1
4208180    mov     eax, (offset aQuit+3)
4208185    mov     esi, 40C377h
4208190    cmovz   rsi, rax
4208194    mov     edi, ebx
4208196    xor     eax, eax
4208198    call    _fdprintf
loc_40364B:
4208203    mov     ecx, [r13-3Ch]
4208207    mov     r8d, [r13-38h]
4208211    xor     eax, eax
4208213    mov     rdx, [r13-48h]
4208217    mov     esi, a3d8d8d
4208222    mov     edi, ebx
4208224    call    _fdprintf
4208229    mov     rdx, [r13-28h]
4208233    xor     eax, eax
4208235    mov     esi, a8lu
4208240    mov     edi, ebx
4208242    call    _fdprintf
4208247    lea     rsi, [rbp-20F0h]
4208254    mov     rdi, r13
4208257    call    _localtime_r
4208262    mov     rsi, [r13+0]
4208266    mov     rdi, [rbp-20F8h]
4208273    call    _difftime
4208278    ucomisd xmm0, [cs:qword_40AA30]
4208286    lea     rcx, [rbp-20F0h]
4208293    ja      loc_4036B9
4208295    movsd   xmm1, [cs:qword_40AA38]
4208303    ucomisd xmm1, xmm0
4208307    jbe     loc_40385F
loc_4036B9:
4208313    lea     rdi, [rbp-2060h]
4208320    mov     edx, aBEY
4208325    mov     esi, 0Dh
4208330    call    _strftime
loc_4036CF:
4208335    lea     rdx, [rbp-2060h]
4208342    xor     eax, eax
4208344    mov     esi, aS_0
4208349    mov     edi, ebx
4208351    call    _fdprintf
4208356    mov     rdx, [r13-68h]
4208360    xor     eax, eax
4208362    mov     esi, (offset aSDSS+0Bh)
4208367    mov     edi, ebx
4208369    call    _fdprintf
4208374    cmp     r14d, 0A000h
4208381    jz      loc_40390B
loc_403703:
4208387    xor     eax, eax
4208389    mov     esi, (offset aTotal0+7)
4208394    mov     edi, ebx
4208396    call    _fdprintf
4208401    add     r13, 0A0h
4208408    cmp     r13, [rbp-2108h]
4208415    jz      loc_40397B
loc_403725:
4208421    mov     r12d, [r13-40h]
4208425    mov     r14d, r12d
4208428    and     r14d, 0F000h
4208435    cmp     r14d, 4000h
4208442    jz      loc_40387A
4208448    jbe     loc_403836
4208454    cmp     r14d, 0A000h
4208461    jz      loc_4038A0
4208467    cmp     r14d, 0C000h
4208474    jz      loc_40388D
4208480    cmp     r14d, 6000h
4208487    jz      loc_4038F8
loc_40376D:
4208493    mov     esi, (offset a03d+4)
4208498    mov     edi, ebx
4208500    xor     eax, eax
4208502    call    _fdprintf
4208507    nop     dword [rax+rax+00h]
loc_403780:
4208512    test    r12d, 100h
4208519    mov     r15d, (offset a03d+4)
4208525    mov     esi, 40C2B2h
4208530    cmovz   rsi, r15
4208534    mov     edi, ebx
4208536    xor     eax, eax
4208538    call    _fdprintf
4208543    test    r12b, 80h
4208547    mov     esi, aW
4208552    mov     edi, ebx
4208554    cmovz   rsi, r15
4208558    xor     eax, eax
4208560    call    _fdprintf
4208565    test    r12d, 800h
4208572    jnz     loc_40357C
4208578    test    r12b, 40h
4208582    mov     esi, asc_40A97D
4208587    mov     edi, ebx
4208589    cmovz   rsi, r15
4208593    xor     eax, eax
4208595    call    _fdprintf
4208600    jmp     loc_403597
loc_4037DD:
4208605    call    ___ctype_b_loc
4208610    mov     r14, r13
4208613    mov     rdx, [rax]
4208616    xor     eax, eax
4208618    jmp     loc_4032D0
loc_4037EF:
4208623    cmp     byte [r15+1], 0
4208628    jz      loc_403312
4208634    jmp     loc_40330A
4208639    align 20h
loc_403800:
4208640    and     r12d, 1
4208644    mov     esi, asc_40A97D
4208649    mov     edi, ebx
4208651    cmovz   rsi, r15
4208655    xor     eax, eax
4208657    call    _fdprintf
4208662    jmp     loc_40364B
loc_40381B:
4208667    test    r12b, 8
4208671    mov     esi, asc_40A97D
4208676    mov     edi, ebx
4208678    cmovz   rsi, r15
4208682    xor     eax, eax
4208684    call    _fdprintf
4208689    jmp     loc_4035F1
loc_403836:
4208694    cmp     r14d, 1000h
4208701    jz      loc_4038B3
4208703    cmp     r14d, 2000h
4208710    jnz     loc_40376D
4208716    mov     esi, (offset aFtp_command_c+0Ch)
4208721    mov     edi, ebx
4208723    xor     eax, eax
4208725    call    _fdprintf
4208730    jmp     loc_403780
loc_40385F:
4208735    lea     rdi, [rbp-2060h]
4208742    mov     edx, aBEHM
4208747    mov     esi, 0Dh
4208752    call    _strftime
4208757    jmp     loc_4036CF
loc_40387A:
4208762    mov     esi, (offset aErrorCreatingN+1Ch)
4208767    mov     edi, ebx
4208769    xor     eax, eax
4208771    call    _fdprintf
4208776    jmp     loc_403780
loc_40388D:
4208781    mov     esi, (offset aSDSS+0Ch)
4208786    mov     edi, ebx
4208788    xor     eax, eax
4208790    call    _fdprintf
4208795    jmp     loc_403780
loc_4038A0:
4208800    mov     esi, (offset aLocal+6)
4208805    mov     edi, ebx
4208807    xor     eax, eax
4208809    call    _fdprintf
4208814    jmp     loc_403780
loc_4038B3:
4208819    mov     esi, (offset aHelp+5)
4208824    mov     edi, ebx
4208826    xor     eax, eax
4208828    call    _fdprintf
4208833    jmp     loc_403780
loc_4038C6:
4208838    xor     eax, eax
4208840    mov     esi, aErrorPathNameT
4208845    mov     edi, ebx
4208847    call    _fdprintf
4208852    xor     eax, eax
loc_4038D6:
4208854    mov     rbx, [rbp-38h]
4208858    xor     rbx, [fs:28h]
4208867    jnz     loc_403A5E
4208873    lea     rsp, [rbp-28h]
4208877    pop     rbx
4208878    pop     r12
4208880    pop     r13
4208882    pop     r14
4208884    pop     r15
4208886    pop     rbp
4208887    retn    
loc_4038F8:
4208888    mov     esi, aB
4208893    mov     edi, ebx
4208895    xor     eax, eax
4208897    call    _fdprintf
4208902    jmp     loc_403780
loc_40390B:
4208907    mov     rdi, [r13-60h]
4208911    lea     rsi, [rbp-1040h]
4208918    mov     edx, 1001h
4208923    call    _readlink
4208928    test    eax, eax
4208930    mov     r12, rax
4208933    jle     loc_403703
4208939    mov     edi, ebx
4208941    xor     eax, eax
4208943    mov     esi, asc_40A9C7
4208948    call    _fdprintf
4208953    lea     rdx, [rbp-1040h]
4208960    movsxd  r12, r12d
4208963    mov     esi, (offset aSDSS+0Bh)
4208968    mov     edi, ebx
4208970    xor     eax, eax
4208972    mov     byte [rbp+r12-1040h], 0
4208981    call    _fdprintf
4208986    jmp     loc_403703
loc_40395F:
4208991    mov     edi, ebx
4208993    xor     edx, edx
4208995    mov     esi, aTotalLu
4209000    xor     eax, eax
4209002    call    _fdprintf
4209007    lea     rdi, [rbp-20F8h]
4209014    call    _time
loc_40397B:
4209019    lea     rdi, [rbp-20B0h]
4209026    call    _globfree
4209031    mov     eax, 1
4209036    jmp     loc_4038D6
loc_403991:
4209041    mov     rdi, r15
4209044    call    _strlen
4209049    cmp     rax, 1000h
4209055    jbe     loc_40325B
4209061    jmp     loc_403242
4209066    align 10h
loc_4039B0:
4209072    xor     eax, eax
4209074    mov     esi, aErrorReadError
4209079    mov     edi, ebx
4209081    call    _fdprintf
4209086    xor     eax, eax
4209088    jmp     loc_4038D6
loc_4039C5:
4209093    mov     edx, eax
4209095    mov     esi, aErrorUnknownGl
4209100    xor     eax, eax
4209102    mov     edi, ebx
4209104    call    _fdprintf
4209109    xor     eax, eax
4209111    jmp     loc_4038D6
loc_4039DC:
4209116    mov     ecx, __func___4175
4209121    mov     edx, 0AAh
4209126    mov     esi, aFile_list_c
4209131    mov     edi, aOut0
4209136    call    _daemon_assert_fail
4209141    jmp     loc_403233
loc_4039FA:
4209146    mov     ecx, __func___4175
4209151    mov     edx, 0ACh
4209156    mov     esi, aFile_list_c
4209161    mov     edi, aFilespecVoid0
4209166    call    _daemon_assert_fail
4209171    mov     ecx, __func___4209
4209176    mov     edx, 192h
4209181    mov     esi, aFile_list_c
4209186    mov     edi, aFilespecVoid0
4209191    call    _daemon_assert_fail
4209196    jmp     loc_403264
loc_403A31:
4209201    xor     eax, eax
4209203    mov     esi, aTotal0
4209208    mov     edi, ebx
4209210    call    _fdprintf
4209215    mov     eax, 1
4209220    jmp     loc_4038D6
loc_403A49:
4209225    xor     eax, eax
4209227    mov     esi, aErrorOutOfMemo
4209232    mov     edi, ebx
4209234    call    _fdprintf
4209239    xor     eax, eax
4209241    jmp     loc_4038D6
loc_403A5E:
4209246    call    ___stack_chk_fail
USE32

section .text

global _copy_string

_copy_string:
4209264    push    rbp
4209265    mov     rbp, rsi
4209268    push    rbx
4209269    mov     rbx, rdi
4209272    sub     rsp, 8
4209276    test    rdi, rdi
4209279    jz      loc_403AD2
loc_403A81:
4209281    test    rbp, rbp
4209284    jz      loc_403AED
loc_403A86:
4209286    mov     rax, rbp
4209289    xor     ecx, ecx
4209291    jmp     loc_403AA9
4209293    align 10h
loc_403A90:
4209296    cmp     dl, 0Ah
4209299    jz      loc_403AB0
4209301    mov     [rbx+rcx], dl
4209304    add     rcx, 1
4209308    add     rax, 1
4209312    cmp     rcx, 1001h
4209319    jz      loc_403AC0
loc_403AA9:
4209321    movzx   edx, byte [rax]
4209324    test    dl, dl
4209326    jnz     loc_403A90
loc_403AB0:
4209328    mov     byte [rbx+rcx], 0
4209332    add     rsp, 8
4209336    pop     rbx
4209337    pop     rbp
4209338    retn    
4209339    align 20h
loc_403AC0:
4209344    mov     byte [rbx+rcx], 0
4209348    add     rsp, 8
4209352    lea     rax, [rbp+1001h]
4209359    pop     rbx
4209360    pop     rbp
4209361    retn    
loc_403AD2:
4209362    mov     ecx, __func___3603
4209367    mov     edx, 133h
4209372    mov     esi, aFtp_command_c
4209377    mov     edi, aDstVoid0
4209382    call    _daemon_assert_fail
4209387    jmp     loc_403A81
loc_403AED:
4209389    mov     ecx, __func___3603
4209394    mov     edx, 134h
4209399    mov     esi, aFtp_command_c
4209404    mov     edi, aSrcVoid0
4209409    call    _daemon_assert_fail
USE32

section .text

global _parse_number

_parse_number:
4209424    push    r14
4209426    test    rsi, rsi
4209429    mov     r14, rsi
4209432    push    r13
4209434    mov     r13d, edx
4209437    push    r12
4209439    mov     r12, rdi
4209442    push    rbp
4209443    push    rbx
4209444    jz      loc_403BDB
loc_403B2A:
4209450    test    r12, r12
4209453    jz      loc_403BF9
loc_403B33:
4209459    call    ___ctype_b_loc
4209464    movsx   ebx, byte [r14]
4209468    mov     rdx, [rax]
4209471    movsx   rax, bl
4209475    test    byte [rdx+rax*2+1], 8
4209480    jz      loc_403B8E
4209482    movsx   eax, byte [r14+1]
4209487    sub     ebx, 30h
4209490    lea     rbp, [r14+1]
4209494    movsx   rcx, al
4209498    test    byte [rdx+rcx*2+1], 8
4209503    jnz     loc_403B7D
4209505    jmp     loc_403BA0
4209507    align 8 
loc_403B68:
4209512    add     rbp, 1
4209516    add     ebx, eax
4209518    movsx   eax, byte [rbp+0]
4209522    movsx   rcx, al
4209526    test    byte [rdx+rcx*2+1], 8
4209531    jz      loc_403BA0
loc_403B7D:
4209533    lea     ebx, [rbx+rbx*4]
4209536    sub     eax, 30h
4209539    mov     ecx, r13d
4209542    sub     ecx, eax
4209544    add     ebx, ebx
4209546    cmp     ecx, ebx
4209548    jge     loc_403B68
loc_403B8E:
4209550    pop     rbx
4209551    pop     rbp
4209552    pop     r12
4209554    pop     r13
4209556    xor     eax, eax
4209558    pop     r14
4209560    retn    
4209561    align 20h
loc_403BA0:
4209568    test    ebx, ebx
4209570    js      loc_403C17
loc_403BA4:
4209572    cmp     r13d, ebx
4209575    jl      loc_403BC0
loc_403BA9:
4209577    mov     [r12], ebx
4209581    mov     rax, rbp
4209584    pop     rbx
4209585    pop     rbp
4209586    pop     r12
4209588    pop     r13
4209590    pop     r14
4209592    retn    
4209593    align 20h
loc_403BC0:
4209600    mov     ecx, __func___3665
4209605    mov     edx, 261h
4209610    mov     esi, aFtp_command_c
4209615    mov     edi, aTmpMax_num
4209620    call    _daemon_assert_fail
4209625    jmp     loc_403BA9
loc_403BDB:
4209627    mov     ecx, __func___3665
4209632    mov     edx, 248h
4209637    mov     esi, aFtp_command_c
4209642    mov     edi, aSVoid0
4209647    call    _daemon_assert_fail
4209652    jmp     loc_403B2A
loc_403BF9:
4209657    mov     ecx, __func___3665
4209662    mov     edx, 249h
4209667    mov     esi, aFtp_command_c
4209672    mov     edi, aNumVoid0
4209677    call    _daemon_assert_fail
4209682    jmp     loc_403B33
loc_403C17:
4209687    mov     ecx, __func___3665
4209692    mov     edx, 260h
4209697    mov     esi, aFtp_command_c
4209702    mov     edi, aTmp0
4209707    call    _daemon_assert_fail
USE32

section .text

global _ftp_command_parse

_ftp_command_parse:
4209728    push    r15
4209730    push    r14
4209732    mov     r14, rsi
4209735    push    r13
4209737    mov     r13, rdi
4209740    push    r12
4209742    push    rbp
4209743    push    rbx
4209744    sub     rsp, 2278h
4209751    mov     rax, [fs:28h]
4209760    mov     [rsp+2268h], rax
4209768    xor     eax, eax
4209770    test    rdi, rdi
4209773    jz      loc_404281
loc_403C73:
4209779    test    r14, r14
4209782    jz      loc_40429F
loc_403C7C:
4209788    mov     r12d, command_def
4209794    xor     ebp, ebp
4209796    nop     dword [rax+00h]
loc_403C88:
4209800    mov     rbx, [r12]
4209804    mov     rdi, rbx
4209807    call    _strlen
4209812    mov     rsi, rbx
4209815    movsxd  rdx, eax
4209818    mov     rdi, r13
4209821    call    _strncasecmp
4209826    test    eax, eax
4209828    mov     ebx, eax
4209830    jnz     loc_403D00
4209832    cmp     ebp, 0FFFFFFFFh
4209835    jz      loc_403D10
4209837    cmp     ebp, 18h
4209840    ja      loc_403D3D
loc_403CB6:
4209846    movsxd  rbp, ebp
4209849    lea     rdi, [rsp+240h]
4209857    shl     rbp, 4
4209861    lea     r12, [command_def+rbp]
4209868    mov     rbp, qword [ss:command_def+rbp]
4209875    mov     rsi, rbp
4209878    call    _strcpy
4209883    mov     rdi, rbp
4209886    call    _strlen
4209891    add     r13, rax
4209894    cmp     dword [r12+8], 0Ah
4209900    ja      loc_4042BD
4209906    mov     eax, [r12+8]
4209911    jmp     off_40AC70[rax*8]
4209918    align 20h
loc_403D00:
4209920    add     ebp, 1
4209923    add     r12, 10h
4209927    cmp     ebp, 18h
4209930    jbe     loc_403C88
loc_403D10:
4209936    xor     ebx, ebx
loc_403D12:
4209938    mov     rcx, [rsp+2268h]
4209946    xor     rcx, [fs:28h]
4209955    mov     eax, ebx
4209957    jnz     loc_4045D8
4209963    add     rsp, 2278h
4209970    pop     rbx
4209971    pop     rbp
4209972    pop     r12
4209974    pop     r13
4209976    pop     r14
4209978    pop     r15
4209980    retn    
loc_403D3D:
4209981    mov     ecx, __func___3560
4209986    mov     edx, 63h
4209991    mov     esi, aFtp_command_c
4209996    mov     edi, aMatchSizeofCom
4210001    call    _daemon_assert_fail
4210006    jmp     loc_403CB6
loc_403D5B:
4210011    cmp     byte [r13+0], 20h
4210016    jnz     loc_403D10
4210018    movsx   ebp, byte [r13+1]
4210023    lea     eax, [rbp-21h]
4210026    cmp     al, 5Dh
4210028    ja      loc_403D12
4210030    cmp     byte [r13+2], 31h
4210035    jnz     loc_403D12
4210037    movsx   eax, byte [r13+3]
4210042    cmp     ebp, eax
4210044    jnz     loc_403D12
4210046    add     r13, 4
4210050    mov     esi, ebp
4210052    mov     rdi, r13
4210055    call    _strchr
4210060    test    rax, rax
4210063    mov     r12, rax
4210066    jz      loc_403D12
4210072    mov     r15, rax
4210075    sub     r15, r13
4210078    cmp     r15d, 0FFh
4210085    ja      loc_403D12
4210091    movsxd  r15, r15d
4210094    lea     rdi, [rsp+140h]
4210102    mov     rsi, r13
4210105    mov     rdx, r15
4210108    call    _memcpy
4210113    lea     rsi, [r12+1]
4210118    lea     rdi, [rsp+20h]
4210123    mov     edx, 0FFFFh
4210128    mov     byte [rsp+r15+140h], 0
4210137    call    _parse_number
4210142    test    rax, rax
4210145    mov     r12, rax
4210148    jz      loc_403D12
4210154    movsx   eax, byte [rax]
4210157    cmp     ebp, eax
4210159    jnz     loc_403D12
4210165    lea     rsi, [rsp+10h]
4210170    lea     rdi, [rsp+140h]
4210178    call    _inet_aton
4210183    test    eax, eax
4210185    jz      loc_403D12
4210191    mov     eax, [rsp+10h]
4210195    mov     dword [rsp+248h], 1
4210206    mov     [rsp+254h], eax
4210213    mov     eax, 2
4210218    mov     [rsp+250h], ax
4210226    movzx   eax, word [rsp+20h]
4210231    ror     ax, 8
4210235    mov     [rsp+252h], ax
4210243    movzx   eax, byte [r12+1]
4210249    jmp     loc_403E68
4210251    align 10h
loc_403E50:
4210256    movzx   eax, byte [r13+0]
4210261    cmp     al, 20h
4210263    jz      loc_404334
loc_403E5D:
4210269    mov     dword [rsp+248h], 0
loc_403E68:
4210280    cmp     al, 0Ah
4210282    jnz     loc_403D10
4210288    lea     rsi, [rsp+240h]
4210296    mov     edx, 2020h
4210301    mov     rdi, r14
4210304    mov     ebx, 1
4210309    call    _memcpy
4210314    jmp     loc_403D12
loc_403E8F:
4210319    mov     dword [rsp+248h], 0
4210330    movzx   eax, byte [r13+0]
4210335    jmp     loc_403E68
loc_403EA1:
4210337    cmp     byte [r13+0], 20h
4210342    jnz     loc_403D10
loc_403EAC:
4210348    lea     rsi, [r13+1]
4210352    lea     rdi, [rsp+250h]
4210360    call    _copy_string
4210365    mov     dword [rsp+248h], 1
4210376    movzx   eax, byte [rax]
4210379    jmp     loc_403E68
loc_403ECD:
4210381    movzx   eax, byte [r13+0]
4210386    cmp     al, 20h
4210388    jnz     loc_403E5D
4210390    jmp     loc_403EAC
loc_403ED8:
4210392    cmp     byte [r13+0], 20h
4210397    jnz     loc_403D10
4210403    add     r13, 1
4210407    jz      loc_4045FF
loc_403EED:
4210413    lea     rbp, [rsp+20h]
4210418    lea     r12, [rbp+14h]
loc_403EF6:
4210422    mov     edx, 0FFh
4210427    mov     rsi, r13
4210430    mov     rdi, rbp
4210433    call    _parse_number
4210438    test    rax, rax
4210441    jz      loc_403D12
4210447    cmp     byte [rax], 2Ch
4210450    jnz     loc_403D12
4210456    add     rbp, 4
4210460    lea     r13, [rax+1]
4210464    cmp     rbp, r12
4210467    jnz     loc_403EF6
4210469    lea     rdi, [rsp+34h]
4210474    mov     edx, 0FFh
4210479    mov     rsi, r13
4210482    call    _parse_number
4210487    test    rax, rax
4210490    mov     r12, rax
4210493    jz      loc_403D12
4210499    mov     eax, [rsp+20h]
4210503    test    eax, eax
4210505    js      loc_404598
loc_403F4F:
4210511    cmp     eax, 0FFh
4210516    jg      loc_40457A
loc_403F5A:
4210522    mov     eax, [rsp+24h]
4210526    test    eax, eax
4210528    js      loc_404558
loc_403F66:
4210534    cmp     eax, 0FFh
4210539    jg      loc_40453A
loc_403F71:
4210545    mov     eax, [rsp+28h]
4210549    test    eax, eax
4210551    js      loc_404518
loc_403F7D:
4210557    cmp     eax, 0FFh
4210562    jg      loc_4044FA
loc_403F88:
4210568    mov     r9d, [rsp+2Ch]
4210573    test    r9d, r9d
4210576    js      loc_4044D7
loc_403F96:
4210582    cmp     r9d, 0FFh
4210589    jg      loc_4044B4
loc_403FA3:
4210595    mov     r8d, [rsp+28h]
4210600    mov     ecx, [rsp+24h]
4210604    lea     rdi, [rsp+140h]
4210612    mov     edx, [rsp+20h]
4210616    mov     esi, aD_D_D_D
4210621    xor     eax, eax
4210623    call    _sprintf
4210628    mov     ebp, [rsp+30h]
4210632    lea     rsi, [rsp+10h]
4210637    lea     rdi, [rsp+140h]
4210645    shl     ebp, 8
4210648    or      ebp, [rsp+34h]
4210652    call    _inet_aton
4210657    test    eax, eax
4210659    jz      loc_403D12
4210665    mov     eax, [rsp+10h]
4210669    mov     edi, 2
4210674    mov     dword [rsp+248h], 1
4210685    mov     [rsp+250h], di
4210693    ror     bp, 8
4210697    mov     [rsp+254h], eax
4210704    mov     [rsp+252h], bp
4210712    movzx   eax, byte [r12]
4210717    jmp     loc_403E68
loc_404022:
4210722    cmp     byte [r13+0], 20h
4210727    jnz     loc_403D10
4210733    call    ___ctype_toupper_loc
4210738    mov     rdx, [rax]
4210741    movsx   rax, byte [r13+1]
4210746    mov     eax, [rdx+rax*4]
4210749    mov     ecx, eax
4210751    and     ecx, 0FFFFFFFBh
4210754    cmp     ecx, 41h
4210757    jnz     loc_4042E0
4210763    mov     [rsp+250h], al
4210770    movzx   eax, byte [r13+2]
4210775    mov     byte [rsp+251h], 0
4210783    cmp     al, 20h
4210785    jz      loc_404450
loc_404067:
4210791    mov     dword [rsp+248h], 1
4210802    jmp     loc_403E68
loc_404077:
4210807    cmp     byte [r13+0], 20h
4210812    jnz     loc_403D10
4210818    call    ___ctype_toupper_loc
4210823    movsx   rdx, byte [r13+1]
4210828    mov     rax, [rax]
4210831    mov     eax, [rax+rdx*4]
4210834    cmp     eax, 46h
4210837    jz      loc_4040E1
4210839    mov     edx, eax
4210841    and     edx, 0FFFFFFFDh
4210844    cmp     edx, 50h
4210847    jnz     loc_403D10
4210853    jmp     loc_4040E1
4210855    align 10h
loc_4040B0:
4210864    cmp     byte [r13+0], 20h
4210869    jnz     loc_403D10
4210875    nop     dword [rax+rax+00h]
4210880    call    ___ctype_toupper_loc
4210885    movsx   rdx, byte [r13+1]
4210890    mov     rax, [rax]
4210893    mov     eax, [rax+rdx*4]
4210896    lea     edx, [rax-42h]
4210899    cmp     edx, 1
4210902    jbe     loc_4040E1
4210904    cmp     eax, 53h
4210907    jnz     loc_403D10
loc_4040E1:
4210913    mov     [rsp+250h], al
4210920    mov     byte [rsp+251h], 0
4210928    mov     dword [rsp+248h], 1
4210939    movzx   eax, byte [r13+2]
4210944    jmp     loc_403E68
loc_404105:
4210949    cmp     byte [r13+0], 20h
4210954    jnz     loc_403D10
4210960    cmp     r13, 0FFFFFFFFFFFFFFFFh
4210964    jz      loc_4045BA
loc_40411A:
4210970    call    ___ctype_b_loc
4210975    mov     rdi, [rax]
4210978    movsx   eax, byte [r13+1]
4210983    movsx   rdx, al
4210987    test    byte [rdi+rdx*2+1], 8
4210992    jz      loc_403D10
4210998    lea     edx, [rax-30h]
4211001    movsx   eax, byte [r13+2]
4211006    lea     rcx, [r13+2]
4211010    movsxd  rdx, edx
4211013    movsx   rsi, al
4211017    test    byte [rdi+rsi*2+1], 8
4211022    jz      loc_404198
4211024    lea     rdx, [rdx+rdx*4]
4211028    sub     eax, 30h
4211031    mov     r8, 7FFFFFFFFFFFFFFFh
4211041    cdqe    
4211043    add     rdx, rdx
4211046    jmp     loc_404183
loc_404168:
4211048    sub     eax, 30h
4211051    lea     rdx, [rdx+rdx*4]
4211055    mov     rsi, r8
4211058    cdqe    
4211060    add     rdx, rdx
4211063    sub     rsi, rax
4211066    cmp     rsi, rdx
4211069    jl      loc_403D10
loc_404183:
4211075    add     rcx, 1
4211079    add     rdx, rax
4211082    movsx   eax, byte [rcx]
4211085    movsx   rsi, al
4211089    test    byte [rdi+rsi*2+1], 8
4211094    jnz     loc_404168
loc_404198:
4211096    mov     [rsp+250h], rdx
4211104    jmp     loc_404067
4211109    align 8 
loc_4041A8:
4211112    cmp     byte [r13+0], 20h
4211117    jnz     loc_403D10
4211123    lea     rsi, [r13+1]
4211127    lea     rdi, [rsp+8]
4211132    mov     edx, 0FFh
4211137    call    _parse_number
4211142    test    rax, rax
4211145    jz      loc_403D12
4211151    cmp     byte [rax], 2Ch
4211154    jnz     loc_403D12
4211160    lea     rsi, [rax+1]
4211164    lea     rdi, [rsp+10h]
4211169    mov     edx, 0FFh
4211174    call    _parse_number
4211179    test    rax, rax
4211182    jz      loc_403D12
4211188    cmp     byte [rax], 2Ch
4211191    jnz     loc_403D12
4211197    mov     esi, [rsp+10h]
4211201    lea     r13, [rax+1]
4211205    test    esi, esi
4211207    jle     loc_404366
4211213    xor     ebp, ebp
4211215    lea     r12, [rsp+0Ch]
4211220    jmp     loc_404224
4211222    align 20h
loc_404220:
4211232    add     rbp, 1
loc_404224:
4211236    mov     edx, 0FFh
4211241    mov     rsi, r13
4211244    mov     rdi, r12
4211247    call    _parse_number
4211252    mov     edx, [rsp+0Ch]
4211256    test    rax, rax
4211259    mov     [rsp+rbp+40h], dl
4211263    jz      loc_403D12
4211269    cmp     byte [rax], 2Ch
4211272    jnz     loc_403D12
4211278    lea     r13, [rax+1]
4211282    lea     eax, [rbp+1]
4211285    cmp     eax, [rsp+10h]
4211289    jge     loc_404366
4211295    cmp     eax, 0FEh
4211300    jbe     loc_404220
4211302    mov     ecx, __func___3634
4211307    mov     edx, 19Dh
4211312    mov     esi, aFtp_command_c
4211317    mov     edi, aISizeofAddrSiz
4211322    call    _daemon_assert_fail
4211327    jmp     loc_404220
loc_404281:
4211329    mov     ecx, __func___3560
4211334    mov     edx, 52h
4211339    mov     esi, aFtp_command_c
4211344    mov     edi, aInputVoid0
4211349    call    _daemon_assert_fail
4211354    jmp     loc_403C73
loc_40429F:
4211359    mov     ecx, __func___3560
4211364    mov     edx, 53h
4211369    mov     esi, aFtp_command_c
4211374    mov     edi, aCmdVoid0
4211379    call    _daemon_assert_fail
4211384    jmp     loc_403C7C
loc_4042BD:
4211389    mov     ecx, __func___3560
4211394    mov     edx, 121h
4211399    mov     esi, aFtp_command_c
4211404    mov     edi, (offset aCmdNum_arg0+10h)
4211409    call    _daemon_assert_fail
4211414    movzx   eax, byte [r13+0]
4211419    jmp     loc_403E68
loc_4042E0:
4211424    cmp     eax, 49h
4211427    jz      loc_40448F
4211433    cmp     eax, 4Ch
4211436    jnz     loc_403D10
4211442    lea     rsi, [r13+2]
4211446    lea     rdi, [rsp+1258h]
4211454    mov     edx, 0FFh
4211459    mov     byte [rsp+250h], 4Ch
4211467    mov     byte [rsp+251h], 0
4211475    call    _parse_number
4211480    test    rax, rax
4211483    jz      loc_403D10
4211489    mov     dword [rsp+248h], 2
4211500    movzx   eax, byte [rax]
4211503    jmp     loc_403E68
loc_404334:
4211508    lea     rsi, [r13+1]
4211512    lea     rdi, [rsp+250h]
4211520    mov     edx, 0FFh
4211525    call    _parse_number
4211530    test    rax, rax
4211533    jz      loc_404406
loc_404353:
4211539    mov     dword [rsp+248h], 1
4211550    movzx   eax, byte [rax]
4211553    jmp     loc_403E68
loc_404366:
4211558    lea     rdi, [rsp+20h]
4211563    mov     edx, 0FFh
4211568    mov     rsi, r13
4211571    call    _parse_number
4211576    test    rax, rax
4211579    jz      loc_403D12
4211585    mov     edx, [rsp+20h]
4211589    test    edx, edx
4211591    jle     loc_4045DD
4211597    xor     ebp, ebp
4211599    cmp     byte [rax], 2Ch
4211602    lea     r13, [rax+1]
4211606    lea     r12, [rsp+0Ch]
4211611    jz      loc_4043AC
4211613    jmp     loc_403D12
4211618    align 8 
loc_4043A8:
4211624    add     rbp, 1
loc_4043AC:
4211628    mov     edx, 0FFh
4211633    mov     rsi, r13
4211636    mov     rdi, r12
4211639    call    _parse_number
4211644    mov     edx, [rsp+0Ch]
4211648    lea     ecx, [rbp+1]
4211651    mov     [rsp+rbp+140h], dl
4211658    mov     edx, [rsp+20h]
4211662    cmp     edx, ecx
4211664    jle     loc_4045DD
4211670    cmp     byte [rax], 2Ch
4211673    jnz     loc_403D12
4211679    cmp     ecx, 0FEh
4211685    lea     r13, [rax+1]
4211689    jbe     loc_4043A8
4211691    mov     ecx, __func___3634
4211696    mov     edx, 1B5h
4211701    mov     esi, aFtp_command_c
4211706    mov     edi, aISizeofPortSiz
4211711    call    _daemon_assert_fail
4211716    jmp     loc_4043A8
loc_404406:
4211718    call    ___ctype_tolower_loc
4211723    movsx   rdx, byte [r13+1]
4211728    mov     rax, [rax]
4211731    cmp     dword [rax+rdx*4], 61h
4211735    jnz     loc_403D10
4211741    movsx   rdx, byte [r13+2]
4211746    cmp     dword [rax+rdx*4], 6Ch
4211750    jnz     loc_403D10
4211756    movsx   rdx, byte [r13+3]
4211761    cmp     dword [rax+rdx*4], 6Ch
4211765    jnz     loc_403D10
4211771    mov     dword [rsp+250h], 0FFFFFFFFh
4211782    lea     rax, [r13+4]
4211786    jmp     loc_404353
4211791    align 10h
loc_404450:
4211792    movsx   rax, byte [r13+3]
4211797    mov     eax, [rdx+rax*4]
4211800    cmp     eax, 4Eh
4211803    jz      loc_40446B
4211805    cmp     eax, 54h
4211808    jz      loc_40446B
4211810    cmp     eax, 43h
4211813    jnz     loc_403D10
loc_40446B:
4211819    mov     [rsp+1258h], al
4211826    mov     byte [rsp+1259h], 0
4211834    mov     dword [rsp+248h], 2
4211845    movzx   eax, byte [r13+4]
4211850    jmp     loc_403E68
loc_40448F:
4211855    mov     byte [rsp+250h], 49h
4211863    mov     byte [rsp+251h], 0
4211871    mov     dword [rsp+248h], 1
4211882    movzx   eax, byte [r13+2]
4211887    jmp     loc_403E68
loc_4044B4:
4211892    mov     ecx, __func___3616
4211897    mov     edx, 163h
4211902    mov     esi, aFtp_command_c
4211907    mov     edi, aOctets3255
4211912    call    _daemon_assert_fail
4211917    mov     r9d, [rsp+2Ch]
4211922    jmp     loc_403FA3
loc_4044D7:
4211927    mov     ecx, __func___3616
4211932    mov     edx, 162h
4211937    mov     esi, aFtp_command_c
4211942    mov     edi, aOctets30
4211947    call    _daemon_assert_fail
4211952    mov     r9d, [rsp+2Ch]
4211957    jmp     loc_403F96
loc_4044FA:
4211962    mov     ecx, __func___3616
4211967    mov     edx, 161h
4211972    mov     esi, aFtp_command_c
4211977    mov     edi, aOctets2255
4211982    call    _daemon_assert_fail
4211987    jmp     loc_403F88
loc_404518:
4211992    mov     ecx, __func___3616
4211997    mov     edx, 160h
4212002    mov     esi, aFtp_command_c
4212007    mov     edi, aOctets20
4212012    call    _daemon_assert_fail
4212017    mov     eax, [rsp+28h]
4212021    jmp     loc_403F7D
loc_40453A:
4212026    mov     ecx, __func___3616
4212031    mov     edx, 15Fh
4212036    mov     esi, aFtp_command_c
4212041    mov     edi, aOctets1255
4212046    call    _daemon_assert_fail
4212051    jmp     loc_403F71
loc_404558:
4212056    mov     ecx, __func___3616
4212061    mov     edx, 15Eh
4212066    mov     esi, aFtp_command_c
4212071    mov     edi, aOctets10
4212076    call    _daemon_assert_fail
4212081    mov     eax, [rsp+24h]
4212085    jmp     loc_403F66
loc_40457A:
4212090    mov     ecx, __func___3616
4212095    mov     edx, 15Dh
4212100    mov     esi, aFtp_command_c
4212105    mov     edi, aOctets0255
4212110    call    _daemon_assert_fail
4212115    jmp     loc_403F5A
loc_404598:
4212120    mov     ecx, __func___3616
4212125    mov     edx, 15Ch
4212130    mov     esi, aFtp_command_c
4212135    mov     edi, aOctets00
4212140    call    _daemon_assert_fail
4212145    mov     eax, [rsp+20h]
4212149    jmp     loc_403F4F
loc_4045BA:
4212154    mov     ecx, __func___3676
4212159    mov     edx, 26Fh
4212164    mov     esi, aFtp_command_c
4212169    mov     edi, aSVoid0
4212174    call    _daemon_assert_fail
4212179    jmp     loc_40411A
loc_4045D8:
4212184    call    ___stack_chk_fail
loc_4045DD:
4212189    cmp     dword [rsp+8], 4
4212194    jz      loc_40461D
4212196    mov     edx, 0FFFFFFFFh
4212201    mov     [rsp+250h], dx
loc_4045F1:
4212209    test    rax, rax
4212212    jnz     loc_404353
4212218    jmp     loc_403D10
USE32

section .text

global _addr2string

_addr2string:
4212336    test    rdi, rdi
4212339    push    rbx
4212340    mov     rbx, rdi
4212343    jz      loc_404688
4212345    mov     edi, [rbx+4]
4212348    pop     rbx
4212349    jmp     _inet_ntoa
4212354    align 8 
loc_404688:
4212360    mov     edi, aSVoid0
4212365    mov     ecx, __func___5301
4212370    mov     edx, 1C5h
4212375    mov     esi, aFtp_listener_c
4212380    call    _daemon_assert_fail
USE32

section .text

global _connection_handler_cleanup

_connection_handler_cleanup:
4212400    push    r12
4212402    push    rbp
4212403    push    rbx
4212404    mov     rbp, [rdi]
4212407    mov     rbx, rdi
4212410    lea     rdi, [rdi+2108h]
4212417    lea     r12, [rbp+50h]
4212421    call    _watchdog_remove_watched
4212426    mov     rdi, r12
4212429    call    _pthread_mutex_lock
4212434    sub     dword [rbp+8], 1
4212438    lea     rdi, [rbp+1090h]
4212445    call    _pthread_cond_signal
4212450    lea     rdi, [rbx+106Ch]
4212457    movzx   ebp, word [rbx+106Eh]
4212464    ror     bp, 8
4212468    call    _addr2string
4212473    movzx   ecx, bp
4212476    mov     rdx, rax
4212479    mov     esi, aSPortDDisconne
4212484    mov     edi, 6
4212489    xor     eax, eax
4212491    call    _syslog
4212496    mov     rdi, r12
4212499    call    _pthread_mutex_unlock
4212504    lea     rdi, [rbx+1040h]
4212511    call    _ftp_session_destroy
4212516    lea     rdi, [rbx+8]
4212520    call    _telnet_session_destroy
4212525    mov     rdi, rbx
4212528    pop     rbx
4212529    pop     rbp
4212530    pop     r12
4212532    jmp     _free
USE32

section .text

global _connection_handler

_connection_handler:
4212544    push    r14
4212546    push    r13
4212548    push    r12
4212550    push    rbp
4212551    push    rbx
4212552    mov     rbx, rdi
4212555    sub     rsp, 0F0h
4212562    mov     rax, [rdi]
4212565    mov     rdx, [fs:28h]
4212574    mov     [rsp+0E8h], rdx
4212582    xor     edx, edx
4212584    mov     [rsp], rdi
4212588    mov     r14, rax
4212591    mov     [rsp+8], rax
4212596    call    _pthread_self
4212601    mov     rdi, rax
4212604    call    _pthread_detach
4212609    xor     esi, esi
4212611    mov     edi, 1
4212616    call    _pthread_setcanceltype
4212621    mov     rax, rbx
4212624    lea     rdi, [r14+10h]
4212628    add     rax, 2108h
4212634    mov     rsi, rax
4212637    mov     [rsp+18h], rax
4212642    call    _watchdog_add_watched
4212647    lea     rdi, [rsp+20h]
4212652    xor     esi, esi
4212654    call    ___sigsetjmp
4212659    test    eax, eax
4212661    jnz     loc_4048F4
4212667    lea     rdi, [rsp+20h]
4212672    call    ___pthread_register_cancel
4212677    mov     r14, [rsp+8]
4212682    lea     rbx, [r14+50h]
4212686    mov     rdi, rbx
4212689    call    _pthread_mutex_lock
4212694    mov     edx, [r14+8]
4212698    mov     rax, [rsp]
4212702    lea     r12d, [rdx+1]
4212706    lea     r13, [rax+106Ch]
4212713    mov     [rsp+14h], edx
4212717    movzx   ebp, word [rax+106Eh]
4212724    mov     rdi, r13
4212727    mov     [r14+8], r12d
4212731    call    _addr2string
4212736    ror     bp, 8
4212740    mov     rdx, rax
4212743    movzx   ecx, bp
4212746    xor     eax, eax
4212748    mov     esi, aSPortDConnecti
4212753    mov     edi, 6
4212758    call    _syslog
4212763    mov     rdi, rbx
4212766    call    _pthread_mutex_unlock
4212771    mov     edx, [r14+4]
4212775    cmp     r12d, edx
4212778    jle     loc_4048D8
4212784    lea     rdi, [rsp+90h]
4212792    mov     esi, aTooManyUsersLo
4212797    xor     eax, eax
4212799    call    _sprintf
4212804    mov     r14, [rsp]
4212808    lea     rsi, [rsp+90h]
4212816    lea     rdi, [r14+1040h]
4212823    call    _ftp_session_drop
4212828    mov     rdi, rbx
4212831    call    _pthread_mutex_lock
4212836    mov     rdi, r13
4212839    movzx   ebp, word [r14+106Eh]
4212847    call    _addr2string
4212852    ror     bp, 8
4212856    mov     rdx, rax
4212859    mov     edi, 4
4212864    movzx   ecx, bp
4212867    mov     r8d, r12d
4212870    mov     esi, aSPortDExceedsM
4212875    xor     eax, eax
4212877    call    _syslog
4212882    mov     rdi, rbx
4212885    call    _pthread_mutex_unlock
loc_40489A:
4212890    lea     rdi, [rsp+20h]
4212895    call    ___pthread_unregister_cancel
4212900    mov     rdi, [rsp]
4212904    call    _connection_handler_cleanup
4212909    xor     eax, eax
4212911    mov     rcx, [rsp+0E8h]
4212919    xor     rcx, [fs:28h]
4212928    jnz     loc_4048EF
4212930    add     rsp, 0F0h
4212937    pop     rbx
4212938    pop     rbp
4212939    pop     r12
4212941    pop     r13
4212943    pop     r14
4212945    retn    
4212946    align 8 
loc_4048D8:
4212952    mov     rax, [rsp]
4212956    mov     rsi, [rsp+18h]
4212961    lea     rdi, [rax+1040h]
4212968    call    _ftp_session_run
4212973    jmp     loc_40489A
loc_4048EF:
4212975    call    ___stack_chk_fail
loc_4048F4:
4212980    mov     rdi, [rsp]
4212984    call    _connection_handler_cleanup
4212989    lea     rdi, [rsp+20h]
4212994    call    ___pthread_unwind_next
4212999    nop     word [rax+rax+00000000h]
USE32

section .text

global _invariant

_invariant:
4213008    push    rbp
4213009    push    rbx
4213010    mov     rbx, rdi
4213013    sub     rsp, 8
4213017    test    rdi, rdi
4213020    jz      loc_404970
4213022    mov     edx, [rdi]
4213024    test    edx, edx
4213026    js      loc_404970
4213028    mov     eax, [rdi+4]
4213031    test    eax, eax
4213033    jle     loc_404970
4213035    mov     edx, [rdi+8]
4213038    xor     ebp, ebp
4213040    test    edx, edx
4213042    js      loc_404960
4213044    cmp     eax, edx
4213046    jl      loc_404960
4213048    lea     rdi, [rdi+78h]
4213052    call    _strlen
4213057    sub     eax, 1
4213060    cmp     eax, 0FFFh
4213065    ja      loc_404960
4213067    mov     eax, [rbx+1088h]
4213073    test    eax, eax
4213075    js      loc_404960
4213077    mov     ebp, [rbx+108Ch]
4213083    not     ebp
4213085    shr     ebp, 1Fh
loc_404960:
4213088    add     rsp, 8
4213092    mov     eax, ebp
4213094    pop     rbx
4213095    pop     rbp
4213096    retn    
4213097    align 10h
loc_404970:
4213104    add     rsp, 8
4213108    xor     ebp, ebp
4213110    pop     rbx
4213111    mov     eax, ebp
4213113    pop     rbp
4213114    retn    
USE32

section .text

global _connection_acceptor

_connection_acceptor:
4213120    push    r15
4213122    push    r14
4213124    push    r13
4213126    push    r12
4213128    push    rbp
4213129    push    rbx
4213130    mov     rbx, rdi
4213133    sub     rsp, 148h
4213140    mov     rax, [fs:28h]
4213149    mov     [rsp+138h], rax
4213157    xor     eax, eax
4213159    call    _invariant
4213164    test    eax, eax
4213166    jz      loc_404CE6
loc_4049B4:
4213172    mov     esi, [rbx+0Ch]
4213175    lea     rdi, [rbx+10h]
4213179    lea     rdx, [rsp+0B0h]
4213187    call    _watchdog_init
4213192    test    eax, eax
4213194    jz      loc_404D04
4213200    lea     rbp, [rsp+10h]
4213205    xor     r12d, r12d
4213208    nop     dword [rax+rax+00000000h]
loc_4049E0:
4213216    mov     ecx, 10h
4213221    xor     eax, eax
4213223    mov     rdi, rbp
4213226    cld     
4213227    rep stosq
4213230    mov     ecx, [rbx]
4213232    mov     r13d, 1
4213238    mov     rsi, rbp
4213241    mov     edi, 400h
4213246    lea     eax, [rcx+3Fh]
4213249    test    ecx, ecx
4213251    cmovns  eax, ecx
4213254    sar     eax, 6
4213257    movsxd  rdx, eax
4213260    mov     eax, ecx
4213262    sar     eax, 1Fh
4213265    shr     eax, 1Ah
4213268    add     ecx, eax
4213270    and     ecx, 3Fh
4213273    sub     ecx, eax
4213275    mov     rax, r13
4213278    shl     rax, cl
4213281    mov     ecx, [rbx+108Ch]
4213287    or      [rsp+rdx*8+10h], rax
4213292    lea     eax, [rcx+3Fh]
4213295    test    ecx, ecx
4213297    cmovns  eax, ecx
4213300    xor     r8d, r8d
4213303    sar     eax, 6
4213306    movsxd  rdx, eax
4213309    mov     eax, ecx
4213311    sar     eax, 1Fh
4213314    shr     eax, 1Ah
4213317    add     ecx, eax
4213319    and     ecx, 3Fh
4213322    sub     ecx, eax
4213324    mov     rax, r13
4213327    shl     rax, cl
4213330    xor     ecx, ecx
4213332    or      [rsp+rdx*8+10h], rax
4213337    xor     edx, edx
4213339    call    _select
4213344    mov     eax, [rbx+108Ch]
4213350    cdq     
4213351    shr     edx, 1Ah
4213354    lea     ecx, [rax+rdx]
4213357    and     ecx, 3Fh
4213360    sub     ecx, edx
4213362    lea     edx, [rax+3Fh]
4213365    shl     r13, cl
4213368    test    eax, eax
4213370    cmovs   eax, edx
4213373    sar     eax, 6
4213376    cdqe    
4213378    test    [rsp+rax*8+10h], r13
4213383    jnz     loc_404D2A
4213389    mov     edi, [rbx]
4213391    lea     rdx, [rsp+4]
4213396    lea     rsi, [rsp+90h]
4213404    mov     dword [rsp+4], 10h
4213412    call    _accept
4213417    test    eax, eax
4213419    mov     r13d, eax
4213422    js      loc_404B10
4213424    mov     r8d, 4
4213430    mov     rcx, rsp
4213433    mov     edx, 1
4213438    mov     esi, 6
4213443    mov     edi, eax
4213445    mov     dword [rsp], 1
4213452    call    _setsockopt
4213457    test    eax, eax
4213459    jz      loc_404B90
4213465    call    ___errno_location
4213470    mov     edi, [rax]
4213472    call    _strerror
4213477    mov     esi, aErrorInSetsock
4213482    mov     rdx, rax
loc_404AED:
4213485    mov     edi, 3
4213490    xor     eax, eax
4213492    call    _syslog
4213497    mov     edi, r13d
4213500    call    _close
4213505    jmp     loc_4049E0
4213510    align 10h
loc_404B10:
4213520    call    ___errno_location
4213525    mov     edi, [rax]
4213527    lea     eax, [rdi-67h]
4213530    cmp     eax, 1
4213533    jbe     loc_404C50
4213539    call    _strerror
4213544    add     r12d, 1
4213548    mov     rdx, rax
4213551    mov     esi, aErrorAccepting
4213556    mov     edi, 4
4213561    xor     eax, eax
4213563    call    _syslog
loc_404B40:
4213568    cmp     r12d, 9
4213572    jle     loc_4049E0
4213578    mov     esi, aTooManyConsecu
4213583    mov     edi, 3
4213588    xor     eax, eax
4213590    call    _syslog
loc_404B5B:
4213595    xor     eax, eax
4213597    mov     rbx, [rsp+138h]
4213605    xor     rbx, [fs:28h]
4213614    jnz     loc_404D49
4213620    add     rsp, 148h
4213627    pop     rbx
4213628    pop     rbp
4213629    pop     r12
4213631    pop     r13
4213633    pop     r14
4213635    pop     r15
4213637    retn    
4213638    align 10h
loc_404B90:
4213648    lea     rdx, [rsp+4]
4213653    lea     rsi, [rsp+0A0h]
4213661    mov     edi, r13d
4213664    mov     dword [rsp+4], 10h
4213672    call    _getsockname
4213677    cmp     eax, 0FFFFFFFFh
4213680    jz      loc_404CA8
4213686    mov     edi, 2140h
4213691    call    _malloc
4213696    test    rax, rax
4213699    mov     r14, rax
4213702    jz      loc_404CC8
4213708    lea     r15, [rax+8]
4213712    mov     [rax], rbx
4213715    mov     edx, r13d
4213718    mov     esi, r13d
4213721    mov     rdi, r15
4213724    call    _telnet_session_init
4213729    lea     rdi, [r14+1040h]
4213736    lea     r9, [rsp+0B0h]
4213744    lea     r8, [rbx+78h]
4213748    lea     rdx, [rsp+0A0h]
4213756    lea     rsi, [rsp+90h]
4213764    mov     rcx, r15
4213767    call    _ftp_session_init
4213772    test    eax, eax
4213774    jnz     loc_404C70
4213776    lea     rdi, [rsp+0B0h]
4213784    call    _error_get_desc
4213789    mov     esi, aErrorInitial_0
4213794    mov     rdx, rax
4213797    mov     edi, 3
4213802    xor     eax, eax
4213804    call    _syslog
loc_404C31:
4213809    mov     edi, r13d
4213812    call    _close
4213817    mov     rdi, r15
4213820    call    _telnet_session_destroy
4213825    mov     rdi, r14
4213828    call    _free
4213833    jmp     loc_4049E0
4213838    align 10h
loc_404C50:
4213840    call    _strerror
4213845    mov     esi, aInterruptionAc
4213850    mov     rdx, rax
4213853    mov     edi, 5
4213858    xor     eax, eax
4213860    call    _syslog
4213865    jmp     loc_404B40
4213870    align 10h
loc_404C70:
4213872    lea     rdi, [rsp+8]
4213877    xor     esi, esi
4213879    mov     rcx, r14
4213882    mov     edx, connection_handler
4213887    xor     r12d, r12d
4213890    call    _pthread_create
4213895    test    eax, eax
4213897    jz      loc_4049E0
4213903    mov     edx, eax
4213905    mov     esi, aErrorCreatingN
4213910    mov     edi, 3
4213915    xor     eax, eax
4213917    call    _syslog
4213922    jmp     loc_404C31
4213924    align 8 
loc_404CA8:
4213928    call    ___errno_location
4213933    mov     edi, [rax]
4213935    nop     
4213936    call    _strerror
4213941    mov     esi, aErrorInGetsock
4213946    mov     rdx, rax
4213949    jmp     loc_404AED
4213954    align 8 
loc_404CC8:
4213960    mov     esi, aOutOfMemoryFtp
4213965    mov     edi, 2
4213970    xor     eax, eax
4213972    call    _syslog
4213977    mov     edi, r13d
4213980    call    _close
4213985    jmp     loc_4049E0
loc_404CE6:
4213990    mov     ecx, __func___5290
4213995    mov     edx, 14Dh
4214000    mov     esi, aFtp_listener_c
4214005    mov     edi, aInvariantF
4214010    call    _daemon_assert_fail
4214015    jmp     loc_4049B4
loc_404D04:
4214020    lea     rdi, [rsp+0B0h]
4214028    call    _error_get_desc
4214033    mov     esi, aErrorInitial_1
4214038    mov     rdx, rax
4214041    mov     edi, 3
4214046    xor     eax, eax
4214048    call    _syslog
4214053    jmp     loc_404B5B
loc_404D2A:
4214058    mov     edi, [rbx]
4214060    call    _close
4214065    mov     edi, 6
4214070    mov     esi, aListenerNoLong
4214075    xor     eax, eax
4214077    call    _syslog
4214082    xor     edi, edi
4214084    call    _pthread_exit
loc_404D49:
4214089    call    ___stack_chk_fail
USE32

section .text

global _ftp_listener_init

_ftp_listener_init:
4214096    push    r15
4214098    push    r14
4214100    mov     r14, rdi
4214103    push    r13
4214105    mov     r13, rsi
4214108    push    r12
4214110    mov     r12d, ecx
4214113    push    rbp
4214114    mov     rbp, r9
4214117    push    rbx
4214118    mov     ebx, edx
4214120    sub     rsp, 10E8h
4214127    mov     rax, [fs:28h]
4214136    mov     [rsp+10D8h], rax
4214144    xor     eax, eax
4214146    test    rdi, rdi
4214149    mov     [rsp+0Ch], r8d
4214154    jz      loc_405220
loc_404D90:
4214160    test    ebx, ebx
4214162    js      loc_405148
4214168    cmp     ebx, 0FFFFh
4214174    jle     loc_404DB9
4214176    mov     ecx, __func___5251
4214181    mov     edx, 63h
4214186    mov     esi, aFtp_listener_c
4214191    mov     edi, aPort65536
4214196    call    _daemon_assert_fail
loc_404DB9:
4214201    test    r12d, r12d
4214204    jle     loc_405170
loc_404DC2:
4214210    test    rbp, rbp
4214213    jz      loc_4051F8
loc_404DCB:
4214219    lea     r15, [rsp+0D0h]
4214227    mov     esi, 1001h
4214232    mov     rdi, r15
4214235    call    _getcwd
4214240    test    rax, rax
4214243    jz      loc_4051B0
4214249    test    r13, r13
4214252    mov     qword [rsp+50h], 0
4214261    mov     qword [rsp+58h], 0
4214270    jz      loc_4050C0
4214276    lea     rdx, [rsp+20h]
4214281    xor     eax, eax
4214283    mov     ecx, 6
4214288    xor     esi, esi
4214290    mov     rdi, rdx
4214293    rep stosq
4214296    lea     rcx, [rsp+18h]
4214301    mov     rdi, r13
4214304    mov     dword [rsp+24h], 2
4214312    mov     dword [rsp+20h], 1
4214320    call    _getaddrinfo
4214325    test    eax, eax
4214327    mov     r13d, eax
4214330    jnz     loc_405060
4214336    mov     r13, [rsp+18h]
4214341    lea     rdi, [rsp+50h]
4214346    mov     edx, [r13+10h]
4214350    mov     rsi, [r13+18h]
4214354    call    _memcpy
4214359    mov     rdi, r13
4214362    call    _freeaddrinfo
4214367    movzx   edi, word [rsp+50h]
loc_404E64:
4214372    test    ebx, ebx
4214374    jnz     loc_4050B0
4214380    mov     eax, 1500h
4214385    mov     [rsp+52h], ax
loc_404E76:
4214390    lea     rsi, [rsp+54h]
4214395    lea     rdx, [rsp+60h]
4214400    mov     ecx, 65h
4214405    call    _inet_ntop
4214410    test    rax, rax
4214413    jz      loc_4052A0
4214419    lea     rdx, [rsp+60h]
4214424    xor     eax, eax
4214426    movzx   ecx, word [rsp+52h]
4214431    mov     r8d, r12d
4214434    mov     esi, aBindingInterfa
4214439    mov     edi, 6
4214444    ror     cx, 8
4214448    movzx   ecx, cx
4214451    call    _syslog
4214456    xor     edx, edx
4214458    mov     esi, 1
4214463    mov     edi, 2
4214468    call    _socket
4214473    cmp     eax, 0FFFFFFFFh
4214476    mov     ebx, eax
4214478    jz      loc_405190
4214484    lea     rcx, [rsp+18h]
4214489    mov     r8d, 4
4214495    mov     edx, 2
4214500    mov     esi, 1
4214505    mov     edi, eax
4214507    mov     dword [rsp+18h], 1
4214515    call    _setsockopt
4214520    test    eax, eax
4214522    mov     r13d, eax
4214525    jnz     loc_405110
4214531    lea     rsi, [rsp+50h]
4214536    mov     edx, 10h
4214541    mov     edi, ebx
4214543    call    _bind
4214548    test    eax, eax
4214550    jnz     loc_4050D8
4214556    mov     esi, 80h
4214561    mov     edi, ebx
4214563    call    _listen
4214568    test    eax, eax
4214570    mov     r13d, eax
4214573    jnz     loc_4051D0
4214579    xor     eax, eax
4214581    mov     esi, 3
4214586    mov     edi, ebx
4214588    call    _fcntl
4214593    cmp     eax, 0FFFFFFFFh
4214596    jz      loc_4052C0
4214602    or      ah, 8
4214605    mov     esi, 4
4214610    mov     edi, ebx
4214612    mov     edx, eax
4214614    xor     eax, eax
4214616    call    _fcntl
4214621    test    eax, eax
4214623    jnz     loc_405270
4214629    lea     rdi, [rsp+20h]
4214634    call    _pipe
4214639    test    eax, eax
4214641    jnz     loc_405240
4214647    mov     eax, [rsp+0Ch]
4214651    lea     rdi, [r14+50h]
4214655    mov     [r14], ebx
4214658    mov     [r14+4], r12d
4214662    mov     dword [r14+8], 0
4214670    xor     esi, esi
4214672    mov     [r14+0Ch], eax
4214676    call    _pthread_mutex_init
4214681    mov     rdx, r15
loc_404F9C:
4214684    mov     ecx, [rdx]
4214686    add     rdx, 4
4214690    lea     eax, [rcx-1010101h]
4214696    not     ecx
4214698    and     eax, ecx
4214700    and     eax, 80808080h
4214705    jz      loc_404F9C
4214707    mov     ecx, eax
4214709    shr     ecx, 10h
4214712    test    eax, 8080h
4214717    cmovz   eax, ecx
4214720    lea     rcx, [rdx+2]
4214724    cmovz   rdx, rcx
4214728    add     al, al
4214730    sbb     rdx, 3
4214734    sub     rdx, r15
4214737    cmp     rdx, 1000h
4214744    jbe     loc_404FF3
4214746    mov     ecx, __func___5251
4214751    mov     edx, 0F2h
4214756    mov     esi, aFtp_listener_c
4214761    mov     edi, aStrlenDirSizeo
4214766    call    _daemon_assert_fail
loc_404FF3:
4214771    lea     rdi, [r14+78h]
4214775    mov     rsi, r15
4214778    mov     r13d, 1
4214784    call    _strcpy
4214789    mov     eax, [rsp+24h]
4214793    lea     rdi, [r14+1090h]
4214800    xor     esi, esi
4214802    mov     dword [r14+107Ch], 0
4214813    mov     [r14+1088h], eax
4214820    mov     eax, [rsp+20h]
4214824    mov     [r14+108Ch], eax
4214831    call    _pthread_cond_init
4214836    mov     rdi, r14
4214839    call    _invariant
4214844    test    eax, eax
4214846    jnz     loc_40507F
4214848    mov     ecx, __func___5251
4214853    mov     edx, 0FAh
4214858    mov     esi, aFtp_listener_c
4214863    mov     edi, aInvariantF
4214868    call    _daemon_assert_fail
4214873    jmp     loc_40507F
4214875    align 20h
loc_405060:
4214880    mov     edi, eax
4214882    call    _gai_strerror
4214887    mov     esi, r13d
4214890    mov     rcx, rax
4214893    mov     edx, aErrorParsingSe
4214898    mov     rdi, rbp
4214901    xor     eax, eax
4214903    xor     r13d, r13d
4214906    call    _error_init
loc_40507F:
4214911    mov     rbx, [rsp+10D8h]
4214919    xor     rbx, [fs:28h]
4214928    mov     eax, r13d
4214931    jnz     loc_4052EF
4214937    add     rsp, 10E8h
4214944    pop     rbx
4214945    pop     rbp
4214946    pop     r12
4214948    pop     r13
4214950    pop     r14
4214952    pop     r15
4214954    retn    
4214955    align 10h
loc_4050B0:
4214960    ror     bx, 8
4214964    mov     [rsp+52h], bx
4214969    jmp     loc_404E76
4214974    align 20h
loc_4050C0:
4214976    mov     edx, 2
4214981    mov     edi, 2
4214986    mov     [rsp+50h], dx
4214991    jmp     loc_404E64
4214996    align 8 
loc_4050D8:
4215000    mov     edi, ebx
4215002    call    _close
4215007    call    ___errno_location
4215012    mov     edi, [rax]
4215014    mov     rbx, rax
4215017    call    _strerror
4215022    mov     esi, [rbx]
4215024    mov     rcx, rax
4215027    mov     edx, aErrorBindingAd
4215032    mov     rdi, rbp
4215035    xor     eax, eax
4215037    call    _error_init
4215042    jmp     loc_40507F
4215047    align 10h
loc_405110:
4215056    mov     edi, ebx
4215058    call    _close
4215063    call    ___errno_location
4215068    mov     edi, [rax]
4215070    mov     rbx, rax
4215073    call    _strerror
4215078    mov     edx, aErrorSettingSo
4215083    mov     rcx, rax
loc_40512E:
4215086    mov     esi, [rbx]
4215088    mov     rdi, rbp
4215091    xor     eax, eax
4215093    xor     r13d, r13d
4215096    call    _error_init
4215101    jmp     loc_40507F
4215106    align 8 
loc_405148:
4215112    mov     ecx, __func___5251
4215117    mov     edx, 62h
4215122    mov     esi, aFtp_listener_c
4215127    mov     edi, aPort0
4215132    call    _daemon_assert_fail
4215137    test    r12d, r12d
4215140    jg      loc_404DC2
4215146    nop     word [rax+rax+00h]
loc_405170:
4215152    mov     ecx, __func___5251
4215157    mov     edx, 64h
4215162    mov     esi, aFtp_listener_c
4215167    mov     edi, aMax_connection
4215172    call    _daemon_assert_fail
4215177    jmp     loc_404DC2
4215182    align 10h
loc_405190:
4215184    call    ___errno_location
4215189    mov     edi, [rax]
4215191    mov     rbx, rax
4215194    call    _strerror
4215199    mov     edx, aErrorCreatingS
4215204    mov     rcx, rax
4215207    jmp     loc_40512E
4215209    align 10h
loc_4051B0:
4215216    call    ___errno_location
4215221    mov     edi, [rax]
4215223    mov     rbx, rax
4215226    call    _strerror
4215231    mov     edx, aErrorGettingCu
4215236    mov     rcx, rax
4215239    jmp     loc_40512E
4215244    align 10h
loc_4051D0:
4215248    mov     edi, ebx
4215250    call    _close
4215255    call    ___errno_location
4215260    mov     edi, [rax]
4215262    mov     rbx, rax
4215265    call    _strerror
4215270    mov     edx, aErrorSetting_0
4215275    mov     rcx, rax
4215278    jmp     loc_40512E
4215283    align 8 
loc_4051F8:
4215288    mov     ecx, __func___5251
4215293    mov     edx, 65h
4215298    mov     esi, aFtp_listener_c
4215303    mov     edi, aErrVoid0
4215308    call    _daemon_assert_fail
4215313    jmp     loc_404DCB
4215318    align 20h
loc_405220:
4215328    mov     ecx, __func___5251
4215333    mov     edx, 61h
4215338    mov     esi, aFtp_listener_c
4215343    mov     edi, aFVoid0
4215348    call    _daemon_assert_fail
4215353    jmp     loc_404D90
4215358    align 20h
loc_405240:
4215360    mov     edi, ebx
4215362    call    _close
4215367    call    ___errno_location
4215372    mov     edi, [rax]
4215374    mov     rbx, rax
4215377    call    _strerror
4215382    mov     esi, [rbx]
4215384    mov     rcx, rax
4215387    mov     edx, aErrorCreatingP
4215392    mov     rdi, rbp
4215395    xor     eax, eax
4215397    call    _error_init
4215402    jmp     loc_40507F
4215407    align 10h
loc_405270:
4215408    mov     edi, ebx
4215410    call    _close
4215415    call    ___errno_location
4215420    mov     edi, [rax]
4215422    mov     rbx, rax
4215425    call    _strerror
4215430    mov     esi, [rbx]
4215432    mov     rcx, rax
4215435    mov     edx, aErrorSetting_1
4215440    mov     rdi, rbp
4215443    xor     eax, eax
4215445    call    _error_init
4215450    jmp     loc_40507F
4215455    align 20h
loc_4052A0:
4215456    call    ___errno_location
4215461    mov     edi, [rax]
4215463    mov     rbx, rax
4215466    call    _strerror
4215471    mov     edx, aErrorConvertin
4215476    mov     rcx, rax
4215479    jmp     loc_40512E
4215484    align 20h
loc_4052C0:
4215488    mov     edi, ebx
4215490    call    _close
4215495    call    ___errno_location
4215500    mov     edi, [rax]
4215502    mov     rbx, rax
4215505    call    _strerror
4215510    mov     esi, [rbx]
4215512    mov     rcx, rax
4215515    mov     edx, aErrorGettingFl
4215520    mov     rdi, rbp
4215523    xor     eax, eax
4215525    call    _error_init
4215530    jmp     loc_40507F
loc_4052EF:
4215535    call    ___stack_chk_fail
USE32

section .text

global _ftp_listener_start

_ftp_listener_start:
4215552    push    rbp
4215553    mov     rbp, rsi
4215556    push    rbx
4215557    mov     rbx, rdi
4215560    sub     rsp, 18h
4215564    call    _invariant
4215569    test    eax, eax
4215571    jz      loc_4053A0
loc_405319:
4215577    test    rbp, rbp
4215580    jz      loc_4053C0
loc_405322:
4215586    lea     rdi, [rsp+8]
4215591    xor     esi, esi
4215593    mov     rcx, rbx
4215596    mov     edx, connection_acceptor
4215601    call    _pthread_create
4215606    test    eax, eax
4215608    jnz     loc_405388
4215610    mov     rax, [rsp+8]
4215615    mov     dword [rbx+107Ch], 1
4215625    mov     ebp, 1
4215630    mov     [rbx+1080h], rax
loc_405355:
4215637    mov     rdi, rbx
4215640    call    _invariant
4215645    test    eax, eax
4215647    jnz     loc_40537A
4215649    mov     ecx, __func___5271
4215654    mov     edx, 116h
4215659    mov     esi, aFtp_listener_c
4215664    mov     edi, aInvariantF
4215669    call    _daemon_assert_fail
loc_40537A:
4215674    add     rsp, 18h
4215678    mov     eax, ebp
4215680    pop     rbx
4215681    pop     rbp
4215682    retn    
4215683    align 8 
loc_405388:
4215688    mov     esi, eax
4215690    mov     rdi, rbp
4215693    mov     edx, aUnableToCreate
4215698    xor     eax, eax
4215700    xor     ebp, ebp
4215702    call    _error_init
4215707    jmp     loc_405355
4215709    align 20h
loc_4053A0:
4215712    mov     ecx, __func___5271
4215717    mov     edx, 105h
4215722    mov     esi, aFtp_listener_c
4215727    mov     edi, aInvariantF
4215732    call    _daemon_assert_fail
4215737    jmp     loc_405319
4215742    align 20h
loc_4053C0:
4215744    mov     ecx, __func___5271
4215749    mov     edx, 106h
4215754    mov     esi, aFtp_listener_c
4215759    mov     edi, aErrVoid0
4215764    call    _daemon_assert_fail
USE32

section .text

global _ftp_listener_stop

_ftp_listener_stop:
4215776    push    r12
4215778    push    rbp
4215779    push    rbx
4215780    mov     rbx, rdi
4215783    call    _invariant
4215788    test    eax, eax
4215790    jz      loc_405440
loc_4053F0:
4215792    mov     edi, [rbx+1088h]
4215798    lea     rbp, [rbx+50h]
4215802    mov     edx, 1
4215807    mov     esi, (offset aTotal0+9)
4215812    lea     r12, [rbx+1090h]
4215819    call    _write
4215824    mov     rdi, rbp
4215827    call    _pthread_mutex_lock
4215832    mov     edx, [rbx+8]
4215835    test    edx, edx
4215837    jle     loc_405432
4215839    nop     
loc_405420:
4215840    mov     rsi, rbp
4215843    mov     rdi, r12
4215846    call    _pthread_cond_wait
4215851    mov     eax, [rbx+8]
4215854    test    eax, eax
4215856    jg      loc_405420
loc_405432:
4215858    pop     rbx
4215859    mov     rdi, rbp
4215862    pop     rbp
4215863    pop     r12
4215865    jmp     _pthread_mutex_unlock
4215870    align 20h
loc_405440:
4215872    mov     ecx, __func___5329
4215877    mov     edx, 234h
4215882    mov     esi, aFtp_listener_c
4215887    mov     edi, aInvariantF
4215892    call    _daemon_assert_fail
USE32

section .text

global _ip_equal

_ip_equal:
4215904    push    rbp
4215905    mov     rbp, rsi
4215908    push    rbx
4215909    mov     rbx, rdi
4215912    sub     rsp, 8
4215916    test    rdi, rdi
4215919    jz      loc_405530
loc_405475:
4215925    test    rbp, rbp
4215928    jz      loc_405510
loc_40547E:
4215934    movzx   eax, word [rbx]
4215937    and     eax, 0FFFFFFF7h
4215940    cmp     ax, 2
4215944    jnz     loc_4054F0
loc_40548A:
4215946    movzx   eax, word [rbp+0]
4215950    mov     ecx, eax
4215952    mov     edx, eax
4215954    and     ecx, 0FFFFFFF7h
4215957    cmp     cx, 2
4215961    jnz     loc_4054C8
loc_40549B:
4215963    xor     eax, eax
4215965    cmp     dx, [rbx]
4215968    jnz     loc_4054BC
4215970    lea     rsi, [rbp+4]
4215974    lea     rdi, [rbx+4]
4215978    mov     edx, 4
4215983    call    _memcmp
4215988    test    eax, eax
4215990    setz    al
4215993    movzx   eax, al
loc_4054BC:
4215996    add     rsp, 8
4216000    pop     rbx
4216001    pop     rbp
4216002    retn    
4216003    align 8 
loc_4054C8:
4216008    mov     edx, 71Ch
4216013    mov     ecx, __func___5784
4216018    mov     esi, aFtp_session_c
4216023    mov     edi, aStructSockaddr
4216028    call    _daemon_assert_fail
4216033    movzx   edx, word [rbp+0]
4216037    jmp     loc_40549B
4216039    align 10h
loc_4054F0:
4216048    mov     ecx, __func___5784
4216053    mov     edx, 71Bh
4216058    mov     esi, aFtp_session_c
4216063    mov     edi, aStructSockad_0
4216068    call    _daemon_assert_fail
4216073    jmp     loc_40548A
4216078    align 10h
loc_405510:
4216080    mov     ecx, __func___5784
4216085    mov     edx, 71Ah
4216090    mov     esi, aFtp_session_c
4216095    mov     edi, aBVoid0
4216100    call    _daemon_assert_fail
4216105    jmp     loc_40547E
4216110    align 10h
loc_405530:
4216112    mov     ecx, __func___5784
4216117    mov     edx, 719h
4216122    mov     esi, aFtp_session_c
4216127    mov     edi, aAVoid0
4216132    call    _daemon_assert_fail
USE32

section .text

global _init_passive_port

_init_passive_port:
4216144    sub     rsp, 28h
4216148    xor     esi, esi
4216150    lea     rdi, [rsp+10h]
4216155    call    _gettimeofday
4216160    mov     rax, [rsp+10h]
4216165    mov     rdi, rsp
4216168    mov     [rsp+2], ax
4216173    mov     rdx, rax
4216176    mov     rax, [rsp+18h]
4216181    sar     rdx, 10h
4216185    mov     [rsp], dx
4216189    mov     [rsp+4], ax
4216194    call    _seed48
4216199    add     rsp, 28h
4216203    retn    
USE32

section .text

global _invariant_0

_invariant_0:
4216208    push    rbp
4216209    xor     ebp, ebp
4216211    push    rbx
4216212    mov     rbx, rdi
4216215    sub     rsp, 8
4216219    test    rdi, rdi
4216222    jz      loc_4055A5
4216224    cmp     dword [rdi], 1
4216227    jbe     loc_4055B0
loc_4055A5:
4216229    add     rsp, 8
4216233    mov     eax, ebp
4216235    pop     rbx
4216236    pop     rbp
4216237    retn    
4216238    align 10h
loc_4055B0:
4216240    cmp     dword [rdi+10h], 1
4216244    ja      loc_4055A5
4216246    cmp     dword [rdi+14h], 1
4216250    ja      loc_4055A5
4216252    cmp     qword [rdi+18h], 0
4216257    js      loc_4055A5
4216259    cmp     dword [rdi+28h], 1
4216263    ja      loc_4055A5
4216265    lea     rdi, [rdi+3Ch]
4216269    call    _strlen
4216274    sub     eax, 1
4216277    cmp     eax, 38h
4216280    ja      loc_4055A5
4216282    cmp     qword [rbx+98h], 0
4216290    jz      loc_4055A5
4216292    mov     eax, [rbx+10A4h]
4216298    test    eax, eax
4216300    jz      loc_405600
4216302    cmp     eax, 1
4216305    jnz     loc_405625
4216307    mov     ebp, [rbx+10B8h]
4216313    not     ebp
4216315    shr     ebp, 1Fh
4216318    jmp     loc_4055A5
loc_405600:
4216320    lea     rsi, [rbx+10A8h]
4216327    lea     rdi, [rbx+2Ch]
4216331    call    _ip_equal
4216336    test    eax, eax
4216338    mov     ebp, eax
4216340    jz      loc_4055A5
4216342    xor     ebp, ebp
4216344    cmp     dword [rbx+10B8h], 0FFFFFFFFh
4216351    setz    bpl
4216355    jmp     loc_4055A5
loc_405625:
4216357    xor     ebp, ebp
4216359    jmp     loc_4055A5
USE32

section .text

global _reply

_reply:
4216368    push    r12
4216370    push    rbp
4216371    mov     ebp, esi
4216373    push    rbx
4216374    mov     rbx, rdi
4216377    sub     rsp, 1E0h
4216384    test    al, al
4216386    mov     [rsp+148h], rcx
4216394    mov     [rsp+150h], r8
4216402    mov     [rsp+158h], r9
4216410    jz      loc_40569C
4216412    movaps  xmmword [rsp+160h], xmm0
4216420    movaps  xmmword [rsp+170h], xmm1
4216428    movaps  xmmword [rsp+180h], xmm2
4216436    movaps  xmmword [rsp+190h], xmm3
4216444    movaps  xmmword [rsp+1A0h], xmm4
4216452    movaps  xmmword [rsp+1B0h], xmm5
4216460    movaps  xmmword [rsp+1C0h], xmm6
4216468    movaps  xmmword [rsp+1D0h], xmm7
loc_40569C:
4216476    mov     rdi, rbx
4216479    mov     r12, rdx
4216482    mov     rax, [fs:28h]
4216491    mov     [rsp+128h], rax
4216499    xor     eax, eax
4216501    call    _invariant_0
4216506    test    eax, eax
4216508    jz      loc_4057F0
loc_4056C2:
4216514    cmp     ebp, 63h
4216517    jle     loc_4057D0
4216523    cmp     ebp, 22Fh
4216529    jg      loc_4057B0
loc_4056D7:
4216535    test    r12, r12
4216538    jz      loc_405810
loc_4056E0:
4216544    lea     rdi, [rsp+20h]
4216549    mov     edx, ebp
4216551    mov     esi, (offset aErrorCreatingN+1Bh)
4216556    xor     eax, eax
4216558    call    _sprintf
4216563    lea     rax, [rsp+200h]
4216571    lea     rdi, [rsp+24h]
4216576    lea     rcx, [rsp+8]
4216581    mov     rdx, r12
4216584    mov     esi, 0FCh
4216589    mov     byte [rsp+23h], 20h
4216594    mov     [rsp+10h], rax
4216599    lea     rax, [rsp+130h]
4216607    mov     dword [rsp+8], 18h
4216615    mov     dword [rsp+0Ch], 30h
4216623    mov     [rsp+18h], rax
4216628    call    _vsnprintf
4216633    lea     rdx, [rbx+3Ch]
4216637    lea     rcx, [rsp+20h]
4216642    xor     eax, eax
4216644    mov     esi, aSS
4216649    mov     edi, 7
4216654    call    _syslog
4216659    mov     rdi, [rbx+98h]
4216666    lea     rsi, [rsp+20h]
4216671    call    _telnet_session_println
4216676    mov     rdi, rbx
4216679    call    _invariant_0
4216684    test    eax, eax
4216686    jnz     loc_405789
4216688    mov     ecx, __func___5414
4216693    mov     edx, 175h
4216698    mov     esi, aFtp_session_c
4216703    mov     edi, aInvariantF
4216708    call    _daemon_assert_fail
loc_405789:
4216713    mov     rax, [rsp+128h]
4216721    xor     rax, [fs:28h]
4216730    jnz     loc_40582E
4216736    add     rsp, 1E0h
4216743    pop     rbx
4216744    pop     rbp
4216745    pop     r12
4216747    retn    
4216748    align 10h
loc_4057B0:
4216752    mov     ecx, __func___5414
4216757    mov     edx, 163h
4216762    mov     esi, aFtp_session_c
4216767    mov     edi, aCode559
4216772    call    _daemon_assert_fail
4216777    jmp     loc_4056D7
4216782    align 10h
loc_4057D0:
4216784    mov     ecx, __func___5414
4216789    mov     edx, 162h
4216794    mov     esi, aFtp_session_c
4216799    mov     edi, aCode100
4216804    call    _daemon_assert_fail
4216809    jmp     loc_4056D7
4216814    align 10h
loc_4057F0:
4216816    mov     ecx, __func___5414
4216821    mov     edx, 161h
4216826    mov     esi, aFtp_session_c
4216831    mov     edi, aInvariantF
4216836    call    _daemon_assert_fail
4216841    jmp     loc_4056C2
4216846    align 10h
loc_405810:
4216848    mov     ecx, __func___5414
4216853    mov     edx, 164h
4216858    mov     esi, aFtp_session_c
4216863    mov     edi, aFmtVoid0
4216868    call    _daemon_assert_fail
4216873    jmp     loc_4056E0
loc_40582E:
4216878    call    ___stack_chk_fail
USE32

section .text

global _open_connection

_open_connection:
4216896    push    rbp
4216897    push    rbx
4216898    mov     rbx, rdi
4216901    sub     rsp, 38h
4216905    mov     rax, [fs:28h]
4216914    mov     [rsp+28h], rax
4216919    xor     eax, eax
4216921    mov     eax, [rdi+10A4h]
4216927    cmp     eax, 1
4216930    jbe     loc_405883
4216932    mov     ecx, __func___5649
4216937    mov     edx, 505h
4216942    mov     esi, aFtp_session_c
4216947    mov     edi, aFData_channel0
4216952    call    _daemon_assert_fail
4216957    mov     eax, [rbx+10A4h]
loc_405883:
4216963    test    eax, eax
4216965    jz      loc_405910
4216971    cmp     eax, 1
4216974    jz      loc_4058A9
4216976    mov     ecx, __func___5649
4216981    mov     edx, 515h
4216986    mov     esi, aFtp_session_c
4216991    mov     edi, aFData_channel1
4216996    call    _daemon_assert_fail
loc_4058A9:
4217001    mov     edi, [rbx+10B8h]
4217007    lea     rdx, [rsp+0Ch]
4217012    lea     rsi, [rsp+10h]
4217017    mov     dword [rsp+0Ch], 10h
4217025    call    _accept
4217030    cmp     eax, 0FFFFFFFFh
4217033    mov     ebp, eax
4217035    jz      loc_40599E
4217041    lea     rsi, [rsp+14h]
4217046    lea     rdi, [rbx+30h]
4217050    mov     edx, 4
4217055    call    _memcmp
4217060    test    eax, eax
4217062    jnz     loc_405979
loc_4058EC:
4217068    mov     eax, ebp
loc_4058EE:
4217070    mov     rcx, [rsp+28h]
4217075    xor     rcx, [fs:28h]
4217084    jnz     loc_4059DE
4217090    add     rsp, 38h
4217094    pop     rbx
4217095    pop     rbp
4217096    retn    
4217097    align 10h
loc_405910:
4217104    movzx   edi, word [rbx+10A8h]
4217111    xor     edx, edx
4217113    mov     esi, 1
4217118    call    _socket
4217123    cmp     eax, 0FFFFFFFFh
4217126    mov     ebp, eax
4217128    jz      loc_4059C8
4217134    lea     rsi, [rbx+10A8h]
4217141    mov     edx, 10h
4217146    mov     edi, eax
4217148    call    _connect
4217153    test    eax, eax
4217155    jz      loc_4058EC
4217157    call    ___errno_location
4217162    mov     edi, [rax]
4217164    call    _strerror
4217169    mov     edx, aErrorConnectin
4217174    mov     rcx, rax
4217177    mov     esi, 1A9h
4217182    mov     rdi, rbx
4217185    xor     eax, eax
4217187    call    _reply
4217192    mov     edi, ebp
4217194    call    _close
4217199    mov     eax, 0FFFFFFFFh
4217204    jmp     loc_4058EE
loc_405979:
4217209    mov     edx, aErrorAccepti_0
4217214    mov     esi, 1A9h
4217219    mov     rdi, rbx
4217222    xor     eax, eax
4217224    call    _reply
4217229    mov     edi, ebp
4217231    call    _close
4217236    mov     eax, 0FFFFFFFFh
4217241    jmp     loc_4058EE
loc_40599E:
4217246    call    ___errno_location
4217251    mov     edi, [rax]
4217253    call    _strerror
4217258    mov     edx, aErrorAccepti_1
4217263    mov     rcx, rax
loc_4059B2:
4217266    xor     eax, eax
4217268    mov     esi, 1A9h
4217273    mov     rdi, rbx
4217276    call    _reply
4217281    mov     eax, ebp
4217283    jmp     loc_4058EE
loc_4059C8:
4217288    call    ___errno_location
4217293    mov     edi, [rax]
4217295    call    _strerror
4217300    mov     edx, aErrorCreatin_0
4217305    mov     rcx, rax
4217308    jmp     loc_4059B2
loc_4059DE:
4217310    call    ___stack_chk_fail
USE32

section .text

global _do_rest

_do_rest:
4217328    push    rbp
4217329    mov     rbp, rsi
4217332    push    rbx
4217333    mov     rbx, rdi
4217336    sub     rsp, 8
4217340    call    _invariant_0
4217345    test    eax, eax
4217347    jz      loc_405AB0
loc_405A09:
4217353    test    rbp, rbp
4217356    jz      loc_405B00
loc_405A12:
4217362    cmp     dword [rbp+8], 1
4217366    jz      loc_405A31
4217368    mov     ecx, __func___5728
4217373    mov     edx, 641h
4217378    mov     esi, aFtp_session_c
4217383    mov     edi, aCmdNum_arg1
4217388    call    _daemon_assert_fail
loc_405A31:
4217393    cmp     dword [rbx+10h], 1
4217397    jz      loc_405A60
4217399    mov     edx, aRestartNotPoss
4217404    mov     esi, 22Bh
4217409    mov     rdi, rbx
4217412    xor     eax, eax
4217414    call    _reply
loc_405A4B:
4217419    mov     rdi, rbx
4217422    call    _invariant_0
4217427    test    eax, eax
4217429    jz      loc_405A87
loc_405A57:
4217431    add     rsp, 8
4217435    pop     rbx
4217436    pop     rbp
4217437    retn    
4217438    align 20h
loc_405A60:
4217440    mov     eax, [rbx+14h]
4217443    test    eax, eax
4217445    jz      loc_405AD0
4217447    xor     eax, eax
4217449    mov     edx, aRestartOnlyPos
4217454    mov     esi, 22Bh
4217459    mov     rdi, rbx
4217462    call    _reply
4217467    mov     rdi, rbx
4217470    call    _invariant_0
4217475    test    eax, eax
4217477    jnz     loc_405A57
loc_405A87:
4217479    add     rsp, 8
4217483    mov     ecx, __func___5728
4217488    mov     edx, 64Dh
4217493    pop     rbx
4217494    pop     rbp
4217495    mov     esi, aFtp_session_c
4217500    mov     edi, aInvariantF
4217505    jmp     daemon_assert_fail
4217510    align 10h
loc_405AB0:
4217520    mov     ecx, __func___5728
4217525    mov     edx, 63Fh
4217530    mov     esi, aFtp_session_c
4217535    mov     edi, aInvariantF
4217540    call    _daemon_assert_fail
4217545    jmp     loc_405A09
4217550    align 10h
loc_405AD0:
4217552    mov     rax, [rbp+10h]
4217556    mov     edx, aRestartOkayAwa
4217561    mov     esi, 15Eh
4217566    mov     rdi, rbx
4217569    mov     [rbx+18h], rax
4217573    mov     rax, [rbx+8]
4217577    mov     [rbx+20h], rax
4217581    xor     eax, eax
4217583    call    _reply
4217588    jmp     loc_405A4B
4217593    align 20h
loc_405B00:
4217600    mov     ecx, __func___5728
4217605    mov     edx, 640h
4217610    mov     esi, aFtp_session_c
4217615    mov     edi, aCmdVoid0
4217620    call    _daemon_assert_fail
USE32

section .text

global _do_mode

_do_mode:
4217632    push    rbp
4217633    mov     rbp, rsi
4217636    push    rbx
4217637    mov     rbx, rdi
4217640    sub     rsp, 8
4217644    call    _invariant_0
4217649    test    eax, eax
4217651    jz      loc_405BB0
loc_405B35:
4217653    test    rbp, rbp
4217656    jz      loc_405BF0
loc_405B3E:
4217662    cmp     dword [rbp+8], 1
4217666    jz      loc_405B5D
4217668    mov     ecx, __func___5593
4217673    mov     edx, 3FBh
4217678    mov     esi, aFtp_session_c
4217683    mov     edi, aCmdNum_arg1
4217688    call    _daemon_assert_fail
loc_405B5D:
4217693    cmp     byte [rbp+10h], 53h
4217697    jz      loc_405BD0
4217699    mov     edx, aCommandNotImpl
4217704    mov     esi, 1F8h
4217709    mov     rdi, rbx
4217712    xor     eax, eax
4217714    call    _reply
loc_405B77:
4217719    mov     rdi, rbx
4217722    call    _invariant_0
4217727    test    eax, eax
4217729    jz      loc_405B90
4217731    add     rsp, 8
4217735    pop     rbx
4217736    pop     rbp
4217737    retn    
4217738    align 10h
loc_405B90:
4217744    add     rsp, 8
4217748    mov     ecx, __func___5593
4217753    mov     edx, 404h
4217758    pop     rbx
4217759    pop     rbp
4217760    mov     esi, aFtp_session_c
4217765    mov     edi, aInvariantF
4217770    jmp     daemon_assert_fail
4217775    align 10h
loc_405BB0:
4217776    mov     ecx, __func___5593
4217781    mov     edx, 3F9h
4217786    mov     esi, aFtp_session_c
4217791    mov     edi, aInvariantF
4217796    call    _daemon_assert_fail
4217801    jmp     loc_405B35
4217806    align 10h
loc_405BD0:
4217808    mov     edx, aCommandOkay_
4217813    mov     esi, 0C8h
4217818    mov     rdi, rbx
4217821    xor     eax, eax
4217823    call    _reply
4217828    jmp     loc_405B77
4217830    align 10h
loc_405BF0:
4217840    mov     ecx, __func___5593
4217845    mov     edx, 3FAh
4217850    mov     esi, aFtp_session_c
4217855    mov     edi, aCmdVoid0
4217860    call    _daemon_assert_fail
USE32

section .text

global _do_stru

_do_stru:
4217872    push    rbp
4217873    mov     rbp, rsi
4217876    push    rbx
4217877    mov     rbx, rdi
4217880    sub     rsp, 8
4217884    call    _invariant_0
4217889    test    eax, eax
4217891    jz      loc_405CB0
loc_405C29:
4217897    test    rbp, rbp
4217900    jz      loc_405D00
loc_405C32:
4217906    cmp     dword [rbp+8], 1
4217910    jz      loc_405C51
4217912    mov     ecx, __func___5587
4217917    mov     edx, 3E0h
4217922    mov     esi, aFtp_session_c
4217927    mov     edi, aCmdNum_arg1
4217932    call    _daemon_assert_fail
loc_405C51:
4217937    movzx   eax, byte [rbp+10h]
4217941    cmp     al, 46h
4217943    jz      loc_405CD0
4217945    cmp     al, 52h
4217947    jz      loc_405CF0
4217953    mov     edx, aCommandNotImpl
4217958    mov     esi, 1F8h
4217963    mov     rdi, rbx
4217966    xor     eax, eax
4217968    call    _reply
loc_405C75:
4217973    mov     rdi, rbx
4217976    call    _invariant_0
4217981    test    eax, eax
4217983    jz      loc_405C90
4217985    add     rsp, 8
4217989    pop     rbx
4217990    pop     rbp
4217991    retn    
4217992    align 10h
loc_405C90:
4218000    add     rsp, 8
4218004    mov     ecx, __func___5587
4218009    mov     edx, 3F2h
4218014    pop     rbx
4218015    pop     rbp
4218016    mov     esi, aFtp_session_c
4218021    mov     edi, aInvariantF
4218026    jmp     daemon_assert_fail
4218031    align 10h
loc_405CB0:
4218032    mov     ecx, __func___5587
4218037    mov     edx, 3DEh
4218042    mov     esi, aFtp_session_c
4218047    mov     edi, aInvariantF
4218052    call    _daemon_assert_fail
4218057    jmp     loc_405C29
4218062    align 10h
loc_405CD0:
4218064    mov     dword [rbx+14h], 0
loc_405CD7:
4218071    mov     edx, aCommandOkay_
4218076    mov     esi, 0C8h
4218081    mov     rdi, rbx
4218084    xor     eax, eax
4218086    call    _reply
4218091    jmp     loc_405C75
4218093    align 10h
loc_405CF0:
4218096    mov     dword [rbx+14h], 1
4218103    jmp     loc_405CD7
4218105    align 20h
loc_405D00:
4218112    mov     ecx, __func___5587
4218117    mov     edx, 3DFh
4218122    mov     esi, aFtp_session_c
4218127    mov     edi, aCmdVoid0
4218132    call    _daemon_assert_fail
USE32

section .text

global _do_type

_do_type:
4218144    push    rbp
4218145    mov     rbp, rdi
4218148    push    rbx
4218149    mov     rbx, rsi
4218152    sub     rsp, 8
4218156    call    _invariant_0
4218161    test    eax, eax
4218163    jz      loc_405E18
loc_405D39:
4218169    test    rbx, rbx
4218172    jz      loc_405EA8
loc_405D42:
4218178    mov     eax, [rbx+8]
4218181    test    eax, eax
4218183    jle     loc_405E80
loc_405D4D:
4218189    cmp     eax, 2
4218192    jg      loc_405DC0
4218194    cmp     eax, 2
4218197    movzx   edx, byte [rbx+10h]
4218201    jz      loc_405DE9
loc_405D5F:
4218207    cmp     dl, 41h
4218210    jz      loc_405E40
loc_405D68:
4218216    cmp     dl, 49h
4218219    jz      loc_405E58
loc_405D71:
4218225    mov     edx, aCommandNotImpl
4218230    mov     esi, 1F8h
4218235    mov     rdi, rbp
4218238    xor     eax, eax
4218240    call    _reply
loc_405D85:
4218245    mov     rdi, rbp
4218248    call    _invariant_0
4218253    test    eax, eax
4218255    jz      loc_405DA0
4218257    add     rsp, 8
4218261    pop     rbx
4218262    pop     rbp
4218263    retn    
4218264    align 20h
loc_405DA0:
4218272    add     rsp, 8
4218276    mov     ecx, __func___5580
4218281    mov     edx, 3D6h
4218286    pop     rbx
4218287    pop     rbp
4218288    mov     esi, aFtp_session_c
4218293    mov     edi, aInvariantF
4218298    jmp     daemon_assert_fail
4218303    align 20h
loc_405DC0:
4218304    mov     edx, 3BCh
4218309    mov     ecx, __func___5580
4218314    mov     esi, aFtp_session_c
4218319    mov     edi, aCmdNum_arg2
4218324    call    _daemon_assert_fail
4218329    mov     eax, [rbx+8]
4218332    movzx   edx, byte [rbx+10h]
4218336    cmp     eax, 2
4218339    jnz     loc_405D5F
loc_405DE9:
4218345    cmp     dl, 41h
4218348    movzx   eax, byte [rbx+1018h]
4218355    jnz     loc_405D68
4218361    cmp     al, 4Eh
4218363    jnz     loc_405D71
4218369    nop     dword [rax+00000000h]
loc_405E08:
4218376    mov     dword [rbp+10h], 0
4218383    jmp     loc_405E5F
4218385    align 8 
loc_405E18:
4218392    mov     ecx, __func___5580
4218397    mov     edx, 3B9h
4218402    mov     esi, aFtp_session_c
4218407    mov     edi, aInvariantF
4218412    call    _daemon_assert_fail
4218417    jmp     loc_405D39
4218422    align 20h
loc_405E40:
4218432    cmp     eax, 1
4218435    jnz     loc_405D71
4218441    nop     dword [rax+00000000h]
4218448    jmp     loc_405E08
4218450    align 8 
loc_405E58:
4218456    mov     dword [rbp+10h], 1
loc_405E5F:
4218463    mov     edx, aCommandOkay_
4218468    mov     esi, 0C8h
4218473    mov     rdi, rbp
4218476    xor     eax, eax
4218478    call    _reply
4218483    jmp     loc_405D85
4218488    align 20h
loc_405E80:
4218496    mov     ecx, __func___5580
4218501    mov     edx, 3BBh
4218506    mov     esi, aFtp_session_c
4218511    mov     edi, aCmdNum_arg1_0
4218516    call    _daemon_assert_fail
4218521    mov     eax, [rbx+8]
4218524    jmp     loc_405D4D
4218529    align 8 
loc_405EA8:
4218536    mov     ecx, __func___5580
4218541    mov     edx, 3BAh
4218546    mov     esi, aFtp_session_c
4218551    mov     edi, aCmdVoid0
4218556    call    _daemon_assert_fail
USE32

section .text

global _do_pass

_do_pass:
4218576    push    rbp
4218577    mov     rbp, rsi
4218580    push    rbx
4218581    mov     rbx, rdi
4218584    sub     rsp, 8
4218588    call    _invariant_0
4218593    test    eax, eax
4218595    jz      loc_405F80
loc_405EE9:
4218601    test    rbp, rbp
4218604    jz      loc_405FA0
loc_405EF2:
4218610    cmp     dword [rbp+8], 1
4218614    jz      loc_405F11
4218616    mov     ecx, __func___5428
4218621    mov     edx, 194h
4218626    mov     esi, aFtp_session_c
4218631    mov     edi, aCmdNum_arg1
4218636    call    _daemon_assert_fail
loc_405F11:
4218641    lea     rcx, [rbp+10h]
4218645    lea     rdx, [rbx+3Ch]
4218649    xor     eax, eax
4218651    mov     esi, aSReportsEMailA
4218656    mov     edi, 6
4218661    call    _syslog
4218666    xor     eax, eax
4218668    mov     edx, aUserLoggedInPr
4218673    mov     esi, 0E6h
4218678    mov     rdi, rbx
4218681    call    _reply
4218686    mov     rdi, rbx
4218689    call    _invariant_0
4218694    test    eax, eax
4218696    jz      loc_405F58
4218698    add     rsp, 8
4218702    pop     rbx
4218703    pop     rbp
4218704    retn    
4218705    align 8 
loc_405F58:
4218712    add     rsp, 8
4218716    mov     ecx, __func___5428
4218721    mov     edx, 19Bh
4218726    pop     rbx
4218727    pop     rbp
4218728    mov     esi, aFtp_session_c
4218733    mov     edi, aInvariantF
4218738    jmp     daemon_assert_fail
4218743    align 20h
loc_405F80:
4218752    mov     ecx, __func___5428
4218757    mov     edx, 192h
4218762    mov     esi, aFtp_session_c
4218767    mov     edi, aInvariantF
4218772    call    _daemon_assert_fail
4218777    jmp     loc_405EE9
4218782    align 20h
loc_405FA0:
4218784    mov     ecx, __func___5428
4218789    mov     edx, 193h
4218794    mov     esi, aFtp_session_c
4218799    mov     edi, aCmdVoid0
4218804    call    _daemon_assert_fail
USE32

section .text

global _set_port

_set_port:
4218816    push    rbp
4218817    mov     rbp, rsi
4218820    push    rbx
4218821    mov     rbx, rdi
4218824    sub     rsp, 8
4218828    call    _invariant_0
4218833    test    eax, eax
4218835    jz      loc_4060A8
loc_405FD9:
4218841    test    rbp, rbp
4218844    jz      loc_406110
loc_405FE2:
4218850    mov     eax, [rbx+28h]
4218853    test    eax, eax
4218855    jz      loc_406010
4218857    mov     edx, aAfterEpsvAllOn
4218862    mov     esi, 1F4h
4218867    mov     rdi, rbx
4218870    xor     eax, eax
4218872    call    _reply
loc_405FFD:
4218877    mov     rdi, rbx
4218880    call    _invariant_0
4218885    test    eax, eax
4218887    jz      loc_406083
loc_406009:
4218889    add     rsp, 8
4218893    pop     rbx
4218894    pop     rbp
4218895    retn    
loc_406010:
4218896    lea     rdi, [rbx+2Ch]
4218900    mov     rsi, rbp
4218903    call    _ip_equal
4218908    test    eax, eax
4218910    jz      loc_4060D0
4218916    movzx   eax, word [rbp+2]
4218920    ror     ax, 8
4218924    cmp     ax, 3FFh
4218928    jbe     loc_4060F0
4218934    cmp     dword [rbx+10A4h], 1
4218941    jz      loc_406130
loc_406043:
4218947    mov     dword [rbx+10A4h], 0
4218957    mov     rax, [rbp+0]
4218961    mov     esi, 0C8h
4218966    mov     rdx, [rbp+8]
4218970    mov     rdi, rbx
4218973    mov     [rbx+10A8h], rax
4218980    xor     eax, eax
4218982    mov     [rbx+10B0h], rdx
4218989    mov     edx, aCommandOkay_
4218994    call    _reply
4218999    mov     rdi, rbx
4219002    call    _invariant_0
4219007    test    eax, eax
4219009    jnz     loc_406009
loc_406083:
4219011    add     rsp, 8
4219015    mov     ecx, __func___5493
4219020    mov     edx, 28Ch
4219025    pop     rbx
4219026    pop     rbp
4219027    mov     esi, aFtp_session_c
4219032    mov     edi, aInvariantF
4219037    jmp     daemon_assert_fail
4219042    align 8 
loc_4060A8:
4219048    mov     ecx, __func___5493
4219053    mov     edx, 277h
4219058    mov     esi, aFtp_session_c
4219063    mov     edi, aInvariantF
4219068    call    _daemon_assert_fail
4219073    jmp     loc_405FD9
4219078    align 10h
loc_4060D0:
4219088    mov     edx, aPortMustBeOnCo
4219093    mov     esi, 1F4h
4219098    mov     rdi, rbx
4219101    call    _reply
4219106    jmp     loc_405FFD
4219111    align 10h
loc_4060F0:
4219120    mov     edx, aPortMayNotBeLe
4219125    mov     esi, 1F4h
4219130    mov     rdi, rbx
4219133    xor     eax, eax
4219135    call    _reply
4219140    jmp     loc_405FFD
4219145    align 10h
loc_406110:
4219152    mov     ecx, __func___5493
4219157    mov     edx, 278h
4219162    mov     esi, aFtp_session_c
4219167    mov     edi, aHost_portVoid0
4219172    call    _daemon_assert_fail
4219177    jmp     loc_405FE2
4219182    align 10h
loc_406130:
4219184    mov     edi, [rbx+10B8h]
4219190    call    _close
4219195    mov     dword [rbx+10B8h], 0FFFFFFFFh
4219205    jmp     loc_406043
USE32

section .text

global _do_lprt

_do_lprt:
4219216    push    r12
4219218    push    rbp
4219219    mov     rbp, rdi
4219222    push    rbx
4219223    mov     rbx, rsi
4219226    call    _invariant_0
4219231    test    eax, eax
4219233    jz      loc_4061F0
loc_406167:
4219239    test    rbx, rbx
4219242    jz      loc_406210
loc_406170:
4219248    cmp     dword [rbx+8], 1
4219252    jz      loc_40618F
4219254    mov     ecx, __func___5508
4219259    mov     edx, 2A7h
4219264    mov     esi, aFtp_session_c
4219269    mov     edi, aCmdNum_arg1
4219274    call    _daemon_assert_fail
loc_40618F:
4219279    cmp     word [rbx+10h], 2
4219284    lea     r12, [rbx+10h]
4219288    jz      loc_4061AE
4219290    mov     edx, aOnlyIpv4Suppor
4219295    mov     esi, 209h
4219300    mov     rdi, rbp
4219303    xor     eax, eax
4219305    call    _reply
loc_4061AE:
4219310    mov     rsi, r12
4219313    mov     rdi, rbp
4219316    call    _set_port
4219321    mov     rdi, rbp
4219324    call    _invariant_0
4219329    test    eax, eax
4219331    jz      loc_4061D0
4219333    pop     rbx
4219334    pop     rbp
4219335    pop     r12
4219337    retn    
4219338    align 10h
loc_4061D0:
4219344    pop     rbx
4219345    pop     rbp
4219346    pop     r12
4219348    mov     ecx, __func___5508
4219353    mov     edx, 2B7h
4219358    mov     esi, aFtp_session_c
4219363    mov     edi, aInvariantF
4219368    jmp     daemon_assert_fail
4219373    align 10h
loc_4061F0:
4219376    mov     ecx, __func___5508
4219381    mov     edx, 2A5h
4219386    mov     esi, aFtp_session_c
4219391    mov     edi, aInvariantF
4219396    call    _daemon_assert_fail
4219401    jmp     loc_406167
4219406    align 10h
loc_406210:
4219408    mov     ecx, __func___5508
4219413    mov     edx, 2A6h
4219418    mov     esi, aFtp_session_c
4219423    mov     edi, aCmdVoid0
4219428    call    _daemon_assert_fail
USE32

section .text

global _do_port

_do_port:
4219440    push    r12
4219442    push    rbp
4219443    mov     rbp, rdi
4219446    push    rbx
4219447    mov     rbx, rsi
4219450    call    _invariant_0
4219455    test    eax, eax
4219457    jz      loc_4062D0
loc_406247:
4219463    test    rbx, rbx
4219466    jz      loc_4062F0
loc_406250:
4219472    cmp     dword [rbx+8], 1
4219476    jz      loc_40626F
4219478    mov     ecx, __func___5502
4219483    mov     edx, 296h
4219488    mov     esi, aFtp_session_c
4219493    mov     edi, aCmdNum_arg1
4219498    call    _daemon_assert_fail
loc_40626F:
4219503    cmp     word [rbx+10h], 2
4219508    lea     r12, [rbx+10h]
4219512    jz      loc_406293
4219514    mov     ecx, __func___5502
4219519    mov     edx, 299h
4219524    mov     esi, aFtp_session_c
4219529    mov     edi, aStructSockad_1
4219534    call    _daemon_assert_fail
loc_406293:
4219539    mov     rsi, r12
4219542    mov     rdi, rbp
4219545    call    _set_port
4219550    mov     rdi, rbp
4219553    call    _invariant_0
4219558    test    eax, eax
4219560    jz      loc_4062B0
4219562    pop     rbx
4219563    pop     rbp
4219564    pop     r12
4219566    retn    
4219567    align 10h
loc_4062B0:
4219568    pop     rbx
4219569    pop     rbp
4219570    pop     r12
4219572    mov     ecx, __func___5502
4219577    mov     edx, 29Dh
4219582    mov     esi, aFtp_session_c
4219587    mov     edi, aInvariantF
4219592    jmp     daemon_assert_fail
4219597    align 10h
loc_4062D0:
4219600    mov     ecx, __func___5502
4219605    mov     edx, 294h
4219610    mov     esi, aFtp_session_c
4219615    mov     edi, aInvariantF
4219620    call    _daemon_assert_fail
4219625    jmp     loc_406247
4219630    align 10h
loc_4062F0:
4219632    mov     ecx, __func___5502
4219637    mov     edx, 295h
4219642    mov     esi, aFtp_session_c
4219647    mov     edi, aCmdVoid0
4219652    call    _daemon_assert_fail
USE32

section .text

global _set_pasv

_set_pasv:
4219664    push    r14
4219666    mov     r14, rdi
4219669    push    r13
4219671    push    r12
4219673    push    rbp
4219674    mov     rbp, rsi
4219677    push    rbx
4219678    call    _invariant_0
4219683    test    eax, eax
4219685    jz      loc_406448
loc_40632B:
4219691    test    rbp, rbp
4219694    jz      loc_406466
loc_406334:
4219700    movzx   edi, word [rbp+0]
4219704    xor     edx, edx
4219706    mov     esi, 1
4219711    call    _socket
4219716    cmp     eax, 0FFFFFFFFh
4219719    mov     r12d, eax
4219722    jz      loc_4064A2
4219728    mov     r13, 8208208208208209h
4219738    jmp     loc_406370
4219740    align 20h
loc_406360:
4219744    call    ___errno_location
4219749    mov     edi, [rax]
4219751    cmp     edi, 62h
4219754    jnz     loc_406410
loc_406370:
4219760    mov     esi, init_passive_port
4219765    mov     edi, once_control_5570
4219770    call    _pthread_once
4219775    mov     edi, mutex_5571
4219780    call    _pthread_mutex_lock
4219785    call    _lrand48
4219790    mov     edi, mutex_5571
4219795    mov     rbx, rax
4219798    call    _pthread_mutex_unlock
4219803    mov     rax, rbx
4219806    mov     rsi, rbp
4219809    mov     edi, r12d
4219812    imul    r13
4219815    mov     rax, rbx
4219818    sar     rax, 3Fh
4219822    add     rdx, rbx
4219825    sar     rdx, 0Fh
4219829    sub     rdx, rax
4219832    mov     rax, rdx
4219835    shl     rdx, 10h
4219839    sub     ebx, edx
4219841    shl     rax, 0Ah
4219845    mov     edx, 10h
4219850    lea     eax, [rbx+rax+400h]
4219857    ror     ax, 8
4219861    mov     [rbp+2], ax
4219865    call    _bind
4219870    test    eax, eax
4219872    jnz     loc_406360
4219878    mov     esi, 1
4219883    mov     edi, r12d
4219886    call    _listen
4219891    test    eax, eax
4219893    jnz     loc_406484
4219899    mov     eax, r12d
loc_4063FE:
4219902    pop     rbx
4219903    pop     rbp
4219904    pop     r12
4219906    pop     r13
4219908    pop     r14
4219910    retn    
4219911    align 10h
loc_406410:
4219920    call    _strerror
4219925    mov     edx, aErrorBindingSe
4219930    mov     rcx, rax
loc_40641D:
4219933    mov     rdi, r14
4219936    mov     esi, 1F4h
4219941    xor     eax, eax
4219943    call    _reply
4219948    mov     edi, r12d
4219951    call    _close
4219956    pop     rbx
4219957    pop     rbp
4219958    pop     r12
4219960    pop     r13
4219962    mov     eax, 0FFFFFFFFh
4219967    pop     r14
4219969    retn    
4219970    align 8 
loc_406448:
4219976    mov     ecx, __func___5521
4219981    mov     edx, 2D5h
4219986    mov     esi, aFtp_session_c
4219991    mov     edi, aInvariantF
4219996    call    _daemon_assert_fail
4220001    jmp     loc_40632B
loc_406466:
4220006    mov     ecx, __func___5521
4220011    mov     edx, 2D6h
4220016    mov     esi, aFtp_session_c
4220021    mov     edi, aBind_addrVoid0
4220026    call    _daemon_assert_fail
4220031    jmp     loc_406334
loc_406484:
4220036    call    ___errno_location
4220041    mov     edi, [rax]
4220043    nop     dword [rax+rax+00h]
4220048    call    _strerror
4220053    mov     edx, aErrorListening
4220058    mov     rcx, rax
4220061    jmp     loc_40641D
loc_4064A2:
4220066    call    ___errno_location
4220071    mov     edi, [rax]
4220073    call    _strerror
4220078    mov     edx, aErrorCreatin_1
4220083    mov     rcx, rax
4220086    mov     esi, 1F4h
4220091    xor     eax, eax
4220093    mov     rdi, r14
4220096    call    _reply
4220101    mov     eax, r12d
4220104    jmp     loc_4063FE
USE32

section .text

global _do_epsv

_do_epsv:
4220112    push    rbp
4220113    mov     rbp, rsi
4220116    push    rbx
4220117    mov     rbx, rdi
4220120    sub     rsp, 8
4220124    call    _invariant_0
4220129    test    eax, eax
4220131    jz      loc_4065C0
loc_4064E9:
4220137    test    rbp, rbp
4220140    jz      loc_406620
loc_4064F2:
4220146    mov     eax, [rbp+8]
4220149    cmp     eax, 1
4220152    jbe     loc_406516
4220154    mov     ecx, __func___5555
4220159    mov     edx, 35Eh
4220164    mov     esi, aFtp_session_c
4220169    mov     edi, aCmdNum_arg0Cmd
4220174    call    _daemon_assert_fail
4220179    mov     eax, [rbp+8]
loc_406516:
4220182    test    eax, eax
4220184    lea     rsi, [rbx+78h]
4220188    jz      loc_40653A
4220190    mov     eax, [rbp+10h]
4220193    cmp     eax, 0FFFFFFFFh
4220196    jz      loc_406600
4220202    cmp     eax, 1
4220205    jnz     loc_4065E0
4220211    lea     rsi, [rbx+88h]
loc_40653A:
4220218    mov     rdi, rbx
4220221    call    _set_pasv
4220226    cmp     eax, 0FFFFFFFFh
4220229    mov     ebp, eax
4220231    jz      loc_406585
4220233    movzx   ecx, word [rbx+7Ah]
4220237    xor     eax, eax
4220239    mov     edx, aEnteringExtend
4220244    ror     cx, 8
4220248    mov     esi, 0E5h
4220253    movzx   ecx, cx
4220256    mov     rdi, rbx
4220259    call    _reply
4220264    cmp     dword [rbx+10A4h], 1
4220271    jz      loc_406640
loc_406575:
4220277    mov     dword [rbx+10A4h], 1
4220287    mov     [rbx+10B8h], ebp
loc_406585:
4220293    mov     rdi, rbx
4220296    call    _invariant_0
4220301    test    eax, eax
4220303    jz      loc_4065A0
4220305    add     rsp, 8
4220309    pop     rbx
4220310    pop     rbp
4220311    retn    
4220312    align 20h
loc_4065A0:
4220320    add     rsp, 8
4220324    mov     ecx, __func___5555
4220329    mov     edx, 391h
4220334    pop     rbx
4220335    pop     rbp
4220336    mov     esi, aFtp_session_c
4220341    mov     edi, aInvariantF
4220346    jmp     daemon_assert_fail
4220351    align 20h
loc_4065C0:
4220352    mov     ecx, __func___5555
4220357    mov     edx, 35Ch
4220362    mov     esi, aFtp_session_c
4220367    mov     edi, aInvariantF
4220372    call    _daemon_assert_fail
4220377    jmp     loc_4064E9
4220382    align 20h
loc_4065E0:
4220384    mov     edx, aOnlyIpv4Supp_0
4220389    mov     esi, 20Ah
4220394    mov     rdi, rbx
4220397    xor     eax, eax
4220399    call    _reply
4220404    jmp     loc_406585
4220406    align 20h
loc_406600:
4220416    mov     dword [rbx+28h], 1
4220423    mov     edx, aEpsvAllCommand
4220428    mov     esi, 0C8h
4220433    mov     rdi, rbx
4220436    xor     eax, eax
4220438    call    _reply
4220443    jmp     loc_406585
loc_406620:
4220448    mov     ecx, __func___5555
4220453    mov     edx, 35Dh
4220458    mov     esi, aFtp_session_c
4220463    mov     edi, aCmdVoid0
4220468    call    _daemon_assert_fail
4220473    jmp     loc_4064F2
4220478    align 20h
loc_406640:
4220480    mov     edi, [rbx+10B8h]
4220486    call    _close
4220491    jmp     loc_406575
USE32

section .text

global _do_lpsv

_do_lpsv:
4220496    push    rbp
4220497    mov     rbp, rsi
4220500    push    rbx
4220501    mov     rbx, rdi
4220504    sub     rsp, 88h
4220511    mov     rax, [fs:28h]
4220520    mov     [rsp+78h], rax
4220525    xor     eax, eax
4220527    call    _invariant_0
4220532    test    eax, eax
4220534    jz      loc_4067A0
loc_40667C:
4220540    test    rbp, rbp
4220543    jz      loc_4067C0
loc_406685:
4220549    mov     edx, [rbp+8]
4220552    test    edx, edx
4220554    jnz     loc_406780
loc_406690:
4220560    mov     eax, [rbx+28h]
4220563    test    eax, eax
4220565    jz      loc_4066F0
4220567    mov     edx, aAfterEpsvAllOn
4220572    mov     esi, 1F4h
4220577    mov     rdi, rbx
4220580    xor     eax, eax
4220582    call    _reply
loc_4066AB:
4220587    mov     rdi, rbx
4220590    call    _invariant_0
4220595    test    eax, eax
4220597    jnz     loc_4066D0
4220599    mov     ecx, __func___5547
4220604    mov     edx, 353h
4220609    mov     esi, aFtp_session_c
4220614    mov     edi, aInvariantF
4220619    call    _daemon_assert_fail
loc_4066D0:
4220624    mov     rax, [rsp+78h]
4220629    xor     rax, [fs:28h]
4220638    jnz     loc_4067F0
4220644    add     rsp, 88h
4220651    pop     rbx
4220652    pop     rbp
4220653    retn    
4220654    align 10h
loc_4066F0:
4220656    lea     rsi, [rbx+78h]
4220660    mov     rdi, rbx
4220663    call    _set_pasv
4220668    cmp     eax, 0FFFFFFFFh
4220671    mov     ebp, eax
4220673    jz      loc_4066AB
4220675    movzx   eax, byte [rbx+7Bh]
4220679    movzx   r9d, byte [rbx+7Eh]
4220684    lea     rdi, [rsp+20h]
4220689    movzx   r8d, byte [rbx+7Dh]
4220694    movzx   ecx, byte [rbx+7Ch]
4220698    mov     edx, a44DDDD2DD
4220703    mov     esi, 50h
4220708    mov     [rsp+10h], eax
4220712    movzx   eax, byte [rbx+7Ah]
4220716    mov     [rsp+8], eax
4220720    movzx   eax, byte [rbx+7Fh]
4220724    mov     [rsp], eax
4220727    xor     eax, eax
4220729    call    _snprintf
4220734    lea     rcx, [rsp+20h]
4220739    xor     eax, eax
4220741    mov     edx, aEnteringLongPa
4220746    mov     esi, 0E4h
4220751    mov     rdi, rbx
4220754    call    _reply
4220759    cmp     dword [rbx+10A4h], 1
4220766    jz      loc_4067E0
loc_406764:
4220772    mov     dword [rbx+10A4h], 1
4220782    mov     [rbx+10B8h], ebp
4220788    jmp     loc_4066AB
4220793    align 20h
loc_406780:
4220800    mov     ecx, __func___5547
4220805    mov     edx, 32Bh
4220810    mov     esi, aFtp_session_c
4220815    mov     edi, aCmdNum_arg0
4220820    call    _daemon_assert_fail
4220825    jmp     loc_406690
4220830    align 20h
loc_4067A0:
4220832    mov     ecx, __func___5547
4220837    mov     edx, 329h
4220842    mov     esi, aFtp_session_c
4220847    mov     edi, aInvariantF
4220852    call    _daemon_assert_fail
4220857    jmp     loc_40667C
4220862    align 20h
loc_4067C0:
4220864    mov     ecx, __func___5547
4220869    mov     edx, 32Ah
4220874    mov     esi, aFtp_session_c
4220879    mov     edi, aCmdVoid0
4220884    call    _daemon_assert_fail
4220889    jmp     loc_406685
4220894    align 20h
loc_4067E0:
4220896    mov     edi, [rbx+10B8h]
4220902    call    _close
4220907    jmp     loc_406764
loc_4067F0:
4220912    call    ___stack_chk_fail
USE32

section .text

global _do_pasv

_do_pasv:
4220928    push    rbp
4220929    mov     rbp, rsi
4220932    push    rbx
4220933    mov     rbx, rdi
4220936    sub     rsp, 28h
4220940    call    _invariant_0
4220945    test    eax, eax
4220947    jz      loc_406940
loc_406819:
4220953    test    rbp, rbp
4220956    jz      loc_406960
loc_406822:
4220962    mov     edx, [rbp+8]
4220965    test    edx, edx
4220967    jnz     loc_406920
loc_40682D:
4220973    mov     eax, [rbx+28h]
4220976    test    eax, eax
4220978    jz      loc_406860
4220980    mov     edx, aAfterEpsvAllOn
4220985    mov     esi, 1F4h
4220990    mov     rdi, rbx
4220993    xor     eax, eax
4220995    call    _reply
loc_406848:
4221000    mov     rdi, rbx
4221003    call    _invariant_0
4221008    test    eax, eax
4221010    jz      loc_4068F8
loc_406858:
4221016    add     rsp, 28h
4221020    pop     rbx
4221021    pop     rbp
4221022    retn    
4221023    align 20h
loc_406860:
4221024    lea     rsi, [rbx+88h]
4221031    mov     rdi, rbx
4221034    call    _set_pasv
4221039    cmp     eax, 0FFFFFFFFh
4221042    mov     ebp, eax
4221044    jz      loc_406848
4221046    mov     edx, [rbx+8Ch]
4221052    movzx   esi, word [rbx+8Ah]
4221059    mov     rdi, rbx
4221062    ror     si, 8
4221066    bswap   edx
4221068    movzx   eax, dh
4221071    mov     r8d, edx
4221074    mov     ecx, edx
4221076    mov     r9d, eax
4221079    movzx   eax, sil
4221083    shr     r8d, 10h
4221087    mov     [rsp+10h], eax
4221091    mov     rax, rsi
4221094    movzx   edx, dl
4221097    movzx   esi, ah
4221100    shr     ecx, 18h
4221103    mov     [rsp], edx
4221106    mov     [rsp+8], esi
4221110    xor     eax, eax
4221112    movzx   r8d, r8b
4221116    mov     edx, aEnteringPassiv
4221121    mov     esi, 0E3h
4221126    call    _reply
4221131    cmp     dword [rbx+10A4h], 1
4221138    jz      loc_406980
loc_4068D8:
4221144    mov     dword [rbx+10A4h], 1
4221154    mov     [rbx+10B8h], ebp
4221160    mov     rdi, rbx
4221163    call    _invariant_0
4221168    test    eax, eax
4221170    jnz     loc_406858
loc_4068F8:
4221176    add     rsp, 28h
4221180    mov     ecx, __func___5534
4221185    mov     edx, 31Eh
4221190    pop     rbx
4221191    pop     rbp
4221192    mov     esi, aFtp_session_c
4221197    mov     edi, aInvariantF
4221202    jmp     daemon_assert_fail
4221207    align 20h
loc_406920:
4221216    mov     ecx, __func___5534
4221221    mov     edx, 2FFh
4221226    mov     esi, aFtp_session_c
4221231    mov     edi, aCmdNum_arg0
4221236    call    _daemon_assert_fail
4221241    jmp     loc_40682D
4221246    align 20h
loc_406940:
4221248    mov     ecx, __func___5534
4221253    mov     edx, 2FDh
4221258    mov     esi, aFtp_session_c
4221263    mov     edi, aInvariantF
4221268    call    _daemon_assert_fail
4221273    jmp     loc_406819
4221278    align 20h
loc_406960:
4221280    mov     ecx, __func___5534
4221285    mov     edx, 2FEh
4221290    mov     esi, aFtp_session_c
4221295    mov     edi, aCmdVoid0
4221300    call    _daemon_assert_fail
4221305    jmp     loc_406822
4221310    align 20h
loc_406980:
4221312    mov     edi, [rbx+10B8h]
4221318    call    _close
4221323    jmp     loc_4068D8
USE32

section .text

global _do_user

_do_user:
4221328    push    rbp
4221329    mov     rbp, rsi
4221332    push    rbx
4221333    mov     rbx, rdi
4221336    sub     rsp, 8
4221340    call    _invariant_0
4221345    test    eax, eax
4221347    jz      loc_406A40
loc_4069A9:
4221353    test    rbp, rbp
4221356    jz      loc_406A98
loc_4069B2:
4221362    cmp     dword [rbp+8], 1
4221366    jz      loc_4069D1
4221368    mov     ecx, __func___5421
4221373    mov     edx, 17Fh
4221378    mov     esi, aFtp_session_c
4221383    mov     edi, aCmdNum_arg1
4221388    call    _daemon_assert_fail
loc_4069D1:
4221393    add     rbp, 10h
4221397    mov     esi, aFtp
4221402    mov     rdi, rbp
4221405    call    _strcasecmp
4221410    test    eax, eax
4221412    jz      loc_4069F7
4221414    mov     esi, aAnonymous
4221419    mov     rdi, rbp
4221422    call    _strcasecmp
4221427    test    eax, eax
4221429    jnz     loc_406A60
loc_4069F7:
4221431    mov     edx, aSendEMailAddre
4221436    mov     esi, 14Bh
4221441    mov     rdi, rbx
4221444    xor     eax, eax
4221446    call    _reply
loc_406A0B:
4221451    mov     rdi, rbx
4221454    call    _invariant_0
4221459    test    eax, eax
4221461    jz      loc_406A20
4221463    add     rsp, 8
4221467    pop     rbx
4221468    pop     rbp
4221469    retn    
4221470    align 20h
loc_406A20:
4221472    add     rsp, 8
4221476    mov     ecx, __func___5421
4221481    mov     edx, 189h
4221486    pop     rbx
4221487    pop     rbp
4221488    mov     esi, aFtp_session_c
4221493    mov     edi, aInvariantF
4221498    jmp     daemon_assert_fail
4221503    align 20h
loc_406A40:
4221504    mov     ecx, __func___5421
4221509    mov     edx, 17Dh
4221514    mov     esi, aFtp_session_c
4221519    mov     edi, aInvariantF
4221524    call    _daemon_assert_fail
4221529    jmp     loc_4069A9
4221534    align 20h
loc_406A60:
4221536    lea     rdx, [rbx+3Ch]
4221540    xor     eax, eax
4221542    mov     rcx, rbp
4221545    mov     esi, aSAttemptedToLo
4221550    mov     edi, 4
4221555    call    _syslog
4221560    mov     edx, aOnlyAnonymousF
4221565    mov     esi, 212h
4221570    mov     rdi, rbx
4221573    xor     eax, eax
4221575    call    _reply
4221580    jmp     loc_406A0B
4221585    align 8 
loc_406A98:
4221592    mov     ecx, __func___5421
4221597    mov     edx, 17Eh
4221602    mov     esi, aFtp_session_c
4221607    mov     edi, aCmdVoid0
4221612    call    _daemon_assert_fail
USE32

section .text

global _send_readme

_send_readme:
4221632    push    r14
4221634    push    r13
4221636    mov     r13, rdi
4221639    push    r12
4221641    push    rbp
4221642    mov     ebp, esi
4221644    push    rbx
4221645    sub     rsp, 20B0h
4221652    mov     rax, [fs:28h]
4221661    mov     [rsp+20A8h], rax
4221669    xor     eax, eax
4221671    call    _invariant_0
4221676    test    eax, eax
4221678    jz      loc_406BC0
loc_406AF4:
4221684    cmp     ebp, 63h
4221687    jle     loc_406BA0
4221693    cmp     ebp, 22Fh
4221699    jg      loc_406B80
loc_406B05:
4221701    lea     r12, [r13+0A0h]
4221708    mov     rdi, r12
4221711    call    _strlen
4221716    mov     rbx, rax
4221719    lea     eax, [rax+1]
4221722    cdqe    
4221724    add     rax, 7
4221728    cmp     rax, 1001h
4221734    jbe     loc_406BE0
loc_406B2C:
4221740    mov     rdi, r13
4221743    call    _invariant_0
4221748    test    eax, eax
4221750    jnz     loc_406B51
4221752    mov     ecx, __func___5762
4221757    mov     edx, 6FEh
4221762    mov     esi, aFtp_session_c
4221767    mov     edi, aInvariantF
4221772    call    _daemon_assert_fail
loc_406B51:
4221777    mov     rax, [rsp+20A8h]
4221785    xor     rax, [fs:28h]
4221794    jnz     loc_406DB3
4221800    add     rsp, 20B0h
4221807    pop     rbx
4221808    pop     rbp
4221809    pop     r12
4221811    pop     r13
4221813    pop     r14
4221815    retn    
4221816    align 20h
loc_406B80:
4221824    mov     ecx, __func___5762
4221829    mov     edx, 6B7h
4221834    mov     esi, aFtp_session_c
4221839    mov     edi, aCode559
4221844    call    _daemon_assert_fail
4221849    jmp     loc_406B05
4221854    align 20h
loc_406BA0:
4221856    mov     ecx, __func___5762
4221861    mov     edx, 6B6h
4221866    mov     esi, aFtp_session_c
4221871    mov     edi, aCode100
4221876    call    _daemon_assert_fail
4221881    jmp     loc_406B05
4221886    align 20h
loc_406BC0:
4221888    mov     ecx, __func___5762
4221893    mov     edx, 6B5h
4221898    mov     esi, aFtp_session_c
4221903    mov     edi, aInvariantF
4221908    call    _daemon_assert_fail
4221913    jmp     loc_406AF4
4221918    align 20h
loc_406BE0:
4221920    lea     rdi, [rsp+10A0h]
4221928    mov     rdx, rbx
4221931    mov     rsi, r12
4221934    call    _memcpy
4221939    lea     rax, [rsp+rbx+10A1h]
4221947    mov     edx, 454Dh
4221952    lea     rdi, [rsp+10A0h]
4221960    mov     byte [rsp+rbx+10A0h], 2Fh
4221968    xor     esi, esi
4221970    mov     dword [rax], 44414552h
4221976    mov     [rax+4], dx
4221980    mov     byte [rax+6], 0
4221984    xor     eax, eax
4221986    call    _open
4221991    cmp     eax, 0FFFFFFFFh
4221994    mov     r14d, eax
4221997    jz      loc_406B2C
4222003    mov     rdx, rsp
4222006    mov     esi, eax
4222008    mov     edi, 1
4222013    call    ___fxstat
4222018    test    eax, eax
4222020    jnz     loc_406D88
4222026    mov     eax, [rsp+18h]
4222030    and     eax, 0F000h
4222035    cmp     eax, 4000h
4222040    jz      loc_406D88
4222046    cmp     ebp, 63h
4222049    jle     loc_406D95
4222055    cmp     ebp, 3E7h
4222061    jle     loc_406C88
4222063    mov     ecx, __func___5762
4222068    mov     edx, 6DBh
4222073    mov     esi, aFtp_session_c
4222078    mov     edi, aCode999
4222083    call    _daemon_assert_fail
loc_406C88:
4222088    lea     rdi, [rsp+90h]
4222096    mov     edx, ebp
4222098    mov     esi, a03d
4222103    xor     eax, eax
4222105    call    _sprintf
4222110    lea     rsi, [rsp+0A0h]
4222118    mov     edx, 1000h
4222123    mov     edi, r14d
4222126    call    _read
4222131    test    eax, eax
4222133    mov     ebx, eax
4222135    jle     loc_406D88
4222141    mov     rdi, [r13+98h]
4222148    lea     rsi, [rsp+90h]
4222156    call    _telnet_session_print
4222161    jmp     loc_406CF7
4222163    align 8 
loc_406CD8:
4222168    lea     rsi, [rsp+0A0h]
4222176    mov     edx, 1000h
4222181    mov     edi, r14d
4222184    call    _read
4222189    test    eax, eax
4222191    mov     ebx, eax
4222193    jle     loc_406D88
loc_406CF7:
4222199    lea     rdi, [rsp+0A0h]
4222207    movsxd  rdx, ebx
4222210    mov     esi, 0Ah
4222215    call    _memchr
4222220    test    ebx, ebx
4222222    mov     rbp, rax
4222225    jle     loc_406CD8
4222227    test    rax, rax
4222230    lea     r12, [rsp+0A0h]
4222238    jz      loc_406D71
loc_406D20:
4222240    mov     byte [rbp+0], 0
4222244    mov     rdi, [r13+98h]
4222251    mov     rsi, r12
4222254    call    _telnet_session_println
4222259    mov     rdx, rbp
4222262    sub     rdx, r12
4222265    not     edx
4222267    add     ebx, edx
4222269    test    ebx, ebx
4222271    jle     loc_406CD8
4222273    mov     rdi, [r13+98h]
4222280    lea     rsi, [rsp+90h]
4222288    lea     r12, [rbp+1]
4222292    call    _telnet_session_print
4222297    movsxd  rdx, ebx
4222300    mov     esi, 0Ah
4222305    mov     rdi, r12
4222308    call    _memchr
4222313    test    rax, rax
4222316    mov     rbp, rax
4222319    jnz     loc_406D20
loc_406D71:
4222321    mov     rdi, [r13+98h]
4222328    mov     rsi, r12
4222331    call    _telnet_session_print
4222336    jmp     loc_406CD8
4222341    align 8 
loc_406D88:
4222344    mov     edi, r14d
4222347    call    _close
4222352    jmp     loc_406B2C
loc_406D95:
4222357    mov     ecx, __func___5762
4222362    mov     edx, 6DAh
4222367    mov     esi, aFtp_session_c
4222372    mov     edi, aCode100
4222377    call    _daemon_assert_fail
4222382    jmp     loc_406C88
loc_406DB3:
4222387    call    ___stack_chk_fail
USE32

section .text

global _change_dir

_change_dir:
4222400    push    r15
4222402    push    r14
4222404    push    r13
4222406    mov     r13, rdi
4222409    push    r12
4222411    push    rbp
4222412    push    rbx
4222413    mov     rbx, rsi
4222416    sub     rsp, 10A8h
4222423    mov     rax, [fs:28h]
4222432    mov     [rsp+1098h], rax
4222440    xor     eax, eax
4222442    call    _invariant_0
4222447    test    eax, eax
4222449    jz      loc_40706B
loc_406DF7:
4222455    test    rbx, rbx
4222458    jz      loc_4071F2
loc_406E00:
4222464    mov     rdi, rbx
4222467    call    _strlen
4222472    cmp     rax, 1000h
4222478    ja      loc_407089
4222484    movzx   r15d, byte [rbx]
4222488    cmp     r15b, 2Fh
4222492    jz      loc_4070B0
loc_406E22:
4222498    lea     r12, [r13+0A0h]
4222505    mov     rdi, r12
4222508    call    _strlen
4222513    cmp     rax, 1000h
4222519    ja      loc_4070DB
loc_406E3D:
4222525    lea     rbp, [rsp+90h]
4222533    mov     rsi, r12
4222536    mov     rdi, rbp
4222539    call    _strcpy
loc_406E50:
4222544    lea     r12, [rbp+1]
loc_406E54:
4222548    test    r15b, r15b
4222551    jz      loc_406F57
4222557    nop     dword [rax]
loc_406E60:
4222560    mov     esi, 2Fh
4222565    mov     rdi, rbx
4222568    call    _strchr
4222573    test    rax, rax
4222576    mov     r14, rax
4222579    jz      loc_407040
loc_406E79:
4222585    mov     rsi, r14
4222588    sub     rsi, rbx
4222591    cmp     esi, 1
4222594    jz      loc_406FD8
4222600    cmp     esi, 2
4222603    jz      loc_406FF0
loc_406E91:
4222609    mov     rdx, rbp
loc_406E94:
4222612    mov     ecx, [rdx]
4222614    add     rdx, 4
4222618    lea     eax, [rcx-1010101h]
4222624    not     ecx
4222626    and     eax, ecx
4222628    and     eax, 80808080h
4222633    jz      loc_406E94
4222635    mov     ecx, eax
4222637    movsxd  rsi, esi
4222640    shr     ecx, 10h
4222643    test    eax, 8080h
4222648    cmovz   eax, ecx
4222651    lea     rcx, [rdx+2]
4222655    cmovz   rdx, rcx
4222659    add     al, al
4222661    sbb     rdx, 3
4222665    sub     rdx, rbp
4222668    lea     rax, [rdx+rsi+1]
4222673    cmp     rax, 1000h
4222679    ja      loc_407052
4222685    xor     esi, esi
4222687    mov     rdi, rbp
4222690    call    ___rawmemchr
4222695    cmp     rax, r12
4222698    jz      loc_407038
4222704    lea     rdi, [rax+1]
4222708    mov     byte [rax], 2Fh
loc_406EF7:
4222711    cmp     rbx, r14
4222714    jz      loc_406F26
4222716    mov     rcx, rdi
4222719    mov     rdx, rbx
4222722    nop     word [rax+rax+00h]
loc_406F08:
4222728    add     rdx, 1
4222732    movzx   esi, byte [rdx-1]
4222736    add     rcx, 1
4222740    cmp     rdx, r14
4222743    mov     [rcx-1], sil
4222747    jnz     loc_406F08
4222749    mov     rax, r14
4222752    sub     rax, rbx
4222755    add     rdi, rax
loc_406F26:
4222758    mov     byte [rdi], 0
loc_406F29:
4222761    movzx   r15d, byte [r14]
4222765    mov     rbx, r14
4222768    cmp     r15b, 2Fh
4222772    jnz     loc_406E54
4222778    nop     word [rax+rax+00h]
loc_406F40:
4222784    add     rbx, 1
4222788    movzx   eax, byte [rbx]
4222791    cmp     al, 2Fh
4222793    jz      loc_406F40
4222795    mov     r15d, eax
4222798    test    r15b, r15b
4222801    jnz     loc_406E60
loc_406F57:
4222807    mov     rdx, rsp
4222810    mov     rsi, rbp
4222813    mov     edi, 1
4222818    call    ___xstat
4222823    test    eax, eax
4222825    jnz     loc_4070FD
4222831    mov     eax, [rsp+18h]
4222835    mov     edx, eax
4222837    and     edx, 0F000h
4222843    cmp     edx, 4000h
4222849    jz      loc_40713F
4222855    mov     edx, aDirectoryChang
4222860    mov     esi, 226h
4222865    mov     rdi, r13
4222868    xor     eax, eax
4222870    call    _reply
loc_406F9B:
4222875    mov     rdi, r13
4222878    call    _invariant_0
4222883    test    eax, eax
4222885    jz      loc_407121
loc_406FAB:
4222891    mov     rax, [rsp+1098h]
4222899    xor     rax, [fs:28h]
4222908    jnz     loc_407281
4222914    add     rsp, 10A8h
4222921    pop     rbx
4222922    pop     rbp
4222923    pop     r12
4222925    pop     r13
4222927    pop     r14
4222929    pop     r15
4222931    retn    
4222932    align 8 
loc_406FD8:
4222936    cmp     byte [rbx], 2Eh
4222939    jnz     loc_406E91
4222945    jmp     loc_406F29
4222950    align 10h
loc_406FF0:
4222960    cmp     byte [rbx], 2Eh
4222963    jnz     loc_406E91
4222969    cmp     byte [rbx+1], 2Eh
4222973    nop     dword [rax]
4222976    jnz     loc_406E91
4222982    mov     sil, 2Fh
4222985    mov     rdi, rbp
4222988    call    _strrchr
4222993    test    rax, rax
4222996    jz      loc_40725B
4223002    cmp     rax, rbp
4223005    mov     byte [rax], 0
4223008    jnz     loc_406F29
4223014    mov     eax, 2Fh
4223019    mov     [rbp+0], ax
4223023    jmp     loc_406F29
4223028    align 8 
loc_407038:
4223032    mov     rdi, r12
4223035    jmp     loc_406EF7
loc_407040:
4223040    xor     esi, esi
4223042    mov     rdi, rbx
4223045    call    ___rawmemchr
4223050    mov     r14, rax
4223053    jmp     loc_406E79
loc_407052:
4223058    mov     edx, aErrorChangin_0
4223063    mov     esi, 226h
4223068    mov     rdi, r13
4223071    xor     eax, eax
4223073    call    _reply
4223078    jmp     loc_406FAB
loc_40706B:
4223083    mov     ecx, __func___5463
4223088    mov     edx, 1F3h
4223093    mov     esi, aFtp_session_c
4223098    mov     edi, aInvariantF
4223103    call    _daemon_assert_fail
4223108    jmp     loc_406DF7
loc_407089:
4223113    mov     ecx, __func___5463
4223118    mov     edx, 1F5h
4223123    mov     esi, aFtp_session_c
4223128    mov     edi, aStrlenNew_dir4
4223133    call    _daemon_assert_fail
4223138    movzx   r15d, byte [rbx]
4223142    cmp     r15b, 2Fh
4223146    jnz     loc_406E22
loc_4070B0:
4223152    mov     edx, 2Fh
4223157    mov     [rsp+90h], dx
4223165    nop     dword [rax]
loc_4070C0:
4223168    add     rbx, 1
4223172    movzx   r15d, byte [rbx]
4223176    cmp     r15b, 2Fh
4223180    jz      loc_4070C0
4223182    lea     rbp, [rsp+90h]
4223190    jmp     loc_406E50
loc_4070DB:
4223195    mov     ecx, __func___5463
4223200    mov     edx, 201h
4223205    mov     esi, aFtp_session_c
4223210    mov     edi, aStrlenFDirSize
4223215    call    _daemon_assert_fail
4223220    movzx   r15d, byte [rbx]
4223224    jmp     loc_406E3D
loc_4070FD:
4223229    xor     eax, eax
4223231    mov     edx, aDirectoryCha_0
4223236    mov     esi, 226h
4223241    mov     rdi, r13
4223244    call    _reply
4223249    mov     rdi, r13
4223252    call    _invariant_0
4223257    test    eax, eax
4223259    jnz     loc_406FAB
loc_407121:
4223265    mov     ecx, __func___5463
4223270    mov     edx, 265h
4223275    mov     esi, aFtp_session_c
4223280    mov     edi, aInvariantF
4223285    call    _daemon_assert_fail
4223290    jmp     loc_406FAB
loc_40713F:
4223295    test    al, 1
4223297    jz      loc_407210
loc_407147:
4223303    mov     rdx, rbp
loc_40714A:
4223306    mov     ecx, [rdx]
4223308    add     rdx, 4
4223312    lea     eax, [rcx-1010101h]
4223318    not     ecx
4223320    and     eax, ecx
4223322    and     eax, 80808080h
4223327    jz      loc_40714A
4223329    mov     ecx, eax
4223331    shr     ecx, 10h
4223334    test    eax, 8080h
4223339    cmovz   eax, ecx
4223342    lea     rcx, [rdx+2]
4223346    cmovz   rdx, rcx
4223350    add     al, al
4223352    sbb     rdx, 3
4223356    sub     rdx, rbp
4223359    cmp     rdx, 1000h
4223366    jbe     loc_4071A1
4223368    mov     ecx, __func___5463
4223373    mov     edx, 25Ah
4223378    mov     esi, aFtp_session_c
4223383    mov     edi, aStrlenTargetSi
4223388    call    _daemon_assert_fail
loc_4071A1:
4223393    lea     rbx, [r13+0A0h]
4223400    mov     rsi, rbp
4223403    mov     rdi, rbx
4223406    call    _strcmp
4223411    test    eax, eax
4223413    mov     rsi, rbp
4223416    mov     rdi, rbx
4223419    jz      loc_4071E8
4223421    call    _strcpy
4223426    mov     esi, 0FAh
4223431    mov     rdi, r13
4223434    call    _send_readme
loc_4071CF:
4223439    mov     edx, aDirectoryCha_1
4223444    mov     esi, 0FAh
4223449    mov     rdi, r13
4223452    xor     eax, eax
4223454    call    _reply
4223459    jmp     loc_406F9B
loc_4071E8:
4223464    call    _strcpy
4223469    nop     dword [rax]
4223472    jmp     loc_4071CF
loc_4071F2:
4223474    mov     ecx, __func___5463
4223479    mov     edx, 1F4h
4223484    mov     esi, aFtp_session_c
4223489    mov     edi, aNew_dirVoid0
4223494    call    _daemon_assert_fail
4223499    jmp     loc_406E00
loc_407210:
4223504    mov     ebx, [rsp+20h]
4223508    call    _getegid
4223513    cmp     ebx, eax
4223515    jz      loc_40724E
loc_40721D:
4223517    mov     ebx, [rsp+1Ch]
4223521    call    _geteuid
4223526    cmp     ebx, eax
4223528    jnz     loc_407235
4223530    test    byte [rsp+18h], 40h
4223535    jnz     loc_407147
loc_407235:
4223541    mov     edx, aDirectoryCha_2
4223546    mov     esi, 226h
4223551    mov     rdi, r13
4223554    xor     eax, eax
4223556    call    _reply
4223561    jmp     loc_406F9B
loc_40724E:
4223566    test    byte [rsp+18h], 8
4223571    jnz     loc_407147
4223577    jmp     loc_40721D
loc_40725B:
4223579    mov     ecx, __func___5463
4223584    mov     edx, 217h
4223589    mov     esi, aFtp_session_c
4223594    mov     edi, aPrev_dirVoid0
4223599    call    _daemon_assert_fail
4223604    mov     [byte 0], 0
4223612    jmp     loc_406F29
loc_407281:
4223617    call    ___stack_chk_fail
USE32

section .text

global _do_noop

_do_noop:
4223632    push    rbp
4223633    mov     rbp, rsi
4223636    push    rbx
4223637    mov     rbx, rdi
4223640    sub     rsp, 8
4223644    call    _invariant_0
4223649    test    eax, eax
4223651    jz      loc_407320
loc_4072A5:
4223653    test    rbp, rbp
4223656    jz      loc_407340
loc_4072AE:
4223662    mov     eax, [rbp+8]
4223665    test    eax, eax
4223667    jnz     loc_407300
loc_4072B5:
4223669    xor     eax, eax
4223671    mov     edx, aCommandOkay_
4223676    mov     esi, 0C8h
4223681    mov     rdi, rbx
4223684    call    _reply
4223689    mov     rdi, rbx
4223692    call    _invariant_0
4223697    test    eax, eax
4223699    jz      loc_4072E0
4223701    add     rsp, 8
4223705    pop     rbx
4223706    pop     rbp
4223707    retn    
4223708    align 20h
loc_4072E0:
4223712    add     rsp, 8
4223716    mov     ecx, __func___5723
4223721    mov     edx, 63Ah
4223726    pop     rbx
4223727    pop     rbp
4223728    mov     esi, aFtp_session_c
4223733    mov     edi, aInvariantF
4223738    jmp     daemon_assert_fail
4223743    align 20h
loc_407300:
4223744    mov     ecx, __func___5723
4223749    mov     edx, 636h
4223754    mov     esi, aFtp_session_c
4223759    mov     edi, aCmdNum_arg0
4223764    call    _daemon_assert_fail
4223769    jmp     loc_4072B5
4223771    align 20h
loc_407320:
4223776    mov     ecx, __func___5723
4223781    mov     edx, 634h
4223786    mov     esi, aFtp_session_c
4223791    mov     edi, aInvariantF
4223796    call    _daemon_assert_fail
4223801    jmp     loc_4072A5
4223806    align 20h
loc_407340:
4223808    mov     ecx, __func___5723
4223813    mov     edx, 635h
4223818    mov     esi, aFtp_session_c
4223823    mov     edi, aCmdVoid0
4223828    call    _daemon_assert_fail
USE32

section .text

global _do_syst

_do_syst:
4223840    push    rbp
4223841    mov     rbp, rsi
4223844    push    rbx
4223845    mov     rbx, rdi
4223848    sub     rsp, 8
4223852    call    _invariant_0
4223857    test    eax, eax
4223859    jz      loc_4073F0
loc_407375:
4223861    test    rbp, rbp
4223864    jz      loc_407410
loc_40737E:
4223870    mov     eax, [rbp+8]
4223873    test    eax, eax
4223875    jnz     loc_4073D0
loc_407385:
4223877    xor     eax, eax
4223879    mov     edx, aUnix
4223884    mov     esi, 0D7h
4223889    mov     rdi, rbx
4223892    call    _reply
4223897    mov     rdi, rbx
4223900    call    _invariant_0
4223905    test    eax, eax
4223907    jz      loc_4073B0
4223909    add     rsp, 8
4223913    pop     rbx
4223914    pop     rbp
4223915    retn    
4223916    align 10h
loc_4073B0:
4223920    add     rsp, 8
4223924    mov     ecx, __func___5718
4223929    mov     edx, 62Eh
4223934    pop     rbx
4223935    pop     rbp
4223936    mov     esi, aFtp_session_c
4223941    mov     edi, aInvariantF
4223946    jmp     daemon_assert_fail
4223951    align 10h
loc_4073D0:
4223952    mov     ecx, __func___5718
4223957    mov     edx, 62Ah
4223962    mov     esi, aFtp_session_c
4223967    mov     edi, aCmdNum_arg0
4223972    call    _daemon_assert_fail
4223977    jmp     loc_407385
4223979    align 10h
loc_4073F0:
4223984    mov     ecx, __func___5718
4223989    mov     edx, 628h
4223994    mov     esi, aFtp_session_c
4223999    mov     edi, aInvariantF
4224004    call    _daemon_assert_fail
4224009    jmp     loc_407375
4224014    align 10h
loc_407410:
4224016    mov     ecx, __func___5718
4224021    mov     edx, 629h
4224026    mov     esi, aFtp_session_c
4224031    mov     edi, aCmdVoid0
4224036    call    _daemon_assert_fail
USE32

section .text

global _do_pwd

_do_pwd:
4224048    push    rbp
4224049    mov     rbp, rsi
4224052    push    rbx
4224053    mov     rbx, rdi
4224056    sub     rsp, 8
4224060    call    _invariant_0
4224065    test    eax, eax
4224067    jz      loc_4074D0
loc_407449:
4224073    test    rbp, rbp
4224076    jz      loc_4074F0
loc_407452:
4224082    mov     eax, [rbp+8]
4224085    test    eax, eax
4224087    jnz     loc_4074B0
loc_407459:
4224089    lea     rcx, [rbx+0A0h]
4224096    xor     eax, eax
4224098    mov     edx, aSIsCurrentDire
4224103    mov     esi, 101h
4224108    mov     rdi, rbx
4224111    call    _reply
4224116    mov     rdi, rbx
4224119    call    _invariant_0
4224124    test    eax, eax
4224126    jz      loc_407490
4224128    add     rsp, 8
4224132    pop     rbx
4224133    pop     rbp
4224134    retn    
4224135    align 10h
loc_407490:
4224144    add     rsp, 8
4224148    mov     ecx, __func___5675
4224153    mov     edx, 566h
4224158    pop     rbx
4224159    pop     rbp
4224160    mov     esi, aFtp_session_c
4224165    mov     edi, aInvariantF
4224170    jmp     daemon_assert_fail
4224175    align 10h
loc_4074B0:
4224176    mov     ecx, __func___5675
4224181    mov     edx, 562h
4224186    mov     esi, aFtp_session_c
4224191    mov     edi, aCmdNum_arg0
4224196    call    _daemon_assert_fail
4224201    jmp     loc_407459
4224203    align 10h
loc_4074D0:
4224208    mov     ecx, __func___5675
4224213    mov     edx, 560h
4224218    mov     esi, aFtp_session_c
4224223    mov     edi, aInvariantF
4224228    call    _daemon_assert_fail
4224233    jmp     loc_407449
4224238    align 10h
loc_4074F0:
4224240    mov     ecx, __func___5675
4224245    mov     edx, 561h
4224250    mov     esi, aFtp_session_c
4224255    mov     edi, aCmdVoid0
4224260    call    _daemon_assert_fail
USE32

section .text

global _do_stor

_do_stor:
4224272    push    rbp
4224273    mov     rbp, rsi
4224276    push    rbx
4224277    mov     rbx, rdi
4224280    sub     rsp, 8
4224284    call    _invariant_0
4224289    test    eax, eax
4224291    jz      loc_4075A0
loc_407525:
4224293    test    rbp, rbp
4224296    jz      loc_4075C0
loc_40752E:
4224302    cmp     dword [rbp+8], 1
4224306    jz      loc_40754D
4224308    mov     ecx, __func___5642
4224313    mov     edx, 4F7h
4224318    mov     esi, aFtp_session_c
4224323    mov     edi, aCmdNum_arg1
4224328    call    _daemon_assert_fail
loc_40754D:
4224333    xor     eax, eax
4224335    mov     edx, aServerWillNotS
4224340    mov     esi, 229h
4224345    mov     rdi, rbx
4224348    call    _reply
4224353    mov     rdi, rbx
4224356    call    _invariant_0
4224361    test    eax, eax
4224363    jz      loc_407578
4224365    add     rsp, 8
4224369    pop     rbx
4224370    pop     rbp
4224371    retn    
4224372    align 8 
loc_407578:
4224376    add     rsp, 8
4224380    mov     ecx, __func___5642
4224385    mov     edx, 4FBh
4224390    pop     rbx
4224391    pop     rbp
4224392    mov     esi, aFtp_session_c
4224397    mov     edi, aInvariantF
4224402    jmp     daemon_assert_fail
4224407    align 20h
loc_4075A0:
4224416    mov     ecx, __func___5642
4224421    mov     edx, 4F5h
4224426    mov     esi, aFtp_session_c
4224431    mov     edi, aInvariantF
4224436    call    _daemon_assert_fail
4224441    jmp     loc_407525
4224446    align 20h
loc_4075C0:
4224448    mov     ecx, __func___5642
4224453    mov     edx, 4F6h
4224458    mov     esi, aFtp_session_c
4224463    mov     edi, aCmdVoid0
4224468    call    _daemon_assert_fail
USE32

section .text

global _do_eprt

_do_eprt:
4224480    push    rbp
4224481    mov     rbp, rsi
4224484    push    rbx
4224485    mov     rbx, rdi
4224488    sub     rsp, 8
4224492    call    _invariant_0
4224497    test    eax, eax
4224499    jz      loc_407670
loc_4075F5:
4224501    test    rbp, rbp
4224504    jz      loc_407690
loc_4075FE:
4224510    cmp     dword [rbp+8], 1
4224514    jz      loc_40761D
4224516    mov     ecx, __func___5514
4224521    mov     edx, 2C6h
4224526    mov     esi, aFtp_session_c
4224531    mov     edi, aCmdNum_arg1
4224536    call    _daemon_assert_fail
loc_40761D:
4224541    xor     eax, eax
4224543    mov     edx, aEprtNotSupport
4224548    mov     esi, 1F4h
4224553    mov     rdi, rbx
4224556    call    _reply
4224561    mov     rdi, rbx
4224564    call    _invariant_0
4224569    test    eax, eax
4224571    jz      loc_407648
4224573    add     rsp, 8
4224577    pop     rbx
4224578    pop     rbp
4224579    retn    
4224580    align 8 
loc_407648:
4224584    add     rsp, 8
4224588    mov     ecx, __func___5514
4224593    mov     edx, 2CAh
4224598    pop     rbx
4224599    pop     rbp
4224600    mov     esi, aFtp_session_c
4224605    mov     edi, aInvariantF
4224610    jmp     daemon_assert_fail
4224615    align 10h
loc_407670:
4224624    mov     ecx, __func___5514
4224629    mov     edx, 2C4h
4224634    mov     esi, aFtp_session_c
4224639    mov     edi, aInvariantF
4224644    call    _daemon_assert_fail
4224649    jmp     loc_4075F5
4224654    align 10h
loc_407690:
4224656    mov     ecx, __func___5514
4224661    mov     edx, 2C5h
4224666    mov     esi, aFtp_session_c
4224671    mov     edi, aCmdVoid0
4224676    call    _daemon_assert_fail
USE32

section .text

global _do_quit

_do_quit:
4224688    push    rbp
4224689    mov     rbp, rsi
4224692    push    rbx
4224693    mov     rbx, rdi
4224696    sub     rsp, 8
4224700    call    _invariant_0
4224705    test    eax, eax
4224707    jz      loc_407750
loc_4076C9:
4224713    test    rbp, rbp
4224716    jz      loc_407770
loc_4076D2:
4224722    mov     eax, [rbp+8]
4224725    test    eax, eax
4224727    jnz     loc_407730
loc_4076D9:
4224729    xor     eax, eax
4224731    mov     edx, aServiceClosing
4224736    mov     esi, 0DDh
4224741    mov     rdi, rbx
4224744    call    _reply
4224749    mov     dword [rbx], 0
4224755    mov     rdi, rbx
4224758    call    _invariant_0
4224763    test    eax, eax
4224765    jz      loc_407710
4224767    add     rsp, 8
4224771    pop     rbx
4224772    pop     rbp
4224773    retn    
4224774    align 10h
loc_407710:
4224784    add     rsp, 8
4224788    mov     ecx, __func___5488
4224793    mov     edx, 271h
4224798    pop     rbx
4224799    pop     rbp
4224800    mov     esi, aFtp_session_c
4224805    mov     edi, aInvariantF
4224810    jmp     daemon_assert_fail
4224815    align 10h
loc_407730:
4224816    mov     ecx, __func___5488
4224821    mov     edx, 26Ch
4224826    mov     esi, aFtp_session_c
4224831    mov     edi, aCmdNum_arg0
4224836    call    _daemon_assert_fail
4224841    jmp     loc_4076D9
4224843    align 10h
loc_407750:
4224848    mov     ecx, __func___5488
4224853    mov     edx, 26Ah
4224858    mov     esi, aFtp_session_c
4224863    mov     edi, aInvariantF
4224868    call    _daemon_assert_fail
4224873    jmp     loc_4076C9
4224878    align 10h
loc_407770:
4224880    mov     ecx, __func___5488
4224885    mov     edx, 26Bh
4224890    mov     esi, aFtp_session_c
4224895    mov     edi, aCmdVoid0
4224900    call    _daemon_assert_fail
USE32

section .text

global _filespec_is_legal

_filespec_is_legal:
4224912    test    rdi, rdi
4224915    push    rbx
4224916    mov     rbx, rdi
4224919    jz      loc_407810
loc_407799:
4224921    movzx   eax, byte [rbx]
4224924    test    al, al
4224926    jz      loc_4077E0
4224928    mov     rdx, rbx
loc_4077A3:
4224931    cmp     al, 3Fh
4224933    jz      loc_4077F0
4224935    jle     loc_4077C8
4224937    cmp     al, 5Bh
4224939    jz      loc_4077F0
4224941    cmp     al, 5Ch
4224943    nop     
4224944    jnz     loc_4077CC
4224946    cmp     byte [rdx+1], 0
4224950    jz      loc_4077E0
4224952    movzx   eax, byte [rdx+2]
4224956    add     rdx, 1
4224960    jmp     loc_4077D0
4224962    align 8 
loc_4077C8:
4224968    cmp     al, 2Ah
4224970    jz      loc_4077F0
loc_4077CC:
4224972    movzx   eax, byte [rdx+1]
loc_4077D0:
4224976    add     rdx, 1
4224980    test    al, al
4224982    jnz     loc_4077A3
4224984    nop     dword [rax+rax+00000000h]
loc_4077E0:
4224992    mov     eax, 1
4224997    pop     rbx
4224998    retn    
4224999    align 10h
loc_4077F0:
4225008    mov     rdi, rbx
4225011    mov     esi, 2Fh
4225016    call    _strchr
4225021    test    rax, rax
4225024    setz    al
4225027    movzx   eax, al
4225030    pop     rbx
4225031    retn    
4225032    align 10h
loc_407810:
4225040    mov     ecx, __func___5695
4225045    mov     edx, 5A0h
4225050    mov     esi, aFtp_session_c
4225055    mov     edi, aFilespecVoid0
4225060    call    _daemon_assert_fail
USE32

section .text

global _netscape_hack

_netscape_hack:
4225104    push    rbx
4225105    mov     ebx, edi
4225107    sub     rsp, 0A0h
4225114    test    edi, edi
4225116    js      loc_4078F0
loc_407862:
4225122    mov     edi, ebx
4225124    mov     esi, 1
4225129    call    _shutdown
4225134    lea     rsi, [rsp+20h]
4225139    mov     ecx, 10h
4225144    xor     eax, eax
4225146    mov     rdi, rsi
4225149    cld     
4225150    rep stosq
4225153    lea     eax, [rbx+3Fh]
4225156    test    ebx, ebx
4225158    lea     edi, [rbx+1]
4225161    lea     r8, [rsp+10h]
4225166    mov     qword [rsp+10h], 0Fh
4225175    mov     qword [rsp+18h], 0
4225184    cmovns  eax, ebx
4225187    sar     eax, 6
4225190    movsxd  rdx, eax
4225193    mov     eax, ebx
4225195    sar     eax, 1Fh
4225198    shr     eax, 1Ah
4225201    lea     ecx, [rbx+rax]
4225204    and     ecx, 3Fh
4225207    sub     ecx, eax
4225209    mov     eax, 1
4225214    shl     rax, cl
4225217    xor     ecx, ecx
4225219    or      [rsp+rdx*8+20h], rax
4225224    xor     edx, edx
4225226    call    _select
4225231    test    eax, eax
4225233    jle     loc_4078E4
4225235    lea     rsi, [rsp+0Fh]
4225240    mov     edx, 1
4225245    mov     edi, ebx
4225247    call    _read
loc_4078E4:
4225252    add     rsp, 0A0h
4225259    pop     rbx
4225260    retn    
4225261    align 10h
loc_4078F0:
4225264    mov     ecx, __func___5777
4225269    mov     edx, 709h
4225274    mov     esi, aFtp_session_c
4225279    mov     edi, aFd0
4225284    call    _daemon_assert_fail
USE32

section .text

global _do_list

_do_list:
4225296    push    r12
4225298    push    rbp
4225299    mov     rbp, rsi
4225302    push    rbx
4225303    mov     rbx, rdi
4225306    call    _invariant_0
4225311    test    eax, eax
4225313    jz      loc_407A70
loc_407927:
4225319    test    rbp, rbp
4225322    jz      loc_407AB0
loc_407930:
4225328    mov     eax, [rbp+8]
4225331    cmp     eax, 1
4225334    jbe     loc_407954
4225336    mov     ecx, __func___5712
4225341    mov     edx, 5F0h
4225346    mov     esi, aFtp_session_c
4225351    mov     edi, aCmdNum_arg0Cmd
4225356    call    _daemon_assert_fail
4225361    mov     eax, [rbp+8]
loc_407954:
4225364    test    eax, eax
4225366    jz      loc_407A30
4225372    cmp     eax, 1
4225375    jz      loc_40797A
4225377    mov     ecx, __func___5712
4225382    mov     edx, 5F9h
4225387    mov     esi, aFtp_session_c
4225392    mov     edi, aCmdNum_arg1
4225397    call    _daemon_assert_fail
loc_40797A:
4225402    cmp     byte [rbp+10h], 2Dh
4225406    jz      loc_407A30
4225412    add     rbp, 10h
4225416    mov     rdi, rbp
4225419    call    _filespec_is_legal
4225424    test    eax, eax
4225426    jz      loc_407A45
loc_407998:
4225432    xor     eax, eax
4225434    mov     edx, aAboutToSendFil
4225439    mov     esi, 96h
4225444    mov     rdi, rbx
4225447    call    _reply
4225452    mov     rdi, rbx
4225455    call    _open_connection
4225460    cmp     eax, 0FFFFFFFFh
4225463    mov     r12d, eax
4225466    jz      loc_407A57
4225472    lea     rsi, [rbx+0A0h]
4225479    mov     rdx, rbp
4225482    mov     edi, eax
4225484    call    _file_list
4225489    mov     edi, r12d
4225492    mov     ebp, eax
4225494    call    _netscape_hack
4225499    test    ebp, ebp
4225501    jnz     loc_407A90
4225507    mov     edx, aErrorSendingFi
4225512    mov     esi, 1C3h
4225517    mov     rdi, rbx
4225520    xor     eax, eax
4225522    call    _reply
loc_4079F7:
4225527    mov     edi, r12d
4225530    call    _close
4225535    mov     rdi, rbx
4225538    call    _invariant_0
4225543    test    eax, eax
4225545    jnz     loc_407A63
loc_407A0B:
4225547    pop     rbx
4225548    pop     rbp
4225549    pop     r12
4225551    mov     ecx, __func___5712
4225556    mov     edx, 623h
4225561    mov     esi, aFtp_session_c
4225566    mov     edi, aInvariantF
4225571    jmp     daemon_assert_fail
4225576    align 10h
loc_407A30:
4225584    mov     ebp, s
4225589    mov     rdi, rbp
4225592    call    _filespec_is_legal
4225597    test    eax, eax
4225599    jnz     loc_407998
loc_407A45:
4225605    mov     edx, aIllegalFilenam
4225610    mov     esi, 226h
4225615    mov     rdi, rbx
4225618    call    _reply
loc_407A57:
4225623    mov     rdi, rbx
4225626    call    _invariant_0
4225631    test    eax, eax
4225633    jz      loc_407A0B
loc_407A63:
4225635    pop     rbx
4225636    pop     rbp
4225637    pop     r12
4225639    retn    
4225640    align 10h
loc_407A70:
4225648    mov     ecx, __func___5712
4225653    mov     edx, 5EEh
4225658    mov     esi, aFtp_session_c
4225663    mov     edi, aInvariantF
4225668    call    _daemon_assert_fail
4225673    jmp     loc_407927
4225678    align 10h
loc_407A90:
4225680    mov     edx, aTransferComple
4225685    mov     esi, 0E2h
4225690    mov     rdi, rbx
4225693    xor     eax, eax
4225695    call    _reply
4225700    jmp     loc_4079F7
4225705    align 10h
loc_407AB0:
4225712    mov     ecx, __func___5712
4225717    mov     edx, 5EFh
4225722    mov     esi, aFtp_session_c
4225727    mov     edi, aCmdVoid0
4225732    call    _daemon_assert_fail
USE32

section .text

global _do_nlst

_do_nlst:
4225744    push    r12
4225746    push    rbp
4225747    mov     rbp, rsi
4225750    push    rbx
4225751    mov     rbx, rdi
4225754    call    _invariant_0
4225759    test    eax, eax
4225761    jz      loc_407C30
loc_407AE7:
4225767    test    rbp, rbp
4225770    jz      loc_407C70
loc_407AF0:
4225776    mov     eax, [rbp+8]
4225779    cmp     eax, 1
4225782    jbe     loc_407B14
4225784    mov     ecx, __func___5703
4225789    mov     edx, 5B2h
4225794    mov     esi, aFtp_session_c
4225799    mov     edi, aCmdNum_arg0Cmd
4225804    call    _daemon_assert_fail
4225809    mov     eax, [rbp+8]
loc_407B14:
4225812    test    eax, eax
4225814    jz      loc_407BF0
4225820    cmp     eax, 1
4225823    jz      loc_407B3A
4225825    mov     ecx, __func___5703
4225830    mov     edx, 5BBh
4225835    mov     esi, aFtp_session_c
4225840    mov     edi, aCmdNum_arg1
4225845    call    _daemon_assert_fail
loc_407B3A:
4225850    cmp     byte [rbp+10h], 2Dh
4225854    jz      loc_407BF0
4225860    add     rbp, 10h
4225864    mov     rdi, rbp
4225867    call    _filespec_is_legal
4225872    test    eax, eax
4225874    jz      loc_407C05
loc_407B58:
4225880    xor     eax, eax
4225882    mov     edx, aAboutToSendNam
4225887    mov     esi, 96h
4225892    mov     rdi, rbx
4225895    call    _reply
4225900    mov     rdi, rbx
4225903    call    _open_connection
4225908    cmp     eax, 0FFFFFFFFh
4225911    mov     r12d, eax
4225914    jz      loc_407C17
4225920    lea     rsi, [rbx+0A0h]
4225927    mov     rdx, rbp
4225930    mov     edi, eax
4225932    call    _file_nlst
4225937    mov     edi, r12d
4225940    mov     ebp, eax
4225942    call    _netscape_hack
4225947    test    ebp, ebp
4225949    jnz     loc_407C50
4225955    mov     edx, aErrorSendingNa
4225960    mov     esi, 1C3h
4225965    mov     rdi, rbx
4225968    xor     eax, eax
4225970    call    _reply
loc_407BB7:
4225975    mov     edi, r12d
4225978    call    _close
4225983    mov     rdi, rbx
4225986    call    _invariant_0
4225991    test    eax, eax
4225993    jnz     loc_407C23
loc_407BCB:
4225995    pop     rbx
4225996    pop     rbp
4225997    pop     r12
4225999    mov     ecx, __func___5703
4226004    mov     edx, 5E5h
4226009    mov     esi, aFtp_session_c
4226014    mov     edi, aInvariantF
4226019    jmp     daemon_assert_fail
4226024    align 10h
loc_407BF0:
4226032    mov     ebp, s
4226037    mov     rdi, rbp
4226040    call    _filespec_is_legal
4226045    test    eax, eax
4226047    jnz     loc_407B58
loc_407C05:
4226053    mov     edx, aIllegalFilenam
4226058    mov     esi, 226h
4226063    mov     rdi, rbx
4226066    call    _reply
loc_407C17:
4226071    mov     rdi, rbx
4226074    call    _invariant_0
4226079    test    eax, eax
4226081    jz      loc_407BCB
loc_407C23:
4226083    pop     rbx
4226084    pop     rbp
4226085    pop     r12
4226087    retn    
4226088    align 10h
loc_407C30:
4226096    mov     ecx, __func___5703
4226101    mov     edx, 5B0h
4226106    mov     esi, aFtp_session_c
4226111    mov     edi, aInvariantF
4226116    call    _daemon_assert_fail
4226121    jmp     loc_407AE7
4226126    align 10h
loc_407C50:
4226128    mov     edx, aTransferComple
4226133    mov     esi, 0E2h
4226138    mov     rdi, rbx
4226141    xor     eax, eax
4226143    call    _reply
4226148    jmp     loc_407BB7
4226153    align 10h
loc_407C70:
4226160    mov     ecx, __func___5703
4226165    mov     edx, 5B1h
4226170    mov     esi, aFtp_session_c
4226175    mov     edi, aCmdVoid0
4226180    call    _daemon_assert_fail
USE32

section .text

global _do_cdup

_do_cdup:
4226192    push    rbp
4226193    mov     rbp, rsi
4226196    push    rbx
4226197    mov     rbx, rdi
4226200    sub     rsp, 8
4226204    call    _invariant_0
4226209    test    eax, eax
4226211    jz      loc_407D20
loc_407CA5:
4226213    test    rbp, rbp
4226216    jz      loc_407D40
loc_407CAE:
4226222    mov     eax, [rbp+8]
4226225    test    eax, eax
4226227    jnz     loc_407D00
loc_407CB5:
4226229    mov     esi, a__
4226234    mov     rdi, rbx
4226237    call    _change_dir
4226242    mov     rdi, rbx
4226245    call    _invariant_0
4226250    test    eax, eax
4226252    jz      loc_407CD8
4226254    add     rsp, 8
4226258    pop     rbx
4226259    pop     rbp
4226260    retn    
4226261    align 8 
loc_407CD8:
4226264    add     rsp, 8
4226268    mov     ecx, __func___5450
4226273    mov     edx, 1E5h
4226278    pop     rbx
4226279    pop     rbp
4226280    mov     esi, aFtp_session_c
4226285    mov     edi, aInvariantF
4226290    jmp     daemon_assert_fail
4226295    align 20h
loc_407D00:
4226304    mov     ecx, __func___5450
4226309    mov     edx, 1E1h
4226314    mov     esi, aFtp_session_c
4226319    mov     edi, aCmdNum_arg0
4226324    call    _daemon_assert_fail
4226329    jmp     loc_407CB5
4226331    align 20h
loc_407D20:
4226336    mov     ecx, __func___5450
4226341    mov     edx, 1DFh
4226346    mov     esi, aFtp_session_c
4226351    mov     edi, aInvariantF
4226356    call    _daemon_assert_fail
4226361    jmp     loc_407CA5
4226366    align 20h
loc_407D40:
4226368    mov     ecx, __func___5450
4226373    mov     edx, 1E0h
4226378    mov     esi, aFtp_session_c
4226383    mov     edi, aCmdVoid0
4226388    call    _daemon_assert_fail
USE32

section .text

global _do_cwd

_do_cwd:
4226400    push    rbp
4226401    mov     rbp, rsi
4226404    push    rbx
4226405    mov     rbx, rdi
4226408    sub     rsp, 8
4226412    call    _invariant_0
4226417    test    eax, eax
4226419    jz      loc_407DE0
loc_407D75:
4226421    test    rbp, rbp
4226424    jz      loc_407E00
loc_407D7E:
4226430    cmp     dword [rbp+8], 1
4226434    jz      loc_407D9D
4226436    mov     ecx, __func___5445
4226441    mov     edx, 1D5h
4226446    mov     esi, aFtp_session_c
4226451    mov     edi, aCmdNum_arg1
4226456    call    _daemon_assert_fail
loc_407D9D:
4226461    lea     rsi, [rbp+10h]
4226465    mov     rdi, rbx
4226468    call    _change_dir
4226473    mov     rdi, rbx
4226476    call    _invariant_0
4226481    test    eax, eax
4226483    jz      loc_407DC0
4226485    add     rsp, 8
4226489    pop     rbx
4226490    pop     rbp
4226491    retn    
4226492    align 20h
loc_407DC0:
4226496    add     rsp, 8
4226500    mov     ecx, __func___5445
4226505    mov     edx, 1DAh
4226510    pop     rbx
4226511    pop     rbp
4226512    mov     esi, aFtp_session_c
4226517    mov     edi, aInvariantF
4226522    jmp     daemon_assert_fail
4226527    align 20h
loc_407DE0:
4226528    mov     ecx, __func___5445
4226533    mov     edx, 1D3h
4226538    mov     esi, aFtp_session_c
4226543    mov     edi, aInvariantF
4226548    call    _daemon_assert_fail
4226553    jmp     loc_407D75
4226558    align 20h
loc_407E00:
4226560    mov     ecx, __func___5445
4226565    mov     edx, 1D4h
4226570    mov     esi, aFtp_session_c
4226575    mov     edi, aCmdVoid0
4226580    call    _daemon_assert_fail
USE32

section .text

global _get_absolute_fname_constprop_11

_get_absolute_fname_constprop_11:
4226592    push    r13
4226594    push    r12
4226596    mov     r12, rsi
4226599    push    rbp
4226600    mov     rbp, rdi
4226603    push    rbx
4226604    mov     rbx, rdx
4226607    sub     rsp, 8
4226611    test    rdi, rdi
4226614    jz      loc_407F18
loc_407E3C:
4226620    test    r12, r12
4226623    jz      loc_407F40
loc_407E45:
4226629    test    rbx, rbx
4226632    jz      loc_407F60
loc_407E4E:
4226638    cmp     byte [rbx], 2Fh
4226641    jz      loc_407EA0
4226643    mov     rdi, r12
4226646    call    _strlen
4226651    mov     rdi, rbx
4226654    mov     r13, rax
4226657    call    _strlen
4226662    lea     rax, [r13+rax+1]
4226667    cmp     rax, 2000h
4226673    ja      loc_407ED8
loc_407E73:
4226675    mov     rsi, r12
4226678    mov     rdi, rbp
4226681    call    _stpcpy
4226686    cmp     byte [rbp+1], 0
4226690    jnz     loc_407EC8
loc_407E84:
4226692    add     rsp, 8
4226696    mov     rsi, rbx
4226699    mov     rdi, rbp
4226702    pop     rbx
4226703    pop     rbp
4226704    pop     r12
4226706    pop     r13
4226708    jmp     _strcat
4226713    align 20h
loc_407EA0:
4226720    mov     rdi, rbx
4226723    call    _strlen
4226728    cmp     rax, 2000h
4226734    ja      loc_407EF8
loc_407EB0:
4226736    add     rsp, 8
4226740    mov     rsi, rbx
4226743    mov     rdi, rbp
4226746    pop     rbx
4226747    pop     rbp
4226748    pop     r12
4226750    pop     r13
4226752    jmp     _strcpy
4226757    align 8 
loc_407EC8:
4226760    mov     edx, 2Fh
4226765    mov     [rax], dx
4226768    jmp     loc_407E84
4226770    align 8 
loc_407ED8:
4226776    mov     ecx, __func___5600
4226781    mov     edx, 41Ah
4226786    mov     esi, aFtp_session_c
4226791    mov     edi, aStrlenDir1Strl
4226796    call    _daemon_assert_fail
4226801    jmp     loc_407E73
4226803    align 8 
loc_407EF8:
4226808    mov     ecx, __func___5600
4226813    mov     edx, 414h
4226818    mov     esi, aFtp_session_c
4226823    mov     edi, aStrlenFileFnam
4226828    call    _daemon_assert_fail
4226833    jmp     loc_407EB0
4226835    align 8 
loc_407F18:
4226840    mov     ecx, __func___5600
4226845    mov     edx, 40Dh
4226850    mov     esi, aFtp_session_c
4226855    mov     edi, aFnameVoid0
4226860    call    _daemon_assert_fail
4226865    jmp     loc_407E3C
4226870    align 20h
loc_407F40:
4226880    mov     ecx, __func___5600
4226885    mov     edx, 40Eh
4226890    mov     esi, aFtp_session_c
4226895    mov     edi, 40B4DBh
4226900    call    _daemon_assert_fail
4226905    jmp     loc_407E45
4226910    align 20h
loc_407F60:
4226912    mov     ecx, __func___5600
4226917    mov     edx, 40Fh
4226922    mov     esi, aFtp_session_c
4226927    mov     edi, aFileVoid0
4226932    call    _daemon_assert_fail
USE32

section .text

global _do_retr

_do_retr:
4226944    push    r15
4226946    push    r14
4226948    push    r13
4226950    push    r12
4226952    mov     r12, rdi
4226955    push    rbp
4226956    push    rbx
4226957    mov     rbx, rsi
4226960    sub     rsp, 50E8h
4226967    mov     rax, [fs:28h]
4226976    mov     [rsp+50D8h], rax
4226984    xor     eax, eax
4226986    call    _invariant_0
4226991    test    eax, eax
4226993    jz      loc_4081B0
loc_407FB7:
4226999    test    rbx, rbx
4227002    jz      loc_408439
loc_407FC0:
4227008    cmp     dword [rbx+8], 1
4227012    jz      loc_407FDF
4227014    mov     ecx, __func___5623
4227019    mov     edx, 43Fh
4227024    mov     esi, aFtp_session_c
4227029    mov     edi, aCmdNum_arg1
4227034    call    _daemon_assert_fail
loc_407FDF:
4227039    lea     rdx, [rbx+10h]
4227043    lea     rsi, [r12+0A0h]
4227051    lea     rdi, [rsp+30D0h]
4227059    call    _get_absolute_fname_constprop_11
4227064    lea     rdi, [rsp+30D0h]
4227072    xor     esi, esi
4227074    xor     eax, eax
4227076    call    _open
4227081    cmp     eax, 0FFFFFFFFh
4227084    mov     r13d, eax
4227087    jz      loc_4081D0
4227093    lea     rdx, [rsp+40h]
4227098    mov     esi, eax
4227100    mov     edi, 1
4227105    call    ___fxstat
4227110    test    eax, eax
4227112    jnz     loc_408208
4227118    mov     eax, [rsp+58h]
4227122    and     eax, 0F000h
4227127    cmp     eax, 4000h
4227132    jz      loc_408305
4227138    mov     rax, [r12+8]
4227143    sub     rax, 1
4227147    cmp     [r12+20h], rax
4227152    jnz     loc_408070
4227154    mov     rsi, [r12+18h]
4227159    test    rsi, rsi
4227162    jle     loc_408070
4227164    xor     edx, edx
4227166    mov     edi, r13d
4227169    call    _lseek
4227174    cmp     rax, 0FFFFFFFFFFFFFFFFh
4227178    jz      loc_408129
loc_408070:
4227184    mov     edx, aAboutToOpenDat
4227189    xor     eax, eax
4227191    mov     esi, 96h
4227196    mov     rdi, r12
4227199    call    _reply
4227204    lea     rdi, [rsp+20h]
4227209    xor     esi, esi
4227211    call    _gettimeofday
4227216    mov     rdi, r12
4227219    call    _open_connection
4227224    cmp     eax, 0FFFFFFFFh
4227227    mov     ebp, eax
4227229    jz      loc_408150
4227235    mov     eax, [r12+10h]
4227240    test    eax, eax
4227242    jnz     loc_408230
4227248    xor     r14d, r14d
4227251    nop     dword [rax+rax+00h]
loc_4080B8:
4227256    lea     rsi, [rsp+0D0h]
4227264    mov     edx, 1000h
4227269    mov     edi, r13d
4227272    call    _read
4227277    cmp     eax, 0FFFFFFFFh
4227280    mov     esi, eax
4227282    jz      loc_408457
4227288    cmp     eax, 0
4227291    jz      loc_408392
4227297    jle     loc_40838B
4227303    xor     edx, edx
4227305    xor     eax, eax
4227307    jmp     loc_40810C
4227309    align 10h
loc_4080F0:
4227312    add     rdx, 1
4227316    lea     r15d, [rax+1]
4227320    cdqe    
4227322    cmp     esi, edx
4227324    mov     [rsp+rax+10D0h], cl
4227331    jle     loc_408320
4227337    mov     eax, r15d
loc_40810C:
4227340    movzx   ecx, byte [rsp+rdx+0D0h]
4227348    cmp     cl, 0Ah
4227351    jnz     loc_4080F0
4227353    movsxd  rdi, eax
4227356    add     eax, 1
4227359    mov     byte [rsp+rdi+10D0h], 0Dh
4227367    jmp     loc_4080F0
loc_408129:
4227369    call    ___errno_location
4227374    mov     edi, [rax]
4227376    call    _strerror
4227381    mov     edx, aErrorSeekingTo
4227386    mov     rcx, rax
4227389    mov     esi, 226h
4227394    mov     rdi, r12
4227397    xor     eax, eax
4227399    call    _reply
4227404    nop     dword [rax+00h]
loc_408150:
4227408    mov     qword [r12+18h], 0
loc_408159:
4227417    mov     edi, r13d
4227420    call    _close
loc_408161:
4227425    mov     rdi, r12
4227428    call    _invariant_0
4227433    test    eax, eax
4227435    jnz     loc_408186
4227437    mov     ecx, __func___5623
4227442    mov     edx, 4F0h
4227447    mov     esi, aFtp_session_c
4227452    mov     edi, aInvariantF
4227457    call    _daemon_assert_fail
loc_408186:
4227462    mov     rax, [rsp+50D8h]
4227470    xor     rax, [fs:28h]
4227479    jnz     loc_408481
4227485    add     rsp, 50E8h
4227492    pop     rbx
4227493    pop     rbp
4227494    pop     r12
4227496    pop     r13
4227498    pop     r14
4227500    pop     r15
4227502    retn    
4227503    align 10h
loc_4081B0:
4227504    mov     ecx, __func___5623
4227509    mov     edx, 43Dh
4227514    mov     esi, aFtp_session_c
4227519    mov     edi, aInvariantF
4227524    call    _daemon_assert_fail
4227529    jmp     loc_407FB7
4227534    align 10h
loc_4081D0:
4227536    call    ___errno_location
4227541    mov     edi, [rax]
4227543    call    _strerror
4227548    mov     edx, aErrorOpeningFi
4227553    mov     rcx, rax
4227556    mov     esi, 226h
4227561    mov     rdi, r12
4227564    xor     eax, eax
4227566    call    _reply
4227571    mov     qword [r12+18h], 0
4227580    jmp     loc_408161
4227585    align 8 
loc_408208:
4227592    call    ___errno_location
4227597    mov     edi, [rax]
4227599    call    _strerror
4227604    mov     edx, aErrorGettingFi
4227609    mov     rcx, rax
4227612    mov     esi, 226h
4227617    mov     rdi, r12
4227620    xor     eax, eax
4227622    call    _reply
4227627    jmp     loc_408150
loc_408230:
4227632    cmp     eax, 1
4227635    jz      loc_40824E
4227637    mov     ecx, __func___5623
4227642    mov     edx, 48Bh
4227647    mov     esi, aFtp_session_c
4227652    mov     edi, aFData_type1
4227657    call    _daemon_assert_fail
loc_40824E:
4227662    mov     rax, [rsp+70h]
4227667    mov     rdx, [r12+18h]
4227672    mov     r14, rax
4227675    mov     [rsp+18h], rdx
4227680    sub     r14, rdx
4227683    cmp     rdx, rax
4227686    jge     loc_408392
4227692    mov     ebx, 10000h
4227697    jmp     loc_408298
4227699    align 8 
loc_408278:
4227704    mov     rdi, [r12+10C0h]
4227712    call    _watchdog_defer_watched
4227717    mov     rax, [rsp+70h]
4227722    mov     rdx, [rsp+18h]
4227727    cmp     rax, rdx
4227730    jle     loc_408392
loc_408298:
4227736    sub     rax, rdx
4227739    lea     rdx, [rsp+18h]
4227744    mov     esi, r13d
4227747    cmp     rax, 10000h
4227753    mov     edi, ebp
4227755    cmovg   rax, rbx
4227759    mov     r15, rax
4227762    mov     rcx, rax
4227765    xor     eax, eax
4227767    call    _sendfile
4227772    cdqe    
4227774    cmp     rax, r15
4227777    jz      loc_408278
4227779    call    ___errno_location
4227784    mov     edi, [rax]
4227786    call    _strerror
4227791    mov     edx, aErrorSending_0
4227796    mov     rcx, rax
4227799    mov     esi, 226h
4227804    mov     rdi, r12
4227807    xor     eax, eax
4227809    call    _reply
4227814    nop     word [rax+rax+00000000h]
loc_4082F0:
4227824    mov     qword [r12+18h], 0
4227833    mov     edi, ebp
4227835    call    _close
4227840    jmp     loc_408159
loc_408305:
4227845    mov     edx, aErrorFileIsADi
4227850    mov     esi, 226h
4227855    mov     rdi, r12
4227858    xor     eax, eax
4227860    call    _reply
4227865    jmp     loc_408150
4227870    align 20h
loc_408320:
4227872    xor     ebx, ebx
4227874    jmp     loc_40832F
4227876    align 8 
loc_408328:
4227880    add     ebx, eax
4227882    cmp     ebx, r15d
4227885    jge     loc_408380
loc_40832F:
4227887    lea     rax, [rsp+10D0h]
4227895    mov     edx, r15d
4227898    movsxd  rsi, ebx
4227901    sub     edx, ebx
4227903    mov     edi, ebp
4227905    add     rsi, rax
4227908    movsxd  rdx, edx
4227911    call    _write
4227916    test    eax, eax
4227918    jg      loc_408328
4227920    call    ___errno_location
4227925    mov     edi, [rax]
4227927    call    _strerror
4227932    mov     edx, aErrorWritingTo
4227937    mov     rcx, rax
4227940    mov     esi, 226h
4227945    mov     rdi, r12
4227948    xor     eax, eax
4227950    call    _reply
4227955    jmp     loc_4082F0
4227960    align 20h
loc_408380:
4227968    movsxd  r15, r15d
loc_408383:
4227971    add     r14, r15
4227974    jmp     loc_4080B8
loc_40838B:
4227979    xor     r15d, r15d
4227982    xchg    ax, ax
4227984    jmp     loc_408383
loc_408392:
4227986    mov     edi, ebp
4227988    call    _close
4227993    xor     eax, eax
4227995    mov     edx, aFileTransferCo
4228000    mov     esi, 0E2h
4228005    mov     rdi, r12
4228008    call    _reply
4228013    lea     rdi, [rsp+30h]
4228018    xor     esi, esi
4228020    call    _gettimeofday
4228025    mov     rax, [rsp+38h]
4228030    sub     rax, [rsp+28h]
4228035    mov     r9, [rsp+30h]
4228040    sub     r9, [rsp+20h]
4228045    cmp     rax, 0F423Fh
4228051    jle     loc_4083F5
4228053    lea     rdx, [r9+1]
4228057    nop     dword [rax+00000000h]
loc_4083E0:
4228064    sub     rax, 0F4240h
4228070    mov     r9, rdx
4228073    add     rdx, 1
4228077    cmp     rax, 0F423Fh
4228083    jg      loc_4083E0
loc_4083F5:
4228085    test    rax, rax
4228088    jns     loc_40840F
4228090    lea     rdx, [r9-1]
4228094    xchg    ax, ax
loc_408400:
4228096    mov     r9, rdx
4228099    sub     rdx, 1
4228103    add     rax, 0F4240h
4228109    js      loc_408400
loc_40840F:
4228111    lea     rdx, [r12+3Ch]
4228116    lea     rcx, [rsp+30D0h]
4228124    mov     [rsp], rax
4228128    mov     r8, r14
4228131    mov     esi, aSRetrievedSLdB
4228136    mov     edi, 6
4228141    xor     eax, eax
4228143    call    _syslog
4228148    jmp     loc_408150
loc_408439:
4228153    mov     ecx, __func___5623
4228158    mov     edx, 43Eh
4228163    mov     esi, aFtp_session_c
4228168    mov     edi, aCmdVoid0
4228173    call    _daemon_assert_fail
4228178    jmp     loc_407FC0
loc_408457:
4228183    call    ___errno_location
4228188    mov     edi, [rax]
4228190    xchg    ax, ax
4228192    call    _strerror
4228197    mov     edx, aErrorReadingFr
4228202    mov     rcx, rax
4228205    mov     esi, 226h
4228210    mov     rdi, r12
4228213    xor     eax, eax
4228215    call    _reply
4228220    jmp     loc_4082F0
loc_408481:
4228225    call    ___stack_chk_fail
USE32

section .text

global _do_size

_do_size:
4228240    push    rbp
4228241    mov     rbp, rsi
4228244    push    rbx
4228245    mov     rbx, rdi
4228248    sub     rsp, 20A8h
4228255    mov     rax, [fs:28h]
4228264    mov     [rsp+2098h], rax
4228272    xor     eax, eax
4228274    call    _invariant_0
4228279    test    eax, eax
4228281    jz      loc_408570
loc_4084BF:
4228287    test    rbp, rbp
4228290    jz      loc_408620
loc_4084C8:
4228296    cmp     dword [rbp+8], 1
4228300    jz      loc_4084E7
4228302    mov     ecx, __func___5736
4228307    mov     edx, 658h
4228312    mov     esi, aFtp_session_c
4228317    mov     edi, aCmdNum_arg1
4228322    call    _daemon_assert_fail
loc_4084E7:
4228327    cmp     dword [rbx+10h], 1
4228331    jz      loc_408550
4228333    mov     edx, aSizeCannotBeDe
4228338    mov     esi, 226h
4228343    mov     rdi, rbx
4228346    xor     eax, eax
4228348    call    _reply
loc_408501:
4228353    mov     rdi, rbx
4228356    call    _invariant_0
4228361    test    eax, eax
4228363    jnz     loc_408526
4228365    mov     ecx, __func___5736
4228370    mov     edx, 67Ah
4228375    mov     esi, aFtp_session_c
4228380    mov     edi, aInvariantF
4228385    call    _daemon_assert_fail
loc_408526:
4228390    mov     rax, [rsp+2098h]
4228398    xor     rax, [fs:28h]
4228407    jnz     loc_408659
4228413    add     rsp, 20A8h
4228420    pop     rbx
4228421    pop     rbp
4228422    retn    
4228423    align 10h
loc_408550:
4228432    mov     eax, [rbx+14h]
4228435    test    eax, eax
4228437    jz      loc_408590
4228439    mov     edx, aSizeCannotBe_0
4228444    mov     esi, 226h
4228449    mov     rdi, rbx
4228452    xor     eax, eax
4228454    call    _reply
4228459    jmp     loc_408501
4228461    align 10h
loc_408570:
4228464    mov     ecx, __func___5736
4228469    mov     edx, 656h
4228474    mov     esi, aFtp_session_c
4228479    mov     edi, aInvariantF
4228484    call    _daemon_assert_fail
4228489    jmp     loc_4084BF
4228494    align 10h
loc_408590:
4228496    lea     rdx, [rbp+10h]
4228500    lea     rsi, [rbx+0A0h]
4228507    lea     rdi, [rsp+90h]
4228515    call    _get_absolute_fname_constprop_11
4228520    lea     rsi, [rsp+90h]
4228528    mov     rdx, rsp
4228531    mov     edi, 1
4228536    call    ___xstat
4228541    test    eax, eax
4228543    jnz     loc_4085F0
4228545    mov     eax, [rsp+18h]
4228549    and     eax, 0F000h
4228554    cmp     eax, 4000h
4228559    jz      loc_408640
4228561    mov     rcx, [rsp+30h]
4228566    mov     edx, aLlu
4228571    mov     esi, 0D5h
4228576    mov     rdi, rbx
4228579    xor     eax, eax
4228581    call    _reply
4228586    jmp     loc_408501
4228591    align 10h
loc_4085F0:
4228592    call    ___errno_location
4228597    mov     edi, [rax]
4228599    call    _strerror
4228604    mov     edx, aErrorGetting_0
4228609    mov     rcx, rax
4228612    mov     esi, 226h
4228617    mov     rdi, rbx
4228620    xor     eax, eax
4228622    call    _reply
4228627    jmp     loc_408501
4228632    align 20h
loc_408620:
4228640    mov     ecx, __func___5736
4228645    mov     edx, 657h
4228650    mov     esi, aFtp_session_c
4228655    mov     edi, aCmdVoid0
4228660    call    _daemon_assert_fail
4228665    jmp     loc_4084C8
4228670    align 20h
loc_408640:
4228672    mov     edx, aFileIsADirecto
4228677    mov     esi, 226h
4228682    mov     rdi, rbx
4228685    xor     eax, eax
4228687    call    _reply
4228692    jmp     loc_408501
loc_408659:
4228697    call    ___stack_chk_fail
USE32

section .text

global _do_mdtm

_do_mdtm:
4228704    push    rbp
4228705    mov     rbp, rsi
4228708    push    rbx
4228709    mov     rbx, rdi
4228712    sub     rsp, 20F8h
4228719    mov     rax, [fs:28h]
4228728    mov     [rsp+20E8h], rax
4228736    xor     eax, eax
4228738    call    _invariant_0
4228743    test    eax, eax
4228745    jz      loc_4087A0
loc_40868F:
4228751    test    rbp, rbp
4228754    jz      loc_4087C0
loc_408698:
4228760    cmp     dword [rbp+8], 1
4228764    jz      loc_4086B7
4228766    mov     ecx, __func___5746
4228771    mov     edx, 694h
4228776    mov     esi, aFtp_session_c
4228781    mov     edi, aCmdNum_arg1
4228786    call    _daemon_assert_fail
loc_4086B7:
4228791    lea     rdx, [rbp+10h]
4228795    lea     rsi, [rbx+0A0h]
4228802    lea     rdi, [rsp+0E0h]
4228810    call    _get_absolute_fname_constprop_11
4228815    lea     rdx, [rsp+40h]
4228820    lea     rsi, [rsp+0E0h]
4228828    mov     edi, 1
4228833    call    ___xstat
4228838    test    eax, eax
4228840    jz      loc_408758
4228842    call    ___errno_location
4228847    mov     edi, [rax]
4228849    call    _strerror
4228854    mov     edx, aErrorGetting_0
4228859    mov     rcx, rax
4228862    mov     esi, 226h
4228867    mov     rdi, rbx
4228870    xor     eax, eax
4228872    call    _reply
loc_40870D:
4228877    mov     rdi, rbx
4228880    call    _invariant_0
4228885    test    eax, eax
4228887    jnz     loc_408732
4228889    mov     ecx, __func___5746
4228894    mov     edx, 6A3h
4228899    mov     esi, aFtp_session_c
4228904    mov     edi, aInvariantF
4228909    call    _daemon_assert_fail
loc_408732:
4228914    mov     rax, [rsp+20E8h]
4228922    xor     rax, [fs:28h]
4228931    jnz     loc_4087DE
4228937    add     rsp, 20F8h
4228944    pop     rbx
4228945    pop     rbp
4228946    retn    
4228947    align 8 
loc_408758:
4228952    lea     rdi, [rsp+98h]
4228960    mov     rsi, rsp
4228963    call    _gmtime_r
4228968    lea     rdi, [rsp+0D0h]
4228976    mov     rcx, rsp
4228979    mov     edx, aYMDHMS
4228984    mov     esi, 10h
4228989    call    _strftime
4228994    lea     rdx, [rsp+0D0h]
4229002    mov     esi, 0D5h
4229007    mov     rdi, rbx
4229010    xor     eax, eax
4229012    call    _reply
4229017    jmp     loc_40870D
4229022    align 20h
loc_4087A0:
4229024    mov     ecx, __func___5746
4229029    mov     edx, 692h
4229034    mov     esi, aFtp_session_c
4229039    mov     edi, aInvariantF
4229044    call    _daemon_assert_fail
4229049    jmp     loc_40868F
4229054    align 20h
loc_4087C0:
4229056    mov     ecx, __func___5746
4229061    mov     edx, 693h
4229066    mov     esi, aFtp_session_c
4229071    mov     edi, aCmdVoid0
4229076    call    _daemon_assert_fail
4229081    jmp     loc_408698
loc_4087DE:
4229086    call    ___stack_chk_fail
USE32

section .text

global _ftp_session_init

_ftp_session_init:
4229104    push    r15
4229106    mov     r15, r9
4229109    push    r14
4229111    mov     r14, rdx
4229114    push    r13
4229116    mov     r13, rsi
4229119    push    r12
4229121    mov     r12, rcx
4229124    push    rbp
4229125    mov     rbp, r8
4229128    push    rbx
4229129    mov     rbx, rdi
4229132    sub     rsp, 18h
4229136    test    rdi, rdi
4229139    jz      loc_408A00
loc_408819:
4229145    test    r13, r13
4229148    jz      loc_408A20
loc_408822:
4229154    test    r14, r14
4229157    jz      loc_408A40
loc_40882B:
4229163    test    r12, r12
4229166    xchg    ax, ax
4229168    jz      loc_408A60
loc_408836:
4229174    test    rbp, rbp
4229177    jz      loc_408A80
loc_40883F:
4229183    mov     rdi, rbp
4229186    call    _strlen
4229191    cmp     rax, 1000h
4229197    ja      loc_4089C0
loc_408853:
4229203    test    r15, r15
4229206    jz      loc_4089E0
loc_40885C:
4229212    mov     rdx, [r14+8]
4229216    mov     rax, [r14]
4229219    lea     rdi, [rbx+3Ch]
4229223    mov     qword [rbx+8], 0
4229231    mov     dword [rbx+10h], 0
4229238    mov     dword [rbx+14h], 0
4229245    mov     qword [rbx+18h], 0
4229253    mov     [rbx+88h], rax
4229260    mov     [rbx+90h], rdx
4229267    mov     qword [rbx+20h], 0FFFFFFFFFFFFFFFFh
4229275    mov     dword [rbx+28h], 0
4229282    mov     dword [rbx], 1
4229288    mov     rax, [r13+0]
4229292    mov     rdx, [r13+8]
4229296    mov     [rbx+2Ch], rax
4229300    mov     eax, [r13+4]
4229304    mov     [rbx+34h], rdx
4229308    movzx   edx, word [r13+2]
4229313    ror     dx, 8
4229317    bswap   eax
4229319    movzx   edx, dx
4229322    mov     r8d, eax
4229325    movzx   esi, ah
4229328    mov     ecx, eax
4229330    shr     r8d, 10h
4229334    movzx   eax, al
4229337    mov     r9d, esi
4229340    shr     ecx, 18h
4229343    mov     [rsp+8], edx
4229347    mov     [rsp], eax
4229350    movzx   r8d, r8b
4229354    mov     edx, aD_D_D_DPortD
4229359    mov     esi, 3Ah
4229364    xor     eax, eax
4229366    call    _snprintf
4229371    mov     rax, [r14]
4229374    mov     rdx, [r14+8]
4229378    mov     rdi, rbp
4229381    mov     [rbx+98h], r12
4229388    mov     [rbx+78h], rax
4229392    mov     [rbx+80h], rdx
4229399    call    _strlen
4229404    cmp     rax, 1000h
4229410    ja      loc_4089A0
loc_408924:
4229412    lea     rdi, [rbx+0A0h]
4229419    mov     rsi, rbp
4229422    call    _strcpy
4229427    mov     dword [rbx+10A4h], 0
4229437    mov     rax, [r13+0]
4229441    mov     rdi, rbx
4229444    mov     rdx, [r13+8]
4229448    mov     dword [rbx+10B8h], 0FFFFFFFFh
4229458    mov     [rbx+10A8h], rax
4229465    mov     [rbx+10B0h], rdx
4229472    call    _invariant_0
4229477    test    eax, eax
4229479    jnz     loc_408982
4229481    mov     ecx, __func___5361
4229486    mov     edx, 0C6h
4229491    mov     esi, aFtp_session_c
4229496    mov     edi, aInvariantF
4229501    call    _daemon_assert_fail
loc_408982:
4229506    add     rsp, 18h
4229510    mov     eax, 1
4229515    pop     rbx
4229516    pop     rbp
4229517    pop     r12
4229519    pop     r13
4229521    pop     r14
4229523    pop     r15
4229525    retn    
4229526    align 20h
loc_4089A0:
4229536    mov     ecx, __func___5361
4229541    mov     edx, 0BFh
4229546    mov     esi, aFtp_session_c
4229551    mov     edi, aStrlenDirSizeo
4229556    call    _daemon_assert_fail
4229561    jmp     loc_408924
4229566    align 20h
loc_4089C0:
4229568    mov     ecx, __func___5361
4229573    mov     edx, 89h
4229578    mov     esi, aFtp_session_c
4229583    mov     edi, aStrlenDir4096
4229588    call    _daemon_assert_fail
4229593    jmp     loc_408853
4229598    align 20h
loc_4089E0:
4229600    mov     ecx, __func___5361
4229605    mov     edx, 8Ah
4229610    mov     esi, aFtp_session_c
4229615    mov     edi, aErrVoid0
4229620    call    _daemon_assert_fail
4229625    jmp     loc_40885C
4229630    align 20h
loc_408A00:
4229632    mov     ecx, __func___5361
4229637    mov     edx, 84h
4229642    mov     esi, aFtp_session_c
4229647    mov     edi, aFVoid0
4229652    call    _daemon_assert_fail
4229657    jmp     loc_408819
4229662    align 20h
loc_408A20:
4229664    mov     ecx, __func___5361
4229669    mov     edx, 85h
4229674    mov     esi, aFtp_session_c
4229679    mov     edi, aClient_addrVoi
4229684    call    _daemon_assert_fail
4229689    jmp     loc_408822
4229694    align 20h
loc_408A40:
4229696    mov     ecx, __func___5361
4229701    mov     edx, 86h
4229706    mov     esi, aFtp_session_c
4229711    mov     edi, aServer_addrVoi
4229716    call    _daemon_assert_fail
4229721    jmp     loc_40882B
4229726    align 20h
loc_408A60:
4229728    mov     ecx, __func___5361
4229733    mov     edx, 87h
4229738    mov     esi, aFtp_session_c
4229743    mov     edi, 40CD39h
4229748    call    _daemon_assert_fail
4229753    jmp     loc_408836
4229758    align 20h
loc_408A80:
4229760    mov     ecx, __func___5361
4229765    mov     edx, 88h
4229770    mov     esi, aFtp_session_c
4229775    mov     edi, 40B4DBh
4229780    call    _daemon_assert_fail
USE32

section .text

global _ftp_session_drop

_ftp_session_drop:
4229792    push    rbp
4229793    mov     rbp, rsi
4229796    push    rbx
4229797    mov     rbx, rdi
4229800    sub     rsp, 8
4229804    call    _invariant_0
4229809    test    eax, eax
4229811    jz      loc_408B10
loc_408AB5:
4229813    test    rbp, rbp
4229816    jz      loc_408B30
loc_408ABA:
4229818    xor     eax, eax
4229820    mov     rcx, rbp
4229823    mov     edx, (offset aErrorSending_0+14h)
4229828    mov     esi, 1A5h
4229833    mov     rdi, rbx
4229836    call    _reply
4229841    mov     rdi, rbx
4229844    call    _invariant_0
4229849    test    eax, eax
4229851    jz      loc_408AE8
4229853    add     rsp, 8
4229857    pop     rbx
4229858    pop     rbp
4229859    retn    
4229860    align 8 
loc_408AE8:
4229864    add     rsp, 8
4229868    mov     ecx, __func___5366
4229873    mov     edx, 0D3h
4229878    pop     rbx
4229879    pop     rbp
4229880    mov     esi, aFtp_session_c
4229885    mov     edi, aInvariantF
4229890    jmp     daemon_assert_fail
4229895    align 10h
loc_408B10:
4229904    mov     ecx, __func___5366
4229909    mov     edx, 0CDh
4229914    mov     esi, aFtp_session_c
4229919    mov     edi, aInvariantF
4229924    call    _daemon_assert_fail
4229929    jmp     loc_408AB5
4229931    align 10h
loc_408B30:
4229936    mov     ecx, __func___5366
4229941    mov     edx, 0CEh
4229946    mov     esi, aFtp_session_c
4229951    mov     edi, aReasonVoid0
4229956    call    _daemon_assert_fail
USE32

section .text

global _ftp_session_run

_ftp_session_run:
4229968    push    r14
4229970    push    r13
4229972    push    r12
4229974    push    rbp
4229975    mov     rbp, rdi
4229978    push    rbx
4229979    mov     rbx, rsi
4229982    sub     rsp, 2830h
4229989    mov     rax, [fs:28h]
4229998    mov     [rsp+2828h], rax
4230006    xor     eax, eax
4230008    call    _invariant_0
4230013    test    eax, eax
4230015    jz      loc_408DF0
loc_408B85:
4230021    test    rbx, rbx
4230024    jz      loc_408E0E
loc_408B8E:
4230030    mov     [rbp+10C0h], rbx
4230037    mov     esi, 0DCh
4230042    mov     rdi, rbp
4230045    lea     r12, [rbp+3Ch]
4230049    mov     rbx, rsp
4230052    call    _send_readme
4230057    mov     edx, aServiceReadyFo
4230062    mov     esi, 0DCh
4230067    mov     rdi, rbp
4230070    xor     eax, eax
4230072    call    _reply
4230077    nop     dword [rax]
loc_408BC0:
4230080    mov     eax, [rbp+0]
4230083    test    eax, eax
4230085    jz      loc_408CE0
loc_408BCB:
4230091    mov     rdi, [rbp+98h]
4230098    mov     edx, 800h
4230103    mov     rsi, rbx
4230106    call    _telnet_session_readln
4230111    test    eax, eax
4230113    jz      loc_408CE0
4230119    mov     rdi, [rbp+10C0h]
4230126    call    _watchdog_defer_watched
4230131    mov     rax, [rbp+8]
4230135    cmp     rax, 0FFFFFFFFFFFFFFFFh
4230139    jz      loc_408D30
4230145    add     rax, 1
4230149    mov     [rbp+8], rax
loc_408C09:
4230153    mov     rdx, rbx
loc_408C0C:
4230156    mov     ecx, [rdx]
4230158    add     rdx, 4
4230162    lea     eax, [rcx-1010101h]
4230168    not     ecx
4230170    and     eax, ecx
4230172    and     eax, 80808080h
4230177    jz      loc_408C0C
4230179    mov     ecx, eax
4230181    shr     ecx, 10h
4230184    test    eax, 8080h
4230189    cmovz   eax, ecx
4230192    lea     rcx, [rdx+2]
4230196    cmovz   rdx, rcx
4230200    add     al, al
4230202    sbb     rdx, 3
4230206    sub     rdx, rbx
4230209    sub     edx, 1
4230212    movsxd  rdx, edx
4230215    cmp     byte [rsp+rdx], 0Ah
4230219    jz      loc_408D40
4230225    mov     edx, aCommandLineToo
4230230    mov     esi, 1F4h
4230235    mov     rdi, rbp
4230238    xor     eax, eax
4230240    call    _reply
4230245    nop     dword [rax]
loc_408C68:
4230248    mov     rdi, [rbp+98h]
4230255    mov     edx, 800h
4230260    mov     rsi, rbx
4230263    call    _telnet_session_readln
4230268    test    eax, eax
4230270    jz      loc_408BC0
4230276    mov     r8, rbx
loc_408C87:
4230279    mov     r9d, [r8]
4230282    add     r8, 4
4230286    lea     eax, [r9-1010101h]
4230293    not     r9d
4230296    and     eax, r9d
4230299    and     eax, 80808080h
4230304    jz      loc_408C87
4230306    mov     edx, eax
4230308    shr     edx, 10h
4230311    test    eax, 8080h
4230316    cmovz   eax, edx
4230319    lea     rdx, [r8+2]
4230323    cmovz   r8, rdx
4230327    add     al, al
4230329    sbb     r8, 3
4230333    sub     r8, rbx
4230336    sub     r8d, 1
4230340    movsxd  r8, r8d
4230343    cmp     byte [rsp+r8], 0Ah
4230348    jnz     loc_408C68
4230350    mov     eax, [rbp+0]
4230353    test    eax, eax
4230355    jnz     loc_408BCB
4230361    nop     dword [rax+00000000h]
loc_408CE0:
4230368    mov     rdi, rbp
4230371    call    _invariant_0
4230376    test    eax, eax
4230378    jnz     loc_408D05
4230380    mov     ecx, __func___5375
4230385    mov     edx, 119h
4230390    mov     esi, aFtp_session_c
4230395    mov     edi, aInvariantF
4230400    call    _daemon_assert_fail
loc_408D05:
4230405    mov     rax, [rsp+2828h]
4230413    xor     rax, [fs:28h]
4230422    jnz     loc_408E2C
4230428    add     rsp, 2830h
4230435    pop     rbx
4230436    pop     rbp
4230437    pop     r12
4230439    pop     r13
4230441    pop     r14
4230443    retn    
4230444    align 10h
loc_408D30:
4230448    mov     qword [rbp+8], 0
4230456    jmp     loc_408C09
4230461    align 20h
loc_408D40:
4230464    xor     eax, eax
4230466    mov     rcx, rbx
4230469    mov     rdx, r12
4230472    mov     esi, aSS
4230477    mov     edi, 7
4230482    xor     r13d, r13d
4230485    call    _syslog
4230490    lea     rsi, [rsp+800h]
4230498    mov     rdi, rbx
4230501    call    _ftp_command_parse
4230506    test    eax, eax
4230508    jnz     loc_408D7A
4230510    jmp     loc_408DD9
loc_408D70:
4230512    add     r13, 1
4230516    cmp     r13, 18h
4230520    jz      loc_408DC0
loc_408D7A:
4230522    mov     rax, r13
4230525    lea     rdi, [rsp+800h]
4230533    movsxd  r14, r13d
4230536    shl     rax, 4
4230540    mov     rsi, qword [command_func+rax]
4230547    call    _strcmp
4230552    test    eax, eax
4230554    jnz     loc_408D70
4230556    shl     r14, 4
4230560    lea     rsi, [rsp+800h]
4230568    mov     rdi, rbp
4230571    call    qword [r14+40C128h]
4230578    jmp     loc_408BC0
4230583    align 20h
loc_408DC0:
4230592    mov     edx, aCommandNotIm_0
4230597    mov     esi, 1F6h
4230602    mov     rdi, rbp
4230605    xor     eax, eax
4230607    call    _reply
4230612    jmp     loc_408BC0
loc_408DD9:
4230617    mov     edx, aSyntaxErrorCom
4230622    mov     esi, 1F4h
4230627    mov     rdi, rbp
4230630    call    _reply
4230635    jmp     loc_408BC0
loc_408DF0:
4230640    mov     ecx, __func___5375
4230645    mov     edx, 0DDh
4230650    mov     esi, aFtp_session_c
4230655    mov     edi, aInvariantF
4230660    call    _daemon_assert_fail
4230665    jmp     loc_408B85
loc_408E0E:
4230670    mov     ecx, __func___5375
4230675    mov     edx, 0DEh
4230680    mov     esi, aFtp_session_c
4230685    mov     edi, aWatchedVoid0
4230690    call    _daemon_assert_fail
4230695    jmp     loc_408B8E
loc_408E2C:
4230700    call    ___stack_chk_fail
USE32

section .text

global _ftp_session_destroy

_ftp_session_destroy:
4230720    push    rbx
4230721    mov     rbx, rdi
4230724    call    _invariant_0
4230729    test    eax, eax
4230731    jz      loc_408E70
loc_408E4D:
4230733    mov     edi, [rbx+10B8h]
4230739    cmp     edi, 0FFFFFFFFh
4230742    jz      loc_408E67
4230744    call    _close
4230749    mov     dword [rbx+10B8h], 0FFFFFFFFh
loc_408E67:
4230759    pop     rbx
4230760    retn    
4230761    align 10h
loc_408E70:
4230768    mov     ecx, __func___5398
4230773    mov     edx, 11Eh
4230778    mov     esi, aFtp_session_c
4230783    mov     edi, aInvariantF
4230788    call    _daemon_assert_fail
USE32

section .text

global _print_usage

_print_usage:
4230800    sub     rsp, 8
4230804    test    rdi, rdi
4230807    jz      loc_408EB6
4230809    mov     rcx, rdi
4230812    mov     rdx, [cs:exe_name]
4230819    mov     rdi, [cs:stderr@@GLIBC_2_2_5]
4230826    mov     esi, aSS_0
4230831    xor     eax, eax
4230833    call    _fprintf
loc_408EB6:
4230838    mov     rdx, [cs:exe_name]
4230845    mov     rdi, [cs:stderr@@GLIBC_2_2_5]
4230852    mov     esi, aSyntaxSOptions
4230857    xor     eax, eax
4230859    call    _fprintf
4230864    mov     rdi, [cs:stderr@@GLIBC_2_2_5]
4230871    mov     ecx, 0FAh
4230876    mov     edx, 15h
4230881    mov     esi, aOptionsPPortNu
4230886    xor     eax, eax
4230888    add     rsp, 8
4230892    jmp     _fprintf
USE32

section .text

global _max_input_read

_max_input_read:
4231040    push    rbp
4231041    mov     rbp, rdi
4231044    push    rbx
4231045    sub     rsp, 8
4231049    call    _invariant_1
4231054    test    eax, eax
4231056    jz      loc_408FF0
loc_408F92:
4231058    mov     edx, [rbp+814h]
4231064    xor     ebx, ebx
4231066    cmp     edx, 7FFh
4231072    jg      loc_408FA8
4231074    mov     bx, 800h
4231078    sub     ebx, edx
loc_408FA8:
4231080    mov     edx, [rbp+1030h]
4231086    xor     ebp, ebp
4231088    cmp     edx, 7FFh
4231094    jg      loc_408FBE
4231096    mov     bp, 800h
4231100    sub     ebp, edx
loc_408FBE:
4231102    test    eax, eax
4231104    jnz     loc_408FDB
4231106    mov     ecx, __func___3207
4231111    mov     edx, 1BFh
4231116    mov     esi, aTelnet_session
4231121    mov     edi, aInvariantT
4231126    call    _daemon_assert_fail
loc_408FDB:
4231131    cmp     ebp, ebx
4231133    mov     eax, ebx
4231135    cmovle  eax, ebp
4231138    add     rsp, 8
4231142    pop     rbx
4231143    pop     rbp
4231144    retn    
4231145    align 10h
loc_408FF0:
4231152    mov     ecx, __func___3207
4231157    mov     edx, 1AFh
4231162    mov     esi, aTelnet_session
4231167    mov     edi, aInvariantT
4231172    call    _daemon_assert_fail
USE32

section .text

global _add_outgoing_char

_add_outgoing_char:
4231200    push    rbp
4231201    mov     ebp, esi
4231203    push    rbx
4231204    mov     rbx, rdi
4231207    sub     rsp, 8
4231211    mov     eax, [rdi+82Ch]
4231217    test    eax, eax
4231219    js      loc_4090D0
loc_409039:
4231225    cmp     eax, 7FFh
4231230    jg      loc_409080
loc_409040:
4231232    movsxd  rdx, eax
4231235    add     eax, 1
4231238    mov     [rbx+rdx+830h], bpl
4231246    xor     edx, edx
4231248    cmp     eax, 800h
4231253    cmovz   eax, edx
4231256    mov     [rbx+82Ch], eax
4231262    mov     eax, [rbx+1030h]
4231268    cmp     eax, 800h
4231273    jz      loc_4090A8
4231275    add     eax, 1
4231278    mov     [rbx+1030h], eax
4231284    add     rsp, 8
4231288    pop     rbx
4231289    pop     rbp
4231290    retn    
4231291    align 20h
loc_409080:
4231296    mov     ecx, __func___3196
4231301    mov     edx, 173h
4231306    mov     esi, aTelnet_session
4231311    mov     edi, aTOut_add2048
4231316    call    _daemon_assert_fail
4231321    mov     eax, [rbx+82Ch]
4231327    jmp     loc_409040
4231329    align 8 
loc_4090A8:
4231336    mov     eax, [rbx+828h]
4231342    add     eax, 1
4231345    cmp     eax, 800h
4231350    cmovnz  edx, eax
4231353    mov     [rbx+828h], edx
4231359    add     rsp, 8
4231363    pop     rbx
4231364    pop     rbp
4231365    retn    
4231366    align 10h
loc_4090D0:
4231376    mov     ecx, __func___3196
4231381    mov     edx, 172h
4231386    mov     esi, aTelnet_session
4231391    mov     edi, aTOut_add0
4231396    call    _daemon_assert_fail
USE32

section .text

global _add_incoming_char

_add_incoming_char:
4231424    push    rbp
4231425    mov     ebp, esi
4231427    push    rbx
4231428    mov     rbx, rdi
4231431    sub     rsp, 8
4231435    mov     eax, [rdi+10h]
4231438    test    eax, eax
4231440    js      loc_409190
loc_409112:
4231442    cmp     eax, 7FFh
4231447    jg      loc_409150
loc_409119:
4231449    movsxd  rdx, eax
4231452    add     eax, 1
4231455    mov     [rbx+rdx+14h], bpl
4231460    xor     edx, edx
4231462    cmp     eax, 800h
4231467    cmovz   eax, edx
4231470    mov     [rbx+10h], eax
4231473    mov     eax, [rbx+814h]
4231479    cmp     eax, 800h
4231484    jz      loc_409170
4231486    add     eax, 1
4231489    mov     [rbx+814h], eax
4231495    add     rsp, 8
4231499    pop     rbx
4231500    pop     rbp
4231501    retn    
4231502    align 10h
loc_409150:
4231504    mov     ecx, __func___3186
4231509    mov     edx, 14Eh
4231514    mov     esi, aTelnet_session
4231519    mov     edi, aTIn_add2048
4231524    call    _daemon_assert_fail
4231529    mov     eax, [rbx+10h]
4231532    jmp     loc_409119
4231534    align 10h
loc_409170:
4231536    mov     eax, [rbx+0Ch]
4231539    add     eax, 1
4231542    cmp     eax, 800h
4231547    cmovnz  edx, eax
4231550    mov     [rbx+0Ch], edx
4231553    add     rsp, 8
4231557    pop     rbx
4231558    pop     rbp
4231559    retn    
4231560    align 10h
loc_409190:
4231568    mov     ecx, __func___3186
4231573    mov     edx, 14Dh
4231578    mov     esi, aTelnet_session
4231583    mov     edi, aTIn_add0
4231588    call    _daemon_assert_fail
USE32

section .text

global _process_data

_process_data:
4231616    push    r13
4231618    mov     r8d, 10h
4231624    mov     rcx, r8
4231627    push    r12
4231629    push    rbp
4231630    push    rbx
4231631    mov     rbx, rdi
4231634    sub     rsp, 9B8h
4231641    lea     rbp, [rsp+20h]
4231646    mov     rax, [fs:28h]
4231655    mov     [rsp+9A8h], rax
4231663    xor     eax, eax
4231665    mov     rdi, rbp
4231668    cld     
4231669    rep stosq
4231672    lea     rdx, [rsp+0A0h]
4231680    mov     rcx, r8
4231683    mov     rdi, rdx
4231686    cld     
4231687    rep stosq
4231690    lea     r12, [rsp+120h]
4231698    mov     rcx, r8
4231701    mov     rdi, r12
4231704    cld     
4231705    rep stosq
4231708    xor     r8b, r8b
4231711    test    esi, esi
4231713    jnz     loc_40923A
4231715    lea     r8, [rsp+10h]
4231720    mov     qword [rsp+10h], 0
4231729    mov     qword [rsp+18h], 0
loc_40923A:
4231738    mov     r9d, [rbx+4]
4231742    test    r9d, r9d
4231745    jnz     loc_40924E
4231747    mov     edi, [rbx+8]
4231750    test    edi, edi
4231752    jz      loc_409490
loc_40924E:
4231758    mov     esi, [rbx+820h]
4231764    test    esi, esi
4231766    jnz     loc_409266
4231768    mov     ecx, [rbx+824h]
4231774    test    ecx, ecx
4231776    jz      loc_4093A0
loc_409266:
4231782    mov     rcx, r12
4231785    mov     rsi, rbp
4231788    mov     edi, 400h
4231793    call    _select
4231798    test    eax, eax
4231800    jle     loc_4092F9
4231802    mov     ecx, [rbx]
4231804    lea     edx, [rcx+3Fh]
4231807    test    ecx, ecx
4231809    mov     eax, ecx
4231811    cmovns  edx, ecx
4231814    sar     eax, 1Fh
4231817    shr     eax, 1Ah
4231820    sar     edx, 6
4231823    add     ecx, eax
4231825    movsxd  rdx, edx
4231828    and     ecx, 3Fh
4231831    sub     ecx, eax
4231833    mov     eax, 1
4231838    shl     rax, cl
4231841    test    [rsp+rdx*8+120h], rax
4231849    jz      loc_409320
loc_4092AB:
4231851    mov     dword [rbx+8], 1
loc_4092B2:
4231858    mov     ecx, [rbx+81Ch]
4231864    lea     edx, [rcx+3Fh]
4231867    test    ecx, ecx
4231869    mov     eax, ecx
4231871    cmovns  edx, ecx
4231874    sar     eax, 1Fh
4231877    shr     eax, 1Ah
4231880    sar     edx, 6
4231883    add     ecx, eax
4231885    movsxd  rdx, edx
4231888    and     ecx, 3Fh
4231891    sub     ecx, eax
4231893    mov     eax, 1
4231898    shl     rax, cl
4231901    test    [rsp+rdx*8+120h], rax
4231909    jnz     loc_4093F0
4231915    test    [rsp+rdx*8+0A0h], rax
4231923    jnz     loc_409400
loc_4092F9:
4231929    mov     rax, [rsp+9A8h]
4231937    xor     rax, [fs:28h]
4231946    jnz     loc_4097AD
4231952    add     rsp, 9B8h
4231959    pop     rbx
4231960    pop     rbp
4231961    pop     r12
4231963    pop     r13
4231965    retn    
4231966    align 20h
loc_409320:
4231968    test    [rsp+rdx*8+20h], rax
4231973    jz      loc_4092B2
4231975    mov     rdi, rbx
4231978    call    _max_input_read
4231983    cmp     eax, 800h
4231988    jg      loc_40967A
loc_40933A:
4231994    mov     rdi, rbx
4231997    call    _max_input_read
4232002    mov     edi, [rbx]
4232004    lea     rsi, [rsp+1A0h]
4232012    movsxd  rdx, eax
4232015    call    _read
4232020    cmp     rax, 0FFFFFFFFFFFFFFFFh
4232024    jz      loc_409707
4232030    lea     rbp, [rsp+1A0h]
4232038    test    rax, rax
4232041    lea     r13, [rbp+rax+0]
4232046    jz      loc_4092AB
4232052    nop     dword [rax+00h]
loc_409378:
4232056    movzx   eax, byte [rbp+0]
4232060    cmp     dword [rbx+818h], 6
4232067    movzx   r12d, al
4232071    ja      loc_40951F
4232077    mov     edx, [rbx+818h]
4232083    jmp     off_40CA30[rdx*8]
4232090    align 20h
loc_4093A0:
4232096    mov     eax, [rbx+1030h]
4232102    test    eax, eax
4232104    jle     loc_409266
4232110    mov     ecx, [rbx+81Ch]
4232116    lea     esi, [rcx+3Fh]
4232119    test    ecx, ecx
4232121    mov     eax, ecx
4232123    cmovns  esi, ecx
4232126    sar     eax, 1Fh
4232129    shr     eax, 1Ah
4232132    sar     esi, 6
4232135    add     ecx, eax
4232137    and     ecx, 3Fh
4232140    sub     ecx, eax
4232142    mov     eax, 1
4232147    shl     rax, cl
4232150    movsxd  rcx, esi
4232153    or      [rsp+rcx*8+0A0h], rax
4232161    or      [rsp+rcx*8+120h], rax
4232169    jmp     loc_409266
4232174    align 10h
loc_4093F0:
4232176    mov     dword [rbx+824h], 1
4232186    jmp     loc_4092F9
4232191    align 20h
loc_409400:
4232192    movsxd  rax, dword [rbx+828h]
4232199    cmp     eax, [rbx+82Ch]
4232205    jge     loc_409640
4232211    test    eax, eax
4232213    js      loc_409760
loc_40941B:
4232219    cmp     eax, 7FFh
4232224    jg      loc_4096E9
loc_409426:
4232230    movsxd  rdx, dword [rbx+1030h]
4232237    test    edx, edx
4232239    jle     loc_409716
loc_409435:
4232245    movsxd  rax, dword [rbx+828h]
4232252    lea     ecx, [rax+rdx]
4232255    cmp     ecx, 800h
4232261    jg      loc_409698
loc_40944B:
4232267    mov     edi, [rbx+81Ch]
4232273    lea     rsi, [rbx+rax+830h]
4232281    call    _write
4232286    cmp     rax, 0FFFFFFFFFFFFFFFFh
4232290    jz      loc_409668
4232296    test    rax, rax
4232299    jz      loc_4093F0
4232301    sub     [rbx+1030h], eax
4232307    add     eax, [rbx+828h]
4232313    cmp     eax, 7FFh
4232318    jle     loc_409485
4232320    sub     eax, 800h
loc_409485:
4232325    mov     [rbx+828h], eax
4232331    jmp     loc_4092F9
loc_409490:
4232336    mov     rdi, rbx
4232339    mov     [rsp+8], rdx
4232344    mov     [rsp], r8
4232348    call    _max_input_read
4232353    test    eax, eax
4232355    mov     r8, [rsp]
4232359    mov     rdx, [rsp+8]
4232364    jle     loc_40924E
4232370    mov     ecx, [rbx]
4232372    lea     esi, [rcx+3Fh]
4232375    test    ecx, ecx
4232377    mov     eax, ecx
4232379    cmovns  esi, ecx
4232382    sar     eax, 1Fh
4232385    shr     eax, 1Ah
4232388    sar     esi, 6
4232391    add     ecx, eax
4232393    and     ecx, 3Fh
4232396    sub     ecx, eax
4232398    mov     eax, 1
4232403    shl     rax, cl
4232406    movsxd  rcx, esi
4232409    or      [rsp+rcx*8+20h], rax
4232414    or      [rsp+rcx*8+120h], rax
4232422    jmp     loc_40924E
4232427    align 10h
loc_4094F0:
4232432    mov     esi, 0FFh
4232437    mov     rdi, rbx
4232440    call    _add_outgoing_char
4232445    mov     esi, 0FEh
loc_409502:
4232450    mov     rdi, rbx
4232453    call    _add_outgoing_char
4232458    mov     esi, r12d
4232461    mov     rdi, rbx
4232464    call    _add_outgoing_char
loc_409515:
4232469    mov     dword [rbx+818h], 0
loc_40951F:
4232479    add     rbp, 1
4232483    cmp     rbp, r13
4232486    jnz     loc_409378
4232492    jmp     loc_4092B2
4232497    align 8 
loc_409538:
4232504    add     eax, 5
4232507    cmp     al, 4
4232509    ja      loc_409515
4232511    movzx   eax, al
4232514    jmp     off_40CA68[rax*8]
4232521    align 10h
loc_409550:
4232528    mov     esi, 0FFh
4232533    mov     rdi, rbx
4232536    call    _add_outgoing_char
4232541    mov     esi, 0FCh
4232546    jmp     loc_409502
4232548    align 8 
loc_409568:
4232552    cmp     r12d, 0FFh
4232559    jz      loc_409630
4232565    cmp     r12d, 0Dh
4232569    jz      loc_409620
4232575    mov     esi, r12d
4232578    mov     rdi, rbx
4232581    call    _add_incoming_char
4232586    jmp     loc_40951F
4232588    align 10h
loc_409590:
4232592    mov     esi, 0Ah
4232597    mov     rdi, rbx
4232600    call    _add_incoming_char
4232605    cmp     r12d, 0Ah
4232609    jz      loc_409515
4232615    mov     esi, r12d
4232618    mov     rdi, rbx
4232621    call    _add_incoming_char
4232626    jmp     loc_409515
4232631    align 20h
loc_4095C0:
4232640    mov     dword [rbx+818h], 5
4232650    jmp     loc_40951F
4232655    align 10h
loc_4095D0:
4232656    mov     dword [rbx+818h], 4
4232666    jmp     loc_40951F
4232671    align 20h
loc_4095E0:
4232672    mov     dword [rbx+818h], 3
4232682    jmp     loc_40951F
4232687    align 10h
loc_4095F0:
4232688    mov     dword [rbx+818h], 2
4232698    jmp     loc_40951F
4232703    align 20h
loc_409600:
4232704    mov     esi, 0FFh
4232709    mov     rdi, rbx
4232712    call    _add_incoming_char
4232717    mov     dword [rbx+818h], 0
4232727    jmp     loc_40951F
4232732    align 20h
loc_409620:
4232736    mov     dword [rbx+818h], 6
4232746    jmp     loc_40951F
4232751    align 10h
loc_409630:
4232752    mov     dword [rbx+818h], 1
4232762    jmp     loc_40951F
4232767    align 20h
loc_409640:
4232768    test    eax, eax
4232770    js      loc_40973B
loc_409648:
4232776    cmp     eax, 7FFh
4232781    jg      loc_4096C4
loc_40964F:
4232783    mov     ebp, 800h
4232788    mov     edx, ebp
4232790    sub     edx, eax
4232792    test    edx, edx
4232794    jle     loc_409784
loc_409660:
4232800    movsxd  rdx, edx
4232803    jmp     loc_40944B
loc_409668:
4232808    call    ___errno_location
4232813    mov     eax, [rax]
4232815    mov     [rbx+820h], eax
4232821    jmp     loc_4092F9
loc_40967A:
4232826    mov     ecx, __func___3159
4232831    mov     edx, 0FCh
4232836    mov     esi, aTelnet_session
4232841    mov     edi, aMax_input_read
4232846    call    _daemon_assert_fail
4232851    jmp     loc_40933A
loc_409698:
4232856    mov     edx, 18Eh
4232861    mov     ecx, __func___3201
4232866    mov     esi, aTelnet_session
4232871    mov     edi, aTOut_buflenTOu
4232876    call    _daemon_assert_fail
4232881    movsxd  rdx, dword [rbx+1030h]
4232888    movsxd  rax, dword [rbx+828h]
4232895    jmp     loc_40944B
loc_4096C4:
4232900    mov     ecx, __func___3201
4232905    mov     edx, 194h
4232910    mov     esi, aTelnet_session
4232915    mov     edi, aTOut_take2048
4232920    call    _daemon_assert_fail
4232925    movsxd  rax, dword [rbx+828h]
4232932    jmp     loc_40964F
loc_4096E9:
4232937    mov     ecx, __func___3201
4232942    mov     edx, 18Ch
4232947    mov     esi, aTelnet_session
4232952    mov     edi, aTOut_take2048
4232957    call    _daemon_assert_fail
4232962    jmp     loc_409426
loc_409707:
4232967    call    ___errno_location
4232972    mov     eax, [rax]
4232974    mov     [rbx+4], eax
4232977    jmp     loc_4092B2
loc_409716:
4232982    mov     edx, 18Dh
4232987    mov     ecx, __func___3201
4232992    mov     esi, aTelnet_session
4232997    mov     edi, aTOut_buflen0
4233002    call    _daemon_assert_fail
4233007    movsxd  rdx, dword [rbx+1030h]
4233014    jmp     loc_409435
loc_40973B:
4233019    mov     ecx, __func___3201
4233024    mov     edx, 193h
4233029    mov     esi, aTelnet_session
4233034    mov     edi, aTOut_take0
4233039    call    _daemon_assert_fail
4233044    movsxd  rax, dword [rbx+828h]
4233051    jmp     loc_409648
loc_409760:
4233056    mov     ecx, __func___3201
4233061    mov     edx, 18Bh
4233066    mov     esi, aTelnet_session
4233071    mov     edi, aTOut_take0
4233076    call    _daemon_assert_fail
4233081    mov     eax, [rbx+828h]
4233087    jmp     loc_40941B
loc_409784:
4233092    mov     edx, 195h
4233097    mov     ecx, __func___3201
4233102    mov     esi, aTelnet_session
4233107    mov     edi, a2048TOut_take0
4233112    call    _daemon_assert_fail
4233117    movsxd  rax, dword [rbx+828h]
4233124    mov     edx, ebp
4233126    sub     edx, eax
4233128    jmp     loc_409660
loc_4097AD:
4233133    call    ___stack_chk_fail
USE32

section .text

global _telnet_session_init

_telnet_session_init:
4233152    push    r12
4233154    test    rdi, rdi
4233157    mov     r12d, esi
4233160    push    rbp
4233161    mov     ebp, edx
4233163    push    rbx
4233164    mov     rbx, rdi
4233167    jz      loc_4098D0
loc_4097D5:
4233173    test    r12d, r12d
4233176    js      loc_4098B0
loc_4097DE:
4233182    test    ebp, ebp
4233184    js      loc_409890
loc_4097E6:
4233190    xor     esi, esi
4233192    mov     rdi, rbx
4233195    mov     [rbx], r12d
4233198    mov     dword [rbx+4], 0
4233205    mov     dword [rbx+8], 0
4233212    mov     dword [rbx+10h], 0
4233219    mov     dword [rbx+0Ch], 0
4233226    mov     dword [rbx+814h], 0
4233236    mov     dword [rbx+818h], 0
4233246    mov     [rbx+81Ch], ebp
4233252    mov     dword [rbx+820h], 0
4233262    mov     dword [rbx+824h], 0
4233272    mov     dword [rbx+82Ch], 0
4233282    mov     dword [rbx+828h], 0
4233292    mov     dword [rbx+1030h], 0
4233302    call    _process_data
4233307    mov     rdi, rbx
4233310    call    _invariant_1
4233315    test    eax, eax
4233317    jz      loc_409870
4233319    pop     rbx
4233320    pop     rbp
4233321    pop     r12
4233323    retn    
4233324    align 10h
loc_409870:
4233328    pop     rbx
4233329    pop     rbp
4233330    pop     r12
4233332    mov     ecx, __func___3102
4233337    mov     edx, 56h
4233342    mov     esi, aTelnet_session
4233347    mov     edi, aInvariantT
4233352    jmp     daemon_assert_fail
4233357    align 10h
loc_409890:
4233360    mov     ecx, __func___3102
4233365    mov     edx, 44h
4233370    mov     esi, aTelnet_session
4233375    mov     edi, aOut0
4233380    call    _daemon_assert_fail
4233385    jmp     loc_4097E6
4233390    align 10h
loc_4098B0:
4233392    mov     ecx, __func___3102
4233397    mov     edx, 43h
4233402    mov     esi, aTelnet_session
4233407    mov     edi, aIn0
4233412    call    _daemon_assert_fail
4233417    jmp     loc_4097DE
4233422    align 10h
loc_4098D0:
4233424    mov     ecx, __func___3102
4233429    mov     edx, 42h
4233434    mov     esi, aTelnet_session
4233439    mov     edi, 40CD39h
4233444    call    _daemon_assert_fail
USE32

section .text

global _telnet_session_print

_telnet_session_print:
4233456    push    r14
4233458    mov     r14, rsi
4233461    push    r13
4233463    push    r12
4233465    mov     r12, rdi
4233468    push    rbp
4233469    push    rbx
4233470    sub     rsp, 10h
4233474    call    _invariant_1
4233479    test    eax, eax
4233481    jz      loc_409A8F
loc_40990F:
4233487    mov     rdi, r14
4233490    call    _strlen
4233495    test    eax, eax
4233497    mov     r13d, eax
4233500    jnz     loc_409940
4233502    mov     rdi, r12
4233505    call    _invariant_1
4233510    test    eax, eax
4233512    jz      loc_409AAD
loc_40992E:
4233518    mov     eax, 1
loc_409933:
4233523    add     rsp, 10h
4233527    pop     rbx
4233528    pop     rbp
4233529    pop     r12
4233531    pop     r13
4233533    pop     r14
4233535    retn    
loc_409940:
4233536    mov     edi, [r12+820h]
4233544    xor     ebp, ebp
4233546    test    edi, edi
4233548    jnz     loc_409A55
4233554    nop     word [rax+rax+00h]
loc_409958:
4233560    mov     esi, [r12+824h]
4233568    test    esi, esi
4233570    jnz     loc_409A55
4233576    cmp     ebp, r13d
4233579    jge     loc_4099E0
4233581    movsxd  rbx, ebp
4233584    add     rbx, r14
4233587    cmp     dword [r12+1030h], 7FFh
4233599    jle     loc_4099B9
4233601    jmp     loc_409A38
4233606    align 10h
loc_409990:
4233616    movsx   esi, al
4233619    mov     rdi, r12
4233622    add     ebp, 1
4233625    call    _add_outgoing_char
4233630    cmp     r13d, ebp
4233633    jle     loc_4099E0
4233635    add     rbx, 1
4233639    cmp     dword [r12+1030h], 7FFh
4233651    jg      loc_409A38
loc_4099B9:
4233657    movzx   eax, byte [rbx]
4233660    test    al, al
4233662    jnz     loc_409990
4233664    mov     ecx, __func___3109
4233669    mov     edx, 6Fh
4233674    mov     esi, aTelnet_session
4233679    mov     edi, aSAmt_printed0
4233684    call    _daemon_assert_fail
4233689    movzx   eax, byte [rbx]
4233692    jmp     loc_409990
4233694    align 20h
loc_4099E0:
4233696    mov     esi, 1
4233701    mov     rdi, r12
4233704    call    _process_data
4233709    mov     eax, [r12+1030h]
4233717    test    eax, eax
4233719    jle     loc_409ACB
4233725    mov     ecx, [r12+820h]
4233733    test    ecx, ecx
4233735    jnz     loc_409A15
4233737    mov     edx, [r12+824h]
4233745    test    edx, edx
4233747    jz      loc_4099E0
loc_409A15:
4233749    mov     rdi, r12
4233752    call    _invariant_1
4233757    test    eax, eax
4233759    jz      loc_409AFE
loc_409A25:
4233765    add     rsp, 10h
4233769    xor     eax, eax
4233771    pop     rbx
4233772    pop     rbp
4233773    pop     r12
4233775    pop     r13
4233777    pop     r14
4233779    retn    
4233780    align 8 
loc_409A38:
4233784    mov     rdi, r12
4233787    mov     esi, 1
4233792    call    _process_data
4233797    mov     edi, [r12+820h]
4233805    test    edi, edi
4233807    jz      loc_409958
loc_409A55:
4233813    mov     rdi, r12
4233816    call    _invariant_1
4233821    test    eax, eax
4233823    jnz     loc_409A25
4233825    mov     ecx, __func___3109
4233830    mov     edx, 6Ah
4233835    mov     esi, aTelnet_session
4233840    mov     edi, aInvariantT
4233845    mov     [rsp+0Ch], eax
4233849    call    _daemon_assert_fail
4233854    mov     eax, [rsp+0Ch]
4233858    add     rsp, 10h
4233862    pop     rbx
4233863    pop     rbp
4233864    pop     r12
4233866    pop     r13
4233868    pop     r14
4233870    retn    
loc_409A8F:
4233871    mov     ecx, __func___3109
4233876    mov     edx, 5Fh
4233881    mov     esi, aTelnet_session
4233886    mov     edi, aInvariantT
4233891    call    _daemon_assert_fail
4233896    jmp     loc_40990F
loc_409AAD:
4233901    mov     ecx, __func___3109
4233906    mov     edx, 63h
4233911    mov     esi, aTelnet_session
4233916    mov     edi, aInvariantT
4233921    call    _daemon_assert_fail
4233926    jmp     loc_40992E
loc_409ACB:
4233931    mov     rdi, r12
4233934    call    _invariant_1
4233939    test    eax, eax
4233941    jnz     loc_40992E
4233947    mov     ecx, __func___3109
4233952    mov     edx, 7Eh
4233957    mov     esi, aTelnet_session
4233962    mov     edi, aInvariantT
4233967    call    _daemon_assert_fail
4233972    mov     eax, 1
4233977    jmp     loc_409933
loc_409AFE:
4233982    mov     ecx, __func___3109
4233987    mov     edx, 78h
4233992    mov     esi, aTelnet_session
4233997    mov     edi, aInvariantT
4234002    mov     [rsp+0Ch], eax
4234006    call    _daemon_assert_fail
USE32

section .text

global _telnet_session_println

_telnet_session_println:
4234032    push    rbp
4234033    mov     rbp, rsi
4234036    push    rbx
4234037    mov     rbx, rdi
4234040    sub     rsp, 18h
4234044    call    _invariant_1
4234049    test    eax, eax
4234051    jz      loc_409BF0
loc_409B49:
4234057    mov     rsi, rbp
4234060    mov     rdi, rbx
4234063    call    _telnet_session_print
4234068    test    eax, eax
4234070    jnz     loc_409BA0
4234072    mov     rdi, rbx
4234075    call    _invariant_1
4234080    test    eax, eax
4234082    jz      loc_409B70
loc_409B64:
4234084    xor     eax, eax
loc_409B66:
4234086    add     rsp, 18h
4234090    pop     rbx
4234091    pop     rbp
4234092    retn    
4234093    align 10h
loc_409B70:
4234096    mov     ecx, __func___3122
4234101    mov     edx, 87h
4234106    mov     esi, aTelnet_session
4234111    mov     edi, aInvariantT
4234116    mov     [rsp+0Ch], eax
4234120    call    _daemon_assert_fail
4234125    mov     eax, [rsp+0Ch]
4234129    add     rsp, 18h
4234133    pop     rbx
4234134    pop     rbp
4234135    retn    
4234136    align 20h
loc_409BA0:
4234144    mov     rdi, rbx
4234147    mov     esi, 40A986h
4234152    call    _telnet_session_print
4234157    test    eax, eax
4234159    mov     rdi, rbx
4234162    jz      loc_409C10
4234164    call    _invariant_1
4234169    mov     edx, eax
4234171    mov     eax, 1
4234176    test    edx, edx
4234178    jnz     loc_409B66
4234180    mov     ecx, __func___3122
4234185    mov     dl, 8Eh
4234187    mov     esi, aTelnet_session
4234192    mov     edi, aInvariantT
4234197    mov     [rsp+0Ch], eax
4234201    call    _daemon_assert_fail
4234206    mov     eax, [rsp+0Ch]
4234210    jmp     loc_409B66
4234215    align 10h
loc_409BF0:
4234224    mov     ecx, __func___3122
4234229    mov     edx, 85h
4234234    mov     esi, aTelnet_session
4234239    mov     edi, aInvariantT
4234244    call    _daemon_assert_fail
4234249    jmp     loc_409B49
4234254    align 10h
loc_409C10:
4234256    call    _invariant_1
4234261    test    eax, eax
4234263    jnz     loc_409B64
4234269    mov     ecx, __func___3122
4234274    mov     edx, 8Bh
4234279    mov     esi, aTelnet_session
4234284    mov     edi, aInvariantT
4234289    mov     [rsp+0Ch], eax
4234293    call    _daemon_assert_fail
USE32

section .text

global _telnet_session_readln

_telnet_session_readln:
4234320    push    r15
4234322    push    r14
4234324    push    r13
4234326    push    r12
4234328    mov     r12, rsi
4234331    push    rbp
4234332    mov     ebp, edx
4234334    push    rbx
4234335    mov     rbx, rdi
4234338    sub     rsp, 18h
4234342    call    _invariant_1
4234347    test    eax, eax
4234349    jz      loc_409E90
loc_409C73:
4234355    mov     r8d, [rbx+4]
4234359    test    r8d, r8d
4234362    jnz     loc_409DEF
4234368    mov     edi, [rbx+8]
4234371    test    edi, edi
4234373    jnz     loc_409DEF
4234379    lea     eax, [rbp-1]
4234382    xor     r15d, r15d
4234385    mov     [rsp+0Ch], eax
loc_409C95:
4234389    mov     ecx, [rbx+814h]
4234395    test    ecx, ecx
4234397    jle     loc_409DD0
4234403    cmp     r15d, [rsp+0Ch]
4234408    jz      loc_409E08
4234414    movsxd  r13, r15d
4234417    xor     r14d, r14d
4234420    jmp     loc_409D22
4234422    align 20h
loc_409CC0:
4234432    mov     eax, [rbx+0Ch]
4234435    test    eax, eax
4234437    js      loc_409D54
loc_409CCB:
4234443    cmp     eax, 7FFh
4234448    jg      loc_409D80
loc_409CD6:
4234454    movsxd  rdx, eax
4234457    add     eax, 1
4234460    movzx   edx, byte [rbx+rdx+14h]
4234465    cmp     eax, 800h
4234470    cmovz   eax, r14d
4234474    sub     dword [rbx+814h], 1
4234481    mov     [rbx+0Ch], eax
4234484    cmp     dl, 0Ah
4234487    mov     [r12+r13], dl
4234491    jz      loc_409E38
4234497    mov     edx, [rbx+814h]
4234503    add     r15d, 1
4234507    test    edx, edx
4234509    jle     loc_409DD0
4234515    add     r13, 1
4234519    cmp     r15d, [rsp+0Ch]
4234524    jz      loc_409E08
loc_409D22:
4234530    test    r15d, r15d
4234533    js      loc_409DA8
loc_409D2B:
4234539    cmp     ebp, r15d
4234542    jg      loc_409CC0
4234544    mov     ecx, __func___3129
4234549    mov     edx, 0A5h
4234554    mov     esi, aTelnet_session
4234559    mov     edi, aAmt_readBuflen
4234564    call    _daemon_assert_fail
4234569    mov     eax, [rbx+0Ch]
4234572    test    eax, eax
4234574    jns     loc_409CCB
loc_409D54:
4234580    mov     ecx, __func___3191
4234585    mov     edx, 163h
4234590    mov     esi, aTelnet_session
4234595    mov     edi, aTIn_take0
4234600    call    _daemon_assert_fail
4234605    mov     eax, [rbx+0Ch]
4234608    cmp     eax, 7FFh
4234613    jle     loc_409CD6
4234619    nop     dword [rax+rax+00h]
loc_409D80:
4234624    mov     ecx, __func___3191
4234629    mov     edx, 164h
4234634    mov     esi, aTelnet_session
4234639    mov     edi, aTIn_take2048
4234644    call    _daemon_assert_fail
4234649    mov     eax, [rbx+0Ch]
4234652    jmp     loc_409CD6
4234657    align 8 
loc_409DA8:
4234664    mov     ecx, __func___3129
4234669    mov     edx, 0A4h
4234674    mov     esi, aTelnet_session
4234679    mov     edi, aAmt_read0
4234684    call    _daemon_assert_fail
4234689    jmp     loc_409D2B
4234694    align 10h
loc_409DD0:
4234704    mov     esi, 1
4234709    mov     rdi, rbx
4234712    call    _process_data
4234717    mov     eax, [rbx+4]
4234720    test    eax, eax
4234722    jnz     loc_409DEF
4234724    mov     esi, [rbx+8]
4234727    test    esi, esi
4234729    jz      loc_409C95
loc_409DEF:
4234735    mov     rdi, rbx
4234738    call    _invariant_1
4234743    test    eax, eax
4234745    jz      loc_409F08
4234751    xor     eax, eax
4234753    jmp     loc_409E25
4234755    align 8 
loc_409E08:
4234760    movsxd  r15, r15d
4234763    mov     rdi, rbx
4234766    mov     byte [r12+r15], 0
4234771    call    _invariant_1
4234776    test    eax, eax
4234778    jz      loc_409EAE
loc_409E20:
4234784    mov     eax, 1
loc_409E25:
4234789    add     rsp, 18h
4234793    pop     rbx
4234794    pop     rbp
4234795    pop     r12
4234797    pop     r13
4234799    pop     r14
4234801    pop     r15
4234803    retn    
4234804    align 8 
loc_409E38:
4234808    cmp     r15d, 0FFFFFFFFh
4234812    jl      loc_409EEA
loc_409E42:
4234818    add     r15d, 1
4234822    cmp     ebp, r15d
4234825    jle     loc_409ECC
loc_409E4F:
4234831    mov     byte [r12+r13+1], 0
4234837    mov     rdi, rbx
4234840    call    _invariant_1
4234845    test    eax, eax
4234847    jnz     loc_409E20
4234849    mov     ecx, __func___3129
4234854    mov     edx, 0ABh
4234859    mov     esi, aTelnet_session
4234864    mov     edi, aInvariantT
4234869    call    _daemon_assert_fail
4234874    add     rsp, 18h
4234878    mov     eax, 1
4234883    pop     rbx
4234884    pop     rbp
4234885    pop     r12
4234887    pop     r13
4234889    pop     r14
4234891    pop     r15
4234893    retn    
4234894    align 10h
loc_409E90:
4234896    mov     ecx, __func___3129
4234901    mov     edx, 97h
4234906    mov     esi, aTelnet_session
4234911    mov     edi, aInvariantT
4234916    call    _daemon_assert_fail
4234921    jmp     loc_409C73
loc_409EAE:
4234926    mov     ecx, __func___3129
4234931    mov     edx, 0A1h
4234936    mov     esi, aTelnet_session
4234941    mov     edi, aInvariantT
4234946    call    _daemon_assert_fail
4234951    jmp     loc_409E20
loc_409ECC:
4234956    mov     ecx, __func___3129
4234961    mov     edx, 0A9h
4234966    mov     esi, aTelnet_session
4234971    mov     edi, aAmt_read1Bufle
4234976    call    _daemon_assert_fail
4234981    jmp     loc_409E4F
loc_409EEA:
4234986    mov     ecx, __func___3129
4234991    mov     edx, 0A8h
4234996    mov     esi, aTelnet_session
4235001    mov     edi, aAmt_read10
4235006    call    _daemon_assert_fail
4235011    jmp     loc_409E42
loc_409F08:
4235016    mov     ecx, __func___3129
4235021    mov     edx, 9Bh
4235026    mov     esi, aTelnet_session
4235031    mov     edi, aInvariantT
4235036    mov     [rsp+0Ch], eax
4235040    call    _daemon_assert_fail
USE32

section .text

global _telnet_session_destroy

_telnet_session_destroy:
4235056    push    rbx
4235057    mov     rbx, rdi
4235060    call    _invariant_1
4235065    test    eax, eax
4235067    jz      loc_409F68
loc_409F3D:
4235069    mov     edi, [rbx]
4235071    call    _close
4235076    mov     edi, [rbx+81Ch]
4235082    cmp     edi, [rbx]
4235084    jz      loc_409F53
4235086    call    _close
loc_409F53:
4235091    mov     dword [rbx], 0FFFFFFFFh
4235097    mov     dword [rbx+81Ch], 0FFFFFFFFh
4235107    pop     rbx
4235108    retn    
4235109    align 8 
loc_409F68:
4235112    mov     ecx, __func___3137
4235117    mov     edx, 0B6h
4235122    mov     esi, aTelnet_session
4235127    mov     edi, aInvariantT
4235132    call    _daemon_assert_fail
USE32

section .text

global _insert

_insert:
4235152    push    rbp
4235153    mov     rbp, rdi
4235156    xor     edi, edi
4235158    push    rbx
4235159    mov     rbx, rsi
4235162    sub     rsp, 8
4235166    call    _time
4235171    movsxd  rdx, dword [rbp+28h]
4235175    add     rax, rdx
4235178    mov     rdx, [rbp+38h]
4235182    mov     [rbx+10h], rax
4235186    test    rdx, rdx
4235189    jz      loc_409FC0
4235191    mov     rcx, [rdx+10h]
4235195    cmp     rax, rcx
4235198    jl      loc_409FF0
loc_409FC0:
4235200    cmp     qword [rbp+30h], 0
4235205    mov     [rbx+18h], rdx
4235209    mov     qword [rbx+20h], 0
4235217    jz      loc_40A000
4235219    mov     [rdx+20h], rbx
loc_409FD7:
4235223    mov     [rbp+38h], rbx
4235227    mov     dword [rbx+8], 1
4235234    add     rsp, 8
4235238    pop     rbx
4235239    pop     rbp
4235240    retn    
4235241    align 10h
loc_409FF0:
4235248    mov     [rbx+10h], rcx
4235252    jmp     loc_409FC0
4235254    align 20h
loc_40A000:
4235264    mov     [rbp+30h], rbx
4235268    jmp     loc_409FD7
USE32

section .text

global _invariant_2

_invariant_2:
4235280    push    rbp
4235281    xor     eax, eax
4235283    push    rbx
4235284    mov     rbx, rdi
4235287    sub     rsp, 8
4235291    test    rdi, rdi
4235294    jz      loc_40A0CA
4235300    call    _pthread_mutex_lock
4235305    mov     eax, [rbx+28h]
4235308    xor     ebp, ebp
4235310    test    eax, eax
4235312    jle     loc_40A0C0
4235318    mov     rdx, [rbx+30h]
4235322    test    rdx, rdx
4235325    jz      loc_40A0F0
4235331    mov     rsi, [rbx+38h]
4235335    test    rsi, rsi
4235338    jz      loc_40A0C0
4235340    xor     ecx, ecx
4235342    jmp     loc_40A05D
loc_40A050:
4235344    mov     rdi, [rax+10h]
4235348    cmp     [rdx+10h], rdi
4235352    jg      loc_40A0D8
4235354    mov     rdx, rax
loc_40A05D:
4235357    mov     rax, [rdx+18h]
4235361    add     ecx, 1
4235364    test    rax, rax
4235367    jz      loc_40A073
4235369    mov     rax, [rax+10h]
4235373    cmp     [rdx+10h], rax
4235377    jl      loc_40A0D8
loc_40A073:
4235379    mov     rax, [rdx+20h]
4235383    test    rax, rax
4235386    jnz     loc_40A050
4235388    xor     edi, edi
4235390    jmp     loc_40A083
loc_40A080:
4235392    mov     rsi, rax
loc_40A083:
4235395    mov     rax, [rsi+18h]
4235399    add     edi, 1
4235402    test    rax, rax
4235405    jz      loc_40A099
4235407    mov     rdx, [rax+10h]
4235411    cmp     [rsi+10h], rdx
4235415    jl      loc_40A0D8
loc_40A099:
4235417    mov     rdx, [rsi+20h]
4235421    test    rdx, rdx
4235424    jz      loc_40A0AC
4235426    mov     rdx, [rdx+10h]
4235430    cmp     [rsi+10h], rdx
4235434    jg      loc_40A0D8
loc_40A0AC:
4235436    test    rax, rax
4235439    jnz     loc_40A080
4235441    xor     ebp, ebp
4235443    cmp     edi, ecx
4235445    setz    bpl
4235449    nop     dword [rax+00000000h]
loc_40A0C0:
4235456    mov     rdi, rbx
4235459    call    _pthread_mutex_unlock
4235464    mov     eax, ebp
loc_40A0CA:
4235466    add     rsp, 8
4235470    pop     rbx
4235471    pop     rbp
4235472    retn    
4235473    align 8 
loc_40A0D8:
4235480    xor     ebp, ebp
4235482    mov     rdi, rbx
4235485    call    _pthread_mutex_unlock
4235490    mov     eax, ebp
4235492    jmp     loc_40A0CA
4235494    align 10h
loc_40A0F0:
4235504    xor     ebp, ebp
4235506    cmp     qword [rbx+38h], 0
4235511    setz    bpl
4235515    jmp     loc_40A0C0
USE32

section .text

global _delete_isra_0_part_1

_delete_isra_0_part_1:
4235520    push    r12
4235522    mov     r12, rsi
4235525    push    rbp
4235526    mov     rbp, rdi
4235529    push    rbx
4235530    mov     rax, [rdx+20h]
4235534    mov     rbx, rdx
4235537    test    rax, rax
4235540    jz      loc_40A160
4235542    cmp     rdx, [rsi]
4235545    jz      loc_40A1F0
loc_40A11F:
4235551    mov     rdx, [rbx+18h]
4235555    mov     [rax+18h], rdx
loc_40A127:
4235559    mov     rax, [rbx+18h]
4235563    test    rax, rax
4235566    jz      loc_40A1A8
loc_40A130:
4235568    cmp     rbx, [rbp+0]
4235572    jz      loc_40A218
loc_40A13A:
4235578    mov     rdx, [rbx+20h]
4235582    mov     [rax+20h], rdx
loc_40A142:
4235586    mov     qword [rbx+18h], 0
4235594    mov     qword [rbx+20h], 0
4235602    mov     dword [rbx+8], 0
4235609    pop     rbx
4235610    pop     rbp
4235611    pop     r12
4235613    retn    
4235614    align 20h
loc_40A160:
4235616    mov     rax, [rsi]
4235619    cmp     rdx, rax
4235622    jz      loc_40A185
4235624    mov     ecx, __func___3129_0
4235629    mov     edx, 83h
4235634    mov     esi, aWatchdog_c
4235639    mov     edi, aWNewestWatched
4235644    call    _daemon_assert_fail
4235649    mov     rax, [r12]
loc_40A185:
4235653    mov     rax, [rax+18h]
4235657    test    rax, rax
4235660    mov     [r12], rax
4235664    jz      loc_40A127
4235666    mov     qword [rax+20h], 0
4235674    mov     rax, [rbx+18h]
4235678    test    rax, rax
4235681    jnz     loc_40A130
4235683    nop     dword [rax+rax+00h]
loc_40A1A8:
4235688    mov     rax, [rbp+0]
4235692    cmp     rbx, rax
4235695    jz      loc_40A1CE
4235697    mov     ecx, __func___3129_0
4235702    mov     edx, 8Eh
4235707    mov     esi, aWatchdog_c
4235712    mov     edi, aWOldestWatched
4235717    call    _daemon_assert_fail
4235722    mov     rax, [rbp+0]
loc_40A1CE:
4235726    mov     rax, [rax+20h]
4235730    test    rax, rax
4235733    mov     [rbp+0], rax
4235737    jz      loc_40A142
4235743    mov     qword [rax+18h], 0
4235751    jmp     loc_40A142
4235756    align 10h
loc_40A1F0:
4235760    mov     ecx, __func___3129_0
4235765    mov     edx, 89h
4235770    mov     esi, aWatchdog_c
4235775    mov     edi, aWNewestWatch_0
4235780    call    _daemon_assert_fail
4235785    mov     rax, [rbx+20h]
4235789    jmp     loc_40A11F
4235794    align 8 
loc_40A218:
4235800    mov     ecx, __func___3129_0
4235805    mov     edx, 94h
4235810    mov     esi, aWatchdog_c
4235815    mov     edi, aWOldestWatch_0
4235820    call    _daemon_assert_fail
USE32

section .text

global _watcher

_watcher:
4235840    push    r13
4235842    lea     r13, [rdi+38h]
4235846    push    r12
4235848    lea     r12, [rdi+30h]
4235852    push    rbp
4235853    mov     rbp, rdi
4235856    push    rbx
4235857    sub     rsp, 28h
4235861    nop     dword [rax]
loc_40A258:
4235864    lea     r8, [rsp+10h]
4235869    xor     ecx, ecx
4235871    xor     edx, edx
4235873    xor     esi, esi
4235875    xor     edi, edi
4235877    mov     qword [rsp+10h], 1
4235886    mov     qword [rsp+18h], 0
4235895    call    _select
4235900    lea     rdi, [rsp+8]
4235905    call    _time
4235910    mov     rdi, rbp
4235913    call    _pthread_mutex_lock
4235918    mov     rbx, [rbp+30h]
4235922    test    rbx, rbx
4235925    jnz     loc_40A2B1
4235927    jmp     loc_40A2E0
4235929    align 20h
loc_40A2A0:
4235936    mov     rdi, [rbx]
4235939    call    _pthread_cancel
4235944    mov     rbx, [rbp+30h]
4235948    test    rbx, rbx
4235951    jz      loc_40A2E0
loc_40A2B1:
4235953    mov     rsi, [rbx+10h]
4235957    mov     rdi, [rsp+8]
4235962    call    _difftime
4235967    xorpd   xmm1, xmm1
4235971    ucomisd xmm0, xmm1
4235975    jbe     loc_40A2E0
4235977    mov     eax, [rbx+8]
4235980    test    eax, eax
4235982    jz      loc_40A2A0
4235984    mov     rdx, rbx
4235987    mov     rsi, r13
4235990    mov     rdi, r12
4235993    call    _delete_isra_0_part_1
4235998    jmp     loc_40A2A0
loc_40A2E0:
4236000    mov     rdi, rbp
4236003    call    _pthread_mutex_unlock
4236008    jmp     loc_40A258
USE32

section .text

global _watchdog_init

_watchdog_init:
4236016    push    r12
4236018    mov     r12, rdx
4236021    push    rbp
4236022    mov     ebp, esi
4236024    push    rbx
4236025    mov     rbx, rdi
4236028    sub     rsp, 10h
4236032    test    rdi, rdi
4236035    jz      loc_40A3E0
loc_40A309:
4236041    test    ebp, ebp
4236043    jle     loc_40A3C0
loc_40A311:
4236049    test    r12, r12
4236052    jz      loc_40A400
loc_40A31A:
4236058    xor     esi, esi
4236060    mov     rdi, rbx
4236063    call    _pthread_mutex_init
4236068    lea     rdi, [rsp+8]
4236073    xor     esi, esi
4236075    mov     [rbx+28h], ebp
4236078    mov     qword [rbx+30h], 0
4236086    mov     qword [rbx+38h], 0
4236094    mov     rcx, rbx
4236097    mov     edx, watcher
4236102    call    _pthread_create
4236107    test    eax, eax
4236109    jnz     loc_40A3A0
4236111    mov     rdi, [rsp+8]
4236116    call    _pthread_detach
4236121    mov     rdi, rbx
4236124    mov     ebx, 1
4236129    call    _invariant_2
4236134    test    eax, eax
4236136    jz      loc_40A378
4236138    add     rsp, 10h
4236142    mov     eax, ebx
4236144    pop     rbx
4236145    pop     rbp
4236146    pop     r12
4236148    retn    
4236149    align 8 
loc_40A378:
4236152    mov     ecx, __func___3105
4236157    mov     edx, 25h
4236162    mov     esi, aWatchdog_c
4236167    mov     edi, aInvariantW
4236172    call    _daemon_assert_fail
4236177    add     rsp, 10h
4236181    mov     eax, ebx
4236183    pop     rbx
4236184    pop     rbp
4236185    pop     r12
4236187    retn    
4236188    align 20h
loc_40A3A0:
4236192    mov     ecx, eax
4236194    mov     esi, eax
4236196    mov     rdi, r12
4236199    xor     eax, eax
4236201    mov     edx, aErrorDFromPthr
4236206    xor     ebx, ebx
4236208    call    _error_init
4236213    add     rsp, 10h
4236217    mov     eax, ebx
4236219    pop     rbx
4236220    pop     rbp
4236221    pop     r12
4236223    retn    
loc_40A3C0:
4236224    mov     ecx, __func___3105
4236229    mov     edx, 15h
4236234    mov     esi, aWatchdog_c
4236239    mov     edi, aInactivity_tim
4236244    call    _daemon_assert_fail
4236249    jmp     loc_40A311
4236254    align 20h
loc_40A3E0:
4236256    mov     ecx, __func___3105
4236261    mov     edx, 14h
4236266    mov     esi, aWatchdog_c
4236271    mov     edi, aWVoid0
4236276    call    _daemon_assert_fail
4236281    jmp     loc_40A309
4236286    align 20h
loc_40A400:
4236288    mov     ecx, __func___3105
4236293    mov     edx, 16h
4236298    mov     esi, aWatchdog_c
4236303    mov     edi, aErrVoid0
4236308    call    _daemon_assert_fail
USE32

section .text

global _watchdog_add_watched

_watchdog_add_watched:
4236320    push    rbp
4236321    mov     rbp, rsi
4236324    push    rbx
4236325    mov     rbx, rdi
4236328    sub     rsp, 8
4236332    call    _invariant_2
4236337    test    eax, eax
4236339    jz      loc_40A490
loc_40A435:
4236341    mov     rdi, rbx
4236344    call    _pthread_mutex_lock
4236349    call    _pthread_self
4236354    mov     rsi, rbp
4236357    mov     [rbp+0], rax
4236361    mov     rdi, rbx
4236364    mov     [rbp+28h], rbx
4236368    call    _insert
4236373    mov     rdi, rbx
4236376    call    _pthread_mutex_unlock
4236381    mov     rdi, rbx
4236384    call    _invariant_2
4236389    test    eax, eax
4236391    jz      loc_40A470
4236393    add     rsp, 8
4236397    pop     rbx
4236398    pop     rbp
4236399    retn    
loc_40A470:
4236400    add     rsp, 8
4236404    mov     ecx, __func___3110
4236409    mov     edx, 36h
4236414    pop     rbx
4236415    pop     rbp
4236416    mov     esi, aWatchdog_c
4236421    mov     edi, aInvariantW
4236426    jmp     daemon_assert_fail
4236431    align 10h
loc_40A490:
4236432    mov     ecx, __func___3110
4236437    mov     edx, 2Ch
4236442    mov     esi, aWatchdog_c
4236447    mov     edi, aInvariantW
4236452    call    _daemon_assert_fail
USE32

section .text

global _watchdog_defer_watched

_watchdog_defer_watched:
4236464    push    rbp
4236465    mov     rbp, rdi
4236468    push    rbx
4236469    sub     rsp, 8
4236473    mov     rdi, [rdi+28h]
4236477    call    _invariant_2
4236482    test    eax, eax
4236484    jz      loc_40A538
loc_40A4C6:
4236486    mov     rbx, [rbp+28h]
4236490    mov     rdi, rbx
4236493    call    _pthread_mutex_lock
4236498    mov     eax, [rbp+8]
4236501    test    eax, eax
4236503    jnz     loc_40A520
loc_40A4D9:
4236505    mov     rsi, rbp
4236508    mov     rdi, rbx
4236511    call    _insert
4236516    mov     rdi, rbx
4236519    call    _pthread_mutex_unlock
4236524    mov     rdi, rbx
4236527    call    _invariant_2
4236532    test    eax, eax
4236534    jz      loc_40A500
4236536    add     rsp, 8
4236540    pop     rbx
4236541    pop     rbp
4236542    retn    
4236543    align 20h
loc_40A500:
4236544    add     rsp, 8
4236548    mov     ecx, __func___3115
4236553    mov     edx, 46h
4236558    pop     rbx
4236559    pop     rbp
4236560    mov     esi, aWatchdog_c
4236565    mov     edi, aInvariantW
4236570    jmp     daemon_assert_fail
4236575    align 20h
loc_40A520:
4236576    lea     rsi, [rbx+38h]
4236580    lea     rdi, [rbx+30h]
4236584    mov     rdx, rbp
4236587    call    _delete_isra_0_part_1
4236592    jmp     loc_40A4D9
4236594    align 8 
loc_40A538:
4236600    mov     ecx, __func___3115
4236605    mov     edx, 3Dh
4236610    mov     esi, aWatchdog_c
4236615    mov     edi, aInvariantWatch
4236620    call    _daemon_assert_fail
USE32

section .text

global _watchdog_remove_watched

_watchdog_remove_watched:
4236640    push    rbp
4236641    mov     rbp, rdi
4236644    push    rbx
4236645    sub     rsp, 8
4236649    mov     rdi, [rdi+28h]
4236653    call    _invariant_2
4236658    test    eax, eax
4236660    jz      loc_40A5E8
loc_40A576:
4236662    mov     rbx, [rbp+28h]
4236666    mov     rdi, rbx
4236669    call    _pthread_mutex_lock
4236674    mov     eax, [rbp+8]
4236677    test    eax, eax
4236679    jnz     loc_40A5D0
loc_40A589:
4236681    mov     rdi, rbx
4236684    call    _pthread_mutex_unlock
4236689    mov     rdi, rbx
4236692    call    _invariant_2
4236697    test    eax, eax
4236699    jz      loc_40A5A8
4236701    add     rsp, 8
4236705    pop     rbx
4236706    pop     rbp
4236707    retn    
4236708    align 8 
loc_40A5A8:
4236712    add     rsp, 8
4236716    mov     ecx, __func___3120
4236721    mov     edx, 55h
4236726    pop     rbx
4236727    pop     rbp
4236728    mov     esi, aWatchdog_c
4236733    mov     edi, aInvariantW
4236738    jmp     daemon_assert_fail
4236743    align 10h
loc_40A5D0:
4236752    lea     rsi, [rbx+38h]
4236756    lea     rdi, [rbx+30h]
4236760    mov     rdx, rbp
4236763    call    _delete_isra_0_part_1
4236768    jmp     loc_40A589
4236770    align 8 
loc_40A5E8:
4236776    mov     ecx, __func___3120
4236781    mov     edx, 4Dh
4236786    mov     esi, aWatchdog_c
4236791    mov     edi, aInvariantWatch
4236796    call    _daemon_assert_fail
USE32

section .text

global _error_init

_error_init:
4236880    push    r12
4236882    push    rbp
4236883    mov     ebp, esi
4236885    push    rbx
4236886    mov     rbx, rdi
4236889    sub     rsp, 0D0h
4236896    test    al, al
4236898    mov     [rsp+38h], rcx
4236903    mov     [rsp+40h], r8
4236908    mov     [rsp+48h], r9
4236913    jz      loc_40A6AA
4236915    movaps  xmmword [rsp+50h], xmm0
4236920    movaps  xmmword [rsp+60h], xmm1
4236925    movaps  xmmword [rsp+70h], xmm2
4236930    movaps  xmmword [rsp+80h], xmm3
4236938    movaps  xmmword [rsp+90h], xmm4
4236946    movaps  xmmword [rsp+0A0h], xmm5
4236954    movaps  xmmword [rsp+0B0h], xmm6
4236962    movaps  xmmword [rsp+0C0h], xmm7
loc_40A6AA:
4236970    test    rbx, rbx
4236973    mov     r12, rdx
4236976    jz      loc_40A760
loc_40A6B6:
4236982    test    ebp, ebp
4236984    js      loc_40A738
loc_40A6BA:
4236986    test    r12, r12
4236989    jz      loc_40A780
loc_40A6C3:
4236995    lea     rax, [rsp+0F0h]
4237003    lea     rdi, [rbx+4]
4237007    lea     rcx, [rsp+8]
4237012    mov     rdx, r12
4237015    mov     esi, 80h
4237020    mov     [rbx], ebp
4237022    mov     [rsp+10h], rax
4237027    lea     rax, [rsp+20h]
4237032    mov     dword [rsp+8], 18h
4237040    mov     dword [rsp+0Ch], 30h
4237048    mov     [rsp+18h], rax
4237053    call    _vsnprintf
4237058    mov     rdi, rbx
4237061    call    _invariant_3
4237066    test    eax, eax
4237068    jnz     loc_40A727
4237070    mov     ecx, __func___2580
4237075    mov     edx, 23h
4237080    mov     esi, aError_c
4237085    mov     edi, aInvariantErr
4237090    call    _daemon_assert_fail
loc_40A727:
4237095    add     rsp, 0D0h
4237102    pop     rbx
4237103    pop     rbp
4237104    pop     r12
4237106    retn    
4237107    align 8 
loc_40A738:
4237112    mov     ecx, __func___2580
4237117    mov     edx, 1Bh
4237122    mov     esi, aError_c
4237127    mov     edi, aError_code0
4237132    call    _daemon_assert_fail
4237137    jmp     loc_40A6BA
4237142    align 20h
loc_40A760:
4237152    mov     ecx, __func___2580
4237157    mov     edx, 1Ah
4237162    mov     esi, aError_c
4237167    mov     edi, aErrVoid0
4237172    call    _daemon_assert_fail
4237177    jmp     loc_40A6B6
4237182    align 20h
loc_40A780:
4237184    mov     ecx, __func___2580
4237189    mov     edx, 1Ch
4237194    mov     esi, aError_c
4237199    mov     edi, unk_40CD32
4237204    call    _daemon_assert_fail
USE32

section .text

global _error_get_error_code

_error_get_error_code:
4237216    push    rbx
4237217    mov     rbx, rdi
4237220    call    _invariant_3
4237225    test    eax, eax
4237227    jnz     loc_40A7C6
4237229    mov     ecx, __func___2584
4237234    mov     edx, 28h
4237239    mov     esi, aError_c
4237244    mov     edi, aInvariantErr
4237249    call    _daemon_assert_fail
loc_40A7C6:
4237254    mov     eax, [rbx]
4237256    pop     rbx
4237257    retn    
USE32

section .text

global _error_get_desc

_error_get_desc:
4237264    push    rbx
4237265    mov     rbx, rdi
4237268    call    _invariant_3
4237273    test    eax, eax
4237275    jnz     loc_40A7F6
4237277    mov     ecx, __func___2588
4237282    mov     edx, 2Eh
4237287    mov     esi, aError_c
4237292    mov     edi, aInvariantErr
4237297    call    _daemon_assert_fail
loc_40A7F6:
4237302    lea     rax, [rbx+4]
4237306    pop     rbx
4237307    retn    
USE32

section .text

global _daemon_assert_fail

_daemon_assert_fail:
4237312    push    r13
4237314    mov     r9, rdi
4237317    mov     r8, rcx
4237320    mov     r13, rdi
4237323    xor     eax, eax
4237325    mov     edi, 2
4237330    push    r12
4237332    mov     r12, rcx
4237335    mov     ecx, edx
4237337    push    rbp
4237338    mov     ebp, edx
4237340    mov     rdx, rsi
4237343    push    rbx
4237344    mov     rbx, rsi
4237347    mov     esi, aSDSS
4237352    sub     rsp, 8
4237356    call    _syslog
4237361    mov     rdi, [cs:stderr@@GLIBC_2_2_5]
4237368    mov     r9, r13
4237371    mov     r8, r12
4237374    mov     ecx, ebp
4237376    mov     rdx, rbx
4237379    mov     esi, aSD
4237384    xor     eax, eax
4237386    call    _fprintf
4237391    mov     edi, 1
4237396    call    _exit
USE32

section .text

global ___libc_csu_init

___libc_csu_init:
4237408    push    r15
4237410    mov     r15d, edi
4237413    push    r14
4237415    mov     r14, rsi
4237418    push    r13
4237420    mov     r13, rdx
4237423    push    r12
4237425    lea     r12, [__frame_dummy_init_array_entry]
4237432    push    rbp
4237433    lea     rbp, [__do_global_dtors_aux_fini_array_entry]
4237440    push    rbx
4237441    sub     rbp, r12
4237444    xor     ebx, ebx
4237446    sar     rbp, 3
4237450    sub     rsp, 8
4237454    call    _init_proc
4237459    test    rbp, rbp
4237462    jz      loc_40A8B6
4237464    nop     dword [rax+rax+00000000h]
loc_40A8A0:
4237472    mov     rdx, r13
4237475    mov     rsi, r14
4237478    mov     edi, r15d
4237481    call    qword [r12+rbx*8]
4237485    add     rbx, 1
4237489    cmp     rbx, rbp
4237492    jnz     loc_40A8A0
loc_40A8B6:
4237494    add     rsp, 8
4237498    pop     rbx
4237499    pop     rbp
4237500    pop     r12
4237502    pop     r13
4237504    pop     r14
4237506    pop     r15
4237508    retn    
