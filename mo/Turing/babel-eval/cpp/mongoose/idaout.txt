USE32

section .text

global __init_proc

__init_proc:
4202232    sub     rsp, 8
4202236    lea     rax, [__gmon_start__]
4202243    test    rax, rax
4202246    jz      loc_401F0D
4202248    call    __gmon_start__
loc_401F0D:
4202253    add     rsp, 8
4202257    retn    
USE32

section .text

global _deregister_tm_clones

_deregister_tm_clones:
4204256    mov     eax, 61A5BFh
4204261    push    rbp
4204262    sub     rax, 61A5B8h
4204268    cmp     rax, 0Eh
4204272    mov     rbp, rsp
4204275    ja      loc_4026F7
loc_4026F5:
4204277    pop     rbp
4204278    retn    
loc_4026F7:
4204279    mov     eax, 0
4204284    test    rax, rax
4204287    jz      loc_4026F5
4204289    pop     rbp
4204290    mov     edi, 61A5B8h
4204295    jmp     rax
USE32

section .text

global _register_tm_clones

_register_tm_clones:
4204304    mov     eax, 61A5B8h
4204309    push    rbp
4204310    sub     rax, 61A5B8h
4204316    sar     rax, 3
4204320    mov     rbp, rsp
4204323    mov     rdx, rax
4204326    shr     rdx, 3Fh
4204330    add     rax, rdx
4204333    sar     rax, 1
4204336    jnz     loc_402734
loc_402732:
4204338    pop     rbp
4204339    retn    
loc_402734:
4204340    mov     edx, 0
4204345    test    rdx, rdx
4204348    jz      loc_402732
4204350    pop     rbp
4204351    mov     rsi, rax
4204354    mov     edi, 61A5B8h
4204359    jmp     rdx
USE32

section .text

global _signal_handler

_signal_handler:
4204445    push    rbp
4204446    mov     rbp, rsp
4204449    sub     rsp, 10h
4204453    call    _mcount
4204458    mov     [rbp-4], edi
4204461    mov     eax, [rbp-4]
4204464    mov     esi, signal_handler
4204469    mov     edi, eax
4204471    call    ___sysv_signal
4204476    mov     eax, [rbp-4]
4204479    cmp     eax, 11h
4204482    jnz     loc_4027E0
loc_4027C4:
4204484    lea     rax, [rbp-4]
4204488    mov     edx, 1
4204493    mov     rsi, rax
4204496    mov     edi, 0FFFFFFFFh
4204501    call    _waitpid
4204506    test    eax, eax
4204508    jg      loc_4027C4
4204510    jmp     locret_4027E9
loc_4027E0:
4204512    mov     eax, [rbp-4]
4204515    mov     [cs:exit_flag], eax
locret_4027E9:
4204521    leave   
4204522    retn    
USE32

section .text

global _vnotify

_vnotify:
4204523    push    rbp
4204524    mov     rbp, rsp
4204527    sub     rsp, 20h
4204531    call    _mcount
4204536    mov     [rbp-8], rdi
4204540    mov     [rbp-10h], rsi
4204544    mov     [rbp-14h], edx
4204547    mov     rax, [cs:stderr@@GLIBC_2_2_5]
4204554    mov     rdx, [rbp-10h]
4204558    mov     rcx, [rbp-8]
4204562    mov     rsi, rcx
4204565    mov     rdi, rax
4204568    call    _vfprintf
4204573    mov     rax, [cs:stderr@@GLIBC_2_2_5]
4204580    mov     rsi, rax
4204583    mov     edi, 0Ah
4204588    call    _fputc
4204593    cmp     dword [rbp-14h], 0
4204597    jz      locret_402841
4204599    mov     edi, 1
4204604    call    _exit
locret_402841:
4204609    leave   
4204610    retn    
USE32

section .text

global _notify

_notify:
4204611    push    rbp
4204612    mov     rbp, rsp
4204615    sub     rsp, 0E0h
4204622    call    _mcount
4204627    mov     [rbp-0A8h], rsi
4204634    mov     [rbp-0A0h], rdx
4204641    mov     [rbp-98h], rcx
4204648    mov     [rbp-90h], r8
4204655    mov     [rbp-88h], r9
4204662    test    al, al
4204664    jz      loc_40289A
4204666    movaps  xmmword [rbp-80h], xmm0
4204670    movaps  xmmword [rbp-70h], xmm1
4204674    movaps  xmmword [rbp-60h], xmm2
4204678    movaps  xmmword [rbp-50h], xmm3
4204682    movaps  xmmword [rbp-40h], xmm4
4204686    movaps  xmmword [rbp-30h], xmm5
4204690    movaps  xmmword [rbp-20h], xmm6
4204694    movaps  xmmword [rbp-10h], xmm7
loc_40289A:
4204698    mov     [rbp-0D8h], rdi
4204705    mov     dword [rbp-0C8h], 8
4204715    mov     dword [rbp-0C4h], 30h
4204725    lea     rax, [rbp+10h]
4204729    mov     [rbp-0C0h], rax
4204736    lea     rax, [rbp-0B0h]
4204743    mov     [rbp-0B8h], rax
4204750    lea     rcx, [rbp-0C8h]
4204757    mov     rax, [rbp-0D8h]
4204764    mov     edx, 0
4204769    mov     rsi, rcx
4204772    mov     rdi, rax
4204775    call    _vnotify
4204780    leave   
4204781    retn    
USE32

section .text

global _die

_die:
4204782    push    rbp
4204783    mov     rbp, rsp
4204786    sub     rsp, 0E0h
4204793    call    _mcount
4204798    mov     [rbp-0A8h], rsi
4204805    mov     [rbp-0A0h], rdx
4204812    mov     [rbp-98h], rcx
4204819    mov     [rbp-90h], r8
4204826    mov     [rbp-88h], r9
4204833    test    al, al
4204835    jz      loc_402945
4204837    movaps  xmmword [rbp-80h], xmm0
4204841    movaps  xmmword [rbp-70h], xmm1
4204845    movaps  xmmword [rbp-60h], xmm2
4204849    movaps  xmmword [rbp-50h], xmm3
4204853    movaps  xmmword [rbp-40h], xmm4
4204857    movaps  xmmword [rbp-30h], xmm5
4204861    movaps  xmmword [rbp-20h], xmm6
4204865    movaps  xmmword [rbp-10h], xmm7
loc_402945:
4204869    mov     [rbp-0D8h], rdi
4204876    mov     dword [rbp-0C8h], 8
4204886    mov     dword [rbp-0C4h], 30h
4204896    lea     rax, [rbp+10h]
4204900    mov     [rbp-0C0h], rax
4204907    lea     rax, [rbp-0B0h]
4204914    mov     [rbp-0B8h], rax
4204921    lea     rcx, [rbp-0C8h]
4204928    mov     rax, [rbp-0D8h]
4204935    mov     edx, 1
4204940    mov     rsi, rcx
4204943    mov     rdi, rax
4204946    call    _vnotify
4204951    leave   
4204952    retn    
USE32

section .text

global _show_usage_and_exit

_show_usage_and_exit:
4204953    push    rbp
4204954    mov     rbp, rsp
4204957    sub     rsp, 10h
4204961    call    _mcount
4204966    mov     rax, [cs:stderr@@GLIBC_2_2_5]
4204973    mov     ecx, aNov192015
4204978    mov     edx, a5_6
4204983    mov     esi, format
4204988    mov     rdi, rax
4204991    mov     eax, 0
4204996    call    _fprintf
4205001    mov     rax, [cs:stderr@@GLIBC_2_2_5]
4205008    mov     rcx, rax
4205011    mov     edx, 7
4205016    mov     esi, 1
4205021    mov     edi, aUsage
4205026    call    _fwrite
4205031    mov     rax, [cs:stderr@@GLIBC_2_2_5]
4205038    mov     rcx, rax
4205041    mov     edx, 36h
4205046    mov     esi, 1
4205051    mov     edi, aMongooseAHtpas
4205056    call    _fwrite
4205061    mov     rax, [cs:stderr@@GLIBC_2_2_5]
4205068    mov     rcx, rax
4205071    mov     edx, 19h
4205076    mov     esi, 1
4205081    mov     edi, aMongooseConfig
4205086    call    _fwrite
4205091    mov     rax, [cs:stderr@@GLIBC_2_2_5]
4205098    mov     rcx, rax
4205101    mov     edx, 1Fh
4205106    mov     esi, 1
4205111    mov     edi, aMongooseOption
4205116    call    _fwrite
4205121    mov     rax, [cs:stderr@@GLIBC_2_2_5]
4205128    mov     rcx, rax
4205131    mov     edx, 0Ah
4205136    mov     esi, 1
4205141    mov     edi, aOptions
4205146    call    _fwrite
4205151    call    _mg_get_valid_option_names
4205156    mov     [rbp-8], rax
4205160    mov     dword [rbp-0Ch], 0
4205167    jmp     loc_402AE8
loc_402A71:
4205169    mov     eax, [rbp-0Ch]
4205172    cdqe    
4205174    add     rax, 1
4205178    lea     rdx, 0[rax*8]
4205186    mov     rax, [rbp-8]
4205190    add     rax, rdx
4205193    mov     rax, [rax]
4205196    test    rax, rax
4205199    jz      loc_402AAE
4205201    mov     eax, [rbp-0Ch]
4205204    cdqe    
4205206    add     rax, 1
4205210    lea     rdx, 0[rax*8]
4205218    mov     rax, [rbp-8]
4205222    add     rax, rdx
4205225    mov     rax, [rax]
4205228    jmp     loc_402AB3
loc_402AAE:
4205230    mov     eax, aEmpty
loc_402AB3:
4205235    mov     edx, [rbp-0Ch]
4205238    movsxd  rdx, edx
4205241    lea     rcx, 0[rdx*8]
4205249    mov     rdx, [rbp-8]
4205253    add     rdx, rcx
4205256    mov     rdx, [rdx]
4205259    mov     rdi, [cs:stderr@@GLIBC_2_2_5]
4205266    mov     rcx, rax
4205269    mov     esi, aSS
4205274    mov     eax, 0
4205279    call    _fprintf
4205284    add     dword [rbp-0Ch], 2
loc_402AE8:
4205288    mov     eax, [rbp-0Ch]
4205291    cdqe    
4205293    lea     rdx, 0[rax*8]
4205301    mov     rax, [rbp-8]
4205305    add     rax, rdx
4205308    mov     rax, [rax]
4205311    test    rax, rax
4205314    jnz     loc_402A71
4205320    mov     edi, 1
4205325    call    _exit
USE32

section .text

global _sdup

_sdup:
4205330    push    rbp
4205331    mov     rbp, rsp
4205334    sub     rsp, 20h
4205338    call    _mcount
4205343    mov     [rbp-18h], rdi
4205347    mov     rax, [rbp-18h]
4205351    mov     rdi, rax
4205354    call    _strlen
4205359    add     rax, 1
4205363    mov     rdi, rax
4205366    call    _malloc
4205371    mov     [rbp-8], rax
4205375    cmp     qword [rbp-8], 0
4205380    jz      loc_402B59
4205382    mov     rdx, [rbp-18h]
4205386    mov     rax, [rbp-8]
4205390    mov     rsi, rdx
4205393    mov     rdi, rax
4205396    call    _strcpy
loc_402B59:
4205401    mov     rax, [rbp-8]
4205405    leave   
4205406    retn    
USE32

section .text

global _set_option

_set_option:
4205407    push    rbp
4205408    mov     rbp, rsp
4205411    push    rbx
4205412    sub     rsp, 38h
4205416    call    _mcount
4205421    mov     [rbp-28h], rdi
4205425    mov     [rbp-30h], rsi
4205429    mov     [rbp-38h], rdx
4205433    mov     dword [rbp-14h], 0
4205440    jmp     loc_402C8C
loc_402B85:
4205445    mov     eax, [rbp-14h]
4205448    cdqe    
4205450    lea     rdx, 0[rax*8]
4205458    mov     rax, [rbp-28h]
4205462    add     rax, rdx
4205465    mov     rax, [rax]
4205468    test    rax, rax
4205471    jnz     loc_402C11
4205473    mov     eax, [rbp-14h]
4205476    cdqe    
4205478    lea     rdx, 0[rax*8]
4205486    mov     rax, [rbp-28h]
4205490    lea     rbx, [rdx+rax]
4205494    mov     rax, [rbp-30h]
4205498    mov     rdi, rax
4205501    call    _sdup
4205506    mov     [rbx], rax
4205509    mov     eax, [rbp-14h]
4205512    cdqe    
4205514    add     rax, 1
4205518    lea     rdx, 0[rax*8]
4205526    mov     rax, [rbp-28h]
4205530    lea     rbx, [rdx+rax]
4205534    mov     rax, [rbp-38h]
4205538    mov     rdi, rax
4205541    call    _sdup
4205546    mov     [rbx], rax
4205549    mov     eax, [rbp-14h]
4205552    cdqe    
4205554    add     rax, 2
4205558    lea     rdx, 0[rax*8]
4205566    mov     rax, [rbp-28h]
4205570    add     rax, rdx
4205573    mov     qword [rax], 0
4205580    jmp     loc_402C96
loc_402C11:
4205585    mov     eax, [rbp-14h]
4205588    cdqe    
4205590    lea     rdx, 0[rax*8]
4205598    mov     rax, [rbp-28h]
4205602    add     rax, rdx
4205605    mov     rax, [rax]
4205608    mov     rdx, [rbp-30h]
4205612    mov     rsi, rdx
4205615    mov     rdi, rax
4205618    call    _strcmp
4205623    test    eax, eax
4205625    jnz     loc_402C88
4205627    mov     eax, [rbp-14h]
4205630    cdqe    
4205632    add     rax, 1
4205636    lea     rdx, 0[rax*8]
4205644    mov     rax, [rbp-28h]
4205648    add     rax, rdx
4205651    mov     rax, [rax]
4205654    mov     rdi, rax
4205657    call    _free
4205662    mov     eax, [rbp-14h]
4205665    cdqe    
4205667    add     rax, 1
4205671    lea     rdx, 0[rax*8]
4205679    mov     rax, [rbp-28h]
4205683    lea     rbx, [rdx+rax]
4205687    mov     rax, [rbp-38h]
4205691    mov     rdi, rax
4205694    call    _sdup
4205699    mov     [rbx], rax
4205702    jmp     loc_402C96
loc_402C88:
4205704    add     dword [rbp-14h], 1
loc_402C8C:
4205708    cmp     dword [rbp-14h], 60h
4205712    jle     loc_402B85
loc_402C96:
4205718    cmp     dword [rbp-14h], 61h
4205722    jnz     loc_402CB0
4205724    mov     esi, aTooManyOptions
4205729    mov     edi, aS
4205734    mov     eax, 0
4205739    call    _die
loc_402CB0:
4205744    add     rsp, 38h
4205748    pop     rbx
4205749    pop     rbp
4205750    retn    
USE32

section .text

global _process_command_line_arguments

_process_command_line_arguments:
4205751    push    rbp
4205752    mov     rbp, rsp
4205755    push    rbx
4205756    sub     rsp, 7068h
4205763    call    _mcount
4205768    mov     [rbp-7058h], rdi
4205775    mov     [rbp-7060h], rsi
4205782    mov     rax, [fs:28h]
4205791    mov     [rbp-18h], rax
4205795    xor     eax, eax
4205797    mov     qword [rbp-7030h], 0
4205808    mov     qword [rbp-7040h], 1
4205819    mov     qword [rbp-7038h], 0
4205830    mov     rax, [rbp-7058h]
4205837    add     rax, 8
4205841    mov     rax, [rax]
4205844    test    rax, rax
4205847    jz      loc_402D6D
4205849    mov     rax, [rbp-7058h]
4205856    add     rax, 8
4205860    mov     rax, [rax]
4205863    movzx   eax, byte [rax]
4205866    cmp     al, 2Dh
4205868    jz      loc_402D6D
4205870    mov     rax, [rbp-7058h]
4205877    add     rax, 8
4205881    mov     rdx, [rax]
4205884    lea     rax, [rbp-7020h]
4205891    mov     rcx, rdx
4205894    mov     edx, aS
4205899    mov     esi, 1000h
4205904    mov     rdi, rax
4205907    mov     eax, 0
4205912    call    _snprintf
4205917    mov     qword [rbp-7040h], 2
4205928    jmp     loc_402E0C
loc_402D6D:
4205933    mov     rax, [rbp-7058h]
4205940    mov     rax, [rax]
4205943    mov     esi, 2Fh
4205948    mov     rdi, rax
4205951    call    _strrchr
4205956    mov     [rbp-7028h], rax
4205963    cmp     qword [rbp-7028h], 0
4205971    jnz     loc_402DB8
4205973    lea     rax, [rbp-7020h]
4205980    mov     rbx, 65736F6F676E6F6Dh
4205990    mov     [rax], rbx
4205993    mov     dword [rax+8], 6E6F632Eh
4206000    mov     word [rax+0Ch], 66h
4206006    jmp     loc_402E0C
loc_402DB8:
4206008    mov     rax, [rbp-7058h]
4206015    mov     rcx, [rax]
4206018    mov     rdx, [rbp-7028h]
4206025    mov     rax, [rbp-7058h]
4206032    mov     rax, [rax]
4206035    sub     rdx, rax
4206038    mov     rax, rdx
4206041    mov     edx, eax
4206043    lea     rax, [rbp-7020h]
4206050    mov     qword [rsp], aMongoose_conf
4206058    mov     r9d, 2Fh
4206064    mov     r8, rcx
4206067    mov     ecx, edx
4206069    mov     edx, a_SCS
4206074    mov     esi, 1000h
4206079    mov     rdi, rax
4206082    mov     eax, 0
4206087    call    _snprintf
loc_402E0C:
4206092    lea     rax, [rbp-7020h]
4206099    mov     esi, s_config_file
4206104    mov     rdi, rax
4206107    call    _realpath
4206112    mov     esi, modes
4206117    mov     edi, s_config_file
4206122    call    _fopen
4206127    mov     [rbp-7030h], rax
4206134    cmp     qword [rbp-7040h], 2
4206142    jnz     loc_402E6F
4206144    cmp     qword [rbp-7030h], 0
4206152    jnz     loc_402E6F
4206154    call    ___errno_location
4206159    mov     eax, [rax]
4206161    mov     edi, eax
4206163    call    _strerror
4206168    mov     rdx, rax
4206171    mov     esi, s_config_file
4206176    mov     edi, aCannotOpenConf
4206181    mov     eax, 0
4206186    call    _die
loc_402E6F:
4206191    cmp     qword [rbp-7030h], 0
4206199    jz      loc_402FCB
4206205    mov     rax, [cs:stderr@@GLIBC_2_2_5]
4206212    mov     edx, s_config_file
4206217    mov     esi, aLoadingConfigF
4206222    mov     rdi, rax
4206225    mov     eax, 0
4206230    call    _fprintf
4206235    jmp     loc_402F98
loc_402EA0:
4206240    add     qword [rbp-7038h], 1
4206248    mov     qword [rbp-7048h], 0
4206259    jmp     loc_402EBD
loc_402EB5:
4206261    add     qword [rbp-7048h], 1
loc_402EBD:
4206269    call    ___ctype_b_loc
4206274    mov     rax, [rax]
4206277    lea     rcx, [rbp-6020h]
4206284    mov     rdx, [rbp-7048h]
4206291    add     rdx, rcx
4206294    movzx   edx, byte [rdx]
4206297    movzx   edx, dl
4206300    add     rdx, rdx
4206303    add     rax, rdx
4206306    movzx   eax, word [rax]
4206309    movzx   eax, ax
4206312    and     eax, 2000h
4206317    test    eax, eax
4206319    jnz     loc_402EB5
4206321    lea     rdx, [rbp-6020h]
4206328    mov     rax, [rbp-7048h]
4206335    add     rax, rdx
4206338    movzx   eax, byte [rax]
4206341    cmp     al, 23h
4206343    jz      loc_402F21
4206345    lea     rdx, [rbp-6020h]
4206352    mov     rax, [rbp-7048h]
4206359    add     rax, rdx
4206362    movzx   eax, byte [rax]
4206365    test    al, al
4206367    jnz     loc_402F23
loc_402F21:
4206369    jmp     loc_402F98
loc_402F23:
4206371    lea     rcx, [rbp-2020h]
4206378    lea     rdx, [rbp-4020h]
4206385    lea     rax, [rbp-6020h]
4206392    mov     esi, aS_0
4206397    mov     rdi, rax
4206400    mov     eax, 0
4206405    call    ___isoc99_sscanf
4206410    cmp     eax, 2
4206413    jz      loc_402F78
4206415    mov     rax, [rbp-7038h]
4206422    lea     rdx, [rbp-6020h]
4206429    mov     rcx, rdx
4206432    mov     edx, eax
4206434    mov     esi, s_config_file
4206439    mov     edi, aSLineDIsInvali
4206444    mov     eax, 0
4206449    call    _printf
4206454    jmp     loc_402F98
loc_402F78:
4206456    lea     rdx, [rbp-2020h]
4206463    lea     rcx, [rbp-4020h]
4206470    mov     rax, [rbp-7060h]
4206477    mov     rsi, rcx
4206480    mov     rdi, rax
4206483    call    _set_option
loc_402F98:
4206488    mov     rdx, [rbp-7030h]
4206495    lea     rax, [rbp-6020h]
4206502    mov     esi, 2000h
4206507    mov     rdi, rax
4206510    call    _fgets
4206515    test    rax, rax
4206518    jnz     loc_402EA0
4206524    mov     rax, [rbp-7030h]
4206531    mov     rdi, rax
4206534    call    _fclose
loc_402FCB:
4206539    mov     rax, [rbp-7058h]
4206546    add     rax, 8
4206550    mov     rax, [rax]
4206553    test    rax, rax
4206556    jz      loc_403006
4206558    mov     rax, [rbp-7058h]
4206565    add     rax, 8
4206569    mov     rax, [rax]
4206572    mov     edx, 5
4206577    mov     esi, aPsn_
4206582    mov     rdi, rax
4206585    call    _memcmp
4206590    test    eax, eax
4206592    jz      loc_4030E5
loc_403006:
4206598    mov     rax, [rbp-7040h]
4206605    mov     [rbp-7048h], rax
4206612    jmp     loc_4030C0
loc_403019:
4206617    mov     rax, [rbp-7048h]
4206624    lea     rdx, 0[rax*8]
4206632    mov     rax, [rbp-7058h]
4206639    add     rax, rdx
4206642    mov     rax, [rax]
4206645    movzx   eax, byte [rax]
4206648    cmp     al, 2Dh
4206650    jnz     loc_403061
4206652    mov     rax, [rbp-7048h]
4206659    add     rax, 1
4206663    lea     rdx, 0[rax*8]
4206671    mov     rax, [rbp-7058h]
4206678    add     rax, rdx
4206681    mov     rax, [rax]
4206684    test    rax, rax
4206687    jnz     loc_403066
loc_403061:
4206689    call    _show_usage_and_exit
loc_403066:
4206694    mov     rax, [rbp-7048h]
4206701    add     rax, 1
4206705    lea     rdx, 0[rax*8]
4206713    mov     rax, [rbp-7058h]
4206720    add     rax, rdx
4206723    mov     rdx, [rax]
4206726    mov     rax, [rbp-7048h]
4206733    lea     rcx, 0[rax*8]
4206741    mov     rax, [rbp-7058h]
4206748    add     rax, rcx
4206751    mov     rax, [rax]
4206754    lea     rcx, [rax+1]
4206758    mov     rax, [rbp-7060h]
4206765    mov     rsi, rcx
4206768    mov     rdi, rax
4206771    call    _set_option
4206776    add     qword [rbp-7048h], 2
loc_4030C0:
4206784    mov     rax, [rbp-7048h]
4206791    lea     rdx, 0[rax*8]
4206799    mov     rax, [rbp-7058h]
4206806    add     rax, rdx
4206809    mov     rax, [rax]
4206812    test    rax, rax
4206815    jnz     loc_403019
loc_4030E5:
4206821    mov     rax, [rbp-18h]
4206825    xor     rax, [fs:28h]
4206834    jz      loc_4030F9
4206836    call    ___stack_chk_fail
loc_4030F9:
4206841    add     rsp, 7068h
4206848    pop     rbx
4206849    pop     rbp
4206850    retn    
USE32

section .text

global _init_server_name

_init_server_name:
4206851    push    rbp
4206852    mov     rbp, rsp
4206855    sub     rsp, 10h
4206859    call    _mcount
4206864    mov     qword [rbp-8], unk_413EE7
4206872    mov     rax, [rbp-8]
4206876    mov     r8, rax
4206879    mov     ecx, a5_6
4206884    mov     edx, aMongooseWebSer
4206889    mov     esi, 32h
4206894    mov     edi, server_name
4206899    mov     eax, 0
4206904    call    _snprintf
4206909    leave   
4206910    retn    
USE32

section .text

global _is_path_absolute

_is_path_absolute:
4206911    push    rbp
4206912    mov     rbp, rsp
4206915    sub     rsp, 8
4206919    call    _mcount
4206924    mov     [rbp-8], rdi
4206928    cmp     qword [rbp-8], 0
4206933    jz      loc_403169
4206935    mov     rax, [rbp-8]
4206939    movzx   eax, byte [rax]
4206942    cmp     al, 2Fh
4206944    jnz     loc_403169
4206946    mov     eax, 1
4206951    jmp     locret_40316E
loc_403169:
4206953    mov     eax, 0
locret_40316E:
4206958    leave   
4206959    retn    
USE32

section .text

global _get_option

_get_option:
4206960    push    rbp
4206961    mov     rbp, rsp
4206964    sub     rsp, 20h
4206968    call    _mcount
4206973    mov     [rbp-18h], rdi
4206977    mov     [rbp-20h], rsi
4206981    mov     dword [rbp-4], 0
4206988    jmp     loc_4031D9
loc_40318E:
4206990    mov     eax, [rbp-4]
4206993    cdqe    
4206995    lea     rdx, 0[rax*8]
4207003    mov     rax, [rbp-18h]
4207007    add     rax, rdx
4207010    mov     rax, [rax]
4207013    mov     rdx, [rbp-20h]
4207017    mov     rsi, rdx
4207020    mov     rdi, rax
4207023    call    _strcmp
4207028    test    eax, eax
4207030    jnz     loc_4031D5
4207032    mov     eax, [rbp-4]
4207035    cdqe    
4207037    add     rax, 1
4207041    lea     rdx, 0[rax*8]
4207049    mov     rax, [rbp-18h]
4207053    add     rax, rdx
4207056    mov     rax, [rax]
4207059    jmp     locret_4031FA
loc_4031D5:
4207061    add     dword [rbp-4], 1
loc_4031D9:
4207065    mov     eax, [rbp-4]
4207068    cdqe    
4207070    lea     rdx, 0[rax*8]
4207078    mov     rax, [rbp-18h]
4207082    add     rax, rdx
4207085    mov     rax, [rax]
4207088    test    rax, rax
4207091    jnz     loc_40318E
4207093    mov     eax, 0
locret_4031FA:
4207098    leave   
4207099    retn    
USE32

section .text

global _serving_thread_func

_serving_thread_func:
4207100    push    rbp
4207101    mov     rbp, rsp
4207104    sub     rsp, 20h
4207108    call    _mcount
4207113    mov     [rbp-18h], rdi
4207117    mov     rax, [rbp-18h]
4207121    mov     [rbp-8], rax
4207125    jmp     loc_403228
loc_403217:
4207127    mov     rax, [rbp-8]
4207131    mov     esi, 3E8h
4207136    mov     rdi, rax
4207139    call    _mg_poll_server
loc_403228:
4207144    mov     eax, [cs:exit_flag]
4207150    test    eax, eax
4207152    jz      loc_403217
4207154    mov     eax, 0
4207159    leave   
4207160    retn    
USE32

section .text

global _path_exists

_path_exists:
4207161    push    rbp
4207162    mov     rbp, rsp
4207165    sub     rsp, 0A0h
4207172    call    _mcount
4207177    mov     [rbp-98h], rdi
4207184    mov     [rbp-9Ch], esi
4207190    cmp     qword [rbp-98h], 0
4207198    jz      loc_403298
4207200    lea     rdx, [rbp-90h]
4207207    mov     rax, [rbp-98h]
4207214    mov     rsi, rdx
4207217    mov     rdi, rax
4207220    call    _stat
4207225    test    eax, eax
4207227    jnz     loc_40329F
4207229    mov     eax, [rbp-78h]
4207232    and     eax, 0F000h
4207237    cmp     eax, 4000h
4207242    setz    al
4207245    movzx   eax, al
4207248    cmp     eax, [rbp-9Ch]
4207254    jnz     loc_40329F
loc_403298:
4207256    mov     eax, 1
4207261    jmp     locret_4032A4
loc_40329F:
4207263    mov     eax, 0
locret_4032A4:
4207268    leave   
4207269    retn    
USE32

section .text

global _verify_existence

_verify_existence:
4207270    push    rbp
4207271    mov     rbp, rsp
4207274    sub     rsp, 30h
4207278    call    _mcount
4207283    mov     [rbp-18h], rdi
4207287    mov     [rbp-20h], rsi
4207291    mov     [rbp-24h], edx
4207294    mov     rdx, [rbp-20h]
4207298    mov     rax, [rbp-18h]
4207302    mov     rsi, rdx
4207305    mov     rdi, rax
4207308    call    _get_option
4207313    mov     [rbp-8], rax
4207317    mov     edx, [rbp-24h]
4207320    mov     rax, [rbp-8]
4207324    mov     esi, edx
4207326    mov     rdi, rax
4207329    call    _path_exists
4207334    test    eax, eax
4207336    jnz     locret_403315
4207338    call    ___errno_location
4207343    mov     eax, [rax]
4207345    mov     edi, eax
4207347    call    _strerror
4207352    mov     rcx, rax
4207355    mov     rdx, [rbp-8]
4207359    mov     rax, [rbp-20h]
4207363    mov     rsi, rax
4207366    mov     edi, aInvalidPathFor
4207371    mov     eax, 0
4207376    call    _notify
locret_403315:
4207381    leave   
4207382    retn    
USE32

section .text

global _set_absolute_path

_set_absolute_path:
4207383    push    rbp
4207384    mov     rbp, rsp
4207387    sub     rsp, 2030h
4207394    call    _mcount
4207399    mov     [rbp-2028h], rdi
4207406    mov     [rbp-2030h], rsi
4207413    mov     rax, [fs:28h]
4207422    mov     [rbp-8], rax
4207426    xor     eax, eax
4207428    mov     rdx, [rbp-2030h]
4207435    mov     rax, [rbp-2028h]
4207442    mov     rsi, rdx
4207445    mov     rdi, rax
4207448    call    _get_option
4207453    mov     [rbp-2020h], rax
4207460    cmp     qword [rbp-2020h], 0
4207468    jz      loc_403484
4207474    mov     rax, [rbp-2020h]
4207481    mov     rdi, rax
4207484    call    _is_path_absolute
4207489    test    eax, eax
4207491    jnz     loc_403484
4207497    mov     esi, 2Fh
4207502    mov     edi, s_config_file
4207507    call    _strrchr
4207512    mov     [rbp-2018h], rax
4207519    cmp     qword [rbp-2018h], 0
4207527    jnz     loc_4033BF
4207529    lea     rax, [rbp-2010h]
4207536    mov     esi, 1000h
4207541    mov     rdi, rax
4207544    call    _getcwd
4207549    jmp     loc_4033F9
loc_4033BF:
4207551    mov     rdx, [rbp-2018h]
4207558    mov     eax, s_config_file
4207563    sub     rdx, rax
4207566    mov     rax, rdx
4207569    mov     edx, eax
4207571    lea     rax, [rbp-2010h]
4207578    mov     r8d, s_config_file
4207584    mov     ecx, edx
4207586    mov     edx, a_S
4207591    mov     esi, 1000h
4207596    mov     rdi, rax
4207599    mov     eax, 0
4207604    call    _snprintf
loc_4033F9:
4207609    lea     rax, [rbp-2010h]
4207616    mov     rcx, 0FFFFFFFFFFFFFFFFh
4207623    mov     rdx, rax
4207626    mov     eax, 0
4207631    mov     rdi, rdx
4207634    repne scasb
4207636    mov     rax, rcx
4207639    not     rax
4207642    lea     rdx, [rax-1]
4207646    lea     rax, [rbp-2010h]
4207653    add     rax, rdx
4207656    mov     word [rax], 2Fh
4207661    mov     rcx, [rbp-2020h]
4207668    lea     rax, [rbp-2010h]
4207675    mov     edx, 0FFFh
4207680    mov     rsi, rcx
4207683    mov     rdi, rax
4207686    call    _strncat
4207691    lea     rdx, [rbp-1010h]
4207698    lea     rax, [rbp-2010h]
4207705    mov     rsi, rdx
4207708    mov     rdi, rax
4207711    call    _realpath
4207716    lea     rdx, [rbp-1010h]
4207723    mov     rcx, [rbp-2030h]
4207730    mov     rax, [rbp-2028h]
4207737    mov     rsi, rcx
4207740    mov     rdi, rax
4207743    call    _set_option
loc_403484:
4207748    mov     rax, [rbp-8]
4207752    xor     rax, [fs:28h]
4207761    jz      locret_403498
4207763    call    ___stack_chk_fail
locret_403498:
4207768    leave   
4207769    retn    
USE32

section .text

global _modify_passwords_file

_modify_passwords_file:
4207770    push    rbp
4207771    mov     rbp, rsp
4207774    push    rbx
4207775    sub     rsp, 1698h
4207782    call    _mcount
4207787    mov     [rbp-1678h], rdi
4207794    mov     [rbp-1680h], rsi
4207801    mov     [rbp-1688h], rdx
4207808    mov     [rbp-1690h], rcx
4207815    mov     rax, [fs:28h]
4207824    mov     [rbp-18h], rax
4207828    xor     eax, eax
4207830    mov     dword [rbp-1664h], 0
4207840    mov     qword [rbp-1660h], 0
4207851    mov     rax, [rbp-1660h]
4207858    mov     [rbp-1658h], rax
4207865    cmp     qword [rbp-1690h], 0
4207873    jz      loc_40351C
4207875    mov     rax, [rbp-1690h]
4207882    movzx   eax, byte [rax]
4207885    test    al, al
4207887    jnz     loc_40351C
4207889    mov     qword [rbp-1690h], 0
loc_40351C:
4207900    mov     rdx, [rbp-1678h]
4207907    lea     rax, [rbp-1020h]
4207914    mov     rcx, rdx
4207917    mov     edx, aS_tmp
4207922    mov     esi, 1000h
4207927    mov     rdi, rax
4207930    mov     eax, 0
4207935    call    _snprintf
4207940    mov     rax, [rbp-1678h]
4207947    mov     esi, aA
4207952    mov     rdi, rax
4207955    call    _fopen
4207960    mov     [rbp-1658h], rax
4207967    cmp     qword [rbp-1658h], 0
4207975    jz      loc_403578
4207977    mov     rax, [rbp-1658h]
4207984    mov     rdi, rax
4207987    call    _fclose
loc_403578:
4207992    mov     rax, [rbp-1678h]
4207999    mov     esi, modes
4208004    mov     rdi, rax
4208007    call    _fopen
4208012    mov     [rbp-1658h], rax
4208019    cmp     qword [rbp-1658h], 0
4208027    jnz     loc_4035A7
4208029    mov     eax, 0
4208034    jmp     loc_4037F3
loc_4035A7:
4208039    lea     rax, [rbp-1020h]
4208046    mov     esi, aW
4208051    mov     rdi, rax
4208054    call    _fopen
4208059    mov     [rbp-1660h], rax
4208066    cmp     qword [rbp-1660h], 0
4208074    jnz     loc_4035E5
4208076    mov     rax, [rbp-1658h]
4208083    mov     rdi, rax
4208086    call    _fclose
4208091    mov     eax, 0
4208096    jmp     loc_4037F3
loc_4035E5:
4208101    jmp     loc_4036FE
loc_4035EA:
4208106    lea     rcx, [rbp-1220h]
4208113    lea     rdx, [rbp-1420h]
4208120    lea     rax, [rbp-1620h]
4208127    mov     esi, aS_1
4208132    mov     rdi, rax
4208135    mov     eax, 0
4208140    call    ___isoc99_sscanf
4208145    cmp     eax, 2
4208148    jz      loc_40361B
4208150    jmp     loc_4036FE
loc_40361B:
4208155    mov     rdx, [rbp-1688h]
4208162    lea     rax, [rbp-1420h]
4208169    mov     rsi, rdx
4208172    mov     rdi, rax
4208175    call    _strcmp
4208180    test    eax, eax
4208182    jnz     loc_4036E5
4208188    mov     rdx, [rbp-1680h]
4208195    lea     rax, [rbp-1220h]
4208202    mov     rsi, rdx
4208205    mov     rdi, rax
4208208    call    _strcmp
4208213    test    eax, eax
4208215    jnz     loc_4036E5
4208221    add     dword [rbp-1664h], 1
4208228    cmp     qword [rbp-1690h], 0
4208236    jz      loc_4036E3
4208238    mov     rcx, [rbp-1690h]
4208245    mov     rdx, [rbp-1680h]
4208252    mov     rsi, [rbp-1688h]
4208259    lea     rax, [rbp-1650h]
4208266    mov     qword [rsp], 0
4208274    mov     r9, rcx
4208277    mov     r8d, asc_413F9D
4208283    mov     rcx, rdx
4208286    mov     edx, asc_413F9D
4208291    mov     rdi, rax
4208294    mov     eax, 0
4208299    call    _mg_md5
4208304    lea     rsi, [rbp-1650h]
4208311    mov     rcx, [rbp-1680h]
4208318    mov     rdx, [rbp-1688h]
4208325    mov     rax, [rbp-1660h]
4208332    mov     r8, rsi
4208335    mov     esi, aSSS
4208340    mov     rdi, rax
4208343    mov     eax, 0
4208348    call    _fprintf
4208353    jmp     loc_4036FE
loc_4036E3:
4208355    jmp     loc_4036FE
loc_4036E5:
4208357    mov     rdx, [rbp-1660h]
4208364    lea     rax, [rbp-1620h]
4208371    mov     rsi, rdx
4208374    mov     rdi, rax
4208377    call    _fputs
loc_4036FE:
4208382    mov     rdx, [rbp-1658h]
4208389    lea     rax, [rbp-1620h]
4208396    mov     esi, 200h
4208401    mov     rdi, rax
4208404    call    _fgets
4208409    test    rax, rax
4208412    jnz     loc_4035EA
4208418    cmp     dword [rbp-1664h], 0
4208425    jnz     loc_4037A8
4208427    cmp     qword [rbp-1690h], 0
4208435    jz      loc_4037A8
4208437    mov     rcx, [rbp-1690h]
4208444    mov     rdx, [rbp-1680h]
4208451    mov     rsi, [rbp-1688h]
4208458    lea     rax, [rbp-1650h]
4208465    mov     qword [rsp], 0
4208473    mov     r9, rcx
4208476    mov     r8d, asc_413F9D
4208482    mov     rcx, rdx
4208485    mov     edx, asc_413F9D
4208490    mov     rdi, rax
4208493    mov     eax, 0
4208498    call    _mg_md5
4208503    lea     rsi, [rbp-1650h]
4208510    mov     rcx, [rbp-1680h]
4208517    mov     rdx, [rbp-1688h]
4208524    mov     rax, [rbp-1660h]
4208531    mov     r8, rsi
4208534    mov     esi, aSSS
4208539    mov     rdi, rax
4208542    mov     eax, 0
4208547    call    _fprintf
loc_4037A8:
4208552    mov     rax, [rbp-1658h]
4208559    mov     rdi, rax
4208562    call    _fclose
4208567    mov     rax, [rbp-1660h]
4208574    mov     rdi, rax
4208577    call    _fclose
4208582    mov     rax, [rbp-1678h]
4208589    mov     rdi, rax
4208592    call    _remove
4208597    mov     rdx, [rbp-1678h]
4208604    lea     rax, [rbp-1020h]
4208611    mov     rsi, rdx
4208614    mov     rdi, rax
4208617    call    _rename
4208622    mov     eax, 1
loc_4037F3:
4208627    mov     rbx, [rbp-18h]
4208631    xor     rbx, [fs:28h]
4208640    jz      loc_403807
4208642    call    ___stack_chk_fail
loc_403807:
4208647    add     rsp, 1698h
4208654    pop     rbx
4208655    pop     rbp
4208656    retn    
USE32

section .text

global _start_mongoose

_start_mongoose:
4208657    push    rbp
4208658    mov     rbp, rsp
4208661    sub     rsp, 10h
4208665    call    _mcount
4208670    mov     [rbp-4], edi
4208673    mov     [rbp-10h], rsi
4208677    mov     rax, [rbp-10h]
4208681    mov     [cs:s_argv], rax
4208688    mov     esi, 0
4208693    mov     edi, 0
4208698    call    _mg_create_server
4208703    mov     [cs:server], rax
4208710    mov     rax, [cs:server]
4208717    test    rax, rax
4208720    jnz     loc_403866
4208722    mov     esi, aFailedToStartM
4208727    mov     edi, aS
4208732    mov     eax, 0
4208737    call    _die
loc_403866:
4208742    cmp     dword [rbp-4], 1
4208746    jle     loc_4038D6
4208748    mov     rax, [rbp-10h]
4208752    add     rax, 8
4208756    mov     rax, [rax]
4208759    mov     esi, s2
4208764    mov     rdi, rax
4208767    call    _strcmp
4208772    test    eax, eax
4208774    jnz     loc_4038D6
4208776    cmp     dword [rbp-4], 6
4208780    jz      loc_403893
4208782    call    _show_usage_and_exit
loc_403893:
4208787    mov     rax, [rbp-10h]
4208791    add     rax, 28h
4208795    mov     rcx, [rax]
4208798    mov     rax, [rbp-10h]
4208802    add     rax, 20h
4208806    mov     rdx, [rax]
4208809    mov     rax, [rbp-10h]
4208813    add     rax, 18h
4208817    mov     rsi, [rax]
4208820    mov     rax, [rbp-10h]
4208824    add     rax, 10h
4208828    mov     rax, [rax]
4208831    mov     rdi, rax
4208834    call    _modify_passwords_file
4208839    test    eax, eax
4208841    setz    al
4208844    movzx   eax, al
4208847    mov     edi, eax
4208849    call    _exit
loc_4038D6:
4208854    cmp     dword [rbp-4], 2
4208858    jnz     loc_403919
4208860    mov     rax, [rbp-10h]
4208864    add     rax, 8
4208868    mov     rax, [rax]
4208871    mov     esi, asc_413FC6
4208876    mov     rdi, rax
4208879    call    _strcmp
4208884    test    eax, eax
4208886    jz      loc_403914
4208888    mov     rax, [rbp-10h]
4208892    add     rax, 8
4208896    mov     rax, [rax]
4208899    mov     esi, aHelp
4208904    mov     rdi, rax
4208907    call    _strcmp
4208912    test    eax, eax
4208914    jnz     loc_403919
loc_403914:
4208916    call    _show_usage_and_exit
loc_403919:
4208921    mov     rax, [rbp-10h]
4208925    mov     rdi, rax
4208928    call    _set_options
4208933    leave   
4208934    retn    
USE32

section .text

global _set_options

_set_options:
4208935    push    rbp
4208936    mov     rbp, rsp
4208939    sub     rsp, 340h
4208946    call    _mcount
4208951    mov     [rbp-338h], rdi
4208958    mov     qword [rbp-320h], 0
4208969    mov     rdx, [cs:s_default_document_root]
4208976    lea     rax, [rbp-320h]
4208983    mov     esi, aDocument_root
4208988    mov     rdi, rax
4208991    call    _set_option
4208996    mov     rdx, [cs:s_default_listening_port]
4209003    lea     rax, [rbp-320h]
4209010    mov     esi, aListening_port
4209015    mov     rdi, rax
4209018    call    _set_option
4209023    lea     rdx, [rbp-320h]
4209030    mov     rax, [rbp-338h]
4209037    mov     rsi, rdx
4209040    mov     rdi, rax
4209043    call    _process_command_line_arguments
4209048    lea     rax, [rbp-320h]
4209055    mov     esi, aDocument_root
4209060    mov     rdi, rax
4209063    call    _set_absolute_path
4209068    lea     rax, [rbp-320h]
4209075    mov     esi, aDav_auth_file
4209080    mov     rdi, rax
4209083    call    _set_absolute_path
4209088    lea     rax, [rbp-320h]
4209095    mov     esi, aCgi_interprete
4209100    mov     rdi, rax
4209103    call    _set_absolute_path
4209108    lea     rax, [rbp-320h]
4209115    mov     esi, aAccess_log_fil
4209120    mov     rdi, rax
4209123    call    _set_absolute_path
4209128    lea     rax, [rbp-320h]
4209135    mov     esi, aGlobal_auth_fi
4209140    mov     rdi, rax
4209143    call    _set_absolute_path
4209148    lea     rax, [rbp-320h]
4209155    mov     esi, aSsl_certificat
4209160    mov     rdi, rax
4209163    call    _set_absolute_path
4209168    lea     rax, [rbp-320h]
4209175    mov     esi, aDocument_root
4209180    mov     rdi, rax
4209183    call    _get_option
4209188    mov     esi, 1
4209193    mov     rdi, rax
4209196    call    _path_exists
4209201    test    eax, eax
4209203    jnz     loc_403A8A
4209205    mov     rdx, [cs:s_default_document_root]
4209212    lea     rax, [rbp-320h]
4209219    mov     esi, aDocument_root
4209224    mov     rdi, rax
4209227    call    _set_option
4209232    lea     rax, [rbp-320h]
4209239    mov     esi, aDocument_root
4209244    mov     rdi, rax
4209247    call    _set_absolute_path
4209252    mov     rax, [cs:server]
4209259    mov     esi, aDocument_root
4209264    mov     rdi, rax
4209267    call    _mg_get_option
4209272    mov     rsi, rax
4209275    mov     edi, aSettingDocumen
4209280    mov     eax, 0
4209285    call    _notify
loc_403A8A:
4209290    lea     rax, [rbp-320h]
4209297    mov     edx, 1
4209302    mov     esi, aDocument_root
4209307    mov     rdi, rax
4209310    call    _verify_existence
4209315    lea     rax, [rbp-320h]
4209322    mov     edx, 0
4209327    mov     esi, aCgi_interprete
4209332    mov     rdi, rax
4209335    call    _verify_existence
4209340    lea     rax, [rbp-320h]
4209347    mov     edx, 0
4209352    mov     esi, aSsl_certificat
4209357    mov     rdi, rax
4209360    call    _verify_existence
4209365    mov     dword [rbp-32Ch], 0
4209375    jmp     loc_403C09
loc_403AE4:
4209380    mov     eax, [rbp-32Ch]
4209386    add     eax, 1
4209389    cdqe    
4209391    mov     rdx, [rbp+rax*8-320h]
4209399    mov     eax, [rbp-32Ch]
4209405    cdqe    
4209407    mov     rcx, [rbp+rax*8-320h]
4209415    mov     rax, [cs:server]
4209422    mov     rsi, rcx
4209425    mov     rdi, rax
4209428    call    _mg_set_option
4209433    mov     [rbp-328h], rax
4209440    cmp     qword [rbp-328h], 0
4209448    jz      loc_403BCF
4209454    mov     eax, [rbp-32Ch]
4209460    add     eax, 1
4209463    cdqe    
4209465    mov     rdx, [rbp+rax*8-320h]
4209473    mov     eax, [rbp-32Ch]
4209479    cdqe    
4209481    mov     rax, [rbp+rax*8-320h]
4209489    mov     rcx, [rbp-328h]
4209496    mov     rsi, rax
4209499    mov     edi, aFailedToSetOpt
4209504    mov     eax, 0
4209509    call    _notify
4209514    mov     eax, [rbp-32Ch]
4209520    cdqe    
4209522    mov     rax, [rbp+rax*8-320h]
4209530    mov     esi, aListening_port
4209535    mov     rdi, rax
4209538    call    _strcmp
4209543    test    eax, eax
4209545    jnz     loc_403BCF
4209547    mov     rdx, [cs:s_default_listening_port]
4209554    mov     rax, [cs:server]
4209561    mov     esi, aListening_port
4209566    mov     rdi, rax
4209569    call    _mg_set_option
4209574    mov     rdx, [cs:s_default_listening_port]
4209581    mov     eax, [rbp-32Ch]
4209587    cdqe    
4209589    mov     rax, [rbp+rax*8-320h]
4209597    mov     rsi, rax
4209600    mov     edi, aSettingSToS
4209605    mov     eax, 0
4209610    call    _notify
loc_403BCF:
4209615    mov     eax, [rbp-32Ch]
4209621    cdqe    
4209623    mov     rax, [rbp+rax*8-320h]
4209631    mov     rdi, rax
4209634    call    _free
4209639    mov     eax, [rbp-32Ch]
4209645    add     eax, 1
4209648    cdqe    
4209650    mov     rax, [rbp+rax*8-320h]
4209658    mov     rdi, rax
4209661    call    _free
4209666    add     dword [rbp-32Ch], 2
loc_403C09:
4209673    mov     eax, [rbp-32Ch]
4209679    cdqe    
4209681    mov     rax, [rbp+rax*8-320h]
4209689    test    rax, rax
4209692    jnz     loc_403AE4
4209698    mov     rax, [cs:server]
4209705    mov     esi, aDocument_root
4209710    mov     rdi, rax
4209713    call    _mg_get_option
4209718    mov     rdi, rax
4209721    call    _chdir
4209726    mov     esi, signal_handler
4209731    mov     edi, 0Fh
4209736    call    ___sysv_signal
4209741    mov     esi, signal_handler
4209746    mov     edi, 2
4209751    call    ___sysv_signal
4209756    mov     esi, signal_handler
4209761    mov     edi, 11h
4209766    call    ___sysv_signal
4209771    leave   
4209772    retn    
USE32

section .text

global _main

_main:
4209773    push    rbp
4209774    mov     rbp, rsp
4209777    push    rbx
4209778    sub     rsp, 18h
4209782    call    _mcount
4209787    mov     [rbp-14h], edi
4209790    mov     [rbp-20h], rsi
4209794    call    _init_server_name
4209799    mov     rdx, [rbp-20h]
4209803    mov     eax, [rbp-14h]
4209806    mov     rsi, rdx
4209809    mov     edi, eax
4209811    call    _start_mongoose
4209816    mov     rax, [cs:server]
4209823    mov     esi, aListening_port
4209828    mov     rdi, rax
4209831    call    _mg_get_option
4209836    mov     rbx, rax
4209839    mov     rax, [cs:server]
4209846    mov     esi, aDocument_root
4209851    mov     rdi, rax
4209854    call    _mg_get_option
4209859    mov     rcx, rbx
4209862    mov     rdx, rax
4209865    mov     esi, server_name
4209870    mov     edi, aSServingSOnPor
4209875    mov     eax, 0
4209880    call    _printf
4209885    mov     rax, [cs:stdout@@GLIBC_2_2_5]
4209892    mov     rdi, rax
4209895    call    _fflush
4209900    mov     rax, [cs:server]
4209907    mov     rdi, rax
4209910    call    _serving_thread_func
4209915    mov     eax, [cs:exit_flag]
4209921    mov     esi, eax
4209923    mov     edi, aExitingOnSigna
4209928    mov     eax, 0
4209933    call    _printf
4209938    mov     rax, [cs:stdout@@GLIBC_2_2_5]
4209945    mov     rdi, rax
4209948    call    _fflush
4209953    mov     edi, server
4209958    call    _mg_destroy_server
4209963    mov     edi, s
4209968    call    _puts
4209973    mov     eax, 0
4209978    add     rsp, 18h
4209982    pop     rbx
4209983    pop     rbp
4209984    retn    
USE32

section .text

global _iobuf_resize

_iobuf_resize:
4209985    push    rbp
4209986    mov     rbp, rsp
4209989    sub     rsp, 20h
4209993    call    _mcount
4209998    mov     [rbp-18h], rdi
4210002    mov     [rbp-20h], rsi
4210006    mov     rax, [rbp-18h]
4210010    mov     rax, [rax+10h]
4210014    cmp     rax, [rbp-20h]
4210018    jb      loc_403D80
4210020    mov     rax, [rbp-18h]
4210024    mov     rax, [rax+10h]
4210028    cmp     rax, [rbp-20h]
4210032    jbe     locret_403DB8
4210034    mov     rax, [rbp-18h]
4210038    mov     rax, [rax+8]
4210042    cmp     rax, [rbp-20h]
4210046    ja      locret_403DB8
loc_403D80:
4210048    mov     rax, [rbp-18h]
4210052    mov     rax, [rax]
4210055    mov     rdx, [rbp-20h]
4210059    mov     rsi, rdx
4210062    mov     rdi, rax
4210065    call    _realloc
4210070    mov     [rbp-8], rax
4210074    cmp     qword [rbp-8], 0
4210079    jz      locret_403DB8
4210081    mov     rax, [rbp-18h]
4210085    mov     rdx, [rbp-20h]
4210089    mov     [rax+10h], rdx
4210093    mov     rax, [rbp-18h]
4210097    mov     rdx, [rbp-8]
4210101    mov     [rax], rdx
locret_403DB8:
4210104    leave   
4210105    retn    
USE32

section .text

global _iobuf_init

_iobuf_init:
4210106    push    rbp
4210107    mov     rbp, rsp
4210110    sub     rsp, 10h
4210114    call    _mcount
4210119    mov     [rbp-8], rdi
4210123    mov     [rbp-10h], rsi
4210127    mov     rax, [rbp-8]
4210131    mov     qword [rax+10h], 0
4210139    mov     rax, [rbp-8]
4210143    mov     rdx, [rax+10h]
4210147    mov     rax, [rbp-8]
4210151    mov     [rax+8], rdx
4210155    mov     rax, [rbp-8]
4210159    mov     qword [rax], 0
4210166    mov     rdx, [rbp-10h]
4210170    mov     rax, [rbp-8]
4210174    mov     rsi, rdx
4210177    mov     rdi, rax
4210180    call    _iobuf_resize
4210185    leave   
4210186    retn    
USE32

section .text

global _iobuf_free

_iobuf_free:
4210187    push    rbp
4210188    mov     rbp, rsp
4210191    sub     rsp, 10h
4210195    call    _mcount
4210200    mov     [rbp-8], rdi
4210204    cmp     qword [rbp-8], 0
4210209    jz      locret_403E4F
4210211    mov     rax, [rbp-8]
4210215    mov     rax, [rax]
4210218    test    rax, rax
4210221    jz      loc_403E3E
4210223    mov     rax, [rbp-8]
4210227    mov     rax, [rax]
4210230    mov     rdi, rax
4210233    call    _free
loc_403E3E:
4210238    mov     rax, [rbp-8]
4210242    mov     esi, 0
4210247    mov     rdi, rax
4210250    call    _iobuf_init
locret_403E4F:
4210255    leave   
4210256    retn    
USE32

section .text

global _iobuf_append

_iobuf_append:
4210257    push    rbp
4210258    mov     rbp, rsp
4210261    sub     rsp, 30h
4210265    call    _mcount
4210270    mov     [rbp-18h], rdi
4210274    mov     [rbp-20h], rsi
4210278    mov     [rbp-28h], rdx
4210282    mov     qword [rbp-8], 0
4210290    cmp     qword [rbp-18h], 0
4210295    jnz     loc_403E92
4210297    mov     ecx, __PRETTY_FUNCTION___5386
4210302    mov     edx, 162h
4210307    mov     esi, file
4210312    mov     edi, assertion
4210317    call    ___assert_fail
loc_403E92:
4210322    mov     rax, [rbp-18h]
4210326    mov     rdx, [rax+8]
4210330    mov     rax, [rbp-18h]
4210334    mov     rax, [rax+10h]
4210338    cmp     rdx, rax
4210341    jbe     loc_403EC0
4210343    mov     ecx, __PRETTY_FUNCTION___5386
4210348    mov     edx, 163h
4210353    mov     esi, file
4210358    mov     edi, aIoLenIoSize
4210363    call    ___assert_fail
loc_403EC0:
4210368    mov     rax, [rbp-18h]
4210372    mov     rdx, [rax]
4210375    mov     rax, [rbp-18h]
4210379    mov     rax, [rax+8]
4210383    add     rax, rdx
4210386    not     rax
4210389    cmp     rax, [rbp-28h]
4210393    jnb     loc_403EE5
4210395    mov     eax, 0
4210400    jmp     locret_403FE0
loc_403EE5:
4210405    cmp     qword [rbp-28h], 0
4210410    jz      loc_403FDC
4210416    mov     rax, [rbp-18h]
4210420    mov     rdx, [rax+8]
4210424    mov     rax, [rbp-28h]
4210428    add     rdx, rax
4210431    mov     rax, [rbp-18h]
4210435    mov     rax, [rax+10h]
4210439    cmp     rdx, rax
4210442    ja      loc_403F4E
4210444    mov     rax, [rbp-18h]
4210448    mov     rdx, [rax]
4210451    mov     rax, [rbp-18h]
4210455    mov     rax, [rax+8]
4210459    lea     rcx, [rdx+rax]
4210463    mov     rdx, [rbp-28h]
4210467    mov     rax, [rbp-20h]
4210471    mov     rsi, rax
4210474    mov     rdi, rcx
4210477    call    _memcpy
4210482    mov     rax, [rbp-18h]
4210486    mov     rdx, [rax+8]
4210490    mov     rax, [rbp-28h]
4210494    add     rdx, rax
4210497    mov     rax, [rbp-18h]
4210501    mov     [rax+8], rdx
4210505    jmp     loc_403FDC
loc_403F4E:
4210510    mov     rax, [rbp-18h]
4210514    mov     rdx, [rax+8]
4210518    mov     rax, [rbp-28h]
4210522    add     rdx, rax
4210525    mov     rax, [rbp-18h]
4210529    mov     rax, [rax]
4210532    mov     rsi, rdx
4210535    mov     rdi, rax
4210538    call    _realloc
4210543    mov     [rbp-8], rax
4210547    cmp     qword [rbp-8], 0
4210552    jz      loc_403FD4
4210554    mov     rax, [rbp-18h]
4210558    mov     rdx, [rbp-8]
4210562    mov     [rax], rdx
4210565    mov     rax, [rbp-18h]
4210569    mov     rdx, [rax]
4210572    mov     rax, [rbp-18h]
4210576    mov     rax, [rax+8]
4210580    lea     rcx, [rdx+rax]
4210584    mov     rdx, [rbp-28h]
4210588    mov     rax, [rbp-20h]
4210592    mov     rsi, rax
4210595    mov     rdi, rcx
4210598    call    _memcpy
4210603    mov     rax, [rbp-18h]
4210607    mov     rdx, [rax+8]
4210611    mov     rax, [rbp-28h]
4210615    add     rdx, rax
4210618    mov     rax, [rbp-18h]
4210622    mov     [rax+8], rdx
4210626    mov     rax, [rbp-18h]
4210630    mov     rdx, [rax+8]
4210634    mov     rax, [rbp-18h]
4210638    mov     [rax+10h], rdx
4210642    jmp     loc_403FDC
loc_403FD4:
4210644    mov     qword [rbp-28h], 0
loc_403FDC:
4210652    mov     rax, [rbp-28h]
locret_403FE0:
4210656    leave   
4210657    retn    
USE32

section .text

global _iobuf_remove

_iobuf_remove:
4210658    push    rbp
4210659    mov     rbp, rsp
4210662    sub     rsp, 10h
4210666    call    _mcount
4210671    mov     [rbp-8], rdi
4210675    mov     [rbp-10h], rsi
4210679    cmp     qword [rbp-10h], 0
4210684    jz      locret_404052
4210686    mov     rax, [rbp-8]
4210690    mov     rax, [rax+8]
4210694    cmp     rax, [rbp-10h]
4210698    jb      locret_404052
4210700    mov     rax, [rbp-8]
4210704    mov     rax, [rax+8]
4210708    sub     rax, [rbp-10h]
4210712    mov     rdx, rax
4210715    mov     rax, [rbp-8]
4210719    mov     rcx, [rax]
4210722    mov     rax, [rbp-10h]
4210726    add     rcx, rax
4210729    mov     rax, [rbp-8]
4210733    mov     rax, [rax]
4210736    mov     rsi, rcx
4210739    mov     rdi, rax
4210742    call    _memmove
4210747    mov     rax, [rbp-8]
4210751    mov     rax, [rax+8]
4210755    sub     rax, [rbp-10h]
4210759    mov     rdx, rax
4210762    mov     rax, [rbp-8]
4210766    mov     [rax+8], rdx
locret_404052:
4210770    leave   
4210771    retn    
USE32

section .text

global _ns_out

_ns_out:
4210772    push    rbp
4210773    mov     rbp, rsp
4210776    sub     rsp, 30h
4210780    call    _mcount
4210785    mov     [rbp-18h], rdi
4210789    mov     [rbp-20h], rsi
4210793    mov     [rbp-28h], rdx
4210797    mov     rax, [rbp-18h]
4210801    mov     eax, [rax+98h]
4210807    and     eax, 100h
4210812    test    eax, eax
4210814    jz      loc_4040C1
4210816    mov     rax, [rbp-18h]
4210820    lea     rcx, [rax+24h]
4210824    mov     rax, [rbp-18h]
4210828    mov     eax, [rax+20h]
4210831    mov     rdx, [rbp-28h]
4210835    mov     rsi, [rbp-20h]
4210839    mov     r9d, 10h
4210845    mov     r8, rcx
4210848    mov     ecx, 0
4210853    mov     edi, eax
4210855    call    _sendto
4210860    mov     [rbp-8], rax
4210864    mov     eax, 0
4210869    cmp     qword [rbp-8], 0
4210874    cmovns  rax, [rbp-8]
4210879    jmp     locret_4040DC
loc_4040C1:
4210881    mov     rax, [rbp-18h]
4210885    lea     rcx, [rax+50h]
4210889    mov     rdx, [rbp-28h]
4210893    mov     rax, [rbp-20h]
4210897    mov     rsi, rax
4210900    mov     rdi, rcx
4210903    call    _iobuf_append
locret_4040DC:
4210908    leave   
4210909    retn    
USE32

section .text

global _ns_start_thread

_ns_start_thread:
4210910    push    rbp
4210911    mov     rbp, rsp
4210914    push    rbx
4210915    sub     rsp, 68h
4210919    call    _mcount
4210924    mov     [rbp-68h], rdi
4210928    mov     [rbp-70h], rsi
4210932    mov     rax, [fs:28h]
4210941    mov     [rbp-18h], rax
4210945    xor     eax, eax
4210947    mov     qword [rbp-58h], 0
4210955    lea     rax, [rbp-50h]
4210959    mov     rdi, rax
4210962    call    _pthread_attr_init
4210967    lea     rax, [rbp-50h]
4210971    mov     esi, 1
4210976    mov     rdi, rax
4210979    call    _pthread_attr_setdetachstate
4210984    mov     rcx, [rbp-70h]
4210988    mov     rdx, [rbp-68h]
4210992    lea     rsi, [rbp-50h]
4210996    lea     rax, [rbp-58h]
4211000    mov     rdi, rax
4211003    call    _pthread_create
4211008    lea     rax, [rbp-50h]
4211012    mov     rdi, rax
4211015    call    _pthread_attr_destroy
4211020    mov     rax, [rbp-58h]
4211024    mov     rbx, [rbp-18h]
4211028    xor     rbx, [fs:28h]
4211037    jz      loc_404164
4211039    call    ___stack_chk_fail
loc_404164:
4211044    add     rsp, 68h
4211048    pop     rbx
4211049    pop     rbp
4211050    retn    
USE32

section .text

global _ns_add_conn

_ns_add_conn:
4211051    push    rbp
4211052    mov     rbp, rsp
4211055    sub     rsp, 10h
4211059    call    _mcount
4211064    mov     [rbp-8], rdi
4211068    mov     [rbp-10h], rsi
4211072    mov     rax, [rbp-8]
4211076    mov     rdx, [rax]
4211079    mov     rax, [rbp-10h]
4211083    mov     [rax], rdx
4211086    mov     rax, [rbp-8]
4211090    mov     rdx, [rbp-10h]
4211094    mov     [rax], rdx
4211097    mov     rax, [rbp-10h]
4211101    mov     qword [rax+8], 0
4211109    mov     rax, [rbp-10h]
4211113    mov     rax, [rax]
4211116    test    rax, rax
4211119    jz      locret_4041C0
4211121    mov     rax, [rbp-10h]
4211125    mov     rax, [rax]
4211128    mov     rdx, [rbp-10h]
4211132    mov     [rax+8], rdx
locret_4041C0:
4211136    leave   
4211137    retn    
USE32

section .text

global _ns_remove_conn

_ns_remove_conn:
4211138    push    rbp
4211139    mov     rbp, rsp
4211142    sub     rsp, 8
4211146    call    _mcount
4211151    mov     [rbp-8], rdi
4211155    mov     rax, [rbp-8]
4211159    mov     rax, [rax+8]
4211163    test    rax, rax
4211166    jnz     loc_4041F2
4211168    mov     rax, [rbp-8]
4211172    mov     rax, [rax+18h]
4211176    mov     rdx, [rbp-8]
4211180    mov     rdx, [rdx]
4211183    mov     [rax], rdx
loc_4041F2:
4211186    mov     rax, [rbp-8]
4211190    mov     rax, [rax+8]
4211194    test    rax, rax
4211197    jz      loc_404211
4211199    mov     rax, [rbp-8]
4211203    mov     rax, [rax+8]
4211207    mov     rdx, [rbp-8]
4211211    mov     rdx, [rdx]
4211214    mov     [rax], rdx
loc_404211:
4211217    mov     rax, [rbp-8]
4211221    mov     rax, [rax]
4211224    test    rax, rax
4211227    jz      locret_404230
4211229    mov     rax, [rbp-8]
4211233    mov     rax, [rax]
4211236    mov     rdx, [rbp-8]
4211240    mov     rdx, [rdx+8]
4211244    mov     [rax+8], rdx
locret_404230:
4211248    leave   
4211249    retn    
USE32

section .text

global _ns_avprintf

_ns_avprintf:
4211250    push    rbp
4211251    mov     rbp, rsp
4211254    sub     rsp, 40h
4211258    call    _mcount
4211263    mov     [rbp-28h], rdi
4211267    mov     [rbp-30h], rsi
4211271    mov     [rbp-38h], rdx
4211275    mov     [rbp-40h], rcx
4211279    lea     rax, [rbp-18h]
4211283    mov     rdx, [rbp-40h]
4211287    mov     rcx, [rdx]
4211290    mov     [rax], rcx
4211293    mov     rcx, [rdx+8]
4211297    mov     [rax+8], rcx
4211301    mov     rdx, [rdx+10h]
4211305    mov     [rax+10h], rdx
4211309    mov     rax, [rbp-28h]
4211313    mov     rax, [rax]
4211316    lea     rcx, [rbp-18h]
4211320    mov     rdx, [rbp-38h]
4211324    mov     rsi, [rbp-30h]
4211328    mov     rdi, rax
4211331    call    _vsnprintf
4211336    mov     [rbp-1Ch], eax
4211339    cmp     dword [rbp-1Ch], 0
4211343    jns     loc_404334
4211349    mov     rax, [rbp-28h]
4211353    mov     qword [rax], 0
4211360    jmp     loc_404328
loc_4042A5:
4211365    mov     rax, [rbp-28h]
4211369    mov     rax, [rax]
4211372    test    rax, rax
4211375    jz      loc_4042C0
4211377    mov     rax, [rbp-28h]
4211381    mov     rax, [rax]
4211384    mov     rdi, rax
4211387    call    _free
loc_4042C0:
4211392    shl     qword [rbp-30h], 1
4211396    mov     rax, [rbp-30h]
4211400    mov     rdi, rax
4211403    call    _malloc
4211408    mov     rdx, rax
4211411    mov     rax, [rbp-28h]
4211415    mov     [rax], rdx
4211418    mov     rax, [rbp-28h]
4211422    mov     rax, [rax]
4211425    test    rax, rax
4211428    jnz     loc_4042EC
4211430    nop     
4211431    jmp     loc_4043AD
loc_4042EC:
4211436    lea     rax, [rbp-18h]
4211440    mov     rdx, [rbp-40h]
4211444    mov     rcx, [rdx]
4211447    mov     [rax], rcx
4211450    mov     rcx, [rdx+8]
4211454    mov     [rax+8], rcx
4211458    mov     rdx, [rdx+10h]
4211462    mov     [rax+10h], rdx
4211466    mov     rax, [rbp-28h]
4211470    mov     rax, [rax]
4211473    lea     rcx, [rbp-18h]
4211477    mov     rdx, [rbp-38h]
4211481    mov     rsi, [rbp-30h]
4211485    mov     rdi, rax
4211488    call    _vsnprintf
4211493    mov     [rbp-1Ch], eax
loc_404328:
4211496    cmp     dword [rbp-1Ch], 0
4211500    js      loc_4042A5
4211506    jmp     loc_4043AD
loc_404334:
4211508    mov     rax, [rbp-30h]
4211512    cmp     eax, [rbp-1Ch]
4211515    jge     loc_4043AD
4211517    mov     eax, [rbp-1Ch]
4211520    add     eax, 1
4211523    cdqe    
4211525    mov     rdi, rax
4211528    call    _malloc
4211533    mov     rdx, rax
4211536    mov     rax, [rbp-28h]
4211540    mov     [rax], rdx
4211543    mov     rax, [rbp-28h]
4211547    mov     rax, [rax]
4211550    test    rax, rax
4211553    jnz     loc_40436C
4211555    mov     dword [rbp-1Ch], 0FFFFFFFFh
4211562    jmp     loc_4043AD
loc_40436C:
4211564    lea     rax, [rbp-18h]
4211568    mov     rdx, [rbp-40h]
4211572    mov     rcx, [rdx]
4211575    mov     [rax], rcx
4211578    mov     rcx, [rdx+8]
4211582    mov     [rax+8], rcx
4211586    mov     rdx, [rdx+10h]
4211590    mov     [rax+10h], rdx
4211594    mov     eax, [rbp-1Ch]
4211597    add     eax, 1
4211600    movsxd  rsi, eax
4211603    mov     rax, [rbp-28h]
4211607    mov     rax, [rax]
4211610    lea     rcx, [rbp-18h]
4211614    mov     rdx, [rbp-38h]
4211618    mov     rdi, rax
4211621    call    _vsnprintf
4211626    mov     [rbp-1Ch], eax
loc_4043AD:
4211629    mov     eax, [rbp-1Ch]
4211632    leave   
4211633    retn    
USE32

section .text

global _ns_vprintf

_ns_vprintf:
4211634    push    rbp
4211635    mov     rbp, rsp
4211638    push    rbx
4211639    sub     rsp, 238h
4211646    call    _mcount
4211651    mov     [rbp-228h], rdi
4211658    mov     [rbp-230h], rsi
4211665    mov     [rbp-238h], rdx
4211672    mov     rax, [fs:28h]
4211681    mov     [rbp-18h], rax
4211685    xor     eax, eax
4211687    lea     rax, [rbp-210h]
4211694    mov     [rbp-218h], rax
4211701    mov     rcx, [rbp-238h]
4211708    mov     rdx, [rbp-230h]
4211715    lea     rax, [rbp-218h]
4211722    mov     esi, 1F4h
4211727    mov     rdi, rax
4211730    call    _ns_avprintf
4211735    mov     [rbp-21Ch], eax
4211741    cmp     dword [rbp-21Ch], 0
4211748    jle     loc_404448
4211750    mov     eax, [rbp-21Ch]
4211756    movsxd  rdx, eax
4211759    mov     rcx, [rbp-218h]
4211766    mov     rax, [rbp-228h]
4211773    mov     rsi, rcx
4211776    mov     rdi, rax
4211779    call    _ns_out
loc_404448:
4211784    mov     rdx, [rbp-218h]
4211791    lea     rax, [rbp-210h]
4211798    cmp     rdx, rax
4211801    jz      loc_404476
4211803    mov     rax, [rbp-218h]
4211810    test    rax, rax
4211813    jz      loc_404476
4211815    mov     rax, [rbp-218h]
4211822    mov     rdi, rax
4211825    call    _free
loc_404476:
4211830    mov     eax, [rbp-21Ch]
4211836    mov     rbx, [rbp-18h]
4211840    xor     rbx, [fs:28h]
4211849    jz      loc_404490
4211851    call    ___stack_chk_fail
loc_404490:
4211856    add     rsp, 238h
4211863    pop     rbx
4211864    pop     rbp
4211865    retn    
USE32

section .text

global _ns_printf

_ns_printf:
4211866    push    rbp
4211867    mov     rbp, rsp
4211870    sub     rsp, 0E0h
4211877    call    _mcount
4211882    mov     [rbp-0D8h], rdi
4211889    mov     [rbp-0A0h], rdx
4211896    mov     [rbp-98h], rcx
4211903    mov     [rbp-90h], r8
4211910    mov     [rbp-88h], r9
4211917    test    al, al
4211919    jz      loc_4044F1
4211921    movaps  xmmword [rbp-80h], xmm0
4211925    movaps  xmmword [rbp-70h], xmm1
4211929    movaps  xmmword [rbp-60h], xmm2
4211933    movaps  xmmword [rbp-50h], xmm3
4211937    movaps  xmmword [rbp-40h], xmm4
4211941    movaps  xmmword [rbp-30h], xmm5
4211945    movaps  xmmword [rbp-20h], xmm6
4211949    movaps  xmmword [rbp-10h], xmm7
loc_4044F1:
4211953    mov     [rbp-0E0h], rsi
4211960    mov     dword [rbp-0C8h], 10h
4211970    mov     dword [rbp-0C4h], 30h
4211980    lea     rax, [rbp+10h]
4211984    mov     [rbp-0C0h], rax
4211991    lea     rax, [rbp-0B0h]
4211998    mov     [rbp-0B8h], rax
4212005    lea     rdx, [rbp-0C8h]
4212012    mov     rcx, [rbp-0E0h]
4212019    mov     rax, [rbp-0D8h]
4212026    mov     rsi, rcx
4212029    mov     rdi, rax
4212032    call    _ns_vprintf
4212037    mov     [rbp-0CCh], eax
4212043    mov     eax, [rbp-0CCh]
4212049    leave   
4212050    retn    
USE32

section .text

global _hexdump

_hexdump:
4212051    push    rbp
4212052    mov     rbp, rsp
4212055    push    r12
4212057    push    rbx
4212058    sub     rsp, 0E0h
4212065    call    _mcount
4212070    mov     [rbp-0C8h], rdi
4212077    mov     [rbp-0D0h], rsi
4212084    mov     [rbp-0D4h], edx
4212090    mov     [rbp-0D8h], ecx
4212096    mov     rax, [fs:28h]
4212105    mov     [rbp-18h], rax
4212109    xor     eax, eax
4212111    cmp     dword [rbp-0D8h], 4
4212118    jnz     loc_4045A5
4212120    mov     rax, [rbp-0C8h]
4212127    add     rax, 50h
4212131    jmp     loc_4045B0
loc_4045A5:
4212133    mov     rax, [rbp-0C8h]
4212140    add     rax, 38h
loc_4045B0:
4212144    mov     [rbp-0B8h], rax
4212151    mov     edx, [rbp-0D4h]
4212157    mov     eax, edx
4212159    shl     eax, 2
4212162    add     eax, edx
4212164    add     eax, 64h
4212167    mov     [rbp-0BCh], eax
4212173    mov     rax, [rbp-0D0h]
4212180    mov     esi, aA_1
4212185    mov     rdi, rax
4212188    call    _fopen64
4212193    mov     [rbp-0B0h], rax
4212200    cmp     qword [rbp-0B0h], 0
4212208    jz      loc_40479C
4212214    mov     rax, [rbp-0C8h]
4212221    mov     eax, [rax+20h]
4212224    lea     rsi, [rbp-0A0h]
4212231    mov     ecx, 3
4212236    mov     edx, 3Ch
4212241    mov     edi, eax
4212243    call    _ns_sock_to_str
4212248    mov     rax, [rbp-0C8h]
4212255    mov     eax, [rax+20h]
4212258    lea     rsi, [rbp-60h]
4212262    mov     ecx, 7
4212267    mov     edx, 3Ch
4212272    mov     edi, eax
4212274    call    _ns_sock_to_str
4212279    cmp     dword [rbp-0D8h], 3
4212286    jz      loc_40467A
4212288    cmp     dword [rbp-0D8h], 4
4212295    jz      loc_404670
4212297    cmp     dword [rbp-0D8h], 1
4212304    jz      loc_404669
4212306    cmp     dword [rbp-0D8h], 2
4212313    jnz     loc_404662
4212315    mov     eax, aC
4212320    jmp     loc_404675
loc_404662:
4212322    mov     eax, aXx
4212327    jmp     loc_404675
loc_404669:
4212329    mov     eax, aA_2
4212334    jmp     loc_404675
loc_404670:
4212336    mov     eax, asc_41411C
loc_404675:
4212341    mov     rbx, rax
4212344    jmp     loc_40467F
loc_40467A:
4212346    mov     ebx, asc_41411F
loc_40467F:
4212351    mov     rax, [rbp-0C8h]
4212358    mov     r12, [rax+78h]
4212362    mov     edi, 0
4212367    call    _time
4212372    mov     rdx, rax
4212375    lea     rsi, [rbp-0A0h]
4212382    mov     rax, [rbp-0B0h]
4212389    mov     ecx, [rbp-0D4h]
4212395    mov     [rsp+8], ecx
4212399    lea     rcx, [rbp-60h]
4212403    mov     [rsp], rcx
4212407    mov     r9, rbx
4212410    mov     r8, rsi
4212413    mov     rcx, r12
4212416    mov     esi, aLuPSSSD
4212421    mov     rdi, rax
4212424    mov     eax, 0
4212429    call    _fprintf
4212434    cmp     dword [rbp-0D4h], 0
4212441    jle     loc_40478D
4212447    mov     eax, [rbp-0BCh]
4212453    cdqe    
4212455    mov     rdi, rax
4212458    call    _malloc
4212463    mov     [rbp-0A8h], rax
4212470    cmp     qword [rbp-0A8h], 0
4212478    jz      loc_40478D
4212484    mov     rax, [rbp-0B8h]
4212491    mov     rcx, [rax]
4212494    cmp     dword [rbp-0D8h], 4
4212501    jz      loc_404724
4212503    mov     rax, [rbp-0B8h]
4212510    mov     rdx, [rax+8]
4212514    jmp     loc_404729
loc_404724:
4212516    mov     edx, 0
loc_404729:
4212521    cmp     dword [rbp-0D8h], 4
4212528    jz      loc_40473C
4212530    mov     eax, [rbp-0D4h]
4212536    cdqe    
4212538    jmp     loc_404741
loc_40473C:
4212540    mov     eax, 0
loc_404741:
4212545    sub     rdx, rax
4212548    mov     rax, rdx
4212551    lea     rdi, [rcx+rax]
4212555    mov     ecx, [rbp-0BCh]
4212561    mov     rdx, [rbp-0A8h]
4212568    mov     eax, [rbp-0D4h]
4212574    mov     esi, eax
4212576    call    _ns_hexdump
4212581    mov     rdx, [rbp-0B0h]
4212588    mov     rax, [rbp-0A8h]
4212595    mov     rsi, rdx
4212598    mov     rdi, rax
4212601    call    _fputs
4212606    mov     rax, [rbp-0A8h]
4212613    mov     rdi, rax
4212616    call    _free
loc_40478D:
4212621    mov     rax, [rbp-0B0h]
4212628    mov     rdi, rax
4212631    call    _fclose
loc_40479C:
4212636    mov     rax, [rbp-18h]
4212640    xor     rax, [fs:28h]
4212649    jz      loc_4047B0
4212651    call    ___stack_chk_fail
loc_4047B0:
4212656    add     rsp, 0E0h
4212663    pop     rbx
4212664    pop     r12
4212666    pop     rbp
4212667    retn    
USE32

section .text

global _ns_call

_ns_call:
4212668    push    rbp
4212669    mov     rbp, rsp
4212672    sub     rsp, 30h
4212676    call    _mcount
4212681    mov     [rbp-18h], rdi
4212685    mov     [rbp-1Ch], esi
4212688    mov     [rbp-28h], rdx
4212692    mov     rax, [rbp-18h]
4212696    mov     rax, [rax+18h]
4212700    mov     rax, [rax+8]
4212704    test    rax, rax
4212707    jz      loc_404825
4212709    cmp     dword [rbp-1Ch], 0
4212713    jz      loc_404825
4212715    cmp     dword [rbp-1Ch], 3
4212719    jz      loc_4047F7
4212721    cmp     dword [rbp-1Ch], 4
4212725    jnz     loc_4047FF
loc_4047F7:
4212727    mov     rax, [rbp-28h]
4212731    mov     eax, [rax]
4212733    jmp     loc_404804
loc_4047FF:
4212735    mov     eax, 0
loc_404804:
4212740    mov     [rbp-4], eax
4212743    mov     rax, [rbp-18h]
4212747    mov     rax, [rax+18h]
4212751    mov     rsi, [rax+8]
4212755    mov     ecx, [rbp-1Ch]
4212758    mov     edx, [rbp-4]
4212761    mov     rax, [rbp-18h]
4212765    mov     rdi, rax
4212768    call    _hexdump
loc_404825:
4212773    mov     rax, [rbp-18h]
4212777    mov     rax, [rax+90h]
4212784    mov     rdx, [rbp-28h]
4212788    mov     esi, [rbp-1Ch]
4212791    mov     rcx, [rbp-18h]
4212795    mov     rdi, rcx
4212798    call    rax
4212800    leave   
4212801    retn    
USE32

section .text

global _ns_destroy_conn

_ns_destroy_conn:
4212802    push    rbp
4212803    mov     rbp, rsp
4212806    sub     rsp, 10h
4212810    call    _mcount
4212815    mov     [rbp-8], rdi
4212819    mov     rax, [rbp-8]
4212823    mov     eax, [rax+20h]
4212826    mov     edi, eax
4212828    call    _close
4212833    mov     rax, [rbp-8]
4212837    add     rax, 38h
4212841    mov     rdi, rax
4212844    call    _iobuf_free
4212849    mov     rax, [rbp-8]
4212853    add     rax, 50h
4212857    mov     rdi, rax
4212860    call    _iobuf_free
4212865    mov     rax, [rbp-8]
4212869    mov     rdi, rax
4212872    call    _free
4212877    leave   
4212878    retn    
USE32

section .text

global _ns_close_conn

_ns_close_conn:
4212879    push    rbp
4212880    mov     rbp, rsp
4212883    sub     rsp, 10h
4212887    call    _mcount
4212892    mov     [rbp-8], rdi
4212896    mov     rax, [rbp-8]
4212900    mov     edx, 0
4212905    mov     esi, 5
4212910    mov     rdi, rax
4212913    call    _ns_call
4212918    mov     rax, [rbp-8]
4212922    mov     rdi, rax
4212925    call    _ns_remove_conn
4212930    mov     rax, [rbp-8]
4212934    mov     rdi, rax
4212937    call    _ns_destroy_conn
4212942    leave   
4212943    retn    
USE32

section .text

global _ns_set_close_on_exec

_ns_set_close_on_exec:
4212944    push    rbp
4212945    mov     rbp, rsp
4212948    sub     rsp, 10h
4212952    call    _mcount
4212957    mov     [rbp-4], edi
4212960    mov     eax, [rbp-4]
4212963    mov     edx, 1
4212968    mov     esi, 2
4212973    mov     edi, eax
4212975    mov     eax, 0
4212980    call    _fcntl
4212985    leave   
4212986    retn    
USE32

section .text

global _ns_set_non_blocking_mode

_ns_set_non_blocking_mode:
4212987    push    rbp
4212988    mov     rbp, rsp
4212991    sub     rsp, 20h
4212995    call    _mcount
4213000    mov     [rbp-14h], edi
4213003    mov     eax, [rbp-14h]
4213006    mov     edx, 0
4213011    mov     esi, 3
4213016    mov     edi, eax
4213018    mov     eax, 0
4213023    call    _fcntl
4213028    mov     [rbp-4], eax
4213031    mov     eax, [rbp-4]
4213034    or      ah, 8
4213037    mov     edx, eax
4213039    mov     eax, [rbp-14h]
4213042    mov     esi, 4
4213047    mov     edi, eax
4213049    mov     eax, 0
4213054    call    _fcntl
4213059    leave   
4213060    retn    
USE32

section .text

global _ns_socketpair2

_ns_socketpair2:
4213061    push    rbp
4213062    mov     rbp, rsp
4213065    push    rbx
4213066    sub     rsp, 48h
4213070    call    _mcount
4213075    mov     [rbp-48h], rdi
4213079    mov     [rbp-4Ch], esi
4213082    mov     rax, [fs:28h]
4213091    mov     [rbp-18h], rax
4213095    xor     eax, eax
4213097    mov     dword [rbp-3Ch], 10h
4213104    mov     dword [rbp-38h], 0
4213111    mov     rax, [rbp-48h]
4213115    add     rax, 4
4213119    mov     dword [rax], 0FFFFFFFFh
4213125    mov     edx, [rax]
4213127    mov     rax, [rbp-48h]
4213131    mov     [rax], edx
4213133    lea     rax, [rbp-30h]
4213137    mov     edx, 10h
4213142    mov     esi, 0
4213147    mov     rdi, rax
4213150    call    _memset
4213155    mov     word [rbp-30h], 2
4213161    mov     edi, 0
4213166    call    _htons
4213171    mov     [rbp-2Eh], ax
4213175    mov     edi, 7F000001h
4213180    call    _htonl
4213185    mov     [rbp-2Ch], eax
4213188    mov     eax, [rbp-4Ch]
4213191    mov     edx, 0
4213196    mov     esi, eax
4213198    mov     edi, 2
4213203    call    _socket
4213208    mov     [rbp-34h], eax
4213211    cmp     dword [rbp-34h], 0FFFFFFFFh
4213215    jz      loc_404B15
4213221    mov     edx, [rbp-3Ch]
4213224    lea     rcx, [rbp-30h]
4213228    mov     eax, [rbp-34h]
4213231    mov     rsi, rcx
4213234    mov     edi, eax
4213236    call    _bind
4213241    test    eax, eax
4213243    jnz     loc_404B15
4213249    cmp     dword [rbp-4Ch], 2
4213253    jz      loc_404A1E
4213255    mov     eax, [rbp-34h]
4213258    mov     esi, 1
4213263    mov     edi, eax
4213265    call    _listen
4213270    test    eax, eax
4213272    jnz     loc_404B15
loc_404A1E:
4213278    lea     rdx, [rbp-3Ch]
4213282    lea     rcx, [rbp-30h]
4213286    mov     eax, [rbp-34h]
4213289    mov     rsi, rcx
4213292    mov     edi, eax
4213294    call    _getsockname
4213299    test    eax, eax
4213301    jnz     loc_404B15
4213307    mov     eax, [rbp-4Ch]
4213310    mov     edx, 0
4213315    mov     esi, eax
4213317    mov     edi, 2
4213322    call    _socket
4213327    mov     rdx, [rbp-48h]
4213331    mov     [rdx], eax
4213333    mov     rax, [rbp-48h]
4213337    mov     eax, [rax]
4213339    cmp     eax, 0FFFFFFFFh
4213342    jz      loc_404B15
4213348    mov     edx, [rbp-3Ch]
4213351    mov     rax, [rbp-48h]
4213355    mov     eax, [rax]
4213357    lea     rcx, [rbp-30h]
4213361    mov     rsi, rcx
4213364    mov     edi, eax
4213366    call    _connect
4213371    test    eax, eax
4213373    jnz     loc_404B15
4213379    cmp     dword [rbp-4Ch], 1
4213383    jz      loc_404ABD
4213385    mov     rax, [rbp-48h]
4213389    mov     eax, [rax]
4213391    lea     rdx, [rbp-3Ch]
4213395    lea     rcx, [rbp-30h]
4213399    mov     rsi, rcx
4213402    mov     edi, eax
4213404    call    _getsockname
4213409    test    eax, eax
4213411    jnz     loc_404B15
4213413    mov     edx, [rbp-3Ch]
4213416    lea     rcx, [rbp-30h]
4213420    mov     eax, [rbp-34h]
4213423    mov     rsi, rcx
4213426    mov     edi, eax
4213428    call    _connect
4213433    test    eax, eax
4213435    jnz     loc_404B15
loc_404ABD:
4213437    mov     rax, [rbp-48h]
4213441    lea     rbx, [rax+4]
4213445    cmp     dword [rbp-4Ch], 2
4213449    jz      loc_404AE2
4213451    lea     rdx, [rbp-3Ch]
4213455    lea     rcx, [rbp-30h]
4213459    mov     eax, [rbp-34h]
4213462    mov     rsi, rcx
4213465    mov     edi, eax
4213467    call    _accept
4213472    jmp     loc_404AE5
loc_404AE2:
4213474    mov     eax, [rbp-34h]
loc_404AE5:
4213477    mov     [rbx], eax
4213479    mov     eax, [rbx]
4213481    cmp     eax, 0FFFFFFFFh
4213484    jz      loc_404B15
4213486    mov     rax, [rbp-48h]
4213490    mov     eax, [rax]
4213492    mov     edi, eax
4213494    call    _ns_set_close_on_exec
4213499    mov     rax, [rbp-48h]
4213503    add     rax, 4
4213507    mov     eax, [rax]
4213509    mov     edi, eax
4213511    call    _ns_set_close_on_exec
4213516    mov     dword [rbp-38h], 1
4213523    jmp     loc_404B63
loc_404B15:
4213525    mov     rax, [rbp-48h]
4213529    mov     eax, [rax]
4213531    cmp     eax, 0FFFFFFFFh
4213534    jz      loc_404B2D
4213536    mov     rax, [rbp-48h]
4213540    mov     eax, [rax]
4213542    mov     edi, eax
4213544    call    _close
loc_404B2D:
4213549    mov     rax, [rbp-48h]
4213553    add     rax, 4
4213557    mov     eax, [rax]
4213559    cmp     eax, 0FFFFFFFFh
4213562    jz      loc_404B4D
4213564    mov     rax, [rbp-48h]
4213568    add     rax, 4
4213572    mov     eax, [rax]
4213574    mov     edi, eax
4213576    call    _close
loc_404B4D:
4213581    mov     rax, [rbp-48h]
4213585    add     rax, 4
4213589    mov     dword [rax], 0FFFFFFFFh
4213595    mov     edx, [rax]
4213597    mov     rax, [rbp-48h]
4213601    mov     [rax], edx
loc_404B63:
4213603    cmp     dword [rbp-4Ch], 2
4213607    jz      loc_404B73
4213609    mov     eax, [rbp-34h]
4213612    mov     edi, eax
4213614    call    _close
loc_404B73:
4213619    mov     eax, [rbp-38h]
4213622    mov     rbx, [rbp-18h]
4213626    xor     rbx, [fs:28h]
4213635    jz      loc_404B8A
4213637    call    ___stack_chk_fail
loc_404B8A:
4213642    add     rsp, 48h
4213646    pop     rbx
4213647    pop     rbp
4213648    retn    
USE32

section .text

global _ns_socketpair

_ns_socketpair:
4213649    push    rbp
4213650    mov     rbp, rsp
4213653    sub     rsp, 10h
4213657    call    _mcount
4213662    mov     [rbp-8], rdi
4213666    mov     rax, [rbp-8]
4213670    mov     esi, 1
4213675    mov     rdi, rax
4213678    call    _ns_socketpair2
4213683    leave   
4213684    retn    
USE32

section .text

global _ns_resolve2

_ns_resolve2:
4213685    push    rbp
4213686    mov     rbp, rsp
4213689    sub     rsp, 20h
4213693    call    _mcount
4213698    mov     [rbp-18h], rdi
4213702    mov     [rbp-20h], rsi
4213706    mov     rax, [rbp-18h]
4213710    mov     rdi, rax
4213713    call    _gethostbyname
4213718    mov     [rbp-8], rax
4213722    cmp     qword [rbp-8], 0
4213727    jz      loc_404C07
4213729    mov     rax, [rbp-8]
4213733    mov     rax, [rax+18h]
4213737    mov     rcx, [rax]
4213740    mov     rax, [rbp-20h]
4213744    mov     edx, 4
4213749    mov     rsi, rcx
4213752    mov     rdi, rax
4213755    call    _memcpy
4213760    mov     eax, 1
4213765    jmp     locret_404C0C
loc_404C07:
4213767    mov     eax, 0
locret_404C0C:
4213772    leave   
4213773    retn    
USE32

section .text

global _ns_resolve

_ns_resolve:
4213774    push    rbp
4213775    mov     rbp, rsp
4213778    sub     rsp, 30h
4213782    call    _mcount
4213787    mov     [rbp-18h], rdi
4213791    mov     [rbp-20h], rsi
4213795    mov     [rbp-28h], rdx
4213799    lea     rdx, [rbp-10h]
4213803    mov     rax, [rbp-18h]
4213807    mov     rsi, rdx
4213810    mov     rdi, rax
4213813    call    _ns_resolve2
4213818    test    eax, eax
4213820    jz      loc_404C6A
4213822    mov     eax, [rbp-10h]
4213825    mov     edi, eax
4213827    call    _inet_ntoa
4213832    mov     rdx, rax
4213835    mov     rsi, [rbp-28h]
4213839    mov     rax, [rbp-20h]
4213843    mov     rcx, rdx
4213846    mov     edx, aS_2
4213851    mov     rdi, rax
4213854    mov     eax, 0
4213859    call    _snprintf
4213864    jmp     locret_404C6F
loc_404C6A:
4213866    mov     eax, 0
locret_404C6F:
4213871    leave   
4213872    retn    
USE32

section .text

global _ns_parse_address

_ns_parse_address:
4213873    push    rbp
4213874    mov     rbp, rsp
4213877    push    rbx
4213878    sub     rsp, 138h
4213885    call    _mcount
4213890    mov     [rbp-108h], rdi
4213897    mov     [rbp-110h], rsi
4213904    mov     [rbp-118h], rdx
4213911    mov     [rbp-120h], rcx
4213918    mov     [rbp-128h], r8
4213925    mov     [rbp-130h], r9
4213932    mov     rax, [fs:28h]
4213941    mov     [rbp-18h], rax
4213945    xor     eax, eax
4213947    mov     dword [rbp-0E8h], 0
4213957    mov     dword [rbp-0E4h], 0
4213967    mov     rax, [rbp-110h]
4213974    mov     edx, 10h
4213979    mov     esi, 0
4213984    mov     rdi, rax
4213987    call    _memset
4213992    mov     rax, [rbp-110h]
4213999    mov     word [rax], 2
4214004    mov     rax, [rbp-118h]
4214011    mov     dword [rax], 1
4214017    mov     rax, [rbp-120h]
4214024    mov     dword [rax], 0
4214030    mov     rax, [rbp-130h]
4214037    mov     byte [rax], 0
4214040    mov     rax, [rbp-130h]
4214047    movzx   edx, byte [rax]
4214050    mov     rax, [rbp-128h]
4214057    mov     [rax], dl
4214059    mov     rax, [rbp-108h]
4214066    mov     edx, 6
4214071    mov     esi, aSsl
4214076    mov     rdi, rax
4214079    call    _memcmp
4214084    test    eax, eax
4214086    jnz     loc_404D5F
4214088    add     qword [rbp-108h], 6
4214096    mov     rax, [rbp-120h]
4214103    mov     dword [rax], 1
4214109    jmp     loc_404DB8
loc_404D5F:
4214111    mov     rax, [rbp-108h]
4214118    mov     edx, 6
4214123    mov     esi, aUdp
4214128    mov     rdi, rax
4214131    call    _memcmp
4214136    test    eax, eax
4214138    jnz     loc_404D93
4214140    add     qword [rbp-108h], 6
4214148    mov     rax, [rbp-118h]
4214155    mov     dword [rax], 2
4214161    jmp     loc_404DB8
loc_404D93:
4214163    mov     rax, [rbp-108h]
4214170    mov     edx, 6
4214175    mov     esi, aTcp
4214180    mov     rdi, rax
4214183    call    _memcmp
4214188    test    eax, eax
4214190    jnz     loc_404DB8
4214192    add     qword [rbp-108h], 6
loc_404DB8:
4214200    lea     r8, [rbp-0F0h]
4214207    lea     rdi, [rbp-0F4h]
4214214    lea     rcx, [rbp-0F8h]
4214221    lea     rdx, [rbp-0FCh]
4214228    mov     rax, [rbp-108h]
4214235    lea     rsi, [rbp-0E4h]
4214242    mov     [rsp+8], rsi
4214247    lea     rsi, [rbp-0ECh]
4214254    mov     [rsp], rsi
4214258    mov     r9, r8
4214261    mov     r8, rdi
4214264    mov     esi, aU_U_U_UUN
4214269    mov     rdi, rax
4214272    mov     eax, 0
4214277    call    ___isoc99_sscanf
4214282    cmp     eax, 5
4214285    jnz     loc_404E69
4214287    mov     eax, [rbp-0FCh]
4214293    shl     eax, 18h
4214296    mov     edx, eax
4214298    mov     eax, [rbp-0F8h]
4214304    shl     eax, 10h
4214307    or      edx, eax
4214309    mov     eax, [rbp-0F4h]
4214315    shl     eax, 8
4214318    or      edx, eax
4214320    mov     eax, [rbp-0F0h]
4214326    or      eax, edx
4214328    mov     edi, eax
4214330    call    _htonl
4214335    mov     rdx, [rbp-110h]
4214342    mov     [rdx+4], eax
4214345    mov     eax, [rbp-0ECh]
4214351    movzx   eax, ax
4214354    mov     edi, eax
4214356    call    _htons
4214361    mov     rdx, [rbp-110h]
4214368    mov     [rdx+2], ax
4214372    jmp     loc_404F20
loc_404E69:
4214377    lea     rsi, [rbp-0E4h]
4214384    lea     rcx, [rbp-0ECh]
4214391    lea     rdx, [rbp-0E0h]
4214398    mov     rax, [rbp-108h]
4214405    mov     r8, rsi
4214408    mov     esi, a199UN
4214413    mov     rdi, rax
4214416    mov     eax, 0
4214421    call    ___isoc99_sscanf
4214426    cmp     eax, 2
4214429    jnz     loc_404ED9
4214431    mov     eax, [rbp-0ECh]
4214437    movzx   eax, ax
4214440    mov     edi, eax
4214442    call    _htons
4214447    mov     rdx, [rbp-110h]
4214454    mov     [rdx+2], ax
4214458    mov     rax, [rbp-110h]
4214465    lea     rdx, [rax+4]
4214469    lea     rax, [rbp-0E0h]
4214476    mov     rsi, rdx
4214479    mov     rdi, rax
4214482    call    _ns_resolve2
4214487    jmp     loc_404F20
loc_404ED9:
4214489    lea     rcx, [rbp-0E4h]
4214496    lea     rdx, [rbp-0ECh]
4214503    mov     rax, [rbp-108h]
4214510    mov     esi, aUN
4214515    mov     rdi, rax
4214518    mov     eax, 0
4214523    call    ___isoc99_sscanf
4214528    cmp     eax, 1
4214531    jnz     loc_404F20
4214533    mov     eax, [rbp-0ECh]
4214539    movzx   eax, ax
4214542    mov     edi, eax
4214544    call    _htons
4214549    mov     rdx, [rbp-110h]
4214556    mov     [rdx+2], ax
loc_404F20:
4214560    mov     rax, [rbp-120h]
4214567    mov     eax, [rax]
4214569    test    eax, eax
4214571    jz      loc_404FC7
4214577    mov     eax, [rbp-0E4h]
4214583    movsxd  rdx, eax
4214586    mov     rax, [rbp-108h]
4214593    lea     rdi, [rdx+rax]
4214597    lea     rcx, [rbp-0E8h]
4214604    mov     rdx, [rbp-130h]
4214611    mov     rax, [rbp-128h]
4214618    mov     r8, rcx
4214621    mov     rcx, rdx
4214624    mov     rdx, rax
4214627    mov     esi, a9999N
4214632    mov     eax, 0
4214637    call    ___isoc99_sscanf
4214642    cmp     eax, 2
4214645    jz      loc_404FB3
4214647    mov     eax, [rbp-0E4h]
4214653    movsxd  rdx, eax
4214656    mov     rax, [rbp-108h]
4214663    lea     rdi, [rdx+rax]
4214667    lea     rdx, [rbp-0E8h]
4214674    mov     rax, [rbp-128h]
4214681    mov     rcx, rdx
4214684    mov     rdx, rax
4214687    mov     esi, a99N
4214692    mov     eax, 0
4214697    call    ___isoc99_sscanf
4214702    cmp     eax, 1
4214705    jnz     loc_404FC7
loc_404FB3:
4214707    mov     edx, [rbp-0E4h]
4214713    mov     eax, [rbp-0E8h]
4214719    add     eax, edx
4214721    mov     [rbp-0E4h], eax
loc_404FC7:
4214727    mov     eax, [rbp-0ECh]
4214733    cmp     eax, 0FFFEh
4214738    ja      loc_404FF6
4214740    mov     eax, [rbp-0E4h]
4214746    movsxd  rdx, eax
4214749    mov     rax, [rbp-108h]
4214756    add     rax, rdx
4214759    movzx   eax, byte [rax]
4214762    test    al, al
4214764    jnz     loc_404FF6
4214766    mov     eax, [rbp-0E4h]
4214772    jmp     loc_404FFB
loc_404FF6:
4214774    mov     eax, 0
loc_404FFB:
4214779    mov     rbx, [rbp-18h]
4214783    xor     rbx, [fs:28h]
4214792    jz      loc_40500F
4214794    call    ___stack_chk_fail
loc_40500F:
4214799    add     rsp, 138h
4214806    pop     rbx
4214807    pop     rbp
4214808    retn    
USE32

section .text

global _ns_open_listening_socket

_ns_open_listening_socket:
4214809    push    rbp
4214810    mov     rbp, rsp
4214813    sub     rsp, 20h
4214817    call    _mcount
4214822    mov     [rbp-18h], rdi
4214826    mov     [rbp-1Ch], esi
4214829    mov     dword [rbp-0Ch], 10h
4214836    mov     dword [rbp-4], 0FFFFFFFFh
4214843    mov     dword [rbp-8], 1
4214850    mov     rax, [rbp-18h]
4214854    movzx   eax, word [rax]
4214857    movzx   eax, ax
4214860    mov     ecx, [rbp-1Ch]
4214863    mov     edx, 0
4214868    mov     esi, ecx
4214870    mov     edi, eax
4214872    call    _socket
4214877    mov     [rbp-4], eax
4214880    cmp     dword [rbp-4], 0FFFFFFFFh
4214884    jz      loc_4050DD
4214886    lea     rdx, [rbp-8]
4214890    mov     eax, [rbp-4]
4214893    mov     r8d, 4
4214899    mov     rcx, rdx
4214902    mov     edx, 2
4214907    mov     esi, 1
4214912    mov     edi, eax
4214914    call    _setsockopt
4214919    test    eax, eax
4214921    jnz     loc_4050DD
4214923    mov     edx, [rbp-0Ch]
4214926    mov     rcx, [rbp-18h]
4214930    mov     eax, [rbp-4]
4214933    mov     rsi, rcx
4214936    mov     edi, eax
4214938    call    _bind
4214943    test    eax, eax
4214945    jnz     loc_4050DD
4214947    cmp     dword [rbp-1Ch], 2
4214951    jz      loc_4050BC
4214953    mov     eax, [rbp-4]
4214956    mov     esi, 80h
4214961    mov     edi, eax
4214963    call    _listen
4214968    test    eax, eax
4214970    jnz     loc_4050DD
loc_4050BC:
4214972    mov     eax, [rbp-4]
4214975    mov     edi, eax
4214977    call    _ns_set_non_blocking_mode
4214982    mov     rcx, [rbp-18h]
4214986    lea     rdx, [rbp-0Ch]
4214990    mov     eax, [rbp-4]
4214993    mov     rsi, rcx
4214996    mov     edi, eax
4214998    call    _getsockname
4215003    jmp     loc_4050F4
loc_4050DD:
4215005    cmp     dword [rbp-4], 0FFFFFFFFh
4215009    jz      loc_4050F4
4215011    mov     eax, [rbp-4]
4215014    mov     edi, eax
4215016    call    _close
4215021    mov     dword [rbp-4], 0FFFFFFFFh
loc_4050F4:
4215028    mov     eax, [rbp-4]
4215031    leave   
4215032    retn    
USE32

section .text

global _ns_bind

_ns_bind:
4215033    push    rbp
4215034    mov     rbp, rsp
4215037    push    rbx
4215038    sub     rsp, 138h
4215045    call    _mcount
4215050    mov     [rbp-128h], rdi
4215057    mov     [rbp-130h], rsi
4215064    mov     [rbp-138h], rdx
4215071    mov     [rbp-140h], rcx
4215078    mov     rax, [fs:28h]
4215087    mov     [rbp-18h], rax
4215091    xor     eax, eax
4215093    mov     qword [rbp-108h], 0
4215104    lea     r8, [rbp-80h]
4215108    lea     rdi, [rbp-0F0h]
4215115    lea     rcx, [rbp-114h]
4215122    lea     rdx, [rbp-110h]
4215129    lea     rsi, [rbp-100h]
4215136    mov     rax, [rbp-130h]
4215143    mov     r9, r8
4215146    mov     r8, rdi
4215149    mov     rdi, rax
4215152    call    _ns_parse_address
4215157    mov     eax, [rbp-114h]
4215163    test    eax, eax
4215165    jz      loc_405194
4215167    movzx   eax, byte [rbp-0F0h]
4215174    test    al, al
4215176    jnz     loc_405194
4215178    mov     eax, 0
4215183    jmp     loc_405295
loc_405194:
4215188    mov     edx, [rbp-110h]
4215194    lea     rax, [rbp-100h]
4215201    mov     esi, edx
4215203    mov     rdi, rax
4215206    call    _ns_open_listening_socket
4215211    mov     [rbp-10Ch], eax
4215217    cmp     dword [rbp-10Ch], 0FFFFFFFFh
4215224    jz      loc_40528E
4215230    mov     rdx, [rbp-138h]
4215237    mov     esi, [rbp-10Ch]
4215243    mov     rax, [rbp-128h]
4215250    mov     ecx, 0
4215255    mov     rdi, rax
4215258    call    _ns_add_sock
4215263    mov     [rbp-108h], rax
4215270    cmp     qword [rbp-108h], 0
4215278    jnz     loc_405202
4215280    mov     eax, [rbp-10Ch]
4215286    mov     edi, eax
4215288    call    _close
4215293    jmp     loc_40528E
loc_405202:
4215298    mov     rax, [rbp-108h]
4215305    mov     rdx, [rbp-100h]
4215312    mov     [rax+24h], rdx
4215316    mov     rdx, [rbp-0F8h]
4215323    mov     [rax+2Ch], rdx
4215327    mov     rax, [rbp-108h]
4215334    mov     eax, [rax+98h]
4215340    or      al, 80h
4215342    mov     edx, eax
4215344    mov     rax, [rbp-108h]
4215351    mov     [rax+98h], edx
4215357    mov     rax, [rbp-108h]
4215364    mov     rdx, [rbp-140h]
4215371    mov     [rax+78h], rdx
4215375    mov     rax, [rbp-108h]
4215382    mov     rdx, [rbp-138h]
4215389    mov     [rax+90h], rdx
4215396    mov     eax, [rbp-110h]
4215402    cmp     eax, 2
4215405    jnz     loc_40528E
4215407    mov     rax, [rbp-108h]
4215414    mov     eax, [rax+98h]
4215420    or      ah, 1
4215423    mov     edx, eax
4215425    mov     rax, [rbp-108h]
4215432    mov     [rax+98h], edx
loc_40528E:
4215438    mov     rax, [rbp-108h]
loc_405295:
4215445    mov     rbx, [rbp-18h]
4215449    xor     rbx, [fs:28h]
4215458    jz      loc_4052A9
4215460    call    ___stack_chk_fail
loc_4052A9:
4215465    add     rsp, 138h
4215472    pop     rbx
4215473    pop     rbp
4215474    retn    
USE32

section .text

global _accept_conn

_accept_conn:
4215475    push    rbp
4215476    mov     rbp, rsp
4215479    push    rbx
4215480    sub     rsp, 48h
4215484    call    _mcount
4215489    mov     [rbp-48h], rdi
4215493    mov     rax, [fs:28h]
4215502    mov     [rbp-18h], rax
4215506    xor     eax, eax
4215508    mov     qword [rbp-38h], 0
4215516    mov     dword [rbp-40h], 10h
4215523    mov     dword [rbp-3Ch], 0FFFFFFFFh
4215530    mov     rax, [rbp-48h]
4215534    mov     eax, [rax+20h]
4215537    lea     rdx, [rbp-40h]
4215541    lea     rcx, [rbp-30h]
4215545    mov     rsi, rcx
4215548    mov     edi, eax
4215550    call    _accept
4215555    mov     [rbp-3Ch], eax
4215558    cmp     dword [rbp-3Ch], 0FFFFFFFFh
4215562    jz      loc_405380
4215564    mov     rax, [rbp-48h]
4215568    mov     rcx, [rax+78h]
4215572    mov     rax, [rbp-48h]
4215576    mov     rdx, [rax+90h]
4215583    mov     rax, [rbp-48h]
4215587    mov     rax, [rax+18h]
4215591    mov     esi, [rbp-3Ch]
4215594    mov     rdi, rax
4215597    call    _ns_add_sock
4215602    mov     [rbp-38h], rax
4215606    cmp     qword [rbp-38h], 0
4215611    jnz     loc_405349
4215613    mov     eax, [rbp-3Ch]
4215616    mov     edi, eax
4215618    call    _close
4215623    jmp     loc_405380
loc_405349:
4215625    mov     rax, [rbp-38h]
4215629    mov     rdx, [rbp-48h]
4215633    mov     [rax+10h], rdx
4215637    mov     rax, [rbp-48h]
4215641    mov     rdx, [rax+80h]
4215648    mov     rax, [rbp-38h]
4215652    mov     [rax+80h], rdx
4215659    lea     rdx, [rbp-30h]
4215663    mov     rax, [rbp-38h]
4215667    mov     esi, 1
4215672    mov     rdi, rax
4215675    call    _ns_call
loc_405380:
4215680    mov     rax, [rbp-38h]
4215684    mov     rbx, [rbp-18h]
4215688    xor     rbx, [fs:28h]
4215697    jz      loc_405398
4215699    call    ___stack_chk_fail
loc_405398:
4215704    add     rsp, 48h
4215708    pop     rbx
4215709    pop     rbp
4215710    retn    
USE32

section .text

global _ns_is_error

_ns_is_error:
4215711    push    rbp
4215712    mov     rbp, rsp
4215715    sub     rsp, 10h
4215719    call    _mcount
4215724    mov     [rbp-4], edi
4215727    cmp     dword [rbp-4], 0
4215731    jz      loc_4053EB
4215733    cmp     dword [rbp-4], 0
4215737    jns     loc_4053F2
4215739    call    ___errno_location
4215744    mov     eax, [rax]
4215746    cmp     eax, 4
4215749    jz      loc_4053F2
4215751    call    ___errno_location
4215756    mov     eax, [rax]
4215758    cmp     eax, 73h
4215761    jz      loc_4053F2
4215763    call    ___errno_location
4215768    mov     eax, [rax]
4215770    cmp     eax, 0Bh
4215773    jz      loc_4053F2
4215775    call    ___errno_location
4215780    mov     eax, [rax]
4215782    cmp     eax, 0Bh
4215785    jz      loc_4053F2
loc_4053EB:
4215787    mov     eax, 1
4215792    jmp     locret_4053F7
loc_4053F2:
4215794    mov     eax, 0
locret_4053F7:
4215799    leave   
4215800    retn    
USE32

section .text

global _ns_sock_to_str

_ns_sock_to_str:
4215801    push    rbp
4215802    mov     rbp, rsp
4215805    push    r13
4215807    push    r12
4215809    push    rbx
4215810    sub     rsp, 58h
4215814    call    _mcount
4215819    mov     [rbp-54h], edi
4215822    mov     [rbp-60h], rsi
4215826    mov     [rbp-68h], rdx
4215830    mov     [rbp-58h], ecx
4215833    mov     rax, [fs:28h]
4215842    mov     [rbp-28h], rax
4215846    xor     eax, eax
4215848    mov     dword [rbp-44h], 10h
4215855    cmp     qword [rbp-60h], 0
4215860    jz      loc_40553C
4215866    cmp     qword [rbp-68h], 0
4215871    jz      loc_40553C
4215877    mov     rax, [rbp-60h]
4215881    mov     byte [rax], 0
4215884    lea     rax, [rbp-40h]
4215888    mov     edx, 10h
4215893    mov     esi, 0
4215898    mov     rdi, rax
4215901    call    _memset
4215906    mov     eax, [rbp-58h]
4215909    and     eax, 4
4215912    test    eax, eax
4215914    jz      loc_405483
4215916    lea     rdx, [rbp-44h]
4215920    lea     rcx, [rbp-40h]
4215924    mov     eax, [rbp-54h]
4215927    mov     rsi, rcx
4215930    mov     edi, eax
4215932    call    _getpeername
4215937    jmp     loc_405498
loc_405483:
4215939    lea     rdx, [rbp-44h]
4215943    lea     rcx, [rbp-40h]
4215947    mov     eax, [rbp-54h]
4215950    mov     rsi, rcx
4215953    mov     edi, eax
4215955    call    _getsockname
loc_405498:
4215960    mov     eax, [rbp-58h]
4215963    and     eax, 1
4215966    test    eax, eax
4215968    jz      loc_4054C2
4215970    mov     rax, [rbp-68h]
4215974    mov     ecx, eax
4215976    movzx   eax, word [rbp-40h]
4215980    movzx   eax, ax
4215983    mov     rdx, [rbp-60h]
4215987    lea     rsi, [rbp-40h]
4215991    add     rsi, 4
4215995    mov     edi, eax
4215997    call    _inet_ntop
loc_4054C2:
4216002    mov     eax, [rbp-58h]
4216005    and     eax, 2
4216008    test    eax, eax
4216010    jz      loc_40553C
4216012    movzx   eax, word [rbp-3Eh]
4216016    movzx   eax, ax
4216019    mov     edi, eax
4216021    call    _ntohs
4216026    movzx   r13d, ax
4216030    mov     eax, [rbp-58h]
4216033    and     eax, 1
4216036    test    eax, eax
4216038    jz      loc_4054EF
4216040    mov     ebx, asc_414194
4216045    jmp     loc_4054F4
loc_4054EF:
4216047    mov     ebx, unk_414196
loc_4054F4:
4216052    mov     rax, [rbp-60h]
4216056    mov     rdi, rax
4216059    call    _strlen
4216064    mov     rdx, [rbp-68h]
4216068    sub     rdx, rax
4216071    mov     rax, rdx
4216074    lea     r12, [rax-1]
4216078    mov     rax, [rbp-60h]
4216082    mov     rdi, rax
4216085    call    _strlen
4216090    mov     rdx, [rbp-60h]
4216094    add     rax, rdx
4216097    mov     r8d, r13d
4216100    mov     rcx, rbx
4216103    mov     edx, aSD
4216108    mov     rsi, r12
4216111    mov     rdi, rax
4216114    mov     eax, 0
4216119    call    _snprintf
loc_40553C:
4216124    mov     rax, [rbp-28h]
4216128    xor     rax, [fs:28h]
4216137    jz      loc_405550
4216139    call    ___stack_chk_fail
loc_405550:
4216144    add     rsp, 58h
4216148    pop     rbx
4216149    pop     r12
4216151    pop     r13
4216153    pop     rbp
4216154    retn    
USE32

section .text

global _ns_hexdump

_ns_hexdump:
4216155    push    rbp
4216156    mov     rbp, rsp
4216159    push    rbx
4216160    sub     rsp, 68h
4216164    call    _mcount
4216169    mov     [rbp-58h], rdi
4216173    mov     [rbp-5Ch], esi
4216176    mov     [rbp-68h], rdx
4216180    mov     [rbp-60h], ecx
4216183    mov     rax, [fs:28h]
4216192    mov     [rbp-18h], rax
4216196    xor     eax, eax
4216198    mov     rax, [rbp-58h]
4216202    mov     [rbp-38h], rax
4216206    mov     qword [rbp-30h], 0
4216214    mov     qword [rbp-28h], 0
4216222    mov     byte [rbp-20h], 0
4216226    mov     dword [rbp-40h], 0
4216233    mov     dword [rbp-44h], 0
4216240    jmp     loc_4056DA
loc_4055B5:
4216245    mov     eax, [rbp-44h]
4216248    cdq     
4216249    shr     edx, 1Ch
4216252    add     eax, edx
4216254    and     eax, 0Fh
4216257    sub     eax, edx
4216259    mov     [rbp-3Ch], eax
4216262    cmp     dword [rbp-3Ch], 0
4216266    jnz     loc_40563C
4216268    cmp     dword [rbp-44h], 0
4216272    jle     loc_405608
4216274    mov     eax, [rbp-40h]
4216277    mov     edx, [rbp-60h]
4216280    sub     edx, eax
4216282    mov     eax, edx
4216284    cdqe    
4216286    mov     edx, [rbp-40h]
4216289    movsxd  rcx, edx
4216292    mov     rdx, [rbp-68h]
4216296    lea     rdi, [rcx+rdx]
4216300    lea     rdx, [rbp-30h]
4216304    mov     rcx, rdx
4216307    mov     edx, aS_3
4216312    mov     rsi, rax
4216315    mov     eax, 0
4216320    call    _snprintf
4216325    add     [rbp-40h], eax
loc_405608:
4216328    mov     eax, [rbp-40h]
4216331    mov     edx, [rbp-60h]
4216334    sub     edx, eax
4216336    mov     eax, edx
4216338    cdqe    
4216340    mov     edx, [rbp-40h]
4216343    movsxd  rcx, edx
4216346    mov     rdx, [rbp-68h]
4216350    lea     rdi, [rcx+rdx]
4216354    mov     edx, [rbp-44h]
4216357    mov     ecx, edx
4216359    mov     edx, a04x
4216364    mov     rsi, rax
4216367    mov     eax, 0
4216372    call    _snprintf
4216377    add     [rbp-40h], eax
loc_40563C:
4216380    mov     eax, [rbp-44h]
4216383    movsxd  rdx, eax
4216386    mov     rax, [rbp-38h]
4216390    add     rax, rdx
4216393    movzx   eax, byte [rax]
4216396    movzx   edx, al
4216399    mov     eax, [rbp-40h]
4216402    mov     ecx, [rbp-60h]
4216405    sub     ecx, eax
4216407    mov     eax, ecx
4216409    cdqe    
4216411    mov     ecx, [rbp-40h]
4216414    movsxd  rsi, ecx
4216417    mov     rcx, [rbp-68h]
4216421    lea     rdi, [rsi+rcx]
4216425    mov     ecx, edx
4216427    mov     edx, a02x
4216432    mov     rsi, rax
4216435    mov     eax, 0
4216440    call    _snprintf
4216445    add     [rbp-40h], eax
4216448    mov     eax, [rbp-44h]
4216451    movsxd  rdx, eax
4216454    mov     rax, [rbp-38h]
4216458    add     rax, rdx
4216461    movzx   eax, byte [rax]
4216464    cmp     al, 1Fh
4216466    jbe     loc_4056BA
4216468    mov     eax, [rbp-44h]
4216471    movsxd  rdx, eax
4216474    mov     rax, [rbp-38h]
4216478    add     rax, rdx
4216481    movzx   eax, byte [rax]
4216484    cmp     al, 7Eh
4216486    ja      loc_4056BA
4216488    mov     eax, [rbp-44h]
4216491    movsxd  rdx, eax
4216494    mov     rax, [rbp-38h]
4216498    add     rax, rdx
4216501    movzx   eax, byte [rax]
4216504    jmp     loc_4056BF
loc_4056BA:
4216506    mov     eax, 2Eh
loc_4056BF:
4216511    mov     edx, [rbp-3Ch]
4216514    movsxd  rdx, edx
4216517    mov     [rbp+rdx-30h], al
4216521    mov     eax, [rbp-3Ch]
4216524    add     eax, 1
4216527    cdqe    
4216529    mov     byte [rbp+rax-30h], 0
4216534    add     dword [rbp-44h], 1
loc_4056DA:
4216538    mov     eax, [rbp-44h]
4216541    cmp     eax, [rbp-5Ch]
4216544    jl      loc_4055B5
4216550    jmp     loc_40571C
loc_4056E8:
4216552    mov     eax, [rbp-40h]
4216555    mov     edx, [rbp-60h]
4216558    sub     edx, eax
4216560    mov     eax, edx
4216562    cdqe    
4216564    mov     edx, [rbp-40h]
4216567    movsxd  rcx, edx
4216570    mov     rdx, [rbp-68h]
4216574    lea     rdi, [rcx+rdx]
4216578    mov     ecx, asc_4141AE
4216583    mov     edx, aS_2
4216588    mov     rsi, rax
4216591    mov     eax, 0
4216596    call    _snprintf
4216601    add     [rbp-40h], eax
loc_40571C:
4216604    mov     eax, [rbp-44h]
4216607    lea     edx, [rax+1]
4216610    mov     [rbp-44h], edx
4216613    and     eax, 0Fh
4216616    test    eax, eax
4216618    jnz     loc_4056E8
4216620    mov     eax, [rbp-40h]
4216623    mov     edx, [rbp-60h]
4216626    sub     edx, eax
4216628    mov     eax, edx
4216630    cdqe    
4216632    mov     edx, [rbp-40h]
4216635    movsxd  rcx, edx
4216638    mov     rdx, [rbp-68h]
4216642    lea     rdi, [rcx+rdx]
4216646    lea     rdx, [rbp-30h]
4216650    mov     rcx, rdx
4216653    mov     edx, aS_4
4216658    mov     rsi, rax
4216661    mov     eax, 0
4216666    call    _snprintf
4216671    add     [rbp-40h], eax
4216674    mov     eax, [rbp-40h]
4216677    mov     rbx, [rbp-18h]
4216681    xor     rbx, [fs:28h]
4216690    jz      loc_405779
4216692    call    ___stack_chk_fail
loc_405779:
4216697    add     rsp, 68h
4216701    pop     rbx
4216702    pop     rbp
4216703    retn    
USE32

section .text

global _ns_read_from_socket

_ns_read_from_socket:
4216704    push    rbp
4216705    mov     rbp, rsp
4216708    sub     rsp, 830h
4216715    call    _mcount
4216720    mov     [rbp-828h], rdi
4216727    mov     rax, [fs:28h]
4216736    mov     [rbp-8], rax
4216740    xor     eax, eax
4216742    mov     dword [rbp-820h], 0
4216752    mov     rax, [rbp-828h]
4216759    mov     eax, [rax+98h]
4216765    and     eax, 8
4216768    test    eax, eax
4216770    jz      loc_40587A
4216776    mov     dword [rbp-81Ch], 1
4216786    mov     dword [rbp-818h], 4
4216796    mov     rax, [rbp-828h]
4216803    mov     eax, [rax+20h]
4216806    lea     rcx, [rbp-818h]
4216813    lea     rdx, [rbp-81Ch]
4216820    mov     r8, rcx
4216823    mov     rcx, rdx
4216826    mov     edx, 4
4216831    mov     esi, 1
4216836    mov     edi, eax
4216838    call    _getsockopt
4216843    mov     [rbp-814h], eax
4216849    mov     rax, [rbp-828h]
4216856    mov     eax, [rax+98h]
4216862    and     eax, 0FFFFFFF7h
4216865    mov     edx, eax
4216867    mov     rax, [rbp-828h]
4216874    mov     [rax+98h], edx
4216880    mov     eax, [rbp-81Ch]
4216886    test    eax, eax
4216888    jz      loc_405859
4216890    mov     rax, [rbp-828h]
4216897    mov     eax, [rax+98h]
4216903    or      eax, 10h
4216906    mov     edx, eax
4216908    mov     rax, [rbp-828h]
4216915    mov     [rax+98h], edx
loc_405859:
4216921    lea     rdx, [rbp-81Ch]
4216928    mov     rax, [rbp-828h]
4216935    mov     esi, 2
4216940    mov     rdi, rax
4216943    call    _ns_call
4216948    nop     
4216949    jmp     loc_40591F
loc_40587A:
4216954    jmp     loc_4058BD
loc_40587C:
4216956    mov     eax, [rbp-820h]
4216962    movsxd  rdx, eax
4216965    mov     rax, [rbp-828h]
4216972    lea     rcx, [rax+38h]
4216976    lea     rax, [rbp-810h]
4216983    mov     rsi, rax
4216986    mov     rdi, rcx
4216989    call    _iobuf_append
4216994    lea     rdx, [rbp-820h]
4217001    mov     rax, [rbp-828h]
4217008    mov     esi, 3
4217013    mov     rdi, rax
4217016    call    _ns_call
loc_4058BD:
4217021    mov     rax, [rbp-828h]
4217028    mov     eax, [rax+20h]
4217031    lea     rsi, [rbp-810h]
4217038    mov     ecx, 0
4217043    mov     edx, 800h
4217048    mov     edi, eax
4217050    call    _recv
4217055    mov     [rbp-820h], eax
4217061    mov     eax, [rbp-820h]
4217067    test    eax, eax
4217069    jg      loc_40587C
4217071    mov     eax, [rbp-820h]
4217077    mov     edi, eax
4217079    call    _ns_is_error
4217084    test    eax, eax
4217086    jz      loc_40591F
4217088    mov     rax, [rbp-828h]
4217095    mov     eax, [rax+98h]
4217101    or      eax, 10h
4217104    mov     edx, eax
4217106    mov     rax, [rbp-828h]
4217113    mov     [rax+98h], edx
loc_40591F:
4217119    mov     rax, [rbp-8]
4217123    xor     rax, [fs:28h]
4217132    jz      locret_405933
4217134    call    ___stack_chk_fail
locret_405933:
4217139    leave   
4217140    retn    
USE32

section .text

global _ns_write_to_socket

_ns_write_to_socket:
4217141    push    rbp
4217142    mov     rbp, rsp
4217145    sub     rsp, 20h
4217149    call    _mcount
4217154    mov     [rbp-18h], rdi
4217158    mov     rax, [rbp-18h]
4217162    add     rax, 50h
4217166    mov     [rbp-8], rax
4217170    mov     dword [rbp-0Ch], 0
4217177    mov     rax, [rbp-8]
4217181    mov     rdx, [rax+8]
4217185    mov     rax, [rbp-8]
4217189    mov     rsi, [rax]
4217192    mov     rax, [rbp-18h]
4217196    mov     eax, [rax+20h]
4217199    mov     ecx, 0
4217204    mov     edi, eax
4217206    call    _send
4217211    mov     [rbp-0Ch], eax
4217214    lea     rdx, [rbp-0Ch]
4217218    mov     rax, [rbp-18h]
4217222    mov     esi, 4
4217227    mov     rdi, rax
4217230    call    _ns_call
4217235    mov     eax, [rbp-0Ch]
4217238    mov     edi, eax
4217240    call    _ns_is_error
4217245    test    eax, eax
4217247    jz      loc_4059BC
4217249    mov     rax, [rbp-18h]
4217253    mov     eax, [rax+98h]
4217259    or      eax, 10h
4217262    mov     edx, eax
4217264    mov     rax, [rbp-18h]
4217268    mov     [rax+98h], edx
4217274    jmp     locret_4059D8
loc_4059BC:
4217276    mov     eax, [rbp-0Ch]
4217279    test    eax, eax
4217281    jle     locret_4059D8
4217283    mov     eax, [rbp-0Ch]
4217286    movsxd  rdx, eax
4217289    mov     rax, [rbp-8]
4217293    mov     rsi, rdx
4217296    mov     rdi, rax
4217299    call    _iobuf_remove
locret_4059D8:
4217304    leave   
4217305    retn    
USE32

section .text

global _ns_send

_ns_send:
4217306    push    rbp
4217307    mov     rbp, rsp
4217310    sub     rsp, 20h
4217314    call    _mcount
4217319    mov     [rbp-8], rdi
4217323    mov     [rbp-10h], rsi
4217327    mov     [rbp-18h], rdx
4217331    mov     rdx, [rbp-18h]
4217335    mov     rcx, [rbp-10h]
4217339    mov     rax, [rbp-8]
4217343    mov     rsi, rcx
4217346    mov     rdi, rax
4217349    call    _ns_out
4217354    leave   
4217355    retn    
USE32

section .text

global _ns_handle_udp

_ns_handle_udp:
4217356    push    rbp
4217357    mov     rbp, rsp
4217360    sub     rsp, 8A0h
4217367    call    _mcount
4217372    mov     [rbp-898h], rdi
4217379    mov     rax, [fs:28h]
4217388    mov     [rbp-8], rax
4217392    xor     eax, eax
4217394    mov     dword [rbp-88Ch], 10h
4217404    lea     rax, [rbp-880h]
4217411    mov     edx, 0A0h
4217416    mov     esi, 0
4217421    mov     rdi, rax
4217424    call    _memset
4217429    mov     rax, [rbp-898h]
4217436    mov     eax, [rax+20h]
4217439    lea     rdx, [rbp-88Ch]
4217446    lea     rcx, [rbp-880h]
4217453    add     rcx, 24h
4217457    lea     rsi, [rbp-7E0h]
4217464    mov     r9, rdx
4217467    mov     r8, rcx
4217470    mov     ecx, 0
4217475    mov     edx, 7D0h
4217480    mov     edi, eax
4217482    call    _recvfrom
4217487    mov     [rbp-888h], rax
4217494    mov     rax, [rbp-888h]
4217501    test    rax, rax
4217504    jle     loc_405B73
4217510    mov     rax, [rbp-898h]
4217517    mov     rax, [rax+18h]
4217521    mov     [rbp-868h], rax
4217528    lea     rax, [rbp-7E0h]
4217535    mov     [rbp-848h], rax
4217542    mov     rax, [rbp-888h]
4217549    mov     [rbp-838h], rax
4217556    mov     rax, [rbp-838h]
4217563    mov     [rbp-840h], rax
4217570    mov     rax, [rbp-898h]
4217577    mov     eax, [rax+20h]
4217580    mov     [rbp-860h], eax
4217586    mov     rax, [rbp-898h]
4217593    mov     rax, [rax+90h]
4217600    mov     [rbp-7F0h], rax
4217607    mov     rax, [rbp-898h]
4217614    mov     rax, [rax+78h]
4217618    mov     [rbp-808h], rax
4217625    mov     rax, [rbp-898h]
4217632    mov     rax, [rax+80h]
4217639    mov     [rbp-800h], rax
4217646    mov     rax, [rbp-898h]
4217653    mov     rax, [rax+18h]
4217657    mov     [rbp-868h], rax
4217664    mov     rax, [rbp-898h]
4217671    mov     [rbp-870h], rax
4217678    mov     dword [rbp-7E8h], 100h
4217688    lea     rdx, [rbp-888h]
4217695    lea     rax, [rbp-880h]
4217702    mov     esi, 3
4217707    mov     rdi, rax
4217710    call    _ns_call
loc_405B73:
4217715    mov     rax, [rbp-8]
4217719    xor     rax, [fs:28h]
4217728    jz      locret_405B87
4217730    call    ___stack_chk_fail
locret_405B87:
4217735    leave   
4217736    retn    
USE32

section .text

global _ns_add_to_set

_ns_add_to_set:
4217737    push    rbp
4217738    mov     rbp, rsp
4217741    sub     rsp, 18h
4217745    call    _mcount
4217750    mov     [rbp-4], edi
4217753    mov     [rbp-10h], rsi
4217757    mov     [rbp-18h], rdx
4217761    cmp     dword [rbp-4], 0FFFFFFFFh
4217765    jz      locret_405C0E
4217767    mov     eax, [rbp-4]
4217770    lea     edx, [rax+3Fh]
4217773    test    eax, eax
4217775    cmovs   eax, edx
4217778    sar     eax, 6
4217781    mov     rdx, [rbp-10h]
4217785    movsxd  rcx, eax
4217788    mov     rsi, [rdx+rcx*8]
4217792    mov     edx, [rbp-4]
4217795    mov     ecx, edx
4217797    sar     ecx, 1Fh
4217800    shr     ecx, 1Ah
4217803    add     edx, ecx
4217805    and     edx, 3Fh
4217808    sub     edx, ecx
4217810    mov     edi, 1
4217815    mov     ecx, edx
4217817    shl     rdi, cl
4217820    mov     rdx, rdi
4217823    or      rsi, rdx
4217826    mov     rcx, rsi
4217829    mov     rdx, [rbp-10h]
4217833    cdqe    
4217835    mov     [rdx+rax*8], rcx
4217839    mov     rax, [rbp-18h]
4217843    mov     eax, [rax]
4217845    cmp     eax, 0FFFFFFFFh
4217848    jz      loc_405C05
4217850    mov     rax, [rbp-18h]
4217854    mov     eax, [rax]
4217856    cmp     eax, [rbp-4]
4217859    jge     locret_405C0E
loc_405C05:
4217861    mov     rax, [rbp-18h]
4217865    mov     edx, [rbp-4]
4217868    mov     [rax], edx
locret_405C0E:
4217870    leave   
4217871    retn    
USE32

section .text

global _ns_mgr_poll

_ns_mgr_poll:
4217872    push    rbp
4217873    mov     rbp, rsp
4217876    push    rbx
4217877    sub     rsp, 2178h
4217884    call    _mcount
4217889    mov     [rbp-2178h], rdi
4217896    mov     [rbp-217Ch], esi
4217902    mov     rax, [fs:28h]
4217911    mov     [rbp-18h], rax
4217915    xor     eax, eax
4217917    mov     dword [rbp-2168h], 0FFFFFFFFh
4217927    mov     edi, 0
4217932    call    _time
4217937    mov     [rbp-2150h], rax
4217944    mov     eax, 0
4217949    mov     edx, 10h
4217954    lea     rsi, [rbp-2120h]
4217961    mov     rcx, rdx
4217964    mov     rdi, rsi
4217967    cld     
4217968    rep stosq
4217971    mov     eax, edi
4217973    mov     edx, ecx
4217975    mov     [rbp-2164h], edx
4217981    mov     [rbp-2160h], eax
4217987    mov     eax, 0
4217992    mov     edx, 10h
4217997    lea     rsi, [rbp-20A0h]
4218004    mov     rcx, rdx
4218007    mov     rdi, rsi
4218010    cld     
4218011    rep stosq
4218014    mov     eax, edi
4218016    mov     edx, ecx
4218018    mov     [rbp-215Ch], edx
4218024    mov     [rbp-2158h], eax
4218030    mov     rax, [rbp-2178h]
4218037    mov     eax, [rax+14h]
4218040    lea     rdx, [rbp-2168h]
4218047    lea     rcx, [rbp-2120h]
4218054    mov     rsi, rcx
4218057    mov     edi, eax
4218059    call    _ns_add_to_set
4218064    mov     rax, [rbp-2178h]
4218071    mov     rax, [rax]
4218074    mov     [rbp-2148h], rax
4218081    jmp     loc_405E16
loc_405CE6:
4218086    mov     rax, [rbp-2148h]
4218093    mov     rax, [rax]
4218096    mov     [rbp-2138h], rax
4218103    mov     rax, [rbp-2148h]
4218110    mov     eax, [rax+98h]
4218116    and     eax, 88h
4218121    test    eax, eax
4218123    jnz     loc_405D28
4218125    lea     rdx, [rbp-2150h]
4218132    mov     rax, [rbp-2148h]
4218139    mov     esi, 0
4218144    mov     rdi, rax
4218147    call    _ns_call
loc_405D28:
4218152    mov     rax, [rbp-2148h]
4218159    mov     eax, [rax+98h]
4218165    and     eax, 10h
4218168    test    eax, eax
4218170    jz      loc_405D50
4218172    mov     rax, [rbp-2148h]
4218179    mov     rdi, rax
4218182    call    _ns_close_conn
4218187    jmp     loc_405E08
loc_405D50:
4218192    mov     rax, [rbp-2148h]
4218199    mov     eax, [rax+98h]
4218205    and     eax, 40h
4218208    test    eax, eax
4218210    jnz     loc_405D86
4218212    mov     rax, [rbp-2148h]
4218219    mov     eax, [rax+20h]
4218222    lea     rdx, [rbp-2168h]
4218229    lea     rcx, [rbp-2120h]
4218236    mov     rsi, rcx
4218239    mov     edi, eax
4218241    call    _ns_add_to_set
loc_405D86:
4218246    mov     rax, [rbp-2148h]
4218253    mov     eax, [rax+98h]
4218259    and     eax, 8
4218262    test    eax, eax
4218264    jz      loc_405DAE
4218266    mov     rax, [rbp-2148h]
4218273    mov     eax, [rax+98h]
4218279    and     eax, 20h
4218282    test    eax, eax
4218284    jz      loc_405DE6
loc_405DAE:
4218286    mov     rax, [rbp-2148h]
4218293    mov     rax, [rax+58h]
4218297    test    rax, rax
4218300    jz      loc_405E08
4218302    mov     rax, [rbp-2148h]
4218309    mov     eax, [rax+98h]
4218315    and     eax, 8
4218318    test    eax, eax
4218320    jnz     loc_405E08
4218322    mov     rax, [rbp-2148h]
4218329    mov     eax, [rax+98h]
4218335    and     eax, 2
4218338    test    eax, eax
4218340    jnz     loc_405E08
loc_405DE6:
4218342    mov     rax, [rbp-2148h]
4218349    mov     eax, [rax+20h]
4218352    lea     rdx, [rbp-2168h]
4218359    lea     rcx, [rbp-20A0h]
4218366    mov     rsi, rcx
4218369    mov     edi, eax
4218371    call    _ns_add_to_set
loc_405E08:
4218376    mov     rax, [rbp-2138h]
4218383    mov     [rbp-2148h], rax
loc_405E16:
4218390    cmp     qword [rbp-2148h], 0
4218398    jnz     loc_405CE6
4218404    mov     ecx, [rbp-217Ch]
4218410    mov     edx, 10624DD3h
4218415    mov     eax, ecx
4218417    imul    edx
4218419    sar     edx, 6
4218422    mov     eax, ecx
4218424    sar     eax, 1Fh
4218427    sub     edx, eax
4218429    mov     eax, edx
4218431    cdqe    
4218433    mov     [rbp-2130h], rax
4218440    mov     ecx, [rbp-217Ch]
4218446    mov     edx, 10624DD3h
4218451    mov     eax, ecx
4218453    imul    edx
4218455    sar     edx, 6
4218458    mov     eax, ecx
4218460    sar     eax, 1Fh
4218463    sub     edx, eax
4218465    mov     eax, edx
4218467    imul    eax, eax
4218473    sub     ecx, eax
4218475    mov     eax, ecx
4218477    imul    eax, eax
4218483    cdqe    
4218485    mov     [rbp-2128h], rax
4218492    mov     eax, [rbp-2168h]
4218498    lea     edi, [rax+1]
4218501    lea     rcx, [rbp-2130h]
4218508    lea     rdx, [rbp-20A0h]
4218515    lea     rax, [rbp-2120h]
4218522    mov     r8, rcx
4218525    mov     ecx, 0
4218530    mov     rsi, rax
4218533    call    _select
4218538    test    eax, eax
4218540    jle     loc_406185
4218546    mov     edi, 0
4218551    call    _time
4218556    mov     [rbp-2150h], rax
4218563    mov     rax, [rbp-2178h]
4218570    mov     eax, [rax+14h]
4218573    cmp     eax, 0FFFFFFFFh
4218576    jz      loc_405FEB
4218582    mov     rax, [rbp-2178h]
4218589    mov     eax, [rax+14h]
4218592    lea     edx, [rax+3Fh]
4218595    test    eax, eax
4218597    cmovs   eax, edx
4218600    sar     eax, 6
4218603    cdqe    
4218605    mov     rsi, [rbp+rax*8-2120h]
4218613    mov     rax, [rbp-2178h]
4218620    mov     eax, [rax+14h]
4218623    cdq     
4218624    shr     edx, 1Ah
4218627    add     eax, edx
4218629    and     eax, 3Fh
4218632    sub     eax, edx
4218634    mov     ecx, eax
4218636    sar     rsi, cl
4218639    mov     rax, rsi
4218642    and     eax, 1
4218645    test    rax, rax
4218648    jz      loc_405FEB
4218654    mov     rax, [rbp-2178h]
4218661    mov     eax, [rax+14h]
4218664    lea     rsi, [rbp-2020h]
4218671    mov     ecx, 0
4218676    mov     edx, 2008h
4218681    mov     edi, eax
4218683    call    _recv
4218688    mov     [rbp-2154h], eax
4218694    mov     rax, [rbp-2178h]
4218701    mov     eax, [rax+14h]
4218704    lea     rdx, [rbp-2020h]
4218711    lea     rsi, [rdx+8]
4218715    mov     ecx, 0
4218720    mov     edx, 1
4218725    mov     edi, eax
4218727    call    _send
4218732    cmp     dword [rbp-2154h], 7
4218739    jle     loc_405FEB
4218741    mov     rax, [rbp-2020h]
4218748    test    rax, rax
4218751    jz      loc_405FEB
4218753    mov     rax, [rbp-2178h]
4218760    mov     esi, 0
4218765    mov     rdi, rax
4218768    call    _ns_next
4218773    mov     [rbp-2140h], rax
4218780    jmp     loc_405FE1
loc_405F9E:
4218782    mov     rax, [rbp-2020h]
4218789    lea     rdx, [rbp-2020h]
4218796    add     rdx, 8
4218800    mov     rcx, [rbp-2140h]
4218807    mov     esi, 0
4218812    mov     rdi, rcx
4218815    call    rax
4218817    mov     rdx, [rbp-2140h]
4218824    mov     rax, [rbp-2178h]
4218831    mov     rsi, rdx
4218834    mov     rdi, rax
4218837    call    _ns_next
4218842    mov     [rbp-2140h], rax
loc_405FE1:
4218849    cmp     qword [rbp-2140h], 0
4218857    jnz     loc_405F9E
loc_405FEB:
4218859    mov     rax, [rbp-2178h]
4218866    mov     rax, [rax]
4218869    mov     [rbp-2148h], rax
4218876    jmp     loc_406177
loc_406001:
4218881    mov     rax, [rbp-2148h]
4218888    mov     rax, [rax]
4218891    mov     [rbp-2138h], rax
4218898    mov     rax, [rbp-2148h]
4218905    mov     eax, [rax+20h]
4218908    lea     edx, [rax+3Fh]
4218911    test    eax, eax
4218913    cmovs   eax, edx
4218916    sar     eax, 6
4218919    cdqe    
4218921    mov     rsi, [rbp+rax*8-2120h]
4218929    mov     rax, [rbp-2148h]
4218936    mov     eax, [rax+20h]
4218939    cdq     
4218940    shr     edx, 1Ah
4218943    add     eax, edx
4218945    and     eax, 3Fh
4218948    sub     eax, edx
4218950    mov     ecx, eax
4218952    sar     rsi, cl
4218955    mov     rax, rsi
4218958    and     eax, 1
4218961    test    rax, rax
4218964    jz      loc_4060C8
4218966    mov     rax, [rbp-2148h]
4218973    mov     eax, [rax+98h]
4218979    and     eax, 80h
4218984    test    eax, eax
4218986    jz      loc_4060A4
4218988    mov     rax, [rbp-2148h]
4218995    mov     eax, [rax+98h]
4219001    and     eax, 100h
4219006    test    eax, eax
4219008    jz      loc_406093
4219010    mov     rax, [rbp-2148h]
4219017    mov     rdi, rax
4219020    call    _ns_handle_udp
4219025    jmp     loc_4060C8
loc_406093:
4219027    mov     rax, [rbp-2148h]
4219034    mov     rdi, rax
4219037    call    _accept_conn
4219042    jmp     loc_4060C8
loc_4060A4:
4219044    mov     rdx, [rbp-2150h]
4219051    mov     rax, [rbp-2148h]
4219058    mov     [rax+88h], rdx
4219065    mov     rax, [rbp-2148h]
4219072    mov     rdi, rax
4219075    call    _ns_read_from_socket
loc_4060C8:
4219080    mov     rax, [rbp-2148h]
4219087    mov     eax, [rax+20h]
4219090    lea     edx, [rax+3Fh]
4219093    test    eax, eax
4219095    cmovs   eax, edx
4219098    sar     eax, 6
4219101    cdqe    
4219103    mov     rsi, [rbp+rax*8-20A0h]
4219111    mov     rax, [rbp-2148h]
4219118    mov     eax, [rax+20h]
4219121    cdq     
4219122    shr     edx, 1Ah
4219125    add     eax, edx
4219127    and     eax, 3Fh
4219130    sub     eax, edx
4219132    mov     ecx, eax
4219134    sar     rsi, cl
4219137    mov     rax, rsi
4219140    and     eax, 1
4219143    test    rax, rax
4219146    jz      loc_406169
4219148    mov     rax, [rbp-2148h]
4219155    mov     eax, [rax+98h]
4219161    and     eax, 8
4219164    test    eax, eax
4219166    jz      loc_406131
4219168    mov     rax, [rbp-2148h]
4219175    mov     rdi, rax
4219178    call    _ns_read_from_socket
4219183    jmp     loc_406169
loc_406131:
4219185    mov     rax, [rbp-2148h]
4219192    mov     eax, [rax+98h]
4219198    and     eax, 2
4219201    test    eax, eax
4219203    jnz     loc_406169
4219205    mov     rdx, [rbp-2150h]
4219212    mov     rax, [rbp-2148h]
4219219    mov     [rax+88h], rdx
4219226    mov     rax, [rbp-2148h]
4219233    mov     rdi, rax
4219236    call    _ns_write_to_socket
loc_406169:
4219241    mov     rax, [rbp-2138h]
4219248    mov     [rbp-2148h], rax
loc_406177:
4219255    cmp     qword [rbp-2148h], 0
4219263    jnz     loc_406001
loc_406185:
4219269    mov     rax, [rbp-2178h]
4219276    mov     rax, [rax]
4219279    mov     [rbp-2148h], rax
4219286    jmp     loc_4061FE
loc_406198:
4219288    mov     rax, [rbp-2148h]
4219295    mov     rax, [rax]
4219298    mov     [rbp-2138h], rax
4219305    mov     rax, [rbp-2148h]
4219312    mov     eax, [rax+98h]
4219318    and     eax, 10h
4219321    test    eax, eax
4219323    jnz     loc_4061E1
4219325    mov     rax, [rbp-2148h]
4219332    mov     rax, [rax+58h]
4219336    test    rax, rax
4219339    jnz     loc_4061F0
4219341    mov     rax, [rbp-2148h]
4219348    mov     eax, [rax+98h]
4219354    and     eax, 1
4219357    test    eax, eax
4219359    jz      loc_4061F0
loc_4061E1:
4219361    mov     rax, [rbp-2148h]
4219368    mov     rdi, rax
4219371    call    _ns_close_conn
loc_4061F0:
4219376    mov     rax, [rbp-2138h]
4219383    mov     [rbp-2148h], rax
loc_4061FE:
4219390    cmp     qword [rbp-2148h], 0
4219398    jnz     loc_406198
4219400    mov     rax, [rbp-2150h]
4219407    mov     rbx, [rbp-18h]
4219411    xor     rbx, [fs:28h]
4219420    jz      loc_406223
4219422    call    ___stack_chk_fail
loc_406223:
4219427    add     rsp, 2178h
4219434    pop     rbx
4219435    pop     rbp
4219436    retn    
USE32

section .text

global _ns_connect

_ns_connect:
4219437    push    rbp
4219438    mov     rbp, rsp
4219441    push    rbx
4219442    sub     rsp, 138h
4219449    call    _mcount
4219454    mov     [rbp-128h], rdi
4219461    mov     [rbp-130h], rsi
4219468    mov     [rbp-138h], rdx
4219475    mov     [rbp-140h], rcx
4219482    mov     rax, [fs:28h]
4219491    mov     [rbp-18h], rax
4219495    xor     eax, eax
4219497    mov     dword [rbp-110h], 0FFFFFFFFh
4219507    mov     qword [rbp-108h], 0
4219518    lea     r8, [rbp-80h]
4219522    lea     rdi, [rbp-0F0h]
4219529    lea     rcx, [rbp-118h]
4219536    lea     rdx, [rbp-114h]
4219543    lea     rsi, [rbp-100h]
4219550    mov     rax, [rbp-130h]
4219557    mov     r9, r8
4219560    mov     r8, rdi
4219563    mov     rdi, rax
4219566    call    _ns_parse_address
4219571    mov     eax, [rbp-114h]
4219577    mov     edx, 0
4219582    mov     esi, eax
4219584    mov     edi, 2
4219589    call    _socket
4219594    mov     [rbp-110h], eax
4219600    cmp     dword [rbp-110h], 0FFFFFFFFh
4219607    jnz     loc_4062E3
4219609    mov     eax, 0
4219614    jmp     loc_4063E5
loc_4062E3:
4219619    mov     eax, [rbp-110h]
4219625    mov     edi, eax
4219627    call    _ns_set_non_blocking_mode
4219632    mov     eax, [rbp-114h]
4219638    cmp     eax, 2
4219641    jz      loc_406319
4219643    lea     rcx, [rbp-100h]
4219650    mov     eax, [rbp-110h]
4219656    mov     edx, 10h
4219661    mov     rsi, rcx
4219664    mov     edi, eax
4219666    call    _connect
4219671    jmp     loc_40631E
loc_406319:
4219673    mov     eax, 0
loc_40631E:
4219678    mov     [rbp-10Ch], eax
4219684    cmp     dword [rbp-10Ch], 0
4219691    jz      loc_406355
4219693    mov     eax, [rbp-10Ch]
4219699    mov     edi, eax
4219701    call    _ns_is_error
4219706    test    eax, eax
4219708    jz      loc_406355
4219710    mov     eax, [rbp-110h]
4219716    mov     edi, eax
4219718    call    _close
4219723    mov     eax, 0
4219728    jmp     loc_4063E5
loc_406355:
4219733    mov     rcx, [rbp-140h]
4219740    mov     rdx, [rbp-138h]
4219747    mov     esi, [rbp-110h]
4219753    mov     rax, [rbp-128h]
4219760    mov     rdi, rax
4219763    call    _ns_add_sock
4219768    mov     [rbp-108h], rax
4219775    cmp     qword [rbp-108h], 0
4219783    jnz     loc_40639D
4219785    mov     eax, [rbp-110h]
4219791    mov     edi, eax
4219793    call    _close
4219798    mov     eax, 0
4219803    jmp     loc_4063E5
loc_40639D:
4219805    mov     rax, [rbp-108h]
4219812    mov     rdx, [rbp-100h]
4219819    mov     [rax+24h], rdx
4219823    mov     rdx, [rbp-0F8h]
4219830    mov     [rax+2Ch], rdx
4219834    mov     eax, [rbp-114h]
4219840    cmp     eax, 2
4219843    jnz     loc_4063CC
4219845    mov     eax, 100h
4219850    jmp     loc_4063D1
loc_4063CC:
4219852    mov     eax, 8
loc_4063D1:
4219857    mov     rdx, [rbp-108h]
4219864    mov     [rdx+98h], eax
4219870    mov     rax, [rbp-108h]
loc_4063E5:
4219877    mov     rbx, [rbp-18h]
4219881    xor     rbx, [fs:28h]
4219890    jz      loc_4063F9
4219892    call    ___stack_chk_fail
loc_4063F9:
4219897    add     rsp, 138h
4219904    pop     rbx
4219905    pop     rbp
4219906    retn    
USE32

section .text

global _ns_add_sock

_ns_add_sock:
4219907    push    rbp
4219908    mov     rbp, rsp
4219911    sub     rsp, 30h
4219915    call    _mcount
4219920    mov     [rbp-18h], rdi
4219924    mov     [rbp-1Ch], esi
4219927    mov     [rbp-28h], rdx
4219931    mov     [rbp-30h], rcx
4219935    mov     edi, 0A0h
4219940    call    _malloc
4219945    mov     [rbp-8], rax
4219949    cmp     qword [rbp-8], 0
4219954    jz      loc_4064BB
4219960    mov     rax, [rbp-8]
4219964    mov     edx, 0A0h
4219969    mov     esi, 0
4219974    mov     rdi, rax
4219977    call    _memset
4219982    mov     eax, [rbp-1Ch]
4219985    mov     edi, eax
4219987    call    _ns_set_non_blocking_mode
4219992    mov     eax, [rbp-1Ch]
4219995    mov     edi, eax
4219997    call    _ns_set_close_on_exec
4220002    mov     rax, [rbp-8]
4220006    mov     edx, [rbp-1Ch]
4220009    mov     [rax+20h], edx
4220012    mov     rax, [rbp-8]
4220016    mov     rdx, [rbp-30h]
4220020    mov     [rax+78h], rdx
4220024    mov     rax, [rbp-8]
4220028    mov     rdx, [rbp-28h]
4220032    mov     [rax+90h], rdx
4220039    mov     rax, [rbp-8]
4220043    mov     rdx, [rbp-18h]
4220047    mov     [rax+18h], rdx
4220051    mov     edi, 0
4220056    call    _time
4220061    mov     rdx, [rbp-8]
4220065    mov     [rdx+88h], rax
4220072    mov     rdx, [rbp-8]
4220076    mov     rax, [rbp-18h]
4220080    mov     rsi, rdx
4220083    mov     rdi, rax
4220086    call    _ns_add_conn
loc_4064BB:
4220091    mov     rax, [rbp-8]
4220095    leave   
4220096    retn    
USE32

section .text

global _ns_next

_ns_next:
4220097    push    rbp
4220098    mov     rbp, rsp
4220101    sub     rsp, 10h
4220105    call    _mcount
4220110    mov     [rbp-8], rdi
4220114    mov     [rbp-10h], rsi
4220118    cmp     qword [rbp-10h], 0
4220123    jnz     loc_4064E6
4220125    mov     rax, [rbp-8]
4220129    mov     rax, [rax]
4220132    jmp     locret_4064ED
loc_4064E6:
4220134    mov     rax, [rbp-10h]
4220138    mov     rax, [rax]
locret_4064ED:
4220141    leave   
4220142    retn    
USE32

section .text

global _ns_broadcast

_ns_broadcast:
4220143    push    rbp
4220144    mov     rbp, rsp
4220147    sub     rsp, 2030h
4220154    call    _mcount
4220159    mov     [rbp-2018h], rdi
4220166    mov     [rbp-2020h], rsi
4220173    mov     [rbp-2028h], rdx
4220180    mov     [rbp-2030h], rcx
4220187    mov     rax, [fs:28h]
4220196    mov     [rbp-8], rax
4220200    xor     eax, eax
4220202    mov     rax, [rbp-2018h]
4220209    mov     eax, [rax+10h]
4220212    cmp     eax, 0FFFFFFFFh
4220215    jz      loc_4065D6
4220221    cmp     qword [rbp-2028h], 0
4220229    jz      loc_4065D6
4220235    mov     rax, [rbp-2030h]
4220242    cmp     rax, 1FFFh
4220248    ja      loc_4065D6
4220250    mov     rax, [rbp-2020h]
4220257    mov     [rbp-2010h], rax
4220264    mov     rdx, [rbp-2030h]
4220271    mov     rax, [rbp-2028h]
4220278    lea     rcx, [rbp-2010h]
4220285    add     rcx, 8
4220289    mov     rsi, rax
4220292    mov     rdi, rcx
4220295    call    _memcpy
4220300    mov     rax, [rbp-2030h]
4220307    lea     rdx, [rax+8]
4220311    mov     rax, [rbp-2018h]
4220318    mov     eax, [rax+10h]
4220321    lea     rsi, [rbp-2010h]
4220328    mov     ecx, 0
4220333    mov     edi, eax
4220335    call    _send
4220340    mov     rax, [rbp-2018h]
4220347    mov     eax, [rax+10h]
4220350    lea     rsi, [rbp-2030h]
4220357    mov     ecx, 0
4220362    mov     edx, 1
4220367    mov     edi, eax
4220369    call    _recv
loc_4065D6:
4220374    mov     rax, [rbp-8]
4220378    xor     rax, [fs:28h]
4220387    jz      locret_4065EA
4220389    call    ___stack_chk_fail
locret_4065EA:
4220394    leave   
4220395    retn    
USE32

section .text

global _ns_mgr_init

_ns_mgr_init:
4220396    push    rbp
4220397    mov     rbp, rsp
4220400    sub     rsp, 10h
4220404    call    _mcount
4220409    mov     [rbp-8], rdi
4220413    mov     [rbp-10h], rsi
4220417    mov     rax, [rbp-8]
4220421    mov     edx, 20h
4220426    mov     esi, 0
4220431    mov     rdi, rax
4220434    call    _memset
4220439    mov     rax, [rbp-8]
4220443    mov     dword [rax+14h], 0FFFFFFFFh
4220450    mov     rax, [rbp-8]
4220454    mov     edx, [rax+14h]
4220457    mov     rax, [rbp-8]
4220461    mov     [rax+10h], edx
4220464    mov     rax, [rbp-8]
4220468    mov     rdx, [rbp-10h]
4220472    mov     [rax+18h], rdx
4220476    mov     esi, 1
4220481    mov     edi, 0Dh
4220486    call    _signal
loc_40664B:
4220491    mov     rax, [rbp-8]
4220495    add     rax, 10h
4220499    mov     esi, 2
4220504    mov     rdi, rax
4220507    call    _ns_socketpair2
4220512    mov     rax, [rbp-8]
4220516    mov     eax, [rax+10h]
4220519    cmp     eax, 0FFFFFFFFh
4220522    jz      loc_40664B
4220524    leave   
4220525    retn    
USE32

section .text

global _ns_mgr_free

_ns_mgr_free:
4220526    push    rbp
4220527    mov     rbp, rsp
4220530    sub     rsp, 20h
4220534    call    _mcount
4220539    mov     [rbp-18h], rdi
4220543    cmp     qword [rbp-18h], 0
4220548    jnz     loc_40668B
4220550    jmp     locret_40671C
loc_40668B:
4220555    mov     rax, [rbp-18h]
4220559    mov     esi, 0
4220564    mov     rdi, rax
4220567    call    _ns_mgr_poll
4220572    mov     rax, [rbp-18h]
4220576    mov     eax, [rax+10h]
4220579    cmp     eax, 0FFFFFFFFh
4220582    jz      loc_4066B6
4220584    mov     rax, [rbp-18h]
4220588    mov     eax, [rax+10h]
4220591    mov     edi, eax
4220593    call    _close
loc_4066B6:
4220598    mov     rax, [rbp-18h]
4220602    mov     eax, [rax+14h]
4220605    cmp     eax, 0FFFFFFFFh
4220608    jz      loc_4066D0
4220610    mov     rax, [rbp-18h]
4220614    mov     eax, [rax+14h]
4220617    mov     edi, eax
4220619    call    _close
loc_4066D0:
4220624    mov     rax, [rbp-18h]
4220628    mov     dword [rax+14h], 0FFFFFFFFh
4220635    mov     rax, [rbp-18h]
4220639    mov     edx, [rax+14h]
4220642    mov     rax, [rbp-18h]
4220646    mov     [rax+10h], edx
4220649    mov     rax, [rbp-18h]
4220653    mov     rax, [rax]
4220656    mov     [rbp-10h], rax
4220660    jmp     loc_406715
loc_4066F6:
4220662    mov     rax, [rbp-10h]
4220666    mov     rax, [rax]
4220669    mov     [rbp-8], rax
4220673    mov     rax, [rbp-10h]
4220677    mov     rdi, rax
4220680    call    _ns_close_conn
4220685    mov     rax, [rbp-8]
4220689    mov     [rbp-10h], rax
loc_406715:
4220693    cmp     qword [rbp-10h], 0
4220698    jnz     loc_4066F6
locret_40671C:
4220700    leave   
4220701    retn    
USE32

section .text

global _mg_mmap

_mg_mmap:
4220702    push    rbp
4220703    mov     rbp, rsp
4220706    sub     rsp, 20h
4220710    call    _mcount
4220715    mov     [rbp-18h], rdi
4220719    mov     [rbp-20h], rsi
4220723    mov     rax, [rbp-18h]
4220727    mov     rdi, rax
4220730    call    _fileno
4220735    mov     edx, eax
4220737    mov     rax, [rbp-20h]
4220741    mov     r9d, 0
4220747    mov     r8d, edx
4220750    mov     ecx, 2
4220755    mov     edx, 1
4220760    mov     rsi, rax
4220763    mov     edi, 0
4220768    call    _mmap64
4220773    mov     [rbp-8], rax
4220777    cmp     qword [rbp-8], 0FFFFFFFFFFFFFFFFh
4220782    jz      loc_406776
4220784    mov     rax, [rbp-8]
4220788    jmp     locret_40677B
loc_406776:
4220790    mov     eax, 0
locret_40677B:
4220795    leave   
4220796    retn    
USE32

section .text

global _mg_munmap

_mg_munmap:
4220797    push    rbp
4220798    mov     rbp, rsp
4220801    sub     rsp, 10h
4220805    call    _mcount
4220810    mov     [rbp-8], rdi
4220814    mov     [rbp-10h], rsi
4220818    mov     rdx, [rbp-10h]
4220822    mov     rax, [rbp-8]
4220826    mov     rsi, rdx
4220829    mov     rdi, rax
4220832    call    _munmap
4220837    leave   
4220838    retn    
USE32

section .text

global _next_option

_next_option:
4220839    push    rbp
4220840    mov     rbp, rsp
4220843    push    rbx
4220844    sub     rsp, 28h
4220848    call    _mcount
4220853    mov     [rbp-18h], rdi
4220857    mov     [rbp-20h], rsi
4220861    mov     [rbp-28h], rdx
4220865    cmp     qword [rbp-18h], 0
4220870    jz      loc_4067D3
4220872    mov     rax, [rbp-18h]
4220876    movzx   eax, byte [rax]
4220879    test    al, al
4220881    jnz     loc_4067E0
loc_4067D3:
4220883    mov     qword [rbp-18h], 0
4220891    jmp     loc_406911
loc_4067E0:
4220896    mov     rax, [rbp-20h]
4220900    mov     rdx, [rbp-18h]
4220904    mov     [rax], rdx
4220907    mov     rax, [rbp-20h]
4220911    mov     rax, [rax]
4220914    mov     esi, 2Ch
4220919    mov     rdi, rax
4220922    call    _strchr
4220927    mov     [rbp-18h], rax
4220931    cmp     qword [rbp-18h], 0
4220936    jz      loc_40682D
4220938    mov     rdx, [rbp-18h]
4220942    mov     rax, [rbp-20h]
4220946    mov     rax, [rax]
4220949    sub     rdx, rax
4220952    mov     rax, rdx
4220955    mov     rdx, rax
4220958    mov     rax, [rbp-20h]
4220962    mov     [rax+8], rdx
4220966    add     qword [rbp-18h], 1
4220971    jmp     loc_406866
loc_40682D:
4220973    mov     rax, [rbp-20h]
4220977    mov     rbx, [rax]
4220980    mov     rax, [rbp-20h]
4220984    mov     rax, [rax]
4220987    mov     rdi, rax
4220990    call    _strlen
4220995    add     rax, rbx
4220998    mov     [rbp-18h], rax
4221002    mov     rdx, [rbp-18h]
4221006    mov     rax, [rbp-20h]
4221010    mov     rax, [rax]
4221013    sub     rdx, rax
4221016    mov     rax, rdx
4221019    mov     rdx, rax
4221022    mov     rax, [rbp-20h]
4221026    mov     [rax+8], rdx
loc_406866:
4221030    cmp     qword [rbp-28h], 0
4221035    jz      loc_406911
4221041    mov     rax, [rbp-28h]
4221045    mov     qword [rax+8], 0
4221053    mov     rax, [rbp-20h]
4221057    mov     rdx, [rax+8]
4221061    mov     rax, [rbp-20h]
4221065    mov     rax, [rax]
4221068    mov     esi, 3Dh
4221073    mov     rdi, rax
4221076    call    _memchr
4221081    mov     rdx, [rbp-28h]
4221085    mov     [rdx], rax
4221088    mov     rax, [rbp-28h]
4221092    mov     rax, [rax]
4221095    test    rax, rax
4221098    jz      loc_406911
4221100    mov     rax, [rbp-28h]
4221104    mov     rax, [rax]
4221107    lea     rdx, [rax+1]
4221111    mov     rax, [rbp-28h]
4221115    mov     [rax], rdx
4221118    mov     rax, [rbp-20h]
4221122    mov     rdx, [rax]
4221125    mov     rax, [rbp-20h]
4221129    mov     rax, [rax+8]
4221133    add     rax, rdx
4221136    mov     rdx, rax
4221139    mov     rax, [rbp-28h]
4221143    mov     rax, [rax]
4221146    sub     rdx, rax
4221149    mov     rax, rdx
4221152    mov     rdx, rax
4221155    mov     rax, [rbp-28h]
4221159    mov     [rax+8], rdx
4221163    mov     rax, [rbp-28h]
4221167    mov     rax, [rax]
4221170    mov     rdx, rax
4221173    mov     rax, [rbp-20h]
4221177    mov     rax, [rax]
4221180    sub     rdx, rax
4221183    mov     rax, rdx
4221186    sub     rax, 1
4221190    mov     rdx, rax
4221193    mov     rax, [rbp-20h]
4221197    mov     [rax+8], rdx
loc_406911:
4221201    mov     rax, [rbp-18h]
4221205    add     rsp, 28h
4221209    pop     rbx
4221210    pop     rbp
4221211    retn    
USE32

section .text

global _mg_vsnprintf

_mg_vsnprintf:
4221212    push    rbp
4221213    mov     rbp, rsp
4221216    sub     rsp, 30h
4221220    call    _mcount
4221225    mov     [rbp-18h], rdi
4221229    mov     [rbp-20h], rsi
4221233    mov     [rbp-28h], rdx
4221237    mov     [rbp-30h], rcx
4221241    cmp     qword [rbp-20h], 0
4221246    jnz     loc_406947
4221248    mov     eax, 0
4221253    jmp     locret_406997
loc_406947:
4221255    mov     rcx, [rbp-30h]
4221259    mov     rdx, [rbp-28h]
4221263    mov     rsi, [rbp-20h]
4221267    mov     rax, [rbp-18h]
4221271    mov     rdi, rax
4221274    call    _vsnprintf
4221279    mov     [rbp-4], eax
4221282    cmp     dword [rbp-4], 0
4221286    jns     loc_406971
4221288    mov     dword [rbp-4], 0
4221295    jmp     loc_406984
loc_406971:
4221297    mov     rax, [rbp-20h]
4221301    cmp     eax, [rbp-4]
4221304    jg      loc_406984
4221306    mov     rax, [rbp-20h]
4221310    sub     eax, 1
4221313    mov     [rbp-4], eax
loc_406984:
4221316    mov     eax, [rbp-4]
4221319    movsxd  rdx, eax
4221322    mov     rax, [rbp-18h]
4221326    add     rax, rdx
4221329    mov     byte [rax], 0
4221332    mov     eax, [rbp-4]
locret_406997:
4221335    leave   
4221336    retn    
USE32

section .text

global _mg_snprintf

_mg_snprintf:
4221337    push    rbp
4221338    mov     rbp, rsp
4221341    sub     rsp, 0F0h
4221348    call    _mcount
4221353    mov     [rbp-0D8h], rdi
4221360    mov     [rbp-0E0h], rsi
4221367    mov     [rbp-98h], rcx
4221374    mov     [rbp-90h], r8
4221381    mov     [rbp-88h], r9
4221388    test    al, al
4221390    jz      loc_4069F0
4221392    movaps  xmmword [rbp-80h], xmm0
4221396    movaps  xmmword [rbp-70h], xmm1
4221400    movaps  xmmword [rbp-60h], xmm2
4221404    movaps  xmmword [rbp-50h], xmm3
4221408    movaps  xmmword [rbp-40h], xmm4
4221412    movaps  xmmword [rbp-30h], xmm5
4221416    movaps  xmmword [rbp-20h], xmm6
4221420    movaps  xmmword [rbp-10h], xmm7
loc_4069F0:
4221424    mov     [rbp-0E8h], rdx
4221431    mov     dword [rbp-0C8h], 18h
4221441    mov     dword [rbp-0C4h], 30h
4221451    lea     rax, [rbp+10h]
4221455    mov     [rbp-0C0h], rax
4221462    lea     rax, [rbp-0B0h]
4221469    mov     [rbp-0B8h], rax
4221476    lea     rcx, [rbp-0C8h]
4221483    mov     rdx, [rbp-0E8h]
4221490    mov     rsi, [rbp-0E0h]
4221497    mov     rax, [rbp-0D8h]
4221504    mov     rdi, rax
4221507    call    _mg_vsnprintf
4221512    mov     [rbp-0CCh], eax
4221518    mov     eax, [rbp-0CCh]
4221524    leave   
4221525    retn    
USE32

section .text

global _get_request_len

_get_request_len:
4221526    push    rbp
4221527    mov     rbp, rsp
4221530    sub     rsp, 20h
4221534    call    _mcount
4221539    mov     [rbp-18h], rdi
4221543    mov     [rbp-20h], rsi
4221547    mov     rax, [rbp-18h]
4221551    mov     [rbp-8], rax
4221555    mov     qword [rbp-10h], 0
4221563    jmp     loc_406B87
loc_406A80:
4221568    call    ___ctype_b_loc
4221573    mov     rax, [rax]
4221576    mov     rdx, [rbp-10h]
4221580    mov     rcx, [rbp-8]
4221584    add     rdx, rcx
4221587    movzx   edx, byte [rdx]
4221590    movzx   edx, dl
4221593    add     rdx, rdx
4221596    add     rax, rdx
4221599    movzx   eax, word [rax]
4221602    movzx   eax, ax
4221605    and     eax, 4000h
4221610    test    eax, eax
4221612    jnz     loc_406AEE
4221614    mov     rax, [rbp-10h]
4221618    mov     rdx, [rbp-8]
4221622    add     rax, rdx
4221625    movzx   eax, byte [rax]
4221628    cmp     al, 0Dh
4221630    jz      loc_406AEE
4221632    mov     rax, [rbp-10h]
4221636    mov     rdx, [rbp-8]
4221640    add     rax, rdx
4221643    movzx   eax, byte [rax]
4221646    cmp     al, 0Ah
4221648    jz      loc_406AEE
4221650    mov     rax, [rbp-10h]
4221654    mov     rdx, [rbp-8]
4221658    add     rax, rdx
4221661    movzx   eax, byte [rax]
4221664    test    al, al
4221666    js      loc_406AEE
4221668    mov     eax, 0FFFFFFFFh
4221673    jmp     locret_406B9A
loc_406AEE:
4221678    mov     rax, [rbp-10h]
4221682    mov     rdx, [rbp-8]
4221686    add     rax, rdx
4221689    movzx   eax, byte [rax]
4221692    cmp     al, 0Ah
4221694    jnz     loc_406B2D
4221696    mov     rax, [rbp-10h]
4221700    add     rax, 1
4221704    cmp     rax, [rbp-20h]
4221708    jnb     loc_406B2D
4221710    mov     rax, [rbp-10h]
4221714    lea     rdx, [rax+1]
4221718    mov     rax, [rbp-8]
4221722    add     rax, rdx
4221725    movzx   eax, byte [rax]
4221728    cmp     al, 0Ah
4221730    jnz     loc_406B2D
4221732    mov     rax, [rbp-10h]
4221736    add     eax, 2
4221739    jmp     locret_406B9A
loc_406B2D:
4221741    mov     rax, [rbp-10h]
4221745    mov     rdx, [rbp-8]
4221749    add     rax, rdx
4221752    movzx   eax, byte [rax]
4221755    cmp     al, 0Ah
4221757    jnz     loc_406B82
4221759    mov     rax, [rbp-10h]
4221763    add     rax, 2
4221767    cmp     rax, [rbp-20h]
4221771    jnb     loc_406B82
4221773    mov     rax, [rbp-10h]
4221777    lea     rdx, [rax+1]
4221781    mov     rax, [rbp-8]
4221785    add     rax, rdx
4221788    movzx   eax, byte [rax]
4221791    cmp     al, 0Dh
4221793    jnz     loc_406B82
4221795    mov     rax, [rbp-10h]
4221799    lea     rdx, [rax+2]
4221803    mov     rax, [rbp-8]
4221807    add     rax, rdx
4221810    movzx   eax, byte [rax]
4221813    cmp     al, 0Ah
4221815    jnz     loc_406B82
4221817    mov     rax, [rbp-10h]
4221821    add     eax, 3
4221824    jmp     locret_406B9A
loc_406B82:
4221826    add     qword [rbp-10h], 1
loc_406B87:
4221831    mov     rax, [rbp-10h]
4221835    cmp     rax, [rbp-20h]
4221839    jb      loc_406A80
4221845    mov     eax, 0
locret_406B9A:
4221850    leave   
4221851    retn    
USE32

section .text

global _skip

_skip:
4221852    push    rbp
4221853    mov     rbp, rsp
4221856    sub     rsp, 30h
4221860    call    _mcount
4221865    mov     [rbp-28h], rdi
4221869    mov     [rbp-30h], rsi
4221873    mov     rax, [rbp-28h]
4221877    mov     rax, [rax]
4221880    mov     [rbp-18h], rax
4221884    mov     rdx, [rbp-30h]
4221888    mov     rax, [rbp-18h]
4221892    mov     rsi, rdx
4221895    mov     rdi, rax
4221898    call    _strcspn
4221903    mov     rdx, [rbp-18h]
4221907    add     rax, rdx
4221910    mov     [rbp-10h], rax
4221914    mov     rdx, [rbp-30h]
4221918    mov     rax, [rbp-10h]
4221922    mov     rsi, rdx
4221925    mov     rdi, rax
4221928    call    _strspn
4221933    mov     rdx, [rbp-10h]
4221937    add     rax, rdx
4221940    mov     [rbp-8], rax
4221944    mov     rax, [rbp-10h]
4221948    mov     [rbp-20h], rax
4221952    jmp     loc_406C0E
loc_406C02:
4221954    mov     rax, [rbp-20h]
4221958    mov     byte [rax], 0
4221961    add     qword [rbp-20h], 1
loc_406C0E:
4221966    mov     rax, [rbp-20h]
4221970    cmp     rax, [rbp-8]
4221974    jb      loc_406C02
4221976    mov     rax, [rbp-28h]
4221980    mov     rdx, [rbp-8]
4221984    mov     [rax], rdx
4221987    mov     rax, [rbp-18h]
4221991    leave   
4221992    retn    
USE32

section .text

global _parse_http_headers

_parse_http_headers:
4221993    push    rbp
4221994    mov     rbp, rsp
4221997    sub     rsp, 20h
4222001    call    _mcount
4222006    mov     [rbp-18h], rdi
4222010    mov     [rbp-20h], rsi
4222014    mov     qword [rbp-8], 0
4222022    jmp     loc_406CDC
loc_406C4B:
4222027    mov     rax, [rbp-18h]
4222031    mov     esi, unk_414B60
4222036    mov     rdi, rax
4222039    call    _skip
4222044    mov     rdx, [rbp-20h]
4222048    mov     rcx, [rbp-8]
4222052    add     rcx, 8
4222056    shl     rcx, 4
4222060    add     rdx, rcx
4222063    add     rdx, 8
4222067    mov     [rdx], rax
4222070    mov     rax, [rbp-18h]
4222074    mov     esi, unk_414B63
4222079    mov     rdi, rax
4222082    call    _skip
4222087    mov     rdx, [rbp-20h]
4222091    mov     rcx, [rbp-8]
4222095    add     rcx, 8
4222099    shl     rcx, 4
4222103    add     rdx, rcx
4222106    add     rdx, 10h
4222110    mov     [rdx], rax
4222113    mov     rax, [rbp-20h]
4222117    mov     rdx, [rbp-8]
4222121    add     rdx, 8
4222125    shl     rdx, 4
4222129    add     rax, rdx
4222132    add     rax, 8
4222136    mov     rax, [rax]
4222139    movzx   eax, byte [rax]
4222142    test    al, al
4222144    jnz     loc_406CC4
4222146    jmp     locret_406CE7
loc_406CC4:
4222148    mov     rax, [rbp-8]
4222152    add     eax, 1
4222155    mov     edx, eax
4222157    mov     rax, [rbp-20h]
4222161    mov     [rax+84h], edx
4222167    add     qword [rbp-8], 1
loc_406CDC:
4222172    cmp     qword [rbp-8], 1Dh
4222177    jbe     loc_406C4B
locret_406CE7:
4222183    leave   
4222184    retn    
USE32

section .text

global _status_code_to_str

_status_code_to_str:
4222185    push    rbp
4222186    mov     rbp, rsp
4222189    sub     rsp, 8
4222193    call    _mcount
4222198    mov     [rbp-4], edi
4222201    mov     eax, [rbp-4]
4222204    sub     eax, 64h
4222207    cmp     eax, 19Bh
4222212    ja      loc_406F38
4222218    mov     eax, eax
4222220    mov     rax, off_414F58[rax*8]
4222228    jmp     rax
loc_406D16:
4222230    mov     eax, aContinue
4222235    jmp     locret_406F3D
loc_406D20:
4222240    mov     eax, aSwitchingProto
4222245    jmp     locret_406F3D
loc_406D2A:
4222250    mov     eax, aProcessing
4222255    jmp     locret_406F3D
loc_406D34:
4222260    mov     eax, aOk
4222265    jmp     locret_406F3D
loc_406D3E:
4222270    mov     eax, aCreated
4222275    jmp     locret_406F3D
loc_406D48:
4222280    mov     eax, aAccepted
4222285    jmp     locret_406F3D
loc_406D52:
4222290    mov     eax, aNonAuthoritati
4222295    jmp     locret_406F3D
loc_406D5C:
4222300    mov     eax, aNoContent
4222305    jmp     locret_406F3D
loc_406D66:
4222310    mov     eax, aResetContent
4222315    jmp     locret_406F3D
loc_406D70:
4222320    mov     eax, aPartialContent
4222325    jmp     locret_406F3D
loc_406D7A:
4222330    mov     eax, aMultiStatus
4222335    jmp     locret_406F3D
loc_406D84:
4222340    mov     eax, aAlreadyReporte
4222345    jmp     locret_406F3D
loc_406D8E:
4222350    mov     eax, aImUsed
4222355    jmp     locret_406F3D
loc_406D98:
4222360    mov     eax, aMultipleChoice
4222365    jmp     locret_406F3D
loc_406DA2:
4222370    mov     eax, aMovedPermanent
4222375    jmp     locret_406F3D
loc_406DAC:
4222380    mov     eax, aFound
4222385    jmp     locret_406F3D
loc_406DB6:
4222390    mov     eax, aSeeOther
4222395    jmp     locret_406F3D
loc_406DC0:
4222400    mov     eax, aNotModified
4222405    jmp     locret_406F3D
loc_406DCA:
4222410    mov     eax, aUseProxy
4222415    jmp     locret_406F3D
loc_406DD4:
4222420    mov     eax, aSwitchProxy
4222425    jmp     locret_406F3D
loc_406DDE:
4222430    mov     eax, aTemporaryRedir
4222435    jmp     locret_406F3D
loc_406DE8:
4222440    mov     eax, aPermanentRedir
4222445    jmp     locret_406F3D
loc_406DF2:
4222450    mov     eax, aBadRequest
4222455    jmp     locret_406F3D
loc_406DFC:
4222460    mov     eax, aUnauthorized
4222465    jmp     locret_406F3D
loc_406E06:
4222470    mov     eax, aPaymentRequire
4222475    jmp     locret_406F3D
loc_406E10:
4222480    mov     eax, aForbidden
4222485    jmp     locret_406F3D
loc_406E1A:
4222490    mov     eax, aNotFound
4222495    jmp     locret_406F3D
loc_406E24:
4222500    mov     eax, aMethodNotAllow
4222505    jmp     locret_406F3D
loc_406E2E:
4222510    mov     eax, aNotAcceptable
4222515    jmp     locret_406F3D
loc_406E38:
4222520    mov     eax, aProxyAuthentic
4222525    jmp     locret_406F3D
loc_406E42:
4222530    mov     eax, aRequestTimeout
4222535    jmp     locret_406F3D
loc_406E4C:
4222540    mov     eax, aConflict
4222545    jmp     locret_406F3D
loc_406E56:
4222550    mov     eax, aGone
4222555    jmp     locret_406F3D
loc_406E60:
4222560    mov     eax, aLengthRequired
4222565    jmp     locret_406F3D
loc_406E6A:
4222570    mov     eax, aPreconditionFa
4222575    jmp     locret_406F3D
loc_406E74:
4222580    mov     eax, aPayloadTooLarg
4222585    jmp     locret_406F3D
loc_406E7E:
4222590    mov     eax, aUriTooLong
4222595    jmp     locret_406F3D
loc_406E88:
4222600    mov     eax, aUnsupportedMed
4222605    jmp     locret_406F3D
loc_406E92:
4222610    mov     eax, aRequestedRange
4222615    jmp     locret_406F3D
loc_406E9C:
4222620    mov     eax, aExpectationFai
4222625    jmp     locret_406F3D
loc_406EA6:
4222630    mov     eax, aIMATeapot
4222635    jmp     locret_406F3D
loc_406EB0:
4222640    mov     eax, aUnprocessableE
4222645    jmp     locret_406F3D
loc_406EBA:
4222650    mov     eax, aLocked
4222655    jmp     locret_406F3D
loc_406EC1:
4222657    mov     eax, aFailedDependen
4222662    jmp     locret_406F3D
loc_406EC8:
4222664    mov     eax, aUpgradeRequire
4222669    jmp     locret_406F3D
loc_406ECF:
4222671    mov     eax, aPreconditionRe
4222676    jmp     locret_406F3D
loc_406ED6:
4222678    mov     eax, aTooManyRequest
4222683    jmp     locret_406F3D
loc_406EDD:
4222685    mov     eax, aRequestHeaderF
4222690    jmp     locret_406F3D
loc_406EE4:
4222692    mov     eax, aUnavailableFor
4222697    jmp     locret_406F3D
loc_406EEB:
4222699    mov     eax, aInternalServer
4222704    jmp     locret_406F3D
loc_406EF2:
4222706    mov     eax, aNotImplemented
4222711    jmp     locret_406F3D
loc_406EF9:
4222713    mov     eax, aBadGateway
4222718    jmp     locret_406F3D
loc_406F00:
4222720    mov     eax, aServiceUnavail
4222725    jmp     locret_406F3D
loc_406F07:
4222727    mov     eax, aGatewayTimeout
4222732    jmp     locret_406F3D
loc_406F0E:
4222734    mov     eax, aHttpVersionNot
4222739    jmp     locret_406F3D
loc_406F15:
4222741    mov     eax, aVariantAlsoNeg
4222746    jmp     locret_406F3D
loc_406F1C:
4222748    mov     eax, aInsufficientSt
4222753    jmp     locret_406F3D
loc_406F23:
4222755    mov     eax, aLoopDetected
4222760    jmp     locret_406F3D
loc_406F2A:
4222762    mov     eax, aNotExtended
4222767    jmp     locret_406F3D
loc_406F31:
4222769    mov     eax, aNetworkAuthent
4222774    jmp     locret_406F3D
loc_406F38:
4222776    mov     eax, aServerError
locret_406F3D:
4222781    leave   
4222782    retn    
USE32

section .text

global _call_user

_call_user:
4222783    push    rbp
4222784    mov     rbp, rsp
4222787    sub     rsp, 10h
4222791    call    _mcount
4222796    mov     [rbp-8], rdi
4222800    mov     [rbp-0Ch], esi
4222803    cmp     qword [rbp-8], 0
4222808    jz      loc_406FA1
4222810    mov     rax, [rbp-8]
4222814    mov     rax, [rax+2A8h]
4222821    test    rax, rax
4222824    jz      loc_406FA1
4222826    mov     rax, [rbp-8]
4222830    mov     rax, [rax+2A8h]
4222837    mov     rax, [rax+30h]
4222841    test    rax, rax
4222844    jz      loc_406FA1
4222846    mov     rax, [rbp-8]
4222850    mov     rax, [rax+2A8h]
4222857    mov     rax, [rax+30h]
4222861    mov     rdx, [rbp-8]
4222865    lea     rcx, [rdx+8]
4222869    mov     edx, [rbp-0Ch]
4222872    mov     esi, edx
4222874    mov     rdi, rcx
4222877    call    rax
4222879    jmp     locret_406FA6
loc_406FA1:
4222881    mov     eax, 0
locret_406FA6:
4222886    leave   
4222887    retn    
USE32

section .text

global _send_http_error

_send_http_error:
4222888    push    rbp
4222889    mov     rbp, rsp
4222892    sub     rsp, 2F0h
4222899    call    _mcount
4222904    mov     [rbp-2C8h], rdi
4222911    mov     [rbp-2CCh], esi
4222917    mov     [rbp-98h], rcx
4222924    mov     [rbp-90h], r8
4222931    mov     [rbp-88h], r9
4222938    test    al, al
4222940    jz      loc_406FFE
4222942    movaps  xmmword [rbp-80h], xmm0
4222946    movaps  xmmword [rbp-70h], xmm1
4222950    movaps  xmmword [rbp-60h], xmm2
4222954    movaps  xmmword [rbp-50h], xmm3
4222958    movaps  xmmword [rbp-40h], xmm4
4222962    movaps  xmmword [rbp-30h], xmm5
4222966    movaps  xmmword [rbp-20h], xmm6
4222970    movaps  xmmword [rbp-10h], xmm7
loc_406FFE:
4222974    mov     [rbp-2D8h], rdx
4222981    mov     rax, [fs:28h]
4222990    mov     [rbp-0B8h], rax
4222997    xor     eax, eax
4222999    mov     eax, [rbp-2CCh]
4223005    mov     edi, eax
4223007    call    _status_code_to_str
4223012    mov     [rbp-2A0h], rax
4223019    mov     rax, [rbp-2C8h]
4223026    mov     rax, [rax+2A8h]
4223033    mov     rax, [rax+0C8h]
4223040    mov     [rbp-2A8h], rax
4223047    mov     rax, [rbp-2C8h]
4223054    mov     edx, [rbp-2CCh]
4223060    mov     [rax+284h], edx
4223066    mov     rax, [rbp-2C8h]
4223073    mov     esi, 6Dh
4223078    mov     rdi, rax
4223081    call    _call_user
4223086    cmp     eax, 1
4223089    jnz     loc_407087
4223091    mov     rax, [rbp-2C8h]
4223098    mov     rdi, rax
4223101    call    _close_local_endpoint
4223106    jmp     loc_407312
loc_407087:
4223111    jmp     loc_407165
loc_40708C:
4223116    mov     rax, [rbp-290h]
4223123    mov     rdi, rax
4223126    call    _atoi
4223131    mov     [rbp-2B0h], eax
4223137    cmp     dword [rbp-2B0h], 0
4223144    jle     loc_407165
4223150    mov     eax, [rbp-2B0h]
4223156    cmp     eax, [rbp-2CCh]
4223162    jnz     loc_407165
4223168    mov     rax, [rbp-2C8h]
4223175    add     rax, 8
4223179    mov     [rbp-298h], rax
4223186    mov     rax, [rbp-298h]
4223193    mov     dword [rax+27Ch], 12Eh
4223203    mov     rax, [rbp-298h]
4223210    mov     rax, [rax+18h]
4223214    test    rax, rax
4223217    jz      loc_407100
4223219    mov     rax, [rbp-298h]
4223226    mov     rax, [rax+18h]
4223230    jmp     loc_407105
loc_407100:
4223232    mov     eax, unk_414196
loc_407105:
4223237    mov     rdx, [rbp-298h]
4223244    mov     rsi, [rdx+8]
4223248    mov     r8, [rbp-280h]
4223255    mov     rcx, [rbp-278h]
4223262    mov     rdx, [rbp-298h]
4223269    mov     edx, [rdx+27Ch]
4223275    mov     r9d, [rbp-2CCh]
4223282    mov     rdi, [rbp-298h]
4223289    mov     [rsp+8], rax
4223294    mov     [rsp], rsi
4223298    mov     esi, aHttp1_1DMovedL
4223303    mov     eax, 0
4223308    call    _mg_printf
4223313    mov     rax, [rbp-2C8h]
4223320    mov     rdi, rax
4223323    call    _close_local_endpoint
4223328    jmp     loc_407312
loc_407165:
4223333    lea     rdx, [rbp-280h]
4223340    lea     rcx, [rbp-290h]
4223347    mov     rax, [rbp-2A8h]
4223354    mov     rsi, rcx
4223357    mov     rdi, rax
4223360    call    _next_option
4223365    mov     [rbp-2A8h], rax
4223372    cmp     qword [rbp-2A8h], 0
4223380    jnz     loc_40708C
4223386    mov     rcx, [rbp-2A0h]
4223393    mov     edx, [rbp-2CCh]
4223399    lea     rax, [rbp-180h]
4223406    mov     r8, rcx
4223409    mov     ecx, edx
4223411    mov     edx, aDS
4223416    mov     esi, 0C8h
4223421    mov     rdi, rax
4223424    mov     eax, 0
4223429    call    _mg_snprintf
4223434    mov     [rbp-2B4h], eax
4223440    cmp     qword [rbp-2D8h], 0
4223448    jz      loc_40724C
4223450    mov     dword [rbp-268h], 18h
4223460    mov     dword [rbp-264h], 30h
4223470    lea     rax, [rbp+10h]
4223474    mov     [rbp-260h], rax
4223481    lea     rax, [rbp-0B0h]
4223488    mov     [rbp-258h], rax
4223495    mov     eax, [rbp-2B4h]
4223501    cdqe    
4223503    mov     edx, 0C8h
4223508    mov     rsi, rdx
4223511    sub     rsi, rax
4223514    mov     eax, [rbp-2B4h]
4223520    cdqe    
4223522    lea     rdx, [rbp-180h]
4223529    lea     rdi, [rdx+rax]
4223533    lea     rdx, [rbp-268h]
4223540    mov     rax, [rbp-2D8h]
4223547    mov     rcx, rdx
4223550    mov     rdx, rax
4223553    call    _mg_vsnprintf
4223558    add     [rbp-2B4h], eax
loc_40724C:
4223564    cmp     dword [rbp-2CCh], 12Bh
4223574    jle     loc_407264
4223576    cmp     dword [rbp-2CCh], 18Fh
4223586    jle     loc_407270
loc_407264:
4223588    cmp     dword [rbp-2CCh], 0CCh
4223598    jnz     loc_40727A
loc_407270:
4223600    mov     dword [rbp-2B4h], 0
loc_40727A:
4223610    mov     esi, [rbp-2B4h]
4223616    mov     rcx, [rbp-2A0h]
4223623    mov     edx, [rbp-2CCh]
4223629    lea     rax, [rbp-250h]
4223636    mov     r9d, esi
4223639    mov     r8, rcx
4223642    mov     ecx, edx
4223644    mov     edx, aHttp1_1DSConte
4223649    mov     esi, 0C8h
4223654    mov     rdi, rax
4223657    mov     eax, 0
4223662    call    _mg_snprintf
4223667    mov     [rbp-2ACh], eax
4223673    mov     eax, [rbp-2ACh]
4223679    movsxd  rdx, eax
4223682    mov     rax, [rbp-2C8h]
4223689    mov     rax, [rax]
4223692    lea     rcx, [rbp-250h]
4223699    mov     rsi, rcx
4223702    mov     rdi, rax
4223705    call    _ns_send
4223710    mov     eax, [rbp-2B4h]
4223716    movsxd  rdx, eax
4223719    mov     rax, [rbp-2C8h]
4223726    mov     rax, [rax]
4223729    lea     rcx, [rbp-180h]
4223736    mov     rsi, rcx
4223739    mov     rdi, rax
4223742    call    _ns_send
4223747    mov     rax, [rbp-2C8h]
4223754    mov     rdi, rax
4223757    call    _close_local_endpoint
loc_407312:
4223762    mov     rax, [rbp-0B8h]
4223769    xor     rax, [fs:28h]
4223778    jz      locret_407329
4223780    call    ___stack_chk_fail
locret_407329:
4223785    leave   
4223786    retn    
USE32

section .text

global _write_chunk

_write_chunk:
4223787    push    rbp
4223788    mov     rbp, rsp
4223791    sub     rsp, 70h
4223795    call    _mcount
4223800    mov     [rbp-58h], rdi
4223804    mov     [rbp-60h], rsi
4223808    mov     [rbp-64h], edx
4223811    mov     rax, [fs:28h]
4223820    mov     [rbp-8], rax
4223824    xor     eax, eax
4223826    mov     edx, [rbp-64h]
4223829    lea     rax, [rbp-40h]
4223833    mov     ecx, edx
4223835    mov     edx, asc_415CD1
4223840    mov     esi, 32h
4223845    mov     rdi, rax
4223848    mov     eax, 0
4223853    call    _mg_snprintf
4223858    mov     [rbp-44h], eax
4223861    mov     eax, [rbp-44h]
4223864    movsxd  rdx, eax
4223867    mov     rax, [rbp-58h]
4223871    mov     rax, [rax]
4223874    lea     rcx, [rbp-40h]
4223878    mov     rsi, rcx
4223881    mov     rdi, rax
4223884    call    _ns_send
4223889    mov     eax, [rbp-64h]
4223892    movsxd  rdx, eax
4223895    mov     rax, [rbp-58h]
4223899    mov     rax, [rax]
4223902    mov     rcx, [rbp-60h]
4223906    mov     rsi, rcx
4223909    mov     rdi, rax
4223912    call    _ns_send
4223917    mov     rax, [rbp-58h]
4223921    mov     rax, [rax]
4223924    mov     edx, 2
4223929    mov     esi, unk_414B63
4223934    mov     rdi, rax
4223937    call    _ns_send
4223942    mov     rax, [rbp-8]
4223946    xor     rax, [fs:28h]
4223955    jz      locret_4073DA
4223957    call    ___stack_chk_fail
locret_4073DA:
4223962    leave   
4223963    retn    
USE32

section .text

global _mg_printf

_mg_printf:
4223964    push    rbp
4223965    mov     rbp, rsp
4223968    sub     rsp, 0E0h
4223975    call    _mcount
4223980    mov     [rbp-0D8h], rdi
4223987    mov     [rbp-0A0h], rdx
4223994    mov     [rbp-98h], rcx
4224001    mov     [rbp-90h], r8
4224008    mov     [rbp-88h], r9
4224015    test    al, al
4224017    jz      loc_407433
4224019    movaps  xmmword [rbp-80h], xmm0
4224023    movaps  xmmword [rbp-70h], xmm1
4224027    movaps  xmmword [rbp-60h], xmm2
4224031    movaps  xmmword [rbp-50h], xmm3
4224035    movaps  xmmword [rbp-40h], xmm4
4224039    movaps  xmmword [rbp-30h], xmm5
4224043    movaps  xmmword [rbp-20h], xmm6
4224047    movaps  xmmword [rbp-10h], xmm7
loc_407433:
4224051    mov     [rbp-0E0h], rsi
4224058    mov     rax, [rbp-0D8h]
4224065    sub     rax, 8
4224069    mov     [rbp-0D0h], rax
4224076    mov     dword [rbp-0C8h], 10h
4224086    mov     dword [rbp-0C4h], 30h
4224096    lea     rax, [rbp+10h]
4224100    mov     [rbp-0C0h], rax
4224107    lea     rax, [rbp-0B0h]
4224114    mov     [rbp-0B8h], rax
4224121    mov     rax, [rbp-0D0h]
4224128    mov     rax, [rax]
4224131    lea     rdx, [rbp-0C8h]
4224138    mov     rcx, [rbp-0E0h]
4224145    mov     rsi, rcx
4224148    mov     rdi, rax
4224151    call    _ns_vprintf
4224156    mov     rax, [rbp-0D0h]
4224163    mov     rax, [rax]
4224166    mov     rax, [rax+58h]
4224170    leave   
4224171    retn    
USE32

section .text

global _ns_forward

_ns_forward:
4224172    push    rbp
4224173    mov     rbp, rsp
4224176    sub     rsp, 10h
4224180    call    _mcount
4224185    mov     [rbp-8], rdi
4224189    mov     [rbp-10h], rsi
4224193    mov     rax, [rbp-8]
4224197    mov     rdx, [rax+40h]
4224201    mov     rax, [rbp-8]
4224205    mov     rcx, [rax+38h]
4224209    mov     rax, [rbp-10h]
4224213    mov     rsi, rcx
4224216    mov     rdi, rax
4224219    call    _ns_send
4224224    mov     rax, [rbp-8]
4224228    mov     rax, [rax+40h]
4224232    mov     rdx, [rbp-8]
4224236    add     rdx, 38h
4224240    mov     rsi, rax
4224243    mov     rdi, rdx
4224246    call    _iobuf_remove
4224251    leave   
4224252    retn    
USE32

section .text

global _start_process

_start_process:
4224253    push    rbp
4224254    mov     rbp, rsp
4224257    push    rbx
4224258    sub     rsp, 258h
4224265    call    _mcount
4224270    mov     [rbp-228h], rdi
4224277    mov     [rbp-230h], rsi
4224284    mov     [rbp-238h], rdx
4224291    mov     [rbp-240h], rcx
4224298    mov     [rbp-248h], r8
4224305    mov     [rbp-24Ch], r9d
4224312    mov     rax, [fs:28h]
4224321    mov     [rbp-18h], rax
4224325    xor     eax, eax
4224327    call    _fork
4224332    mov     [rbp-214h], eax
4224338    cmp     dword [rbp-214h], 0
4224345    jnz     loc_4076B8
4224351    mov     rax, [rbp-248h]
4224358    mov     rdi, rax
4224361    call    _chdir
4224366    mov     eax, [rbp-24Ch]
4224372    mov     esi, 0
4224377    mov     edi, eax
4224379    call    _dup2
4224384    mov     eax, [rbp-24Ch]
4224390    mov     esi, 1
4224395    mov     edi, eax
4224397    call    _dup2
4224402    mov     eax, [rbp-24Ch]
4224408    mov     edi, eax
4224410    call    _close
4224415    mov     esi, 0
4224420    mov     edi, 11h
4224425    call    _signal
4224430    cmp     qword [rbp-228h], 0
4224438    jnz     loc_4075E4
4224440    mov     rdx, [rbp-240h]
4224447    mov     rsi, [rbp-230h]
4224454    mov     rax, [rbp-230h]
4224461    mov     rcx, rdx
4224464    mov     edx, 0
4224469    mov     rdi, rax
4224472    mov     eax, 0
4224477    call    _execle
4224482    jmp     loc_407615
loc_4075E4:
4224484    mov     rcx, [rbp-240h]
4224491    mov     rdx, [rbp-230h]
4224498    mov     rsi, [rbp-228h]
4224505    mov     rax, [rbp-228h]
4224512    mov     r8, rcx
4224515    mov     ecx, 0
4224520    mov     rdi, rax
4224523    mov     eax, 0
4224528    call    _execle
loc_407615:
4224533    call    ___errno_location
4224538    mov     eax, [rax]
4224540    mov     edi, eax
4224542    call    _strerror
4224547    mov     rcx, rax
4224550    cmp     qword [rbp-228h], 0
4224558    jnz     loc_407637
4224560    mov     edx, unk_414196
4224565    jmp     loc_40763C
loc_407637:
4224567    mov     edx, asc_415CD6
loc_40763C:
4224572    cmp     qword [rbp-228h], 0
4224580    jz      loc_40764F
4224582    mov     rax, [rbp-228h]
4224589    jmp     loc_407654
loc_40764F:
4224591    mov     eax, unk_414196
loc_407654:
4224596    mov     rsi, [rbp-230h]
4224603    lea     rdi, [rbp-210h]
4224610    mov     [rsp], rcx
4224614    mov     r9, rsi
4224617    mov     r8, rdx
4224620    mov     rcx, rax
4224623    mov     edx, aStatus500500Se
4224628    mov     esi, 1F4h
4224633    mov     eax, 0
4224638    call    _snprintf
4224643    lea     rax, [rbp-210h]
4224650    mov     rdi, rax
4224653    call    _strlen
4224658    mov     rdx, rax
4224661    lea     rax, [rbp-210h]
4224668    mov     ecx, 0
4224673    mov     rsi, rax
4224676    mov     edi, 1
4224681    call    _send
4224686    mov     edi, 1
4224691    call    _exit
loc_4076B8:
4224696    mov     eax, [rbp-214h]
4224702    mov     rbx, [rbp-18h]
4224706    xor     rbx, [fs:28h]
4224715    jz      loc_4076D2
4224717    call    ___stack_chk_fail
loc_4076D2:
4224722    add     rsp, 258h
4224729    pop     rbx
4224730    pop     rbp
4224731    retn    
USE32

section .text

global _addenv

_addenv:
4224732    push    rbp
4224733    mov     rbp, rsp
4224736    sub     rsp, 0F0h
4224743    call    _mcount
4224748    mov     [rbp-0E8h], rdi
4224755    mov     [rbp-0A0h], rdx
4224762    mov     [rbp-98h], rcx
4224769    mov     [rbp-90h], r8
4224776    mov     [rbp-88h], r9
4224783    test    al, al
4224785    jz      loc_407733
4224787    movaps  xmmword [rbp-80h], xmm0
4224791    movaps  xmmword [rbp-70h], xmm1
4224795    movaps  xmmword [rbp-60h], xmm2
4224799    movaps  xmmword [rbp-50h], xmm3
4224803    movaps  xmmword [rbp-40h], xmm4
4224807    movaps  xmmword [rbp-30h], xmm5
4224811    movaps  xmmword [rbp-20h], xmm6
4224815    movaps  xmmword [rbp-10h], xmm7
loc_407733:
4224819    mov     [rbp-0F0h], rsi
4224826    mov     rax, [rbp-0E8h]
4224833    mov     eax, [rax+2208h]
4224839    mov     edx, 1FFEh
4224844    sub     edx, eax
4224846    mov     eax, edx
4224848    mov     [rbp-0D8h], eax
4224854    cmp     dword [rbp-0D8h], 0
4224861    jns     loc_407778
4224863    mov     ecx, __PRETTY_FUNCTION___6289
4224868    mov     edx, 86Ah
4224873    mov     esi, file
4224878    mov     edi, aSpace0
4224883    call    ___assert_fail
loc_407778:
4224888    mov     rax, [rbp-0E8h]
4224895    mov     eax, [rax+2208h]
4224901    movsxd  rdx, eax
4224904    mov     rax, [rbp-0E8h]
4224911    add     rax, rdx
4224914    add     rax, 8
4224918    mov     [rbp-0D0h], rax
4224925    mov     dword [rbp-0C8h], 10h
4224935    mov     dword [rbp-0C4h], 30h
4224945    lea     rax, [rbp+10h]
4224949    mov     [rbp-0C0h], rax
4224956    lea     rax, [rbp-0B0h]
4224963    mov     [rbp-0B8h], rax
4224970    mov     eax, [rbp-0D8h]
4224976    movsxd  rsi, eax
4224979    lea     rcx, [rbp-0C8h]
4224986    mov     rdx, [rbp-0F0h]
4224993    mov     rax, [rbp-0D0h]
4225000    mov     rdi, rax
4225003    call    _mg_vsnprintf
4225008    mov     [rbp-0D4h], eax
4225014    cmp     dword [rbp-0D4h], 0
4225021    jle     loc_407884
4225027    mov     eax, [rbp-0D4h]
4225033    add     eax, 1
4225036    cmp     eax, [rbp-0D8h]
4225042    jge     loc_407884
4225044    mov     rax, [rbp-0E8h]
4225051    mov     eax, [rax+220Ch]
4225057    cmp     eax, 3Dh
4225060    jg      loc_407884
4225062    mov     rax, [rbp-0E8h]
4225069    mov     eax, [rax+220Ch]
4225075    lea     ecx, [rax+1]
4225078    mov     rdx, [rbp-0E8h]
4225085    mov     [rdx+220Ch], ecx
4225091    mov     rdx, [rbp-0E8h]
4225098    cdqe    
4225100    lea     rcx, [rax+400h]
4225107    mov     rax, [rbp-0D0h]
4225114    mov     [rdx+rcx*8+8], rax
4225119    mov     rax, [rbp-0E8h]
4225126    mov     eax, [rax+2208h]
4225132    mov     edx, [rbp-0D4h]
4225138    add     edx, 1
4225141    add     edx, eax
4225143    mov     rax, [rbp-0E8h]
4225150    mov     [rax+2208h], edx
loc_407884:
4225156    mov     rax, [rbp-0D0h]
4225163    leave   
4225164    retn    
USE32

section .text

global _addenv2

_addenv2:
4225165    push    rbp
4225166    mov     rbp, rsp
4225169    sub     rsp, 20h
4225173    call    _mcount
4225178    mov     [rbp-18h], rdi
4225182    mov     [rbp-20h], rsi
4225186    mov     rax, [rbp-20h]
4225190    mov     rdi, rax
4225193    call    _getenv
4225198    mov     [rbp-8], rax
4225202    cmp     qword [rbp-8], 0
4225207    jz      locret_4078D7
4225209    mov     rcx, [rbp-8]
4225213    mov     rdx, [rbp-20h]
4225217    mov     rax, [rbp-18h]
4225221    mov     esi, aSS_0
4225226    mov     rdi, rax
4225229    mov     eax, 0
4225234    call    _addenv
locret_4078D7:
4225239    leave   
4225240    retn    
USE32

section .text

global _prepare_cgi_environment

_prepare_cgi_environment:
4225241    push    rbp
4225242    mov     rbp, rsp
4225245    push    r12
4225247    push    rbx
4225248    sub     rsp, 50h
4225252    call    _mcount
4225257    mov     [rbp-48h], rdi
4225261    mov     [rbp-50h], rsi
4225265    mov     [rbp-58h], rdx
4225269    mov     rax, [rbp-48h]
4225273    add     rax, 8
4225277    mov     [rbp-30h], rax
4225281    mov     rax, [rbp-48h]
4225285    mov     rax, [rax+2A8h]
4225292    add     rax, 38h
4225296    mov     [rbp-28h], rax
4225300    mov     rax, [rbp-58h]
4225304    mov     dword [rax+220Ch], 0
4225314    mov     rax, [rbp-58h]
4225318    mov     edx, [rax+220Ch]
4225324    mov     rax, [rbp-58h]
4225328    mov     [rax+2208h], edx
4225334    mov     rax, [rbp-58h]
4225338    mov     rdx, [rbp-30h]
4225342    mov     [rax], rdx
4225345    mov     edi, name
4225350    call    _getenv
4225355    mov     [rbp-20h], rax
4225359    cmp     qword [rbp-20h], 0
4225364    jz      loc_407972
4225366    mov     rdx, [rbp-20h]
4225370    mov     rax, [rbp-58h]
4225374    mov     esi, aServer_nameS
4225379    mov     rdi, rax
4225382    mov     eax, 0
4225387    call    _addenv
4225392    jmp     loc_407990
loc_407972:
4225394    mov     rax, [rbp-30h]
4225398    lea     rdx, [rax+50h]
4225402    mov     rax, [rbp-58h]
4225406    mov     esi, aServer_nameS
4225411    mov     rdi, rax
4225414    mov     eax, 0
4225419    call    _addenv
loc_407990:
4225424    mov     rax, [rbp-28h]
4225428    add     rax, 38h
4225432    mov     rdx, [rax]
4225435    mov     rax, [rbp-58h]
4225439    mov     esi, aServer_rootS
4225444    mov     rdi, rax
4225447    mov     eax, 0
4225452    call    _addenv
4225457    mov     rax, [rbp-28h]
4225461    add     rax, 38h
4225465    mov     rdx, [rax]
4225468    mov     rax, [rbp-58h]
4225472    mov     esi, aDocument_rootS
4225477    mov     rdi, rax
4225480    mov     eax, 0
4225485    call    _addenv
4225490    mov     rax, [rbp-58h]
4225494    mov     ecx, a5_6_0
4225499    mov     edx, aMongoose
4225504    mov     esi, aServer_softwar
4225509    mov     rdi, rax
4225512    mov     eax, 0
4225517    call    _addenv
4225522    mov     rax, [rbp-58h]
4225526    mov     edx, aGateway_interf
4225531    mov     esi, aS_2
4225536    mov     rdi, rax
4225539    mov     eax, 0
4225544    call    _addenv
4225549    mov     rax, [rbp-58h]
4225553    mov     edx, aServer_protoco
4225558    mov     esi, aS_2
4225563    mov     rdi, rax
4225566    mov     eax, 0
4225571    call    _addenv
4225576    mov     rax, [rbp-58h]
4225580    mov     edx, aRedirect_statu
4225585    mov     esi, aS_2
4225590    mov     rdi, rax
4225593    mov     eax, 0
4225598    call    _addenv
4225603    mov     rax, [rbp-30h]
4225607    mov     rdx, [rax]
4225610    mov     rax, [rbp-58h]
4225614    mov     esi, aRequest_method
4225619    mov     rdi, rax
4225622    mov     eax, 0
4225627    call    _addenv
4225632    mov     rax, [rbp-30h]
4225636    lea     rdx, [rax+20h]
4225640    mov     rax, [rbp-58h]
4225644    mov     esi, aRemote_addrS
4225649    mov     rdi, rax
4225652    mov     eax, 0
4225657    call    _addenv
4225662    mov     rax, [rbp-30h]
4225666    movzx   eax, word [rax+80h]
4225673    movzx   edx, ax
4225676    mov     rax, [rbp-58h]
4225680    mov     esi, aRemote_portD
4225685    mov     rdi, rax
4225688    mov     eax, 0
4225693    call    _addenv
4225698    mov     rax, [rbp-30h]
4225702    mov     rax, [rax+18h]
4225706    test    rax, rax
4225709    jz      loc_407AB9
4225711    mov     rax, [rbp-30h]
4225715    mov     rdx, [rax+18h]
4225719    jmp     loc_407ABE
loc_407AB9:
4225721    mov     edx, unk_414196
loc_407ABE:
4225726    mov     rax, [rbp-30h]
4225730    mov     rax, [rax+18h]
4225734    test    rax, rax
4225737    jnz     loc_407AD2
4225739    mov     eax, unk_414196
4225744    jmp     loc_407AD7
loc_407AD2:
4225746    mov     eax, a?
loc_407AD7:
4225751    mov     rcx, [rbp-30h]
4225755    mov     rsi, [rcx+8]
4225759    mov     rdi, [rbp-58h]
4225763    mov     r8, rdx
4225766    mov     rcx, rax
4225769    mov     rdx, rsi
4225772    mov     esi, aRequest_uriSSS
4225777    mov     eax, 0
4225782    call    _addenv
4225787    mov     rax, [rbp-48h]
4225791    mov     rax, [rax+2C0h]
4225798    test    rax, rax
4225801    jz      loc_407B7D
4225803    mov     rax, [rbp-30h]
4225807    mov     rbx, [rax+8]
4225811    mov     rax, [rbp-30h]
4225815    mov     rax, [rax+8]
4225819    mov     rdi, rax
4225822    call    _strlen
4225827    mov     r12d, eax
4225830    mov     rax, [rbp-48h]
4225834    mov     rax, [rax+2C0h]
4225841    mov     rdi, rax
4225844    call    _strlen
4225849    sub     r12d, eax
4225852    mov     eax, r12d
4225855    mov     edx, eax
4225857    mov     rax, [rbp-58h]
4225861    mov     rcx, rbx
4225864    mov     esi, aScript_name_S
4225869    mov     rdi, rax
4225872    mov     eax, 0
4225877    call    _addenv
4225882    mov     rax, [rbp-48h]
4225886    mov     rdx, [rax+2C0h]
4225893    mov     rax, [rbp-58h]
4225897    mov     esi, aPath_infoS
4225902    mov     rdi, rax
4225905    mov     eax, 0
4225910    call    _addenv
4225915    jmp     loc_407BFC
loc_407B7D:
4225917    mov     rax, [rbp-50h]
4225921    mov     esi, 2Fh
4225926    mov     rdi, rax
4225929    call    _strrchr
4225934    mov     [rbp-20h], rax
4225938    mov     rax, [rbp-30h]
4225942    mov     rax, [rax+8]
4225946    mov     esi, 2Fh
4225951    mov     rdi, rax
4225954    call    _strrchr
4225959    mov     [rbp-18h], rax
4225963    cmp     qword [rbp-20h], 0
4225968    jnz     loc_407BB8
4225970    mov     rdx, [rbp-50h]
4225974    jmp     loc_407BBC
loc_407BB8:
4225976    mov     rdx, [rbp-20h]
loc_407BBC:
4225980    mov     rax, [rbp-30h]
4225984    mov     rcx, [rax+8]
4225988    cmp     qword [rbp-18h], 0
4225993    jz      loc_407BDF
4225995    mov     rsi, [rbp-18h]
4225999    mov     rax, [rbp-30h]
4226003    mov     rax, [rax+8]
4226007    sub     rsi, rax
4226010    mov     rax, rsi
4226013    jmp     loc_407BE4
loc_407BDF:
4226015    mov     eax, 0
loc_407BE4:
4226020    mov     rdi, [rbp-58h]
4226024    mov     r8, rdx
4226027    mov     edx, eax
4226029    mov     esi, aScript_name_SS
4226034    mov     eax, 0
4226039    call    _addenv
loc_407BFC:
4226044    mov     rdx, [rbp-50h]
4226048    mov     rax, [rbp-58h]
4226052    mov     esi, aScript_filenam
4226057    mov     rdi, rax
4226060    mov     eax, 0
4226065    call    _addenv
4226070    mov     rdx, [rbp-50h]
4226074    mov     rax, [rbp-58h]
4226078    mov     esi, aPath_translate
4226083    mov     rdi, rax
4226086    mov     eax, 0
4226091    call    _addenv
4226096    mov     rax, [rbp-48h]
4226100    mov     rax, [rax]
4226103    mov     rax, [rax+68h]
4226107    test    rax, rax
4226110    jz      loc_407C47
4226112    mov     eax, aOn
4226117    jmp     loc_407C4C
loc_407C47:
4226119    mov     eax, aOff
loc_407C4C:
4226124    mov     rcx, [rbp-58h]
4226128    mov     rdx, rax
4226131    mov     esi, aHttpsS
4226136    mov     rdi, rcx
4226139    mov     eax, 0
4226144    call    _addenv
4226149    mov     rax, [rbp-30h]
4226153    mov     esi, aContentType
4226158    mov     rdi, rax
4226161    call    _mg_get_header
4226166    mov     [rbp-20h], rax
4226170    cmp     qword [rbp-20h], 0
4226175    jz      loc_407C9B
4226177    mov     rdx, [rbp-20h]
4226181    mov     rax, [rbp-58h]
4226185    mov     esi, aContent_typeS
4226190    mov     rdi, rax
4226193    mov     eax, 0
4226198    call    _addenv
loc_407C9B:
4226203    mov     rax, [rbp-30h]
4226207    mov     rax, [rax+18h]
4226211    test    rax, rax
4226214    jz      loc_407CC6
4226216    mov     rax, [rbp-30h]
4226220    mov     rdx, [rax+18h]
4226224    mov     rax, [rbp-58h]
4226228    mov     esi, aQuery_stringS
4226233    mov     rdi, rax
4226236    mov     eax, 0
4226241    call    _addenv
loc_407CC6:
4226246    mov     rax, [rbp-30h]
4226250    mov     esi, aContentLength
4226255    mov     rdi, rax
4226258    call    _mg_get_header
4226263    mov     [rbp-20h], rax
4226267    cmp     qword [rbp-20h], 0
4226272    jz      loc_407CFC
4226274    mov     rdx, [rbp-20h]
4226278    mov     rax, [rbp-58h]
4226282    mov     esi, aContent_length
4226287    mov     rdi, rax
4226290    mov     eax, 0
4226295    call    _addenv
loc_407CFC:
4226300    mov     rax, [rbp-58h]
4226304    mov     esi, aPath
4226309    mov     rdi, rax
4226312    call    _addenv2
4226317    mov     rax, [rbp-58h]
4226321    mov     esi, aTmp
4226326    mov     rdi, rax
4226329    call    _addenv2
4226334    mov     rax, [rbp-58h]
4226338    mov     esi, aTemp
4226343    mov     rdi, rax
4226346    call    _addenv2
4226351    mov     rax, [rbp-58h]
4226355    mov     esi, aTmpdir
4226360    mov     rdi, rax
4226363    call    _addenv2
4226368    mov     rax, [rbp-58h]
4226372    mov     esi, aPerllib
4226377    mov     rdi, rax
4226380    call    _addenv2
4226385    mov     rax, [rbp-58h]
4226389    mov     esi, aMongoose_cgi
4226394    mov     rdi, rax
4226397    call    _addenv2
4226402    mov     rax, [rbp-58h]
4226406    mov     esi, aLd_library_pat
4226411    mov     rdi, rax
4226414    call    _addenv2
4226419    mov     dword [rbp-3Ch], 0
4226426    jmp     loc_407E1D
loc_407D7F:
4226431    mov     rax, [rbp-30h]
4226435    mov     edx, [rbp-3Ch]
4226438    movsxd  rdx, edx
4226441    add     rdx, 8
4226445    shl     rdx, 4
4226449    add     rax, rdx
4226452    add     rax, 10h
4226456    mov     rcx, [rax]
4226459    mov     rax, [rbp-30h]
4226463    mov     edx, [rbp-3Ch]
4226466    movsxd  rdx, edx
4226469    add     rdx, 8
4226473    shl     rdx, 4
4226477    add     rax, rdx
4226480    add     rax, 8
4226484    mov     rdx, [rax]
4226487    mov     rax, [rbp-58h]
4226491    mov     esi, aHttp_SS
4226496    mov     rdi, rax
4226499    mov     eax, 0
4226504    call    _addenv
4226509    mov     [rbp-38h], rax
4226513    jmp     loc_407E03
loc_407DD3:
4226515    mov     rax, [rbp-38h]
4226519    movzx   eax, byte [rax]
4226522    cmp     al, 2Dh
4226524    jnz     loc_407DE5
4226526    mov     rax, [rbp-38h]
4226530    mov     byte [rax], 5Fh
loc_407DE5:
4226533    mov     rax, [rbp-38h]
4226537    movzx   eax, byte [rax]
4226540    movzx   eax, al
4226543    mov     edi, eax
4226545    call    _toupper
4226550    mov     edx, eax
4226552    mov     rax, [rbp-38h]
4226556    mov     [rax], dl
4226558    add     qword [rbp-38h], 1
loc_407E03:
4226563    mov     rax, [rbp-38h]
4226567    movzx   eax, byte [rax]
4226570    cmp     al, 3Dh
4226572    jz      loc_407E19
4226574    mov     rax, [rbp-38h]
4226578    movzx   eax, byte [rax]
4226581    test    al, al
4226583    jnz     loc_407DD3
loc_407E19:
4226585    add     dword [rbp-3Ch], 1
loc_407E1D:
4226589    mov     rax, [rbp-30h]
4226593    mov     eax, [rax+84h]
4226599    cmp     eax, [rbp-3Ch]
4226602    jg      loc_407D7F
4226608    mov     rax, [rbp-58h]
4226612    mov     eax, [rax+220Ch]
4226618    lea     ecx, [rax+1]
4226621    mov     rdx, [rbp-58h]
4226625    mov     [rdx+220Ch], ecx
4226631    mov     rdx, [rbp-58h]
4226635    cdqe    
4226637    add     rax, 400h
4226643    mov     qword [rdx+rax*8+8], 0
4226652    mov     rax, [rbp-58h]
4226656    mov     eax, [rax+2208h]
4226662    lea     ecx, [rax+1]
4226665    mov     rdx, [rbp-58h]
4226669    mov     [rdx+2208h], ecx
4226675    mov     rdx, [rbp-58h]
4226679    cdqe    
4226681    mov     byte [rdx+rax+8], 0
4226686    mov     rax, [rbp-58h]
4226690    mov     eax, [rax+220Ch]
4226696    cmp     eax, 3Fh
4226699    jle     loc_407EA6
4226701    mov     ecx, __PRETTY_FUNCTION___6312
4226706    mov     edx, 8E4h
4226711    mov     esi, file
4226716    mov     edi, aBlkNvarsIntSiz
4226721    call    ___assert_fail
loc_407EA6:
4226726    mov     rax, [rbp-58h]
4226730    mov     eax, [rax+2208h]
4226736    test    eax, eax
4226738    jg      loc_407ECD
4226740    mov     ecx, __PRETTY_FUNCTION___6312
4226745    mov     edx, 8E5h
4226750    mov     esi, file
4226755    mov     edi, aBlkLen0
4226760    call    ___assert_fail
loc_407ECD:
4226765    mov     rax, [rbp-58h]
4226769    mov     eax, [rax+2208h]
4226775    cmp     eax, 1FFFh
4226780    jle     loc_407EF7
4226782    mov     ecx, __PRETTY_FUNCTION___6312
4226787    mov     edx, 8E6h
4226792    mov     esi, file
4226797    mov     edi, aBlkLenIntSizeo
4226802    call    ___assert_fail
loc_407EF7:
4226807    add     rsp, 50h
4226811    pop     rbx
4226812    pop     r12
4226814    pop     rbp
4226815    retn    
USE32

section .text

global _open_cgi_endpoint

_open_cgi_endpoint:
4226816    push    rbp
4226817    mov     rbp, rsp
4226820    sub     rsp, 4240h
4226827    call    _mcount
4226832    mov     [rbp-4238h], rdi
4226839    mov     [rbp-4240h], rsi
4226846    mov     rax, [fs:28h]
4226855    mov     [rbp-8], rax
4226859    xor     eax, eax
4226861    lea     rdx, [rbp-2220h]
4226868    mov     rcx, [rbp-4240h]
4226875    mov     rax, [rbp-4238h]
4226882    mov     rsi, rcx
4226885    mov     rdi, rax
4226888    call    _prepare_cgi_environment
4226893    mov     rax, [rbp-4240h]
4226900    mov     esi, 2Fh
4226905    mov     rdi, rax
4226908    call    _strrchr
4226913    mov     [rbp-4228h], rax
4226920    cmp     qword [rbp-4228h], 0
4226928    jnz     loc_407F97
4226930    lea     rax, [rbp-4220h]
4226937    mov     ecx, a_
4226942    mov     edx, aS_2
4226947    mov     esi, 2000h
4226952    mov     rdi, rax
4226955    mov     eax, 0
4226960    call    _mg_snprintf
4226965    jmp     loc_407FD7
loc_407F97:
4226967    mov     rdx, [rbp-4228h]
4226974    mov     rax, [rbp-4240h]
4226981    sub     rdx, rax
4226984    mov     rax, rdx
4226987    mov     edx, eax
4226989    mov     rcx, [rbp-4240h]
4226996    lea     rax, [rbp-4220h]
4227003    mov     r8, rcx
4227006    mov     ecx, edx
4227008    mov     edx, a_S_0
4227013    mov     esi, 2000h
4227018    mov     rdi, rax
4227021    mov     eax, 0
4227026    call    _mg_snprintf
loc_407FD7:
4227031    lea     rax, [rbp-4230h]
4227038    mov     rdi, rax
4227041    call    _ns_socketpair
4227046    mov     eax, [rbp-4230h]
4227052    cmp     eax, 0FFFFFFFFh
4227055    jz      loc_407FD7
4227057    mov     r8d, [rbp-422Ch]
4227064    mov     rax, [rbp-4238h]
4227071    mov     rax, [rax+2A8h]
4227078    mov     rax, [rax+50h]
4227082    lea     rdi, [rbp-4220h]
4227089    lea     rdx, [rbp-2220h]
4227096    lea     rcx, [rdx+2008h]
4227103    lea     rdx, [rbp-2220h]
4227110    add     rdx, 8
4227114    mov     rsi, [rbp-4240h]
4227121    mov     r9d, r8d
4227124    mov     r8, rdi
4227127    mov     rdi, rax
4227130    call    _start_process
4227135    test    eax, eax
4227137    jz      loc_40815C
4227143    mov     rax, [rbp-4238h]
4227150    mov     dword [rax+2B8h], 2
4227160    mov     esi, [rbp-4230h]
4227166    mov     rax, [rbp-4238h]
4227173    mov     rax, [rax+2A8h]
4227180    mov     rdx, [rbp-4238h]
4227187    mov     rcx, rdx
4227190    mov     edx, mg_ev_handler
4227195    mov     rdi, rax
4227198    call    _ns_add_sock
4227203    mov     rdx, [rbp-4238h]
4227210    mov     [rdx+2B0h], rax
4227217    mov     rax, [rbp-4238h]
4227224    mov     rax, [rax+2B0h]
4227231    mov     rdx, [rbp-4238h]
4227238    mov     rdx, [rdx+2B0h]
4227245    mov     edx, [rdx+98h]
4227251    or      edx, 400000h
4227257    mov     [rax+98h], edx
4227263    mov     rax, [rbp-4238h]
4227270    mov     rax, [rax]
4227273    mov     edx, 11h
4227278    mov     esi, cgi_status
4227283    mov     rdi, rax
4227286    call    _ns_send
4227291    mov     rax, [rbp-4238h]
4227298    mov     dword [rax+284h], 0C8h
4227308    mov     rax, [rbp-4238h]
4227315    mov     rax, [rax]
4227318    mov     rdx, [rbp-4238h]
4227325    mov     rdx, [rdx]
4227328    mov     edx, [rdx+98h]
4227334    or      edx, 2
4227337    mov     [rax+98h], edx
4227343    mov     rax, [rbp-4238h]
4227350    mov     rax, [rax+2B0h]
4227357    mov     rdx, [rbp-4238h]
4227364    mov     rdx, [rdx]
4227367    mov     rcx, [rdx+38h]
4227371    mov     [rax+50h], rcx
4227375    mov     rcx, [rdx+40h]
4227379    mov     [rax+58h], rcx
4227383    mov     rdx, [rdx+48h]
4227387    mov     [rax+60h], rdx
4227391    mov     rax, [rbp-4238h]
4227398    mov     rax, [rax]
4227401    add     rax, 38h
4227405    mov     esi, 0
4227410    mov     rdi, rax
4227413    call    _iobuf_init
4227418    jmp     loc_408191
loc_40815C:
4227420    mov     eax, [rbp-4230h]
4227426    mov     edi, eax
4227428    call    _close
4227433    mov     rdx, [rbp-4240h]
4227440    mov     rax, [rbp-4238h]
4227447    mov     rcx, rdx
4227450    mov     edx, aStart_processS
4227455    mov     esi, 1F4h
4227460    mov     rdi, rax
4227463    mov     eax, 0
4227468    call    _send_http_error
loc_408191:
4227473    mov     eax, [rbp-422Ch]
4227479    mov     edi, eax
4227481    call    _close
4227486    mov     rax, [rbp-8]
4227490    xor     rax, [fs:28h]
4227499    jz      locret_4081B2
4227501    call    ___stack_chk_fail
locret_4081B2:
4227506    leave   
4227507    retn    
USE32

section .text

global _on_cgi_data

_on_cgi_data:
4227508    push    rbp
4227509    mov     rbp, rsp
4227512    sub     rsp, 42F0h
4227519    call    _mcount
4227524    mov     [rbp-42E8h], rdi
4227531    mov     rax, [fs:28h]
4227540    mov     [rbp-8], rax
4227544    xor     eax, eax
4227546    mov     rax, [rbp-42E8h]
4227553    mov     rax, [rax+78h]
4227557    mov     [rbp-42C8h], rax
4227564    mov     qword [rbp-42D0h], a500
4227575    cmp     qword [rbp-42C8h], 0
4227583    jnz     loc_408206
4227585    jmp     loc_408458
loc_408206:
4227590    mov     rax, [rbp-42C8h]
4227597    mov     rdx, [rax]
4227600    mov     rax, [rbp-42E8h]
4227607    mov     rsi, rdx
4227610    mov     rdi, rax
4227613    call    _ns_forward
4227618    mov     rax, [rbp-42C8h]
4227625    mov     rax, [rax]
4227628    mov     eax, [rax+98h]
4227634    and     eax, 2
4227637    test    eax, eax
4227639    jz      loc_408458
4227645    mov     rax, [rbp-42C8h]
4227652    mov     rax, [rax]
4227655    add     rax, 50h
4227659    mov     [rbp-42C0h], rax
4227666    mov     qword [rbp-42B8h], 11h
4227677    mov     rax, [rbp-42C0h]
4227684    mov     rax, [rax+8]
4227688    sub     rax, [rbp-42B8h]
4227695    mov     rdx, [rbp-42C0h]
4227702    mov     rcx, [rdx]
4227705    mov     rdx, [rbp-42B8h]
4227712    add     rdx, rcx
4227715    mov     rsi, rax
4227718    mov     rdi, rdx
4227721    call    _get_request_len
4227726    mov     [rbp-42DCh], eax
4227732    lea     rax, [rbp-4010h]
4227739    mov     [rbp-42D8h], rax
4227746    cmp     dword [rbp-42DCh], 0
4227753    jz      loc_408458
4227759    cmp     dword [rbp-42DCh], 0
4227766    js      loc_4082C4
4227768    cmp     dword [rbp-42DCh], 4000h
4227778    jle     loc_40832A
loc_4082C4:
4227780    mov     rax, [rbp-42C0h]
4227787    mov     rax, [rax+8]
4227791    mov     [rbp-42DCh], eax
4227797    mov     rax, [rbp-42C0h]
4227804    mov     rdx, [rax+8]
4227808    mov     rax, [rbp-42C0h]
4227815    mov     rsi, rdx
4227818    mov     rdi, rax
4227821    call    _iobuf_remove
4227826    mov     rax, [rbp-42C0h]
4227833    mov     rcx, [rax]
4227836    mov     edx, [rbp-42DCh]
4227842    mov     rax, [rbp-42C8h]
4227849    mov     r8, rcx
4227852    mov     ecx, edx
4227854    mov     edx, aCgiProgramSent
4227859    mov     esi, 1F4h
4227864    mov     rdi, rax
4227867    mov     eax, 0
4227872    call    _send_http_error
4227877    jmp     loc_408435
loc_40832A:
4227882    lea     rax, [rbp-42B0h]
4227889    mov     edx, 2A0h
4227894    mov     esi, 0
4227899    mov     rdi, rax
4227902    call    _memset
4227907    mov     eax, [rbp-42DCh]
4227913    movsxd  rdx, eax
4227916    mov     rax, [rbp-42C0h]
4227923    mov     rcx, [rax]
4227926    mov     rax, [rbp-42B8h]
4227933    add     rcx, rax
4227936    lea     rax, [rbp-4010h]
4227943    mov     rsi, rcx
4227946    mov     rdi, rax
4227949    call    _memcpy
4227954    mov     eax, [rbp-42DCh]
4227960    sub     eax, 1
4227963    cdqe    
4227965    mov     byte [rbp+rax-4010h], 0
4227973    lea     rdx, [rbp-42B0h]
4227980    lea     rax, [rbp-42D8h]
4227987    mov     rsi, rdx
4227990    mov     rdi, rax
4227993    call    _parse_http_headers
4227998    lea     rax, [rbp-42B0h]
4228005    mov     esi, aLocation
4228010    mov     rdi, rax
4228013    call    _mg_get_header
4228018    test    rax, rax
4228021    jz      loc_4083C4
4228023    mov     qword [rbp-42D0h], a302
4228034    jmp     loc_4083F4
loc_4083C4:
4228036    lea     rax, [rbp-42B0h]
4228043    mov     esi, aStatus
4228048    mov     rdi, rax
4228051    call    _mg_get_header
4228056    mov     [rbp-42D0h], rax
4228063    cmp     qword [rbp-42D0h], 0
4228071    jnz     loc_4083F4
4228073    mov     qword [rbp-42D0h], a200
loc_4083F4:
4228084    mov     rax, [rbp-42C0h]
4228091    mov     rax, [rax]
4228094    lea     rcx, [rax+9]
4228098    mov     rax, [rbp-42D0h]
4228105    mov     edx, 3
4228110    mov     rsi, rax
4228113    mov     rdi, rcx
4228116    call    _memcpy
4228121    mov     rax, [rbp-42D0h]
4228128    mov     rdi, rax
4228131    call    _atoi
4228136    mov     rdx, [rbp-42C8h]
4228143    mov     [rdx+284h], eax
loc_408435:
4228149    mov     rax, [rbp-42C8h]
4228156    mov     rax, [rax]
4228159    mov     rdx, [rbp-42C8h]
4228166    mov     rdx, [rdx]
4228169    mov     edx, [rdx+98h]
4228175    and     edx, 0FFFFFFFDh
4228178    mov     [rax+98h], edx
loc_408458:
4228184    mov     rax, [rbp-8]
4228188    xor     rax, [fs:28h]
4228197    jz      locret_40846C
4228199    call    ___stack_chk_fail
locret_40846C:
4228204    leave   
4228205    retn    
USE32

section .text

global _mg_strdup

_mg_strdup:
4228206    push    rbp
4228207    mov     rbp, rsp
4228210    sub     rsp, 20h
4228214    call    _mcount
4228219    mov     [rbp-18h], rdi
4228223    mov     rax, [rbp-18h]
4228227    mov     rdi, rax
4228230    call    _strlen
4228235    add     rax, 1
4228239    mov     rdi, rax
4228242    call    _malloc
4228247    mov     [rbp-8], rax
4228251    cmp     qword [rbp-8], 0
4228256    jz      loc_4084B5
4228258    mov     rdx, [rbp-18h]
4228262    mov     rax, [rbp-8]
4228266    mov     rsi, rdx
4228269    mov     rdi, rax
4228272    call    _strcpy
loc_4084B5:
4228277    mov     rax, [rbp-8]
4228281    leave   
4228282    retn    
USE32

section .text

global _isbyte

_isbyte:
4228283    push    rbp
4228284    mov     rbp, rsp
4228287    sub     rsp, 8
4228291    call    _mcount
4228296    mov     [rbp-4], edi
4228299    cmp     dword [rbp-4], 0
4228303    js      loc_4084E1
4228305    cmp     dword [rbp-4], 0FFh
4228312    jg      loc_4084E1
4228314    mov     eax, 1
4228319    jmp     locret_4084E6
loc_4084E1:
4228321    mov     eax, 0
locret_4084E6:
4228326    leave   
4228327    retn    
USE32

section .text

global _parse_net

_parse_net:
4228328    push    rbp
4228329    mov     rbp, rsp
4228332    sub     rsp, 50h
4228336    call    _mcount
4228341    mov     [rbp-28h], rdi
4228345    mov     [rbp-30h], rsi
4228349    mov     [rbp-38h], rdx
4228353    mov     dword [rbp-8], 20h
4228360    mov     dword [rbp-4], 0
4228367    lea     r8, [rbp-0Ch]
4228371    lea     rdi, [rbp-10h]
4228375    lea     rcx, [rbp-14h]
4228379    lea     rdx, [rbp-18h]
4228383    mov     rax, [rbp-28h]
4228387    lea     rsi, [rbp-1Ch]
4228391    mov     [rsp+8], rsi
4228396    lea     rsi, [rbp-8]
4228400    mov     [rsp], rsi
4228404    mov     r9, r8
4228407    mov     r8, rdi
4228410    mov     esi, aD_D_D_DDN
4228415    mov     rdi, rax
4228418    mov     eax, 0
4228423    call    ___isoc99_sscanf
4228428    cmp     eax, 5
4228431    jz      loc_40858E
4228433    lea     r8, [rbp-0Ch]
4228437    lea     rdi, [rbp-10h]
4228441    lea     rcx, [rbp-14h]
4228445    lea     rdx, [rbp-18h]
4228449    mov     rax, [rbp-28h]
4228453    lea     rsi, [rbp-1Ch]
4228457    mov     [rsp], rsi
4228461    mov     r9, r8
4228464    mov     r8, rdi
4228467    mov     esi, aD_D_D_DN
4228472    mov     rdi, rax
4228475    mov     eax, 0
4228480    call    ___isoc99_sscanf
4228485    cmp     eax, 4
4228488    jnz     loc_40862D
loc_40858E:
4228494    mov     eax, [rbp-18h]
4228497    mov     edi, eax
4228499    call    _isbyte
4228504    test    eax, eax
4228506    jz      loc_40862D
4228512    mov     eax, [rbp-14h]
4228515    mov     edi, eax
4228517    call    _isbyte
4228522    test    eax, eax
4228524    jz      loc_40862D
4228526    mov     eax, [rbp-10h]
4228529    mov     edi, eax
4228531    call    _isbyte
4228536    test    eax, eax
4228538    jz      loc_40862D
4228540    mov     eax, [rbp-0Ch]
4228543    mov     edi, eax
4228545    call    _isbyte
4228550    test    eax, eax
4228552    jz      loc_40862D
4228554    mov     eax, [rbp-8]
4228557    test    eax, eax
4228559    js      loc_40862D
4228561    mov     eax, [rbp-8]
4228564    cmp     eax, 20h
4228567    jg      loc_40862D
4228569    mov     eax, [rbp-1Ch]
4228572    mov     [rbp-4], eax
4228575    mov     eax, [rbp-18h]
4228578    shl     eax, 18h
4228581    mov     edx, eax
4228583    mov     eax, [rbp-14h]
4228586    shl     eax, 10h
4228589    or      edx, eax
4228591    mov     eax, [rbp-10h]
4228594    shl     eax, 8
4228597    or      edx, eax
4228599    mov     eax, [rbp-0Ch]
4228602    or      edx, eax
4228604    mov     rax, [rbp-30h]
4228608    mov     [rax], edx
4228610    mov     eax, [rbp-8]
4228613    test    eax, eax
4228615    jz      loc_408622
4228617    mov     eax, [rbp-8]
4228620    mov     edx, 20h
4228625    sub     edx, eax
4228627    mov     eax, edx
4228629    mov     edx, 0FFFFFFFFh
4228634    mov     ecx, eax
4228636    shl     edx, cl
4228638    mov     eax, edx
4228640    jmp     loc_408627
loc_408622:
4228642    mov     eax, 0
loc_408627:
4228647    mov     rdx, [rbp-38h]
4228651    mov     [rdx], eax
loc_40862D:
4228653    mov     eax, [rbp-4]
4228656    leave   
4228657    retn    
USE32

section .text

global _check_acl

_check_acl:
4228658    push    rbp
4228659    mov     rbp, rsp
4228662    sub     rsp, 30h
4228666    call    _mcount
4228671    mov     [rbp-28h], rdi
4228675    mov     [rbp-2Ch], esi
4228678    cmp     qword [rbp-28h], 0
4228683    jnz     loc_408654
4228685    mov     eax, 2Bh
4228690    jmp     loc_408659
loc_408654:
4228692    mov     eax, 2Dh
loc_408659:
4228697    mov     [rbp-18h], eax
4228700    jmp     loc_4086B2
loc_40865E:
4228702    mov     rax, [rbp-10h]
4228706    movzx   eax, byte [rax]
4228709    movsx   eax, al
4228712    mov     [rbp-14h], eax
4228715    cmp     dword [rbp-14h], 2Bh
4228719    jz      loc_408677
4228721    cmp     dword [rbp-14h], 2Dh
4228725    jnz     loc_408696
loc_408677:
4228727    mov     rax, [rbp-10h]
4228731    lea     rcx, [rax+1]
4228735    lea     rdx, [rbp-1Ch]
4228739    lea     rax, [rbp-20h]
4228743    mov     rsi, rax
4228746    mov     rdi, rcx
4228749    call    _parse_net
4228754    test    eax, eax
4228756    jnz     loc_40869D
loc_408696:
4228758    mov     eax, 0FFFFFFFFh
4228763    jmp     locret_4086DF
loc_40869D:
4228765    mov     eax, [rbp-1Ch]
4228768    and     eax, [rbp-2Ch]
4228771    mov     edx, eax
4228773    mov     eax, [rbp-20h]
4228776    cmp     edx, eax
4228778    jnz     loc_4086B2
4228780    mov     eax, [rbp-14h]
4228783    mov     [rbp-18h], eax
loc_4086B2:
4228786    lea     rcx, [rbp-10h]
4228790    mov     rax, [rbp-28h]
4228794    mov     edx, 0
4228799    mov     rsi, rcx
4228802    mov     rdi, rax
4228805    call    _next_option
4228810    mov     [rbp-28h], rax
4228814    cmp     qword [rbp-28h], 0
4228819    jnz     loc_40865E
4228821    cmp     dword [rbp-18h], 2Bh
4228825    setz    al
4228828    movzx   eax, al
locret_4086DF:
4228831    leave   
4228832    retn    
USE32

section .text

global _remove_double_dots_and_double_slashes

_remove_double_dots_and_double_slashes:
4228833    push    rbp
4228834    mov     rbp, rsp
4228837    sub     rsp, 18h
4228841    call    _mcount
4228846    mov     [rbp-18h], rdi
4228850    mov     rax, [rbp-18h]
4228854    mov     [rbp-8], rax
4228858    jmp     loc_40880F
loc_4086FF:
4228863    mov     rax, [rbp-8]
4228867    lea     rdx, [rax+1]
4228871    mov     [rbp-8], rdx
4228875    mov     rdx, [rbp-18h]
4228879    lea     rcx, [rdx+1]
4228883    mov     [rbp-18h], rcx
4228887    movzx   edx, byte [rdx]
4228890    mov     [rax], dl
4228892    mov     rax, [rbp-18h]
4228896    sub     rax, 1
4228900    movzx   eax, byte [rax]
4228903    cmp     al, 2Fh
4228905    jz      loc_40873E
4228907    mov     rax, [rbp-18h]
4228911    sub     rax, 1
4228915    movzx   eax, byte [rax]
4228918    cmp     al, 5Ch
4228920    jnz     loc_40880F
loc_40873E:
4228926    jmp     loc_408800
loc_408743:
4228931    mov     rax, [rbp-18h]
4228935    movzx   eax, byte [rax]
4228938    cmp     al, 2Fh
4228940    jz      loc_408759
4228942    mov     rax, [rbp-18h]
4228946    movzx   eax, byte [rax]
4228949    cmp     al, 5Ch
4228951    jnz     loc_408763
loc_408759:
4228953    add     qword [rbp-18h], 1
4228958    jmp     loc_408800
loc_408763:
4228963    mov     rax, [rbp-18h]
4228967    movzx   eax, byte [rax]
4228970    cmp     al, 2Eh
4228972    jnz     loc_408793
4228974    mov     rax, [rbp-18h]
4228978    add     rax, 1
4228982    movzx   eax, byte [rax]
4228985    cmp     al, 2Fh
4228987    jz      loc_40878C
4228989    mov     rax, [rbp-18h]
4228993    add     rax, 1
4228997    movzx   eax, byte [rax]
4229000    cmp     al, 5Ch
4229002    jnz     loc_408793
loc_40878C:
4229004    add     qword [rbp-18h], 2
4229009    jmp     loc_408800
loc_408793:
4229011    mov     rax, [rbp-18h]
4229015    movzx   eax, byte [rax]
4229018    cmp     al, 2Eh
4229020    jnz     loc_4087C3
4229022    mov     rax, [rbp-18h]
4229026    add     rax, 1
4229030    movzx   eax, byte [rax]
4229033    cmp     al, 2Eh
4229035    jnz     loc_4087C3
4229037    mov     rax, [rbp-18h]
4229041    add     rax, 2
4229045    movzx   eax, byte [rax]
4229048    test    al, al
4229050    jnz     loc_4087C3
4229052    add     qword [rbp-18h], 2
4229057    jmp     loc_408800
loc_4087C3:
4229059    mov     rax, [rbp-18h]
4229063    movzx   eax, byte [rax]
4229066    cmp     al, 2Eh
4229068    jnz     loc_40880F
4229070    mov     rax, [rbp-18h]
4229074    add     rax, 1
4229078    movzx   eax, byte [rax]
4229081    cmp     al, 2Eh
4229083    jnz     loc_40880F
4229085    mov     rax, [rbp-18h]
4229089    add     rax, 2
4229093    movzx   eax, byte [rax]
4229096    cmp     al, 2Fh
4229098    jz      loc_4087FB
4229100    mov     rax, [rbp-18h]
4229104    add     rax, 2
4229108    movzx   eax, byte [rax]
4229111    cmp     al, 5Ch
4229113    jnz     loc_40880F
loc_4087FB:
4229115    add     qword [rbp-18h], 3
loc_408800:
4229120    mov     rax, [rbp-18h]
4229124    movzx   eax, byte [rax]
4229127    test    al, al
4229129    jnz     loc_408743
loc_40880F:
4229135    mov     rax, [rbp-18h]
4229139    movzx   eax, byte [rax]
4229142    test    al, al
4229144    jnz     loc_4086FF
4229150    mov     rax, [rbp-8]
4229154    mov     byte [rax], 0
4229157    leave   
4229158    retn    
USE32

section .text

global _mg_url_decode

_mg_url_decode:
4229159    push    rbp
4229160    mov     rbp, rsp
4229163    push    r12
4229165    push    rbx
4229166    sub     rsp, 50h
4229170    call    _mcount
4229175    mov     [rbp-38h], rdi
4229179    mov     [rbp-40h], rsi
4229183    mov     [rbp-48h], rdx
4229187    mov     [rbp-50h], rcx
4229191    mov     [rbp-54h], r8d
4229195    mov     qword [rbp-18h], 0
4229203    mov     qword [rbp-18h], 0
4229211    mov     rax, [rbp-18h]
4229215    mov     [rbp-20h], rax
4229219    jmp     loc_408A0C
loc_408868:
4229224    mov     rax, [rbp-20h]
4229228    mov     rdx, [rbp-38h]
4229232    add     rax, rdx
4229235    movzx   eax, byte [rax]
4229238    cmp     al, 25h
4229240    jnz     loc_4089BF
4229246    mov     rax, [rbp-20h]
4229250    add     rax, 2
4229254    cmp     rax, [rbp-40h]
4229258    jnb     loc_4089BF
4229264    call    ___ctype_b_loc
4229269    mov     rax, [rax]
4229272    mov     rdx, [rbp-20h]
4229276    lea     rcx, [rdx+1]
4229280    mov     rdx, [rbp-38h]
4229284    add     rdx, rcx
4229287    movzx   edx, byte [rdx]
4229290    movzx   edx, dl
4229293    add     rdx, rdx
4229296    add     rax, rdx
4229299    movzx   eax, word [rax]
4229302    movzx   eax, ax
4229305    and     eax, 1000h
4229310    test    eax, eax
4229312    jz      loc_4089BF
4229318    call    ___ctype_b_loc
4229323    mov     rax, [rax]
4229326    mov     rdx, [rbp-20h]
4229330    lea     rcx, [rdx+2]
4229334    mov     rdx, [rbp-38h]
4229338    add     rdx, rcx
4229341    movzx   edx, byte [rdx]
4229344    movzx   edx, dl
4229347    add     rdx, rdx
4229350    add     rax, rdx
4229353    movzx   eax, word [rax]
4229356    movzx   eax, ax
4229359    and     eax, 1000h
4229364    test    eax, eax
4229366    jz      loc_4089BF
4229372    mov     rax, [rbp-20h]
4229376    lea     rdx, [rax+1]
4229380    mov     rax, [rbp-38h]
4229384    add     rax, rdx
4229387    movzx   eax, byte [rax]
4229390    movzx   eax, al
4229393    mov     edi, eax
4229395    call    _tolower
4229400    mov     [rbp-28h], eax
4229403    mov     rax, [rbp-20h]
4229407    lea     rdx, [rax+2]
4229411    mov     rax, [rbp-38h]
4229415    add     rax, rdx
4229418    movzx   eax, byte [rax]
4229421    movzx   eax, al
4229424    mov     edi, eax
4229426    call    _tolower
4229431    mov     [rbp-24h], eax
4229434    mov     rax, [rbp-18h]
4229438    mov     rdx, [rbp-48h]
4229442    lea     r12, [rdx+rax]
4229446    call    ___ctype_b_loc
4229451    mov     rax, [rax]
4229454    mov     edx, [rbp-28h]
4229457    movsxd  rdx, edx
4229460    add     rdx, rdx
4229463    add     rax, rdx
4229466    movzx   eax, word [rax]
4229469    movzx   eax, ax
4229472    and     eax, 800h
4229477    test    eax, eax
4229479    jz      loc_408976
4229481    mov     eax, [rbp-28h]
4229484    sub     eax, 30h
4229487    shl     eax, 4
4229490    mov     ebx, eax
4229492    jmp     loc_408981
loc_408976:
4229494    mov     eax, [rbp-28h]
4229497    sub     eax, 57h
4229500    shl     eax, 4
4229503    mov     ebx, eax
loc_408981:
4229505    call    ___ctype_b_loc
4229510    mov     rax, [rax]
4229513    mov     edx, [rbp-24h]
4229516    movsxd  rdx, edx
4229519    add     rdx, rdx
4229522    add     rax, rdx
4229525    movzx   eax, word [rax]
4229528    movzx   eax, ax
4229531    and     eax, 800h
4229536    test    eax, eax
4229538    jz      loc_4089AC
4229540    mov     eax, [rbp-24h]
4229543    sub     eax, 30h
4229546    jmp     loc_4089B2
loc_4089AC:
4229548    mov     eax, [rbp-24h]
4229551    sub     eax, 57h
loc_4089B2:
4229554    or      eax, ebx
4229556    mov     [r12], al
4229560    add     qword [rbp-20h], 2
4229565    jmp     loc_408A02
loc_4089BF:
4229567    cmp     dword [rbp-54h], 0
4229571    jz      loc_4089E7
4229573    mov     rax, [rbp-20h]
4229577    mov     rdx, [rbp-38h]
4229581    add     rax, rdx
4229584    movzx   eax, byte [rax]
4229587    cmp     al, 2Bh
4229589    jnz     loc_4089E7
4229591    mov     rax, [rbp-18h]
4229595    mov     rdx, [rbp-48h]
4229599    add     rax, rdx
4229602    mov     byte [rax], 20h
4229605    jmp     loc_408A02
loc_4089E7:
4229607    mov     rax, [rbp-18h]
4229611    mov     rdx, [rbp-48h]
4229615    add     rdx, rax
4229618    mov     rax, [rbp-20h]
4229622    mov     rcx, [rbp-38h]
4229626    add     rax, rcx
4229629    movzx   eax, byte [rax]
4229632    mov     [rdx], al
loc_408A02:
4229634    add     qword [rbp-20h], 1
4229639    add     qword [rbp-18h], 1
loc_408A0C:
4229644    mov     rax, [rbp-20h]
4229648    cmp     rax, [rbp-40h]
4229652    jnb     loc_408A28
4229654    mov     rax, [rbp-50h]
4229658    sub     rax, 1
4229662    cmp     rax, [rbp-18h]
4229666    ja      loc_408868
loc_408A28:
4229672    mov     rax, [rbp-18h]
4229676    mov     rdx, [rbp-48h]
4229680    add     rax, rdx
4229683    mov     byte [rax], 0
4229686    mov     rax, [rbp-20h]
4229690    cmp     rax, [rbp-40h]
4229694    jb      loc_408A46
4229696    mov     rax, [rbp-18h]
4229700    jmp     loc_408A4B
loc_408A46:
4229702    mov     eax, 0FFFFFFFFh
loc_408A4B:
4229707    add     rsp, 50h
4229711    pop     rbx
4229712    pop     r12
4229714    pop     rbp
4229715    retn    
USE32

section .text

global _is_valid_http_method

_is_valid_http_method:
4229716    push    rbp
4229717    mov     rbp, rsp
4229720    sub     rsp, 10h
4229724    call    _mcount
4229729    mov     [rbp-8], rdi
4229733    mov     rax, [rbp-8]
4229737    mov     esi, aGet
4229742    mov     rdi, rax
4229745    call    _strcmp
4229750    test    eax, eax
4229752    jz      loc_408B2A
4229758    mov     rax, [rbp-8]
4229762    mov     esi, aPost
4229767    mov     rdi, rax
4229770    call    _strcmp
4229775    test    eax, eax
4229777    jz      loc_408B2A
4229783    mov     rax, [rbp-8]
4229787    mov     esi, aHead
4229792    mov     rdi, rax
4229795    call    _strcmp
4229800    test    eax, eax
4229802    jz      loc_408B2A
4229804    mov     rax, [rbp-8]
4229808    mov     esi, aConnect
4229813    mov     rdi, rax
4229816    call    _strcmp
4229821    test    eax, eax
4229823    jz      loc_408B2A
4229825    mov     rax, [rbp-8]
4229829    mov     esi, aPut
4229834    mov     rdi, rax
4229837    call    _strcmp
4229842    test    eax, eax
4229844    jz      loc_408B2A
4229846    mov     rax, [rbp-8]
4229850    mov     esi, aDelete
4229855    mov     rdi, rax
4229858    call    _strcmp
4229863    test    eax, eax
4229865    jz      loc_408B2A
4229867    mov     rax, [rbp-8]
4229871    mov     esi, aOptions_0
4229876    mov     rdi, rax
4229879    call    _strcmp
4229884    test    eax, eax
4229886    jz      loc_408B2A
4229888    mov     rax, [rbp-8]
4229892    mov     esi, aPropfind
4229897    mov     rdi, rax
4229900    call    _strcmp
4229905    test    eax, eax
4229907    jz      loc_408B2A
4229909    mov     rax, [rbp-8]
4229913    mov     esi, aMkcol
4229918    mov     rdi, rax
4229921    call    _strcmp
4229926    test    eax, eax
4229928    jnz     loc_408B31
loc_408B2A:
4229930    mov     eax, 1
4229935    jmp     locret_408B36
loc_408B31:
4229937    mov     eax, 0
locret_408B36:
4229942    leave   
4229943    retn    
USE32

section .text

global _parse_http_message

_parse_http_message:
4229944    push    rbp
4229945    mov     rbp, rsp
4229948    sub     rsp, 30h
4229952    call    _mcount
4229957    mov     [rbp-18h], rdi
4229961    mov     [rbp-20h], rsi
4229965    mov     [rbp-28h], rdx
4229969    mov     rax, [rbp-28h]
4229973    mov     qword [rax+18h], 0
4229981    mov     rax, [rbp-28h]
4229985    mov     rdx, [rax+18h]
4229989    mov     rax, [rbp-28h]
4229993    mov     [rax+10h], rdx
4229997    mov     rax, [rbp-28h]
4230001    mov     rdx, [rax+10h]
4230005    mov     rax, [rbp-28h]
4230009    mov     [rax+8], rdx
4230013    mov     rax, [rbp-28h]
4230017    mov     rdx, [rax+8]
4230021    mov     rax, [rbp-28h]
4230025    mov     [rax], rdx
4230028    mov     rax, [rbp-28h]
4230032    mov     qword [rax+270h], 0
4230043    mov     rax, [rbp-28h]
4230047    mov     dword [rax+278h], 0
4230057    mov     rax, [rbp-28h]
4230061    mov     edx, [rax+278h]
4230067    mov     rax, [rbp-28h]
4230071    mov     [rax+27Ch], edx
4230077    mov     rax, [rbp-28h]
4230081    mov     edx, [rax+27Ch]
4230087    mov     rax, [rbp-28h]
4230091    mov     [rax+84h], edx
4230097    cmp     qword [rbp-20h], 0
4230102    jnz     loc_408BE4
4230104    mov     rax, 0FFFFFFFFFFFFFFFFh
4230111    jmp     locret_408DE2
loc_408BE4:
4230116    mov     rax, [rbp-18h]
4230120    mov     rdx, [rbp-20h]
4230124    sub     rdx, 1
4230128    add     rax, rdx
4230131    mov     byte [rax], 0
4230134    jmp     loc_408C04
loc_408BF8:
4230136    mov     rax, [rbp-18h]
4230140    add     rax, 1
4230144    mov     [rbp-18h], rax
loc_408C04:
4230148    mov     rax, [rbp-18h]
4230152    movzx   eax, byte [rax]
4230155    test    al, al
4230157    jz      loc_408C36
4230159    call    ___ctype_b_loc
4230164    mov     rdx, [rax]
4230167    mov     rax, [rbp-18h]
4230171    movzx   eax, byte [rax]
4230174    movzx   eax, al
4230177    add     rax, rax
4230180    add     rax, rdx
4230183    movzx   eax, word [rax]
4230186    movzx   eax, ax
4230189    and     eax, 2000h
4230194    test    eax, eax
4230196    jnz     loc_408BF8
loc_408C36:
4230198    lea     rax, [rbp-18h]
4230202    mov     esi, asc_415CD6
4230207    mov     rdi, rax
4230210    call    _skip
4230215    mov     rdx, [rbp-28h]
4230219    mov     [rdx], rax
4230222    lea     rax, [rbp-18h]
4230226    mov     esi, asc_415CD6
4230231    mov     rdi, rax
4230234    call    _skip
4230239    mov     rdx, [rbp-28h]
4230243    mov     [rdx+8], rax
4230247    lea     rax, [rbp-18h]
4230251    mov     esi, unk_414B63
4230256    mov     rdi, rax
4230259    call    _skip
4230264    mov     rdx, [rbp-28h]
4230268    mov     [rdx+10h], rax
4230272    mov     rax, [rbp-28h]
4230276    mov     rax, [rax]
4230279    mov     rdi, rax
4230282    call    _is_valid_http_method
4230287    mov     [rbp-8], eax
4230290    cmp     dword [rbp-8], 0
4230294    jz      loc_408CB6
4230296    mov     rax, [rbp-28h]
4230300    mov     rax, [rax+10h]
4230304    mov     edx, 5
4230309    mov     esi, aHttp
4230314    mov     rdi, rax
4230317    call    _memcmp
4230322    test    eax, eax
4230324    jnz     loc_408CD9
loc_408CB6:
4230326    cmp     dword [rbp-8], 0
4230330    jnz     loc_408CE6
4230332    mov     rax, [rbp-28h]
4230336    mov     rax, [rax]
4230339    mov     edx, 5
4230344    mov     esi, aHttp
4230349    mov     rdi, rax
4230352    call    _memcmp
4230357    test    eax, eax
4230359    jz      loc_408CE6
loc_408CD9:
4230361    mov     qword [rbp-20h], 0FFFFFFFFFFFFFFFFh
4230369    jmp     loc_408DDE
loc_408CE6:
4230374    cmp     dword [rbp-8], 0
4230378    jz      loc_408D02
4230380    mov     rax, [rbp-28h]
4230384    mov     rax, [rax+10h]
4230388    lea     rdx, [rax+5]
4230392    mov     rax, [rbp-28h]
4230396    mov     [rax+10h], rdx
4230400    jmp     loc_408D1C
loc_408D02:
4230402    mov     rax, [rbp-28h]
4230406    mov     rax, [rax+8]
4230410    mov     rdi, rax
4230413    call    _atoi
4230418    mov     rdx, [rbp-28h]
4230422    mov     [rdx+27Ch], eax
loc_408D1C:
4230428    mov     rdx, [rbp-28h]
4230432    lea     rax, [rbp-18h]
4230436    mov     rsi, rdx
4230439    mov     rdi, rax
4230442    call    _parse_http_headers
4230447    mov     rax, [rbp-28h]
4230451    mov     rax, [rax+8]
4230455    mov     esi, 3Fh
4230460    mov     rdi, rax
4230463    call    _strchr
4230468    mov     rdx, [rbp-28h]
4230472    mov     [rdx+18h], rax
4230476    mov     rax, [rbp-28h]
4230480    mov     rax, [rax+18h]
4230484    test    rax, rax
4230487    jz      loc_408D70
4230489    mov     rax, [rbp-28h]
4230493    mov     rax, [rax+18h]
4230497    lea     rcx, [rax+1]
4230501    mov     rdx, [rbp-28h]
4230505    mov     [rdx+18h], rcx
4230509    mov     byte [rax], 0
loc_408D70:
4230512    mov     rax, [rbp-28h]
4230516    mov     rax, [rax+8]
4230520    mov     rdi, rax
4230523    call    _strlen
4230528    mov     [rbp-4], eax
4230531    mov     eax, [rbp-4]
4230534    add     eax, 1
4230537    movsxd  rcx, eax
4230540    mov     rax, [rbp-28h]
4230544    mov     rdx, [rax+8]
4230548    mov     eax, [rbp-4]
4230551    movsxd  rsi, eax
4230554    mov     rax, [rbp-28h]
4230558    mov     rax, [rax+8]
4230562    mov     r8d, 0
4230568    mov     rdi, rax
4230571    call    _mg_url_decode
4230576    mov     rax, [rbp-28h]
4230580    mov     rax, [rax+8]
4230584    movzx   eax, byte [rax]
4230587    cmp     al, 2Fh
4230589    jz      loc_408DCE
4230591    mov     rax, [rbp-28h]
4230595    mov     rax, [rax+8]
4230599    movzx   eax, byte [rax]
4230602    cmp     al, 2Eh
4230604    jnz     loc_408DDE
loc_408DCE:
4230606    mov     rax, [rbp-28h]
4230610    mov     rax, [rax+8]
4230614    mov     rdi, rax
4230617    call    _remove_double_dots_and_double_slashes
loc_408DDE:
4230622    mov     rax, [rbp-20h]
locret_408DE2:
4230626    leave   
4230627    retn    
USE32

section .text

global _lowercase

_lowercase:
4230628    push    rbp
4230629    mov     rbp, rsp
4230632    sub     rsp, 10h
4230636    call    _mcount
4230641    mov     [rbp-8], rdi
4230645    mov     rax, [rbp-8]
4230649    movzx   eax, byte [rax]
4230652    movzx   eax, al
4230655    mov     edi, eax
4230657    call    _tolower
4230662    leave   
4230663    retn    
USE32

section .text

global _mg_strcasecmp

_mg_strcasecmp:
4230664    push    rbp
4230665    mov     rbp, rsp
4230668    push    rbx
4230669    sub     rsp, 28h
4230673    call    _mcount
4230678    mov     [rbp-28h], rdi
4230682    mov     [rbp-30h], rsi
loc_408E1E:
4230686    mov     rax, [rbp-28h]
4230690    lea     rdx, [rax+1]
4230694    mov     [rbp-28h], rdx
4230698    mov     rdi, rax
4230701    call    _lowercase
4230706    mov     ebx, eax
4230708    mov     rax, [rbp-30h]
4230712    lea     rdx, [rax+1]
4230716    mov     [rbp-30h], rdx
4230720    mov     rdi, rax
4230723    call    _lowercase
4230728    sub     ebx, eax
4230730    mov     eax, ebx
4230732    mov     [rbp-14h], eax
4230735    cmp     dword [rbp-14h], 0
4230739    jnz     loc_408E64
4230741    mov     rax, [rbp-28h]
4230745    sub     rax, 1
4230749    movzx   eax, byte [rax]
4230752    test    al, al
4230754    jnz     loc_408E1E
loc_408E64:
4230756    mov     eax, [rbp-14h]
4230759    add     rsp, 28h
4230763    pop     rbx
4230764    pop     rbp
4230765    retn    
USE32

section .text

global _mg_strncasecmp

_mg_strncasecmp:
4230766    push    rbp
4230767    mov     rbp, rsp
4230770    push    rbx
4230771    sub     rsp, 38h
4230775    call    _mcount
4230780    mov     [rbp-28h], rdi
4230784    mov     [rbp-30h], rsi
4230788    mov     [rbp-38h], rdx
4230792    mov     dword [rbp-14h], 0
4230799    cmp     qword [rbp-38h], 0
4230804    jz      loc_408EE8
loc_408E96:
4230806    mov     rax, [rbp-28h]
4230810    lea     rdx, [rax+1]
4230814    mov     [rbp-28h], rdx
4230818    mov     rdi, rax
4230821    call    _lowercase
4230826    mov     ebx, eax
4230828    mov     rax, [rbp-30h]
4230832    lea     rdx, [rax+1]
4230836    mov     [rbp-30h], rdx
4230840    mov     rdi, rax
4230843    call    _lowercase
4230848    sub     ebx, eax
4230850    mov     eax, ebx
4230852    mov     [rbp-14h], eax
4230855    cmp     dword [rbp-14h], 0
4230859    jnz     loc_408EE8
4230861    mov     rax, [rbp-28h]
4230865    sub     rax, 1
4230869    movzx   eax, byte [rax]
4230872    test    al, al
4230874    jz      loc_408EE8
4230876    sub     qword [rbp-38h], 1
4230881    cmp     qword [rbp-38h], 0
4230886    jnz     loc_408E96
loc_408EE8:
4230888    mov     eax, [rbp-14h]
4230891    add     rsp, 38h
4230895    pop     rbx
4230896    pop     rbp
4230897    retn    
USE32

section .text

global _mg_get_header

_mg_get_header:
4230898    push    rbp
4230899    mov     rbp, rsp
4230902    sub     rsp, 20h
4230906    call    _mcount
4230911    mov     [rbp-18h], rdi
4230915    mov     [rbp-20h], rsi
4230919    mov     dword [rbp-4], 0
4230926    jmp     loc_408F61
loc_408F10:
4230928    mov     rax, [rbp-18h]
4230932    mov     edx, [rbp-4]
4230935    movsxd  rdx, edx
4230938    add     rdx, 8
4230942    shl     rdx, 4
4230946    add     rax, rdx
4230949    add     rax, 8
4230953    mov     rdx, [rax]
4230956    mov     rax, [rbp-20h]
4230960    mov     rsi, rdx
4230963    mov     rdi, rax
4230966    call    _mg_strcasecmp
4230971    test    eax, eax
4230973    jnz     loc_408F5D
4230975    mov     rax, [rbp-18h]
4230979    mov     edx, [rbp-4]
4230982    movsxd  rdx, edx
4230985    add     rdx, 8
4230989    shl     rdx, 4
4230993    add     rax, rdx
4230996    add     rax, 10h
4231000    mov     rax, [rax]
4231003    jmp     locret_408F75
loc_408F5D:
4231005    add     dword [rbp-4], 1
loc_408F61:
4231009    mov     rax, [rbp-18h]
4231013    mov     eax, [rax+84h]
4231019    cmp     eax, [rbp-4]
4231022    jg      loc_408F10
4231024    mov     eax, 0
locret_408F75:
4231029    leave   
4231030    retn    
USE32

section .text

global _mg_match_prefix

_mg_match_prefix:
4231031    push    rbp
4231032    mov     rbp, rsp
4231035    push    rbx
4231036    sub     rsp, 48h
4231040    call    _mcount
4231045    mov     [rbp-38h], rdi
4231049    mov     [rbp-40h], rsi
4231053    mov     [rbp-48h], rdx
4231057    mov     dword [rbp-24h], 0
4231064    mov     dword [rbp-20h], 0
4231071    mov     rdx, [rbp-40h]
4231075    mov     rax, [rbp-38h]
4231079    mov     esi, 7Ch
4231084    mov     rdi, rax
4231087    call    _memchr
4231092    mov     [rbp-18h], rax
4231096    cmp     qword [rbp-18h], 0
4231101    jz      loc_409021
4231103    mov     rdx, [rbp-18h]
4231107    mov     rax, [rbp-38h]
4231111    mov     rcx, rdx
4231114    sub     rcx, rax
4231117    mov     rdx, [rbp-48h]
4231121    mov     rax, [rbp-38h]
4231125    mov     rsi, rcx
4231128    mov     rdi, rax
4231131    call    _mg_match_prefix
4231136    mov     [rbp-1Ch], eax
4231139    cmp     dword [rbp-1Ch], 0
4231143    jg      loc_409019
4231145    mov     rdx, [rbp-38h]
4231149    mov     rax, [rbp-18h]
4231153    sub     rdx, rax
4231156    mov     rax, [rbp-40h]
4231160    sub     rax, 1
4231164    lea     rsi, [rdx+rax]
4231168    mov     rax, [rbp-18h]
4231172    lea     rcx, [rax+1]
4231176    mov     rax, [rbp-48h]
4231180    mov     rdx, rax
4231183    mov     rdi, rcx
4231186    call    _mg_match_prefix
4231191    jmp     loc_40901C
loc_409019:
4231193    mov     eax, [rbp-1Ch]
loc_40901C:
4231196    jmp     loc_4091C9
loc_409021:
4231201    jmp     loc_4091B7
loc_409026:
4231206    mov     eax, [rbp-24h]
4231209    movsxd  rdx, eax
4231212    mov     rax, [rbp-38h]
4231216    add     rax, rdx
4231219    movzx   eax, byte [rax]
4231222    cmp     al, 3Fh
4231224    jnz     loc_409053
4231226    mov     eax, [rbp-20h]
4231229    movsxd  rdx, eax
4231232    mov     rax, [rbp-48h]
4231236    add     rax, rdx
4231239    movzx   eax, byte [rax]
4231242    test    al, al
4231244    jz      loc_409053
4231246    jmp     loc_4091AF
loc_409053:
4231251    mov     eax, [rbp-24h]
4231254    movsxd  rdx, eax
4231257    mov     rax, [rbp-38h]
4231261    add     rax, rdx
4231264    movzx   eax, byte [rax]
4231267    cmp     al, 24h
4231269    jnz     loc_40908A
4231271    mov     eax, [rbp-20h]
4231274    movsxd  rdx, eax
4231277    mov     rax, [rbp-48h]
4231281    add     rax, rdx
4231284    movzx   eax, byte [rax]
4231287    test    al, al
4231289    jnz     loc_409080
4231291    mov     eax, [rbp-20h]
4231294    jmp     loc_409085
loc_409080:
4231296    mov     eax, 0FFFFFFFFh
loc_409085:
4231301    jmp     loc_4091C9
loc_40908A:
4231306    mov     eax, [rbp-24h]
4231309    movsxd  rdx, eax
4231312    mov     rax, [rbp-38h]
4231316    add     rax, rdx
4231319    movzx   eax, byte [rax]
4231322    cmp     al, 2Ah
4231324    jnz     loc_409178
4231330    add     dword [rbp-24h], 1
4231334    mov     eax, [rbp-24h]
4231337    movsxd  rdx, eax
4231340    mov     rax, [rbp-38h]
4231344    add     rax, rdx
4231347    movzx   eax, byte [rax]
4231350    cmp     al, 2Ah
4231352    jnz     loc_4090D8
4231354    add     dword [rbp-24h], 1
4231358    mov     eax, [rbp-20h]
4231361    movsxd  rdx, eax
4231364    mov     rax, [rbp-48h]
4231368    add     rax, rdx
4231371    mov     rdi, rax
4231374    call    _strlen
4231379    mov     [rbp-28h], eax
4231382    jmp     loc_4090F5
loc_4090D8:
4231384    mov     eax, [rbp-20h]
4231387    movsxd  rdx, eax
4231390    mov     rax, [rbp-48h]
4231394    add     rax, rdx
4231397    mov     esi, reject
4231402    mov     rdi, rax
4231405    call    _strcspn
4231410    mov     [rbp-28h], eax
loc_4090F5:
4231413    mov     eax, [rbp-24h]
4231416    cdqe    
4231418    cmp     rax, [rbp-40h]
4231422    jnz     loc_40910D
4231424    mov     eax, [rbp-28h]
4231427    mov     edx, [rbp-20h]
4231430    add     eax, edx
4231432    jmp     loc_4091C9
loc_40910D:
4231437    mov     eax, [rbp-20h]
4231440    movsxd  rdx, eax
4231443    mov     eax, [rbp-28h]
4231446    cdqe    
4231448    add     rdx, rax
4231451    mov     rax, [rbp-48h]
4231455    add     rdx, rax
4231458    mov     eax, [rbp-24h]
4231461    cdqe    
4231463    mov     rcx, [rbp-40h]
4231467    sub     rcx, rax
4231470    mov     eax, [rbp-24h]
4231473    movsxd  rsi, eax
4231476    mov     rax, [rbp-38h]
4231480    add     rax, rsi
4231483    mov     rsi, rcx
4231486    mov     rdi, rax
4231489    call    _mg_match_prefix
4231494    mov     [rbp-1Ch], eax
4231497    cmp     dword [rbp-1Ch], 0FFFFFFFFh
4231501    jnz     loc_40915C
4231503    mov     eax, [rbp-28h]
4231506    lea     edx, [rax-1]
4231509    mov     [rbp-28h], edx
4231512    test    eax, eax
4231514    jg      loc_40910D
loc_40915C:
4231516    cmp     dword [rbp-1Ch], 0FFFFFFFFh
4231520    jz      loc_409171
4231522    mov     eax, [rbp-1Ch]
4231525    mov     edx, [rbp-20h]
4231528    add     edx, eax
4231530    mov     eax, [rbp-28h]
4231533    add     eax, edx
4231535    jmp     loc_409176
loc_409171:
4231537    mov     eax, 0FFFFFFFFh
loc_409176:
4231542    jmp     loc_4091C9
loc_409178:
4231544    mov     eax, [rbp-24h]
4231547    movsxd  rdx, eax
4231550    mov     rax, [rbp-38h]
4231554    add     rax, rdx
4231557    mov     rdi, rax
4231560    call    _lowercase
4231565    mov     ebx, eax
4231567    mov     eax, [rbp-20h]
4231570    movsxd  rdx, eax
4231573    mov     rax, [rbp-48h]
4231577    add     rax, rdx
4231580    mov     rdi, rax
4231583    call    _lowercase
4231588    cmp     ebx, eax
4231590    jz      loc_4091AF
4231592    mov     eax, 0FFFFFFFFh
4231597    jmp     loc_4091C9
loc_4091AF:
4231599    add     dword [rbp-24h], 1
4231603    add     dword [rbp-20h], 1
loc_4091B7:
4231607    mov     eax, [rbp-24h]
4231610    cdqe    
4231612    cmp     rax, [rbp-40h]
4231616    jl      loc_409026
4231622    mov     eax, [rbp-20h]
loc_4091C9:
4231625    add     rsp, 48h
4231629    pop     rbx
4231630    pop     rbp
4231631    retn    
USE32

section .text

global _mg_template

_mg_template:
4231632    push    rbp
4231633    mov     rbp, rsp
4231636    sub     rsp, 40h
4231640    call    _mcount
4231645    mov     [rbp-28h], rdi
4231649    mov     [rbp-30h], rsi
4231653    mov     [rbp-38h], rdx
4231657    mov     dword [rbp-10h], 0
4231664    mov     dword [rbp-0Ch], 0
4231671    mov     dword [rbp-18h], 0
4231678    jmp     loc_40936B
loc_409203:
4231683    cmp     dword [rbp-0Ch], 0
4231687    jnz     loc_409265
4231689    mov     eax, [rbp-18h]
4231692    movsxd  rdx, eax
4231695    mov     rax, [rbp-30h]
4231699    add     rax, rdx
4231702    mov     edx, 2
4231707    mov     esi, asc_41605A
4231712    mov     rdi, rax
4231715    call    _memcmp
4231720    test    eax, eax
4231722    jnz     loc_409265
4231724    mov     eax, [rbp-18h]
4231727    cmp     eax, [rbp-10h]
4231730    jle     loc_409258
4231732    mov     eax, [rbp-10h]
4231735    mov     edx, [rbp-18h]
4231738    sub     edx, eax
4231740    mov     eax, [rbp-10h]
4231743    movsxd  rcx, eax
4231746    mov     rax, [rbp-30h]
4231750    add     rcx, rax
4231753    mov     rax, [rbp-28h]
4231757    mov     rsi, rcx
4231760    mov     rdi, rax
4231763    call    _mg_send_data
loc_409258:
4231768    mov     eax, [rbp-18h]
4231771    mov     [rbp-10h], eax
4231774    mov     dword [rbp-0Ch], 1
loc_409265:
4231781    cmp     dword [rbp-0Ch], 1
4231785    jnz     loc_409367
4231791    mov     eax, [rbp-18h]
4231794    movsxd  rdx, eax
4231797    mov     rax, [rbp-30h]
4231801    add     rax, rdx
4231804    mov     edx, 2
4231809    mov     esi, asc_41605D
4231814    mov     rdi, rax
4231817    call    _memcmp
4231822    test    eax, eax
4231824    jnz     loc_409367
4231830    mov     dword [rbp-14h], 0
4231837    jmp     loc_409341
loc_4092A2:
4231842    mov     eax, [rbp-14h]
4231845    cdqe    
4231847    shl     rax, 4
4231851    mov     rdx, rax
4231854    mov     rax, [rbp-38h]
4231858    add     rax, rdx
4231861    mov     rax, [rax]
4231864    mov     [rbp-8], rax
4231868    mov     rax, [rbp-8]
4231872    mov     rdi, rax
4231875    call    _strlen
4231880    mov     edx, eax
4231882    mov     eax, 0FFFFFFFEh
4231887    sub     eax, [rbp-10h]
4231890    mov     ecx, eax
4231892    mov     eax, [rbp-18h]
4231895    add     eax, ecx
4231897    cmp     edx, eax
4231899    jnz     loc_40933D
4231901    mov     eax, 0FFFFFFFEh
4231906    sub     eax, [rbp-10h]
4231909    mov     edx, eax
4231911    mov     eax, [rbp-18h]
4231914    add     eax, edx
4231916    movsxd  rdx, eax
4231919    mov     eax, [rbp-10h]
4231922    cdqe    
4231924    lea     rcx, [rax+2]
4231928    mov     rax, [rbp-30h]
4231932    add     rcx, rax
4231935    mov     rax, [rbp-8]
4231939    mov     rsi, rcx
4231942    mov     rdi, rax
4231945    call    _memcmp
4231950    test    eax, eax
4231952    jnz     loc_40933D
4231954    mov     eax, [rbp-14h]
4231957    cdqe    
4231959    shl     rax, 4
4231963    mov     rdx, rax
4231966    mov     rax, [rbp-38h]
4231970    add     rax, rdx
4231973    mov     rax, [rax+8]
4231977    mov     rdx, [rbp-28h]
4231981    mov     rdi, rdx
4231984    call    rax
4231986    mov     eax, [rbp-18h]
4231989    add     eax, 2
4231992    mov     [rbp-10h], eax
4231995    jmp     loc_409360
loc_40933D:
4231997    add     dword [rbp-14h], 1
loc_409341:
4232001    mov     eax, [rbp-14h]
4232004    cdqe    
4232006    shl     rax, 4
4232010    mov     rdx, rax
4232013    mov     rax, [rbp-38h]
4232017    add     rax, rdx
4232020    mov     rax, [rax]
4232023    test    rax, rax
4232026    jnz     loc_4092A2
loc_409360:
4232032    mov     dword [rbp-0Ch], 0
loc_409367:
4232039    add     dword [rbp-18h], 1
loc_40936B:
4232043    mov     eax, [rbp-18h]
4232046    movsxd  rdx, eax
4232049    mov     rax, [rbp-30h]
4232053    add     rax, rdx
4232056    movzx   eax, byte [rax]
4232059    test    al, al
4232061    jnz     loc_409203
4232067    mov     eax, [rbp-18h]
4232070    cmp     eax, [rbp-10h]
4232073    jle     locret_4093AF
4232075    mov     eax, [rbp-10h]
4232078    mov     edx, [rbp-18h]
4232081    sub     edx, eax
4232083    mov     eax, [rbp-10h]
4232086    movsxd  rcx, eax
4232089    mov     rax, [rbp-30h]
4232093    add     rcx, rax
4232096    mov     rax, [rbp-28h]
4232100    mov     rsi, rcx
4232103    mov     rdi, rax
4232106    call    _mg_send_data
locret_4093AF:
4232111    leave   
4232112    retn    
USE32

section .text

global _is_dav_request

_is_dav_request:
4232113    push    rbp
4232114    mov     rbp, rsp
4232117    sub     rsp, 20h
4232121    call    _mcount
4232126    mov     [rbp-18h], rdi
4232130    mov     rax, [rbp-18h]
4232134    mov     rax, [rax+8]
4232138    mov     [rbp-8], rax
4232142    mov     rax, [rbp-8]
4232146    mov     esi, aPut
4232151    mov     rdi, rax
4232154    call    _strcmp
4232159    test    eax, eax
4232161    jz      loc_409422
4232163    mov     rax, [rbp-8]
4232167    mov     esi, aDelete
4232172    mov     rdi, rax
4232175    call    _strcmp
4232180    test    eax, eax
4232182    jz      loc_409422
4232184    mov     rax, [rbp-8]
4232188    mov     esi, aMkcol
4232193    mov     rdi, rax
4232196    call    _strcmp
4232201    test    eax, eax
4232203    jz      loc_409422
4232205    mov     rax, [rbp-8]
4232209    mov     esi, aPropfind
4232214    mov     rdi, rax
4232217    call    _strcmp
4232222    test    eax, eax
4232224    jnz     loc_409429
loc_409422:
4232226    mov     eax, 1
4232231    jmp     locret_40942E
loc_409429:
4232233    mov     eax, 0
locret_40942E:
4232238    leave   
4232239    retn    
USE32

section .text

global _must_hide_file

_must_hide_file:
4232240    push    rbp
4232241    mov     rbp, rsp
4232244    sub     rsp, 20h
4232248    call    _mcount
4232253    mov     [rbp-18h], rdi
4232257    mov     [rbp-20h], rsi
4232261    mov     qword [rbp-10h], a_htpasswd
4232269    mov     rax, [rbp-18h]
4232273    mov     rax, [rax+2A8h]
4232280    mov     rax, [rax+98h]
4232287    mov     [rbp-8], rax
4232291    mov     rax, [rbp-10h]
4232295    mov     rdi, rax
4232298    call    _strlen
4232303    mov     rcx, rax
4232306    mov     rdx, [rbp-20h]
4232310    mov     rax, [rbp-10h]
4232314    mov     rsi, rcx
4232317    mov     rdi, rax
4232320    call    _mg_match_prefix
4232325    test    eax, eax
4232327    jg      loc_4094B6
4232329    cmp     qword [rbp-8], 0
4232334    jz      loc_4094BD
4232336    mov     rax, [rbp-8]
4232340    mov     rdi, rax
4232343    call    _strlen
4232348    mov     rcx, rax
4232351    mov     rdx, [rbp-20h]
4232355    mov     rax, [rbp-8]
4232359    mov     rsi, rcx
4232362    mov     rdi, rax
4232365    call    _mg_match_prefix
4232370    test    eax, eax
4232372    jle     loc_4094BD
loc_4094B6:
4232374    mov     eax, 1
4232379    jmp     locret_4094C2
loc_4094BD:
4232381    mov     eax, 0
locret_4094C2:
4232386    leave   
4232387    retn    
USE32

section .text

global _convert_uri_to_file_name

_convert_uri_to_file_name:
4232388    push    rbp
4232389    mov     rbp, rsp
4232392    sub     rsp, 90h
4232399    call    _mcount
4232404    mov     [rbp-78h], rdi
4232408    mov     [rbp-80h], rsi
4232412    mov     [rbp-88h], rdx
4232419    mov     [rbp-90h], rcx
4232426    mov     rax, [rbp-78h]
4232430    mov     rax, [rax+2A8h]
4232437    mov     rax, [rax+0C8h]
4232444    mov     [rbp-70h], rax
4232448    mov     rax, [rbp-78h]
4232452    mov     rdi, rax
4232455    call    _is_dav_request
4232460    test    eax, eax
4232462    jz      loc_409535
4232464    mov     rax, [rbp-78h]
4232468    mov     rax, [rax+2A8h]
4232475    mov     rax, [rax+68h]
4232479    test    rax, rax
4232482    jz      loc_409535
4232484    mov     rax, [rbp-78h]
4232488    mov     rax, [rax+2A8h]
4232495    mov     rax, [rax+68h]
4232499    jmp     loc_409544
loc_409535:
4232501    mov     rax, [rbp-78h]
4232505    mov     rax, [rax+2A8h]
4232512    mov     rax, [rax+70h]
loc_409544:
4232516    mov     [rbp-68h], rax
4232520    mov     rax, [rbp-78h]
4232524    mov     rax, [rax+2A8h]
4232531    mov     rax, [rax+58h]
4232535    mov     [rbp-50h], rax
4232539    mov     rax, [rbp-78h]
4232543    mov     rax, [rax+10h]
4232547    mov     [rbp-48h], rax
4232551    mov     rax, [rbp-78h]
4232555    add     rax, 8
4232559    mov     esi, aHost
4232564    mov     rdi, rax
4232567    call    _mg_get_header
4232572    mov     [rbp-40h], rax
4232576    cmp     qword [rbp-68h], 0
4232581    jz      loc_409595
4232583    mov     rax, [rbp-68h]
4232587    mov     rdi, rax
4232590    call    _strlen
4232595    jmp     loc_40959A
loc_409595:
4232597    mov     eax, 0
loc_40959A:
4232602    mov     [rbp-58h], rax
4232606    cmp     qword [rbp-70h], 0
4232611    jz      loc_40966B
4232617    cmp     qword [rbp-40h], 0
4232622    jz      loc_40966B
4232628    mov     rax, [rbp-40h]
4232632    mov     esi, 3Ah
4232637    mov     rdi, rax
4232640    call    _strchr
4232645    mov     [rbp-38h], rax
4232649    cmp     qword [rbp-38h], 0
4232654    jnz     loc_4095DE
4232656    mov     rax, [rbp-40h]
4232660    mov     rdi, rax
4232663    call    _strlen
4232668    jmp     loc_4095EC
loc_4095DE:
4232670    mov     rdx, [rbp-38h]
4232674    mov     rax, [rbp-40h]
4232678    sub     rdx, rax
4232681    mov     rax, rdx
loc_4095EC:
4232684    mov     [rbp-30h], rax
4232688    jmp     loc_409649
loc_4095F2:
4232690    mov     rax, [rbp-18h]
4232694    cmp     rax, 1
4232698    jbe     loc_409649
4232700    mov     rax, [rbp-20h]
4232704    movzx   eax, byte [rax]
4232707    cmp     al, 40h
4232709    jnz     loc_409649
4232711    mov     rax, [rbp-18h]
4232715    mov     rdx, [rbp-30h]
4232719    add     rdx, 1
4232723    cmp     rax, rdx
4232726    jnz     loc_409649
4232728    mov     rax, [rbp-20h]
4232732    lea     rcx, [rax+1]
4232736    mov     rdx, [rbp-30h]
4232740    mov     rax, [rbp-40h]
4232744    mov     rsi, rax
4232747    mov     rdi, rcx
4232750    call    _mg_strncasecmp
4232755    test    eax, eax
4232757    jnz     loc_409649
4232759    mov     rax, [rbp-10h]
4232763    mov     [rbp-68h], rax
4232767    mov     rax, [rbp-8]
4232771    mov     [rbp-58h], rax
4232775    jmp     loc_40966B
loc_409649:
4232777    lea     rdx, [rbp-10h]
4232781    lea     rcx, [rbp-20h]
4232785    mov     rax, [rbp-70h]
4232789    mov     rsi, rcx
4232792    mov     rdi, rax
4232795    call    _next_option
4232800    mov     [rbp-70h], rax
4232804    cmp     qword [rbp-70h], 0
4232809    jnz     loc_4095F2
loc_40966B:
4232811    cmp     qword [rbp-68h], 0
4232816    jz      loc_409679
4232818    cmp     qword [rbp-58h], 0
4232823    jnz     loc_409683
loc_409679:
4232825    mov     eax, 0
4232830    jmp     locret_409839
loc_409683:
4232835    mov     rdi, [rbp-48h]
4232839    mov     rcx, [rbp-68h]
4232843    mov     rdx, [rbp-58h]
4232847    mov     rsi, [rbp-88h]
4232854    mov     rax, [rbp-80h]
4232858    mov     r9, rdi
4232861    mov     r8, rcx
4232864    mov     rcx, rdx
4232867    mov     edx, a_SS
4232872    mov     rdi, rax
4232875    mov     eax, 0
4232880    call    _mg_snprintf
4232885    mov     rax, [rbp-78h]
4232889    mov     rax, [rax+2A8h]
4232896    mov     rax, [rax+0C8h]
4232903    mov     [rbp-70h], rax
4232907    jmp     loc_409731
loc_4096CD:
4232909    mov     rax, [rbp-18h]
4232913    mov     rcx, rax
4232916    mov     rax, [rbp-20h]
4232920    mov     rdx, [rbp-48h]
4232924    mov     rsi, rcx
4232927    mov     rdi, rax
4232930    call    _mg_match_prefix
4232935    cdqe    
4232937    mov     [rbp-28h], rax
4232941    cmp     qword [rbp-28h], 0
4232946    jz      loc_409731
4232948    mov     rax, [rbp-28h]
4232952    mov     rdx, [rbp-48h]
4232956    lea     rdi, [rdx+rax]
4232960    mov     rcx, [rbp-10h]
4232964    mov     rax, [rbp-8]
4232968    mov     edx, eax
4232970    mov     rsi, [rbp-88h]
4232977    mov     rax, [rbp-80h]
4232981    mov     r9, rdi
4232984    mov     r8, rcx
4232987    mov     ecx, edx
4232989    mov     edx, a_SS
4232994    mov     rdi, rax
4232997    mov     eax, 0
4233002    call    _mg_snprintf
4233007    jmp     loc_409757
loc_409731:
4233009    lea     rdx, [rbp-10h]
4233013    lea     rcx, [rbp-20h]
4233017    mov     rax, [rbp-70h]
4233021    mov     rsi, rcx
4233024    mov     rdi, rax
4233027    call    _next_option
4233032    mov     [rbp-70h], rax
4233036    cmp     qword [rbp-70h], 0
4233041    jnz     loc_4096CD
loc_409757:
4233047    mov     rdx, [rbp-90h]
4233054    mov     rax, [rbp-80h]
4233058    mov     rsi, rdx
4233061    mov     rdi, rax
4233064    call    _stat64
4233069    test    eax, eax
4233071    jnz     loc_40977B
4233073    mov     eax, 1
4233078    jmp     locret_409839
loc_40977B:
4233083    mov     rax, [rbp-68h]
4233087    mov     rdi, rax
4233090    call    _strlen
4233095    lea     rdx, [rax+2]
4233099    mov     rax, [rbp-80h]
4233103    add     rax, rdx
4233106    mov     [rbp-60h], rax
4233110    jmp     loc_409825
loc_40979B:
4233115    mov     rax, [rbp-60h]
4233119    movzx   eax, byte [rax]
4233122    cmp     al, 2Fh
4233124    jnz     loc_409820
4233126    mov     rax, [rbp-60h]
4233130    mov     byte [rax], 0
4233133    mov     rax, [rbp-50h]
4233137    mov     rdi, rax
4233140    call    _strlen
4233145    mov     rcx, rax
4233148    mov     rdx, [rbp-80h]
4233152    mov     rax, [rbp-50h]
4233156    mov     rsi, rcx
4233159    mov     rdi, rax
4233162    call    _mg_match_prefix
4233167    test    eax, eax
4233169    jle     loc_409819
4233171    mov     rdx, [rbp-90h]
4233178    mov     rax, [rbp-80h]
4233182    mov     rsi, rdx
4233185    mov     rdi, rax
4233188    call    _stat64
4233193    test    eax, eax
4233195    jnz     loc_409819
4233197    mov     rax, [rbp-60h]
4233201    mov     byte [rax], 2Fh
4233204    mov     rax, [rbp-60h]
4233208    mov     rdi, rax
4233211    call    _mg_strdup
4233216    mov     rdx, [rbp-78h]
4233220    mov     [rdx+2C0h], rax
4233227    mov     rax, [rbp-60h]
4233231    mov     byte [rax], 0
4233234    mov     eax, 1
4233239    jmp     locret_409839
loc_409819:
4233241    mov     rax, [rbp-60h]
4233245    mov     byte [rax], 2Fh
loc_409820:
4233248    add     qword [rbp-60h], 1
loc_409825:
4233253    mov     rax, [rbp-60h]
4233257    movzx   eax, byte [rax]
4233260    test    al, al
4233262    jnz     loc_40979B
4233268    mov     eax, 0
locret_409839:
4233273    leave   
4233274    retn    
USE32

section .text

global _should_keep_alive

_should_keep_alive:
4233275    push    rbp
4233276    mov     rbp, rsp
4233279    sub     rsp, 30h
4233283    call    _mcount
4233288    mov     [rbp-28h], rdi
4233292    mov     rax, [rbp-28h]
4233296    sub     rax, 8
4233300    mov     [rbp-20h], rax
4233304    mov     rax, [rbp-28h]
4233308    mov     rax, [rax]
4233311    mov     [rbp-18h], rax
4233315    mov     rax, [rbp-28h]
4233319    mov     rax, [rax+10h]
4233323    mov     [rbp-10h], rax
4233327    mov     rax, [rbp-28h]
4233331    mov     esi, aConnection
4233336    mov     rdi, rax
4233339    call    _mg_get_header
4233344    mov     [rbp-8], rax
4233348    cmp     qword [rbp-18h], 0
4233353    jz      loc_4098F5
4233355    mov     rax, [rbp-18h]
4233359    mov     esi, aGet
4233364    mov     rdi, rax
4233367    call    _strcmp
4233372    test    eax, eax
4233374    jz      loc_4098AF
4233376    mov     rax, [rbp-20h]
4233380    mov     eax, [rax+2B8h]
4233386    cmp     eax, 3
4233389    jnz     loc_4098F5
loc_4098AF:
4233391    cmp     qword [rbp-8], 0
4233396    jz      loc_4098CB
4233398    mov     rax, [rbp-8]
4233402    mov     esi, aKeepAlive
4233407    mov     rdi, rax
4233410    call    _mg_strcasecmp
4233415    test    eax, eax
4233417    jz      loc_4098EE
loc_4098CB:
4233419    cmp     qword [rbp-8], 0
4233424    jnz     loc_4098F5
4233426    cmp     qword [rbp-10h], 0
4233431    jz      loc_4098F5
4233433    mov     rax, [rbp-10h]
4233437    mov     esi, a1_1
4233442    mov     rdi, rax
4233445    call    _strcmp
4233450    test    eax, eax
4233452    jnz     loc_4098F5
loc_4098EE:
4233454    mov     eax, 1
4233459    jmp     locret_4098FA
loc_4098F5:
4233461    mov     eax, 0
locret_4098FA:
4233466    leave   
4233467    retn    
USE32

section .text

global _mg_write

_mg_write:
4233468    push    rbp
4233469    mov     rbp, rsp
4233472    sub     rsp, 30h
4233476    call    _mcount
4233481    mov     [rbp-18h], rdi
4233485    mov     [rbp-20h], rsi
4233489    mov     [rbp-28h], rdx
4233493    mov     rax, [rbp-18h]
4233497    sub     rax, 8
4233501    mov     [rbp-8], rax
4233505    mov     rax, [rbp-8]
4233509    mov     rax, [rax]
4233512    mov     rdx, [rbp-28h]
4233516    mov     rcx, [rbp-20h]
4233520    mov     rsi, rcx
4233523    mov     rdi, rax
4233526    call    _ns_send
4233531    mov     rax, [rbp-8]
4233535    mov     rax, [rax]
4233538    mov     rax, [rax+58h]
4233542    leave   
4233543    retn    
USE32

section .text

global _mg_send_status

_mg_send_status:
4233544    push    rbp
4233545    mov     rbp, rsp
4233548    sub     rsp, 20h
4233552    call    _mcount
4233557    mov     [rbp-18h], rdi
4233561    mov     [rbp-1Ch], esi
4233564    mov     rax, [rbp-18h]
4233568    sub     rax, 8
4233572    mov     [rbp-8], rax
4233576    mov     rax, [rbp-18h]
4233580    mov     eax, [rax+27Ch]
4233586    test    eax, eax
4233588    jnz     loc_4099A9
4233590    mov     rax, [rbp-18h]
4233594    mov     edx, [rbp-1Ch]
4233597    mov     [rax+27Ch], edx
4233603    mov     eax, [rbp-1Ch]
4233606    mov     edi, eax
4233608    call    _status_code_to_str
4233613    mov     rcx, rax
4233616    mov     edx, [rbp-1Ch]
4233619    mov     rax, [rbp-18h]
4233623    mov     esi, aHttp1_1DS
4233628    mov     rdi, rax
4233631    mov     eax, 0
4233636    call    _mg_printf
loc_4099A9:
4233641    mov     rax, [rbp-8]
4233645    mov     rax, [rax]
4233648    mov     rdx, [rbp-8]
4233652    mov     rdx, [rdx]
4233655    mov     edx, [rdx+98h]
4233661    or      edx, 200000h
4233667    mov     [rax+98h], edx
4233673    leave   
4233674    retn    
USE32

section .text

global _mg_send_header

_mg_send_header:
4233675    push    rbp
4233676    mov     rbp, rsp
4233679    sub     rsp, 30h
4233683    call    _mcount
4233688    mov     [rbp-18h], rdi
4233692    mov     [rbp-20h], rsi
4233696    mov     [rbp-28h], rdx
4233700    mov     rax, [rbp-18h]
4233704    sub     rax, 8
4233708    mov     [rbp-8], rax
4233712    mov     rax, [rbp-18h]
4233716    mov     eax, [rax+27Ch]
4233722    test    eax, eax
4233724    jnz     loc_409A37
4233726    mov     rax, [rbp-18h]
4233730    mov     dword [rax+27Ch], 0C8h
4233740    mov     edi, 0C8h
4233745    call    _status_code_to_str
4233750    mov     rdx, rax
4233753    mov     rax, [rbp-18h]
4233757    mov     rcx, rdx
4233760    mov     edx, 0C8h
4233765    mov     esi, aHttp1_1DS
4233770    mov     rdi, rax
4233773    mov     eax, 0
4233778    call    _mg_printf
loc_409A37:
4233783    mov     rcx, [rbp-28h]
4233787    mov     rdx, [rbp-20h]
4233791    mov     rax, [rbp-18h]
4233795    mov     esi, aSS_1
4233800    mov     rdi, rax
4233803    mov     eax, 0
4233808    call    _mg_printf
4233813    mov     rax, [rbp-8]
4233817    mov     rax, [rax]
4233820    mov     rdx, [rbp-8]
4233824    mov     rdx, [rdx]
4233827    mov     edx, [rdx+98h]
4233833    or      edx, 200000h
4233839    mov     [rax+98h], edx
4233845    leave   
4233846    retn    
USE32

section .text

global _terminate_headers

_terminate_headers:
4233847    push    rbp
4233848    mov     rbp, rsp
4233851    sub     rsp, 20h
4233855    call    _mcount
4233860    mov     [rbp-18h], rdi
4233864    mov     rax, [rbp-18h]
4233868    sub     rax, 8
4233872    mov     [rbp-8], rax
4233876    mov     rax, [rbp-8]
4233880    mov     rax, [rax]
4233883    mov     eax, [rax+98h]
4233889    and     eax, 100000h
4233894    test    eax, eax
4233896    jnz     locret_409AF6
4233898    mov     rax, [rbp-18h]
4233902    mov     edx, aChunked
4233907    mov     esi, aTransferEncodi
4233912    mov     rdi, rax
4233915    call    _mg_send_header
4233920    mov     rax, [rbp-18h]
4233924    mov     edx, 2
4233929    mov     esi, unk_414B63
4233934    mov     rdi, rax
4233937    call    _mg_write
4233942    mov     rax, [rbp-8]
4233946    mov     rax, [rax]
4233949    mov     rdx, [rbp-8]
4233953    mov     rdx, [rdx]
4233956    mov     edx, [rdx+98h]
4233962    or      edx, 100000h
4233968    mov     [rax+98h], edx
locret_409AF6:
4233974    leave   
4233975    retn    
USE32

section .text

global _mg_send_data

_mg_send_data:
4233976    push    rbp
4233977    mov     rbp, rsp
4233980    sub     rsp, 30h
4233984    call    _mcount
4233989    mov     [rbp-18h], rdi
4233993    mov     [rbp-20h], rsi
4233997    mov     [rbp-24h], edx
4234000    mov     rax, [rbp-18h]
4234004    sub     rax, 8
4234008    mov     [rbp-8], rax
4234012    mov     rax, [rbp-18h]
4234016    mov     rdi, rax
4234019    call    _terminate_headers
4234024    mov     rax, [rbp-18h]
4234028    lea     rcx, [rax-8]
4234032    mov     edx, [rbp-24h]
4234035    mov     rax, [rbp-20h]
4234039    mov     rsi, rax
4234042    mov     rdi, rcx
4234045    call    _write_chunk
4234050    mov     rax, [rbp-8]
4234054    mov     rax, [rax]
4234057    mov     rax, [rax+58h]
4234061    leave   
4234062    retn    
USE32

section .text

global _mg_printf_data

_mg_printf_data:
4234063    push    rbp
4234064    mov     rbp, rsp
4234067    push    rbx
4234068    sub     rsp, 2108h
4234075    call    _mcount
4234080    mov     [rbp-2108h], rdi
4234087    mov     [rbp-0B0h], rdx
4234094    mov     [rbp-0A8h], rcx
4234101    mov     [rbp-0A0h], r8
4234108    mov     [rbp-98h], r9
4234115    test    al, al
4234117    jz      loc_409BAA
4234119    movaps  xmmword [rbp-90h], xmm0
4234126    movaps  xmmword [rbp-80h], xmm1
4234130    movaps  xmmword [rbp-70h], xmm2
4234134    movaps  xmmword [rbp-60h], xmm3
4234138    movaps  xmmword [rbp-50h], xmm4
4234142    movaps  xmmword [rbp-40h], xmm5
4234146    movaps  xmmword [rbp-30h], xmm6
4234150    movaps  xmmword [rbp-20h], xmm7
loc_409BAA:
4234154    mov     [rbp-2110h], rsi
4234161    mov     rax, [fs:28h]
4234170    mov     [rbp-0C8h], rax
4234177    xor     eax, eax
4234179    mov     rax, [rbp-2108h]
4234186    sub     rax, 8
4234190    mov     [rbp-20F0h], rax
4234197    lea     rax, [rbp-20D0h]
4234204    mov     [rbp-20F8h], rax
4234211    mov     rax, [rbp-2108h]
4234218    mov     rdi, rax
4234221    call    _terminate_headers
4234226    mov     dword [rbp-20E8h], 10h
4234236    mov     dword [rbp-20E4h], 30h
4234246    lea     rax, [rbp+10h]
4234250    mov     [rbp-20E0h], rax
4234257    lea     rax, [rbp-0C0h]
4234264    mov     [rbp-20D8h], rax
4234271    lea     rcx, [rbp-20E8h]
4234278    mov     rdx, [rbp-2110h]
4234285    lea     rax, [rbp-20F8h]
4234292    mov     esi, 2000h
4234297    mov     rdi, rax
4234300    call    _ns_avprintf
4234305    mov     [rbp-20FCh], eax
4234311    cmp     dword [rbp-20FCh], 0
4234318    js      loc_409C6F
4234320    mov     rcx, [rbp-20F8h]
4234327    mov     edx, [rbp-20FCh]
4234333    mov     rax, [rbp-20F0h]
4234340    mov     rsi, rcx
4234343    mov     rdi, rax
4234346    call    _write_chunk
loc_409C6F:
4234351    mov     rdx, [rbp-20F8h]
4234358    lea     rax, [rbp-20D0h]
4234365    cmp     rdx, rax
4234368    jz      loc_409C9D
4234370    mov     rax, [rbp-20F8h]
4234377    test    rax, rax
4234380    jz      loc_409C9D
4234382    mov     rax, [rbp-20F8h]
4234389    mov     rdi, rax
4234392    call    _free
loc_409C9D:
4234397    mov     rax, [rbp-20F0h]
4234404    mov     rax, [rax]
4234407    mov     rax, [rax+58h]
4234411    mov     rbx, [rbp-0C8h]
4234418    xor     rbx, [fs:28h]
4234427    jz      loc_409CC2
4234429    call    ___stack_chk_fail
loc_409CC2:
4234434    add     rsp, 2108h
4234441    pop     rbx
4234442    pop     rbp
4234443    retn    
USE32

section .text

global _is_big_endian

_is_big_endian:
4234444    push    rbp
4234445    mov     rbp, rsp
4234448    call    _mcount
4234453    mov     eax, n_6544
4234458    movzx   eax, byte [rax]
4234461    test    al, al
4234463    setz    al
4234466    movzx   eax, al
4234469    pop     rbp
4234470    retn    
USE32

section .text

global _blk0

_blk0:
4234471    push    rbp
4234472    mov     rbp, rsp
4234475    sub     rsp, 10h
4234479    call    _mcount
4234484    mov     [rbp-8], rdi
4234488    mov     [rbp-0Ch], esi
4234491    call    _is_big_endian
4234496    test    eax, eax
4234498    jnz     loc_409D3F
4234500    mov     rax, [rbp-8]
4234504    mov     edx, [rbp-0Ch]
4234507    movsxd  rdx, edx
4234510    mov     eax, [rax+rdx*4]
4234513    ror     eax, 8
4234516    and     eax, 0FF00FF00h
4234521    mov     ecx, eax
4234523    mov     rax, [rbp-8]
4234527    mov     edx, [rbp-0Ch]
4234530    movsxd  rdx, edx
4234533    mov     eax, [rax+rdx*4]
4234536    ror     eax, 18h
4234539    and     eax, 0FF00FFh
4234544    or      ecx, eax
4234546    mov     rax, [rbp-8]
4234550    mov     edx, [rbp-0Ch]
4234553    movsxd  rdx, edx
4234556    mov     [rax+rdx*4], ecx
loc_409D3F:
4234559    mov     rax, [rbp-8]
4234563    mov     edx, [rbp-0Ch]
4234566    movsxd  rdx, edx
4234569    mov     eax, [rax+rdx*4]
4234572    leave   
4234573    retn    
USE32

section .text

global _SHA1Transform

_SHA1Transform:
4234574    push    rbp
4234575    mov     rbp, rsp
4234578    push    rbx
4234579    sub     rsp, 78h
4234583    call    _mcount
4234588    mov     [rbp-78h], rdi
4234592    mov     [rbp-80h], rsi
4234596    mov     rax, [rbp-80h]
4234600    mov     rdx, [rax]
4234603    mov     [rbp-50h], rdx
4234607    mov     rdx, [rax+8]
4234611    mov     [rbp-48h], rdx
4234615    mov     rdx, [rax+10h]
4234619    mov     [rbp-40h], rdx
4234623    mov     rdx, [rax+18h]
4234627    mov     [rbp-38h], rdx
4234631    mov     rdx, [rax+20h]
4234635    mov     [rbp-30h], rdx
4234639    mov     rdx, [rax+28h]
4234643    mov     [rbp-28h], rdx
4234647    mov     rdx, [rax+30h]
4234651    mov     [rbp-20h], rdx
4234655    mov     rax, [rax+38h]
4234659    mov     [rbp-18h], rax
4234663    mov     rax, [rbp-78h]
4234667    mov     eax, [rax]
4234669    mov     [rbp-64h], eax
4234672    mov     rax, [rbp-78h]
4234676    mov     eax, [rax+4]
4234679    mov     [rbp-60h], eax
4234682    mov     rax, [rbp-78h]
4234686    mov     eax, [rax+8]
4234689    mov     [rbp-5Ch], eax
4234692    mov     rax, [rbp-78h]
4234696    mov     eax, [rax+0Ch]
4234699    mov     [rbp-58h], eax
4234702    mov     rax, [rbp-78h]
4234706    mov     eax, [rax+10h]
4234709    mov     [rbp-54h], eax
4234712    mov     eax, [rbp-58h]
4234715    mov     edx, [rbp-5Ch]
4234718    xor     eax, edx
4234720    and     eax, [rbp-60h]
4234723    xor     eax, [rbp-58h]
4234726    mov     ebx, eax
4234728    lea     rax, [rbp-50h]
4234732    mov     esi, 0
4234737    mov     rdi, rax
4234740    call    _blk0
4234745    lea     edx, [rbx+rax]
4234748    mov     eax, [rbp-64h]
4234751    ror     eax, 1Bh
4234754    add     edx, eax
4234756    mov     eax, [rbp-54h]
4234759    add     eax, edx
4234761    add     eax, 5A827999h
4234766    mov     [rbp-54h], eax
4234769    ror     dword [rbp-60h], 2
4234773    mov     eax, [rbp-5Ch]
4234776    mov     edx, [rbp-60h]
4234779    xor     eax, edx
4234781    and     eax, [rbp-64h]
4234784    xor     eax, [rbp-5Ch]
4234787    mov     ebx, eax
4234789    lea     rax, [rbp-50h]
4234793    mov     esi, 1
4234798    mov     rdi, rax
4234801    call    _blk0
4234806    lea     edx, [rbx+rax]
4234809    mov     eax, [rbp-54h]
4234812    ror     eax, 1Bh
4234815    add     edx, eax
4234817    mov     eax, [rbp-58h]
4234820    add     eax, edx
4234822    add     eax, 5A827999h
4234827    mov     [rbp-58h], eax
4234830    ror     dword [rbp-64h], 2
4234834    mov     eax, [rbp-60h]
4234837    mov     edx, [rbp-64h]
4234840    xor     eax, edx
4234842    and     eax, [rbp-54h]
4234845    xor     eax, [rbp-60h]
4234848    mov     ebx, eax
4234850    lea     rax, [rbp-50h]
4234854    mov     esi, 2
4234859    mov     rdi, rax
4234862    call    _blk0
4234867    lea     edx, [rbx+rax]
4234870    mov     eax, [rbp-58h]
4234873    ror     eax, 1Bh
4234876    add     edx, eax
4234878    mov     eax, [rbp-5Ch]
4234881    add     eax, edx
4234883    add     eax, 5A827999h
4234888    mov     [rbp-5Ch], eax
4234891    ror     dword [rbp-54h], 2
4234895    mov     eax, [rbp-64h]
4234898    mov     edx, [rbp-54h]
4234901    xor     eax, edx
4234903    and     eax, [rbp-58h]
4234906    xor     eax, [rbp-64h]
4234909    mov     ebx, eax
4234911    lea     rax, [rbp-50h]
4234915    mov     esi, 3
4234920    mov     rdi, rax
4234923    call    _blk0
4234928    lea     edx, [rbx+rax]
4234931    mov     eax, [rbp-5Ch]
4234934    ror     eax, 1Bh
4234937    add     edx, eax
4234939    mov     eax, [rbp-60h]
4234942    add     eax, edx
4234944    add     eax, 5A827999h
4234949    mov     [rbp-60h], eax
4234952    ror     dword [rbp-58h], 2
4234956    mov     eax, [rbp-54h]
4234959    mov     edx, [rbp-58h]
4234962    xor     eax, edx
4234964    and     eax, [rbp-5Ch]
4234967    xor     eax, [rbp-54h]
4234970    mov     ebx, eax
4234972    lea     rax, [rbp-50h]
4234976    mov     esi, 4
4234981    mov     rdi, rax
4234984    call    _blk0
4234989    lea     edx, [rbx+rax]
4234992    mov     eax, [rbp-60h]
4234995    ror     eax, 1Bh
4234998    add     edx, eax
4235000    mov     eax, [rbp-64h]
4235003    add     eax, edx
4235005    add     eax, 5A827999h
4235010    mov     [rbp-64h], eax
4235013    ror     dword [rbp-5Ch], 2
4235017    mov     eax, [rbp-58h]
4235020    mov     edx, [rbp-5Ch]
4235023    xor     eax, edx
4235025    and     eax, [rbp-60h]
4235028    xor     eax, [rbp-58h]
4235031    mov     ebx, eax
4235033    lea     rax, [rbp-50h]
4235037    mov     esi, 5
4235042    mov     rdi, rax
4235045    call    _blk0
4235050    lea     edx, [rbx+rax]
4235053    mov     eax, [rbp-64h]
4235056    ror     eax, 1Bh
4235059    add     edx, eax
4235061    mov     eax, [rbp-54h]
4235064    add     eax, edx
4235066    add     eax, 5A827999h
4235071    mov     [rbp-54h], eax
4235074    ror     dword [rbp-60h], 2
4235078    mov     eax, [rbp-5Ch]
4235081    mov     edx, [rbp-60h]
4235084    xor     eax, edx
4235086    and     eax, [rbp-64h]
4235089    xor     eax, [rbp-5Ch]
4235092    mov     ebx, eax
4235094    lea     rax, [rbp-50h]
4235098    mov     esi, 6
4235103    mov     rdi, rax
4235106    call    _blk0
4235111    lea     edx, [rbx+rax]
4235114    mov     eax, [rbp-54h]
4235117    ror     eax, 1Bh
4235120    add     edx, eax
4235122    mov     eax, [rbp-58h]
4235125    add     eax, edx
4235127    add     eax, 5A827999h
4235132    mov     [rbp-58h], eax
4235135    ror     dword [rbp-64h], 2
4235139    mov     eax, [rbp-60h]
4235142    mov     edx, [rbp-64h]
4235145    xor     eax, edx
4235147    and     eax, [rbp-54h]
4235150    xor     eax, [rbp-60h]
4235153    mov     ebx, eax
4235155    lea     rax, [rbp-50h]
4235159    mov     esi, 7
4235164    mov     rdi, rax
4235167    call    _blk0
4235172    lea     edx, [rbx+rax]
4235175    mov     eax, [rbp-58h]
4235178    ror     eax, 1Bh
4235181    add     edx, eax
4235183    mov     eax, [rbp-5Ch]
4235186    add     eax, edx
4235188    add     eax, 5A827999h
4235193    mov     [rbp-5Ch], eax
4235196    ror     dword [rbp-54h], 2
4235200    mov     eax, [rbp-64h]
4235203    mov     edx, [rbp-54h]
4235206    xor     eax, edx
4235208    and     eax, [rbp-58h]
4235211    xor     eax, [rbp-64h]
4235214    mov     ebx, eax
4235216    lea     rax, [rbp-50h]
4235220    mov     esi, 8
4235225    mov     rdi, rax
4235228    call    _blk0
4235233    lea     edx, [rbx+rax]
4235236    mov     eax, [rbp-5Ch]
4235239    ror     eax, 1Bh
4235242    add     edx, eax
4235244    mov     eax, [rbp-60h]
4235247    add     eax, edx
4235249    add     eax, 5A827999h
4235254    mov     [rbp-60h], eax
4235257    ror     dword [rbp-58h], 2
4235261    mov     eax, [rbp-54h]
4235264    mov     edx, [rbp-58h]
4235267    xor     eax, edx
4235269    and     eax, [rbp-5Ch]
4235272    xor     eax, [rbp-54h]
4235275    mov     ebx, eax
4235277    lea     rax, [rbp-50h]
4235281    mov     esi, 9
4235286    mov     rdi, rax
4235289    call    _blk0
4235294    lea     edx, [rbx+rax]
4235297    mov     eax, [rbp-60h]
4235300    ror     eax, 1Bh
4235303    add     edx, eax
4235305    mov     eax, [rbp-64h]
4235308    add     eax, edx
4235310    add     eax, 5A827999h
4235315    mov     [rbp-64h], eax
4235318    ror     dword [rbp-5Ch], 2
4235322    mov     eax, [rbp-58h]
4235325    mov     edx, [rbp-5Ch]
4235328    xor     eax, edx
4235330    and     eax, [rbp-60h]
4235333    xor     eax, [rbp-58h]
4235336    mov     ebx, eax
4235338    lea     rax, [rbp-50h]
4235342    mov     esi, 0Ah
4235347    mov     rdi, rax
4235350    call    _blk0
4235355    lea     edx, [rbx+rax]
4235358    mov     eax, [rbp-64h]
4235361    ror     eax, 1Bh
4235364    add     edx, eax
4235366    mov     eax, [rbp-54h]
4235369    add     eax, edx
4235371    add     eax, 5A827999h
4235376    mov     [rbp-54h], eax
4235379    ror     dword [rbp-60h], 2
4235383    mov     eax, [rbp-5Ch]
4235386    mov     edx, [rbp-60h]
4235389    xor     eax, edx
4235391    and     eax, [rbp-64h]
4235394    xor     eax, [rbp-5Ch]
4235397    mov     ebx, eax
4235399    lea     rax, [rbp-50h]
4235403    mov     esi, 0Bh
4235408    mov     rdi, rax
4235411    call    _blk0
4235416    lea     edx, [rbx+rax]
4235419    mov     eax, [rbp-54h]
4235422    ror     eax, 1Bh
4235425    add     edx, eax
4235427    mov     eax, [rbp-58h]
4235430    add     eax, edx
4235432    add     eax, 5A827999h
4235437    mov     [rbp-58h], eax
4235440    ror     dword [rbp-64h], 2
4235444    mov     eax, [rbp-60h]
4235447    mov     edx, [rbp-64h]
4235450    xor     eax, edx
4235452    and     eax, [rbp-54h]
4235455    xor     eax, [rbp-60h]
4235458    mov     ebx, eax
4235460    lea     rax, [rbp-50h]
4235464    mov     esi, 0Ch
4235469    mov     rdi, rax
4235472    call    _blk0
4235477    lea     edx, [rbx+rax]
4235480    mov     eax, [rbp-58h]
4235483    ror     eax, 1Bh
4235486    add     edx, eax
4235488    mov     eax, [rbp-5Ch]
4235491    add     eax, edx
4235493    add     eax, 5A827999h
4235498    mov     [rbp-5Ch], eax
4235501    ror     dword [rbp-54h], 2
4235505    mov     eax, [rbp-64h]
4235508    mov     edx, [rbp-54h]
4235511    xor     eax, edx
4235513    and     eax, [rbp-58h]
4235516    xor     eax, [rbp-64h]
4235519    mov     ebx, eax
4235521    lea     rax, [rbp-50h]
4235525    mov     esi, 0Dh
4235530    mov     rdi, rax
4235533    call    _blk0
4235538    lea     edx, [rbx+rax]
4235541    mov     eax, [rbp-5Ch]
4235544    ror     eax, 1Bh
4235547    add     edx, eax
4235549    mov     eax, [rbp-60h]
4235552    add     eax, edx
4235554    add     eax, 5A827999h
4235559    mov     [rbp-60h], eax
4235562    ror     dword [rbp-58h], 2
4235566    mov     eax, [rbp-54h]
4235569    mov     edx, [rbp-58h]
4235572    xor     eax, edx
4235574    and     eax, [rbp-5Ch]
4235577    xor     eax, [rbp-54h]
4235580    mov     ebx, eax
4235582    lea     rax, [rbp-50h]
4235586    mov     esi, 0Eh
4235591    mov     rdi, rax
4235594    call    _blk0
4235599    lea     edx, [rbx+rax]
4235602    mov     eax, [rbp-60h]
4235605    ror     eax, 1Bh
4235608    add     edx, eax
4235610    mov     eax, [rbp-64h]
4235613    add     eax, edx
4235615    add     eax, 5A827999h
4235620    mov     [rbp-64h], eax
4235623    ror     dword [rbp-5Ch], 2
4235627    mov     eax, [rbp-58h]
4235630    mov     edx, [rbp-5Ch]
4235633    xor     eax, edx
4235635    and     eax, [rbp-60h]
4235638    xor     eax, [rbp-58h]
4235641    mov     ebx, eax
4235643    lea     rax, [rbp-50h]
4235647    mov     esi, 0Fh
4235652    mov     rdi, rax
4235655    call    _blk0
4235660    lea     edx, [rbx+rax]
4235663    mov     eax, [rbp-64h]
4235666    ror     eax, 1Bh
4235669    add     edx, eax
4235671    mov     eax, [rbp-54h]
4235674    add     eax, edx
4235676    add     eax, 5A827999h
4235681    mov     [rbp-54h], eax
4235684    ror     dword [rbp-60h], 2
4235688    mov     eax, [rbp-5Ch]
4235691    mov     edx, [rbp-60h]
4235694    xor     eax, edx
4235696    and     eax, [rbp-64h]
4235699    xor     eax, [rbp-5Ch]
4235702    mov     edx, eax
4235704    mov     ecx, [rbp-1Ch]
4235707    mov     eax, [rbp-30h]
4235710    xor     ecx, eax
4235712    mov     eax, [rbp-48h]
4235715    xor     ecx, eax
4235717    mov     eax, [rbp-50h]
4235720    xor     eax, ecx
4235722    ror     eax, 1Fh
4235725    mov     [rbp-50h], eax
4235728    mov     eax, [rbp-50h]
4235731    add     edx, eax
4235733    mov     eax, [rbp-54h]
4235736    ror     eax, 1Bh
4235739    add     edx, eax
4235741    mov     eax, [rbp-58h]
4235744    add     eax, edx
4235746    add     eax, 5A827999h
4235751    mov     [rbp-58h], eax
4235754    ror     dword [rbp-64h], 2
4235758    mov     eax, [rbp-60h]
4235761    mov     edx, [rbp-64h]
4235764    xor     eax, edx
4235766    and     eax, [rbp-54h]
4235769    xor     eax, [rbp-60h]
4235772    mov     edx, eax
4235774    mov     ecx, [rbp-18h]
4235777    mov     eax, [rbp-2Ch]
4235780    xor     ecx, eax
4235782    mov     eax, [rbp-44h]
4235785    xor     ecx, eax
4235787    mov     eax, [rbp-4Ch]
4235790    xor     eax, ecx
4235792    ror     eax, 1Fh
4235795    mov     [rbp-4Ch], eax
4235798    mov     eax, [rbp-4Ch]
4235801    add     edx, eax
4235803    mov     eax, [rbp-58h]
4235806    ror     eax, 1Bh
4235809    add     edx, eax
4235811    mov     eax, [rbp-5Ch]
4235814    add     eax, edx
4235816    add     eax, 5A827999h
4235821    mov     [rbp-5Ch], eax
4235824    ror     dword [rbp-54h], 2
4235828    mov     eax, [rbp-64h]
4235831    mov     edx, [rbp-54h]
4235834    xor     eax, edx
4235836    and     eax, [rbp-58h]
4235839    xor     eax, [rbp-64h]
4235842    mov     edx, eax
4235844    mov     ecx, [rbp-14h]
4235847    mov     eax, [rbp-28h]
4235850    xor     ecx, eax
4235852    mov     eax, [rbp-40h]
4235855    xor     ecx, eax
4235857    mov     eax, [rbp-48h]
4235860    xor     eax, ecx
4235862    ror     eax, 1Fh
4235865    mov     [rbp-48h], eax
4235868    mov     eax, [rbp-48h]
4235871    add     edx, eax
4235873    mov     eax, [rbp-5Ch]
4235876    ror     eax, 1Bh
4235879    add     edx, eax
4235881    mov     eax, [rbp-60h]
4235884    add     eax, edx
4235886    add     eax, 5A827999h
4235891    mov     [rbp-60h], eax
4235894    ror     dword [rbp-58h], 2
4235898    mov     eax, [rbp-54h]
4235901    mov     edx, [rbp-58h]
4235904    xor     eax, edx
4235906    and     eax, [rbp-5Ch]
4235909    xor     eax, [rbp-54h]
4235912    mov     edx, eax
4235914    mov     ecx, [rbp-50h]
4235917    mov     eax, [rbp-24h]
4235920    xor     ecx, eax
4235922    mov     eax, [rbp-3Ch]
4235925    xor     ecx, eax
4235927    mov     eax, [rbp-44h]
4235930    xor     eax, ecx
4235932    ror     eax, 1Fh
4235935    mov     [rbp-44h], eax
4235938    mov     eax, [rbp-44h]
4235941    add     edx, eax
4235943    mov     eax, [rbp-60h]
4235946    ror     eax, 1Bh
4235949    add     edx, eax
4235951    mov     eax, [rbp-64h]
4235954    add     eax, edx
4235956    add     eax, 5A827999h
4235961    mov     [rbp-64h], eax
4235964    ror     dword [rbp-5Ch], 2
4235968    mov     eax, [rbp-5Ch]
4235971    mov     edx, [rbp-60h]
4235974    xor     eax, edx
4235976    xor     eax, [rbp-58h]
4235979    mov     edx, eax
4235981    mov     ecx, [rbp-4Ch]
4235984    mov     eax, [rbp-20h]
4235987    xor     ecx, eax
4235989    mov     eax, [rbp-38h]
4235992    xor     ecx, eax
4235994    mov     eax, [rbp-40h]
4235997    xor     eax, ecx
4235999    ror     eax, 1Fh
4236002    mov     [rbp-40h], eax
4236005    mov     eax, [rbp-40h]
4236008    add     edx, eax
4236010    mov     eax, [rbp-64h]
4236013    ror     eax, 1Bh
4236016    add     edx, eax
4236018    mov     eax, [rbp-54h]
4236021    add     eax, edx
4236023    add     eax, 6ED9EBA1h
4236028    mov     [rbp-54h], eax
4236031    ror     dword [rbp-60h], 2
4236035    mov     eax, [rbp-60h]
4236038    mov     edx, [rbp-64h]
4236041    xor     eax, edx
4236043    xor     eax, [rbp-5Ch]
4236046    mov     edx, eax
4236048    mov     ecx, [rbp-48h]
4236051    mov     eax, [rbp-1Ch]
4236054    xor     ecx, eax
4236056    mov     eax, [rbp-34h]
4236059    xor     ecx, eax
4236061    mov     eax, [rbp-3Ch]
4236064    xor     eax, ecx
4236066    ror     eax, 1Fh
4236069    mov     [rbp-3Ch], eax
4236072    mov     eax, [rbp-3Ch]
4236075    add     edx, eax
4236077    mov     eax, [rbp-54h]
4236080    ror     eax, 1Bh
4236083    add     edx, eax
4236085    mov     eax, [rbp-58h]
4236088    add     eax, edx
4236090    add     eax, 6ED9EBA1h
4236095    mov     [rbp-58h], eax
4236098    ror     dword [rbp-64h], 2
4236102    mov     eax, [rbp-64h]
4236105    mov     edx, [rbp-54h]
4236108    xor     eax, edx
4236110    xor     eax, [rbp-60h]
4236113    mov     edx, eax
4236115    mov     ecx, [rbp-44h]
4236118    mov     eax, [rbp-18h]
4236121    xor     ecx, eax
4236123    mov     eax, [rbp-30h]
4236126    xor     ecx, eax
4236128    mov     eax, [rbp-38h]
4236131    xor     eax, ecx
4236133    ror     eax, 1Fh
4236136    mov     [rbp-38h], eax
4236139    mov     eax, [rbp-38h]
4236142    add     edx, eax
4236144    mov     eax, [rbp-58h]
4236147    ror     eax, 1Bh
4236150    add     edx, eax
4236152    mov     eax, [rbp-5Ch]
4236155    add     eax, edx
4236157    add     eax, 6ED9EBA1h
4236162    mov     [rbp-5Ch], eax
4236165    ror     dword [rbp-54h], 2
4236169    mov     eax, [rbp-54h]
4236172    mov     edx, [rbp-58h]
4236175    xor     eax, edx
4236177    xor     eax, [rbp-64h]
4236180    mov     edx, eax
4236182    mov     ecx, [rbp-40h]
4236185    mov     eax, [rbp-14h]
4236188    xor     ecx, eax
4236190    mov     eax, [rbp-2Ch]
4236193    xor     ecx, eax
4236195    mov     eax, [rbp-34h]
4236198    xor     eax, ecx
4236200    ror     eax, 1Fh
4236203    mov     [rbp-34h], eax
4236206    mov     eax, [rbp-34h]
4236209    add     edx, eax
4236211    mov     eax, [rbp-5Ch]
4236214    ror     eax, 1Bh
4236217    add     edx, eax
4236219    mov     eax, [rbp-60h]
4236222    add     eax, edx
4236224    add     eax, 6ED9EBA1h
4236229    mov     [rbp-60h], eax
4236232    ror     dword [rbp-58h], 2
4236236    mov     eax, [rbp-58h]
4236239    mov     edx, [rbp-5Ch]
4236242    xor     eax, edx
4236244    xor     eax, [rbp-54h]
4236247    mov     edx, eax
4236249    mov     ecx, [rbp-3Ch]
4236252    mov     eax, [rbp-50h]
4236255    xor     ecx, eax
4236257    mov     eax, [rbp-28h]
4236260    xor     ecx, eax
4236262    mov     eax, [rbp-30h]
4236265    xor     eax, ecx
4236267    ror     eax, 1Fh
4236270    mov     [rbp-30h], eax
4236273    mov     eax, [rbp-30h]
4236276    add     edx, eax
4236278    mov     eax, [rbp-60h]
4236281    ror     eax, 1Bh
4236284    add     edx, eax
4236286    mov     eax, [rbp-64h]
4236289    add     eax, edx
4236291    add     eax, 6ED9EBA1h
4236296    mov     [rbp-64h], eax
4236299    ror     dword [rbp-5Ch], 2
4236303    mov     eax, [rbp-5Ch]
4236306    mov     edx, [rbp-60h]
4236309    xor     eax, edx
4236311    xor     eax, [rbp-58h]
4236314    mov     edx, eax
4236316    mov     ecx, [rbp-38h]
4236319    mov     eax, [rbp-4Ch]
4236322    xor     ecx, eax
4236324    mov     eax, [rbp-24h]
4236327    xor     ecx, eax
4236329    mov     eax, [rbp-2Ch]
4236332    xor     eax, ecx
4236334    ror     eax, 1Fh
4236337    mov     [rbp-2Ch], eax
4236340    mov     eax, [rbp-2Ch]
4236343    add     edx, eax
4236345    mov     eax, [rbp-64h]
4236348    ror     eax, 1Bh
4236351    add     edx, eax
4236353    mov     eax, [rbp-54h]
4236356    add     eax, edx
4236358    add     eax, 6ED9EBA1h
4236363    mov     [rbp-54h], eax
4236366    ror     dword [rbp-60h], 2
4236370    mov     eax, [rbp-60h]
4236373    mov     edx, [rbp-64h]
4236376    xor     eax, edx
4236378    xor     eax, [rbp-5Ch]
4236381    mov     edx, eax
4236383    mov     ecx, [rbp-34h]
4236386    mov     eax, [rbp-48h]
4236389    xor     ecx, eax
4236391    mov     eax, [rbp-20h]
4236394    xor     ecx, eax
4236396    mov     eax, [rbp-28h]
4236399    xor     eax, ecx
4236401    ror     eax, 1Fh
4236404    mov     [rbp-28h], eax
4236407    mov     eax, [rbp-28h]
4236410    add     edx, eax
4236412    mov     eax, [rbp-54h]
4236415    ror     eax, 1Bh
4236418    add     edx, eax
4236420    mov     eax, [rbp-58h]
4236423    add     eax, edx
4236425    add     eax, 6ED9EBA1h
4236430    mov     [rbp-58h], eax
4236433    ror     dword [rbp-64h], 2
4236437    mov     eax, [rbp-64h]
4236440    mov     edx, [rbp-54h]
4236443    xor     eax, edx
4236445    xor     eax, [rbp-60h]
4236448    mov     edx, eax
4236450    mov     ecx, [rbp-30h]
4236453    mov     eax, [rbp-44h]
4236456    xor     ecx, eax
4236458    mov     eax, [rbp-1Ch]
4236461    xor     ecx, eax
4236463    mov     eax, [rbp-24h]
4236466    xor     eax, ecx
4236468    ror     eax, 1Fh
4236471    mov     [rbp-24h], eax
4236474    mov     eax, [rbp-24h]
4236477    add     edx, eax
4236479    mov     eax, [rbp-58h]
4236482    ror     eax, 1Bh
4236485    add     edx, eax
4236487    mov     eax, [rbp-5Ch]
4236490    add     eax, edx
4236492    add     eax, 6ED9EBA1h
4236497    mov     [rbp-5Ch], eax
4236500    ror     dword [rbp-54h], 2
4236504    mov     eax, [rbp-54h]
4236507    mov     edx, [rbp-58h]
4236510    xor     eax, edx
4236512    xor     eax, [rbp-64h]
4236515    mov     edx, eax
4236517    mov     ecx, [rbp-2Ch]
4236520    mov     eax, [rbp-40h]
4236523    xor     ecx, eax
4236525    mov     eax, [rbp-18h]
4236528    xor     ecx, eax
4236530    mov     eax, [rbp-20h]
4236533    xor     eax, ecx
4236535    ror     eax, 1Fh
4236538    mov     [rbp-20h], eax
4236541    mov     eax, [rbp-20h]
4236544    add     edx, eax
4236546    mov     eax, [rbp-5Ch]
4236549    ror     eax, 1Bh
4236552    add     edx, eax
4236554    mov     eax, [rbp-60h]
4236557    add     eax, edx
4236559    add     eax, 6ED9EBA1h
4236564    mov     [rbp-60h], eax
4236567    ror     dword [rbp-58h], 2
4236571    mov     eax, [rbp-58h]
4236574    mov     edx, [rbp-5Ch]
4236577    xor     eax, edx
4236579    xor     eax, [rbp-54h]
4236582    mov     edx, eax
4236584    mov     ecx, [rbp-28h]
4236587    mov     eax, [rbp-3Ch]
4236590    xor     ecx, eax
4236592    mov     eax, [rbp-14h]
4236595    xor     ecx, eax
4236597    mov     eax, [rbp-1Ch]
4236600    xor     eax, ecx
4236602    ror     eax, 1Fh
4236605    mov     [rbp-1Ch], eax
4236608    mov     eax, [rbp-1Ch]
4236611    add     edx, eax
4236613    mov     eax, [rbp-60h]
4236616    ror     eax, 1Bh
4236619    add     edx, eax
4236621    mov     eax, [rbp-64h]
4236624    add     eax, edx
4236626    add     eax, 6ED9EBA1h
4236631    mov     [rbp-64h], eax
4236634    ror     dword [rbp-5Ch], 2
4236638    mov     eax, [rbp-5Ch]
4236641    mov     edx, [rbp-60h]
4236644    xor     eax, edx
4236646    xor     eax, [rbp-58h]
4236649    mov     edx, eax
4236651    mov     ecx, [rbp-24h]
4236654    mov     eax, [rbp-38h]
4236657    xor     ecx, eax
4236659    mov     eax, [rbp-50h]
4236662    xor     ecx, eax
4236664    mov     eax, [rbp-18h]
4236667    xor     eax, ecx
4236669    ror     eax, 1Fh
4236672    mov     [rbp-18h], eax
4236675    mov     eax, [rbp-18h]
4236678    add     edx, eax
4236680    mov     eax, [rbp-64h]
4236683    ror     eax, 1Bh
4236686    add     edx, eax
4236688    mov     eax, [rbp-54h]
4236691    add     eax, edx
4236693    add     eax, 6ED9EBA1h
4236698    mov     [rbp-54h], eax
4236701    ror     dword [rbp-60h], 2
4236705    mov     eax, [rbp-60h]
4236708    mov     edx, [rbp-64h]
4236711    xor     eax, edx
4236713    xor     eax, [rbp-5Ch]
4236716    mov     edx, eax
4236718    mov     ecx, [rbp-20h]
4236721    mov     eax, [rbp-34h]
4236724    xor     ecx, eax
4236726    mov     eax, [rbp-4Ch]
4236729    xor     ecx, eax
4236731    mov     eax, [rbp-14h]
4236734    xor     eax, ecx
4236736    ror     eax, 1Fh
4236739    mov     [rbp-14h], eax
4236742    mov     eax, [rbp-14h]
4236745    add     edx, eax
4236747    mov     eax, [rbp-54h]
4236750    ror     eax, 1Bh
4236753    add     edx, eax
4236755    mov     eax, [rbp-58h]
4236758    add     eax, edx
4236760    add     eax, 6ED9EBA1h
4236765    mov     [rbp-58h], eax
4236768    ror     dword [rbp-64h], 2
4236772    mov     eax, [rbp-64h]
4236775    mov     edx, [rbp-54h]
4236778    xor     eax, edx
4236780    xor     eax, [rbp-60h]
4236783    mov     edx, eax
4236785    mov     ecx, [rbp-1Ch]
4236788    mov     eax, [rbp-30h]
4236791    xor     ecx, eax
4236793    mov     eax, [rbp-48h]
4236796    xor     ecx, eax
4236798    mov     eax, [rbp-50h]
4236801    xor     eax, ecx
4236803    ror     eax, 1Fh
4236806    mov     [rbp-50h], eax
4236809    mov     eax, [rbp-50h]
4236812    add     edx, eax
4236814    mov     eax, [rbp-58h]
4236817    ror     eax, 1Bh
4236820    add     edx, eax
4236822    mov     eax, [rbp-5Ch]
4236825    add     eax, edx
4236827    add     eax, 6ED9EBA1h
4236832    mov     [rbp-5Ch], eax
4236835    ror     dword [rbp-54h], 2
4236839    mov     eax, [rbp-54h]
4236842    mov     edx, [rbp-58h]
4236845    xor     eax, edx
4236847    xor     eax, [rbp-64h]
4236850    mov     edx, eax
4236852    mov     ecx, [rbp-18h]
4236855    mov     eax, [rbp-2Ch]
4236858    xor     ecx, eax
4236860    mov     eax, [rbp-44h]
4236863    xor     ecx, eax
4236865    mov     eax, [rbp-4Ch]
4236868    xor     eax, ecx
4236870    ror     eax, 1Fh
4236873    mov     [rbp-4Ch], eax
4236876    mov     eax, [rbp-4Ch]
4236879    add     edx, eax
4236881    mov     eax, [rbp-5Ch]
4236884    ror     eax, 1Bh
4236887    add     edx, eax
4236889    mov     eax, [rbp-60h]
4236892    add     eax, edx
4236894    add     eax, 6ED9EBA1h
4236899    mov     [rbp-60h], eax
4236902    ror     dword [rbp-58h], 2
4236906    mov     eax, [rbp-58h]
4236909    mov     edx, [rbp-5Ch]
4236912    xor     eax, edx
4236914    xor     eax, [rbp-54h]
4236917    mov     edx, eax
4236919    mov     ecx, [rbp-14h]
4236922    mov     eax, [rbp-28h]
4236925    xor     ecx, eax
4236927    mov     eax, [rbp-40h]
4236930    xor     ecx, eax
4236932    mov     eax, [rbp-48h]
4236935    xor     eax, ecx
4236937    ror     eax, 1Fh
4236940    mov     [rbp-48h], eax
4236943    mov     eax, [rbp-48h]
4236946    add     edx, eax
4236948    mov     eax, [rbp-60h]
4236951    ror     eax, 1Bh
4236954    add     edx, eax
4236956    mov     eax, [rbp-64h]
4236959    add     eax, edx
4236961    add     eax, 6ED9EBA1h
4236966    mov     [rbp-64h], eax
4236969    ror     dword [rbp-5Ch], 2
4236973    mov     eax, [rbp-5Ch]
4236976    mov     edx, [rbp-60h]
4236979    xor     eax, edx
4236981    xor     eax, [rbp-58h]
4236984    mov     edx, eax
4236986    mov     ecx, [rbp-50h]
4236989    mov     eax, [rbp-24h]
4236992    xor     ecx, eax
4236994    mov     eax, [rbp-3Ch]
4236997    xor     ecx, eax
4236999    mov     eax, [rbp-44h]
4237002    xor     eax, ecx
4237004    ror     eax, 1Fh
4237007    mov     [rbp-44h], eax
4237010    mov     eax, [rbp-44h]
4237013    add     edx, eax
4237015    mov     eax, [rbp-64h]
4237018    ror     eax, 1Bh
4237021    add     edx, eax
4237023    mov     eax, [rbp-54h]
4237026    add     eax, edx
4237028    add     eax, 6ED9EBA1h
4237033    mov     [rbp-54h], eax
4237036    ror     dword [rbp-60h], 2
4237040    mov     eax, [rbp-60h]
4237043    mov     edx, [rbp-64h]
4237046    xor     eax, edx
4237048    xor     eax, [rbp-5Ch]
4237051    mov     edx, eax
4237053    mov     ecx, [rbp-4Ch]
4237056    mov     eax, [rbp-20h]
4237059    xor     ecx, eax
4237061    mov     eax, [rbp-38h]
4237064    xor     ecx, eax
4237066    mov     eax, [rbp-40h]
4237069    xor     eax, ecx
4237071    ror     eax, 1Fh
4237074    mov     [rbp-40h], eax
4237077    mov     eax, [rbp-40h]
4237080    add     edx, eax
4237082    mov     eax, [rbp-54h]
4237085    ror     eax, 1Bh
4237088    add     edx, eax
4237090    mov     eax, [rbp-58h]
4237093    add     eax, edx
4237095    add     eax, 6ED9EBA1h
4237100    mov     [rbp-58h], eax
4237103    ror     dword [rbp-64h], 2
4237107    mov     eax, [rbp-64h]
4237110    mov     edx, [rbp-54h]
4237113    xor     eax, edx
4237115    xor     eax, [rbp-60h]
4237118    mov     edx, eax
4237120    mov     ecx, [rbp-48h]
4237123    mov     eax, [rbp-1Ch]
4237126    xor     ecx, eax
4237128    mov     eax, [rbp-34h]
4237131    xor     ecx, eax
4237133    mov     eax, [rbp-3Ch]
4237136    xor     eax, ecx
4237138    ror     eax, 1Fh
4237141    mov     [rbp-3Ch], eax
4237144    mov     eax, [rbp-3Ch]
4237147    add     edx, eax
4237149    mov     eax, [rbp-58h]
4237152    ror     eax, 1Bh
4237155    add     edx, eax
4237157    mov     eax, [rbp-5Ch]
4237160    add     eax, edx
4237162    add     eax, 6ED9EBA1h
4237167    mov     [rbp-5Ch], eax
4237170    ror     dword [rbp-54h], 2
4237174    mov     eax, [rbp-54h]
4237177    mov     edx, [rbp-58h]
4237180    xor     eax, edx
4237182    xor     eax, [rbp-64h]
4237185    mov     edx, eax
4237187    mov     ecx, [rbp-44h]
4237190    mov     eax, [rbp-18h]
4237193    xor     ecx, eax
4237195    mov     eax, [rbp-30h]
4237198    xor     ecx, eax
4237200    mov     eax, [rbp-38h]
4237203    xor     eax, ecx
4237205    ror     eax, 1Fh
4237208    mov     [rbp-38h], eax
4237211    mov     eax, [rbp-38h]
4237214    add     edx, eax
4237216    mov     eax, [rbp-5Ch]
4237219    ror     eax, 1Bh
4237222    add     edx, eax
4237224    mov     eax, [rbp-60h]
4237227    add     eax, edx
4237229    add     eax, 6ED9EBA1h
4237234    mov     [rbp-60h], eax
4237237    ror     dword [rbp-58h], 2
4237241    mov     eax, [rbp-58h]
4237244    mov     edx, [rbp-5Ch]
4237247    xor     eax, edx
4237249    xor     eax, [rbp-54h]
4237252    mov     edx, eax
4237254    mov     ecx, [rbp-40h]
4237257    mov     eax, [rbp-14h]
4237260    xor     ecx, eax
4237262    mov     eax, [rbp-2Ch]
4237265    xor     ecx, eax
4237267    mov     eax, [rbp-34h]
4237270    xor     eax, ecx
4237272    ror     eax, 1Fh
4237275    mov     [rbp-34h], eax
4237278    mov     eax, [rbp-34h]
4237281    add     edx, eax
4237283    mov     eax, [rbp-60h]
4237286    ror     eax, 1Bh
4237289    add     edx, eax
4237291    mov     eax, [rbp-64h]
4237294    add     eax, edx
4237296    add     eax, 6ED9EBA1h
4237301    mov     [rbp-64h], eax
4237304    ror     dword [rbp-5Ch], 2
4237308    mov     eax, [rbp-5Ch]
4237311    mov     edx, [rbp-60h]
4237314    or      eax, edx
4237316    and     eax, [rbp-58h]
4237319    mov     edx, [rbp-5Ch]
4237322    mov     ecx, [rbp-60h]
4237325    and     edx, ecx
4237327    or      eax, edx
4237329    mov     ecx, eax
4237331    mov     edx, [rbp-3Ch]
4237334    mov     eax, [rbp-50h]
4237337    xor     edx, eax
4237339    mov     eax, [rbp-28h]
4237342    xor     edx, eax
4237344    mov     eax, [rbp-30h]
4237347    xor     eax, edx
4237349    ror     eax, 1Fh
4237352    mov     [rbp-30h], eax
4237355    mov     eax, [rbp-30h]
4237358    lea     edx, [rcx+rax]
4237361    mov     eax, [rbp-64h]
4237364    ror     eax, 1Bh
4237367    add     edx, eax
4237369    mov     eax, [rbp-54h]
4237372    add     eax, edx
4237374    sub     eax, 70E44324h
4237379    mov     [rbp-54h], eax
4237382    ror     dword [rbp-60h], 2
4237386    mov     eax, [rbp-60h]
4237389    mov     edx, [rbp-64h]
4237392    or      eax, edx
4237394    and     eax, [rbp-5Ch]
4237397    mov     edx, [rbp-60h]
4237400    mov     ecx, [rbp-64h]
4237403    and     edx, ecx
4237405    or      eax, edx
4237407    mov     ecx, eax
4237409    mov     edx, [rbp-38h]
4237412    mov     eax, [rbp-4Ch]
4237415    xor     edx, eax
4237417    mov     eax, [rbp-24h]
4237420    xor     edx, eax
4237422    mov     eax, [rbp-2Ch]
4237425    xor     eax, edx
4237427    ror     eax, 1Fh
4237430    mov     [rbp-2Ch], eax
4237433    mov     eax, [rbp-2Ch]
4237436    lea     edx, [rcx+rax]
4237439    mov     eax, [rbp-54h]
4237442    ror     eax, 1Bh
4237445    add     edx, eax
4237447    mov     eax, [rbp-58h]
4237450    add     eax, edx
4237452    sub     eax, 70E44324h
4237457    mov     [rbp-58h], eax
4237460    ror     dword [rbp-64h], 2
4237464    mov     eax, [rbp-64h]
4237467    mov     edx, [rbp-54h]
4237470    or      eax, edx
4237472    and     eax, [rbp-60h]
4237475    mov     edx, [rbp-64h]
4237478    mov     ecx, [rbp-54h]
4237481    and     edx, ecx
4237483    or      eax, edx
4237485    mov     ecx, eax
4237487    mov     edx, [rbp-34h]
4237490    mov     eax, [rbp-48h]
4237493    xor     edx, eax
4237495    mov     eax, [rbp-20h]
4237498    xor     edx, eax
4237500    mov     eax, [rbp-28h]
4237503    xor     eax, edx
4237505    ror     eax, 1Fh
4237508    mov     [rbp-28h], eax
4237511    mov     eax, [rbp-28h]
4237514    lea     edx, [rcx+rax]
4237517    mov     eax, [rbp-58h]
4237520    ror     eax, 1Bh
4237523    add     edx, eax
4237525    mov     eax, [rbp-5Ch]
4237528    add     eax, edx
4237530    sub     eax, 70E44324h
4237535    mov     [rbp-5Ch], eax
4237538    ror     dword [rbp-54h], 2
4237542    mov     eax, [rbp-54h]
4237545    mov     edx, [rbp-58h]
4237548    or      eax, edx
4237550    and     eax, [rbp-64h]
4237553    mov     edx, [rbp-54h]
4237556    mov     ecx, [rbp-58h]
4237559    and     edx, ecx
4237561    or      eax, edx
4237563    mov     ecx, eax
4237565    mov     edx, [rbp-30h]
4237568    mov     eax, [rbp-44h]
4237571    xor     edx, eax
4237573    mov     eax, [rbp-1Ch]
4237576    xor     edx, eax
4237578    mov     eax, [rbp-24h]
4237581    xor     eax, edx
4237583    ror     eax, 1Fh
4237586    mov     [rbp-24h], eax
4237589    mov     eax, [rbp-24h]
4237592    lea     edx, [rcx+rax]
4237595    mov     eax, [rbp-5Ch]
4237598    ror     eax, 1Bh
4237601    add     edx, eax
4237603    mov     eax, [rbp-60h]
4237606    add     eax, edx
4237608    sub     eax, 70E44324h
4237613    mov     [rbp-60h], eax
4237616    ror     dword [rbp-58h], 2
4237620    mov     eax, [rbp-58h]
4237623    mov     edx, [rbp-5Ch]
4237626    or      eax, edx
4237628    and     eax, [rbp-54h]
4237631    mov     edx, [rbp-58h]
4237634    mov     ecx, [rbp-5Ch]
4237637    and     edx, ecx
4237639    or      eax, edx
4237641    mov     ecx, eax
4237643    mov     edx, [rbp-2Ch]
4237646    mov     eax, [rbp-40h]
4237649    xor     edx, eax
4237651    mov     eax, [rbp-18h]
4237654    xor     edx, eax
4237656    mov     eax, [rbp-20h]
4237659    xor     eax, edx
4237661    ror     eax, 1Fh
4237664    mov     [rbp-20h], eax
4237667    mov     eax, [rbp-20h]
4237670    lea     edx, [rcx+rax]
4237673    mov     eax, [rbp-60h]
4237676    ror     eax, 1Bh
4237679    add     edx, eax
4237681    mov     eax, [rbp-64h]
4237684    add     eax, edx
4237686    sub     eax, 70E44324h
4237691    mov     [rbp-64h], eax
4237694    ror     dword [rbp-5Ch], 2
4237698    mov     eax, [rbp-5Ch]
4237701    mov     edx, [rbp-60h]
4237704    or      eax, edx
4237706    and     eax, [rbp-58h]
4237709    mov     edx, [rbp-5Ch]
4237712    mov     ecx, [rbp-60h]
4237715    and     edx, ecx
4237717    or      eax, edx
4237719    mov     ecx, eax
4237721    mov     edx, [rbp-28h]
4237724    mov     eax, [rbp-3Ch]
4237727    xor     edx, eax
4237729    mov     eax, [rbp-14h]
4237732    xor     edx, eax
4237734    mov     eax, [rbp-1Ch]
4237737    xor     eax, edx
4237739    ror     eax, 1Fh
4237742    mov     [rbp-1Ch], eax
4237745    mov     eax, [rbp-1Ch]
4237748    lea     edx, [rcx+rax]
4237751    mov     eax, [rbp-64h]
4237754    ror     eax, 1Bh
4237757    add     edx, eax
4237759    mov     eax, [rbp-54h]
4237762    add     eax, edx
4237764    sub     eax, 70E44324h
4237769    mov     [rbp-54h], eax
4237772    ror     dword [rbp-60h], 2
4237776    mov     eax, [rbp-60h]
4237779    mov     edx, [rbp-64h]
4237782    or      eax, edx
4237784    and     eax, [rbp-5Ch]
4237787    mov     edx, [rbp-60h]
4237790    mov     ecx, [rbp-64h]
4237793    and     edx, ecx
4237795    or      eax, edx
4237797    mov     ecx, eax
4237799    mov     edx, [rbp-24h]
4237802    mov     eax, [rbp-38h]
4237805    xor     edx, eax
4237807    mov     eax, [rbp-50h]
4237810    xor     edx, eax
4237812    mov     eax, [rbp-18h]
4237815    xor     eax, edx
4237817    ror     eax, 1Fh
4237820    mov     [rbp-18h], eax
4237823    mov     eax, [rbp-18h]
4237826    lea     edx, [rcx+rax]
4237829    mov     eax, [rbp-54h]
4237832    ror     eax, 1Bh
4237835    add     edx, eax
4237837    mov     eax, [rbp-58h]
4237840    add     eax, edx
4237842    sub     eax, 70E44324h
4237847    mov     [rbp-58h], eax
4237850    ror     dword [rbp-64h], 2
4237854    mov     eax, [rbp-64h]
4237857    mov     edx, [rbp-54h]
4237860    or      eax, edx
4237862    and     eax, [rbp-60h]
4237865    mov     edx, [rbp-64h]
4237868    mov     ecx, [rbp-54h]
4237871    and     edx, ecx
4237873    or      eax, edx
4237875    mov     ecx, eax
4237877    mov     edx, [rbp-20h]
4237880    mov     eax, [rbp-34h]
4237883    xor     edx, eax
4237885    mov     eax, [rbp-4Ch]
4237888    xor     edx, eax
4237890    mov     eax, [rbp-14h]
4237893    xor     eax, edx
4237895    ror     eax, 1Fh
4237898    mov     [rbp-14h], eax
4237901    mov     eax, [rbp-14h]
4237904    lea     edx, [rcx+rax]
4237907    mov     eax, [rbp-58h]
4237910    ror     eax, 1Bh
4237913    add     edx, eax
4237915    mov     eax, [rbp-5Ch]
4237918    add     eax, edx
4237920    sub     eax, 70E44324h
4237925    mov     [rbp-5Ch], eax
4237928    ror     dword [rbp-54h], 2
4237932    mov     eax, [rbp-54h]
4237935    mov     edx, [rbp-58h]
4237938    or      eax, edx
4237940    and     eax, [rbp-64h]
4237943    mov     edx, [rbp-54h]
4237946    mov     ecx, [rbp-58h]
4237949    and     edx, ecx
4237951    or      eax, edx
4237953    mov     ecx, eax
4237955    mov     edx, [rbp-1Ch]
4237958    mov     eax, [rbp-30h]
4237961    xor     edx, eax
4237963    mov     eax, [rbp-48h]
4237966    xor     edx, eax
4237968    mov     eax, [rbp-50h]
4237971    xor     eax, edx
4237973    ror     eax, 1Fh
4237976    mov     [rbp-50h], eax
4237979    mov     eax, [rbp-50h]
4237982    lea     edx, [rcx+rax]
4237985    mov     eax, [rbp-5Ch]
4237988    ror     eax, 1Bh
4237991    add     edx, eax
4237993    mov     eax, [rbp-60h]
4237996    add     eax, edx
4237998    sub     eax, 70E44324h
4238003    mov     [rbp-60h], eax
4238006    ror     dword [rbp-58h], 2
4238010    mov     eax, [rbp-58h]
4238013    mov     edx, [rbp-5Ch]
4238016    or      eax, edx
4238018    and     eax, [rbp-54h]
4238021    mov     edx, [rbp-58h]
4238024    mov     ecx, [rbp-5Ch]
4238027    and     edx, ecx
4238029    or      eax, edx
4238031    mov     ecx, eax
4238033    mov     edx, [rbp-18h]
4238036    mov     eax, [rbp-2Ch]
4238039    xor     edx, eax
4238041    mov     eax, [rbp-44h]
4238044    xor     edx, eax
4238046    mov     eax, [rbp-4Ch]
4238049    xor     eax, edx
4238051    ror     eax, 1Fh
4238054    mov     [rbp-4Ch], eax
4238057    mov     eax, [rbp-4Ch]
4238060    lea     edx, [rcx+rax]
4238063    mov     eax, [rbp-60h]
4238066    ror     eax, 1Bh
4238069    add     edx, eax
4238071    mov     eax, [rbp-64h]
4238074    add     eax, edx
4238076    sub     eax, 70E44324h
4238081    mov     [rbp-64h], eax
4238084    ror     dword [rbp-5Ch], 2
4238088    mov     eax, [rbp-5Ch]
4238091    mov     edx, [rbp-60h]
4238094    or      eax, edx
4238096    and     eax, [rbp-58h]
4238099    mov     edx, [rbp-5Ch]
4238102    mov     ecx, [rbp-60h]
4238105    and     edx, ecx
4238107    or      eax, edx
4238109    mov     ecx, eax
4238111    mov     edx, [rbp-14h]
4238114    mov     eax, [rbp-28h]
4238117    xor     edx, eax
4238119    mov     eax, [rbp-40h]
4238122    xor     edx, eax
4238124    mov     eax, [rbp-48h]
4238127    xor     eax, edx
4238129    ror     eax, 1Fh
4238132    mov     [rbp-48h], eax
4238135    mov     eax, [rbp-48h]
4238138    lea     edx, [rcx+rax]
4238141    mov     eax, [rbp-64h]
4238144    ror     eax, 1Bh
4238147    add     edx, eax
4238149    mov     eax, [rbp-54h]
4238152    add     eax, edx
4238154    sub     eax, 70E44324h
4238159    mov     [rbp-54h], eax
4238162    ror     dword [rbp-60h], 2
4238166    mov     eax, [rbp-60h]
4238169    mov     edx, [rbp-64h]
4238172    or      eax, edx
4238174    and     eax, [rbp-5Ch]
4238177    mov     edx, [rbp-60h]
4238180    mov     ecx, [rbp-64h]
4238183    and     edx, ecx
4238185    or      eax, edx
4238187    mov     ecx, eax
4238189    mov     edx, [rbp-50h]
4238192    mov     eax, [rbp-24h]
4238195    xor     edx, eax
4238197    mov     eax, [rbp-3Ch]
4238200    xor     edx, eax
4238202    mov     eax, [rbp-44h]
4238205    xor     eax, edx
4238207    ror     eax, 1Fh
4238210    mov     [rbp-44h], eax
4238213    mov     eax, [rbp-44h]
4238216    lea     edx, [rcx+rax]
4238219    mov     eax, [rbp-54h]
4238222    ror     eax, 1Bh
4238225    add     edx, eax
4238227    mov     eax, [rbp-58h]
4238230    add     eax, edx
4238232    sub     eax, 70E44324h
4238237    mov     [rbp-58h], eax
4238240    ror     dword [rbp-64h], 2
4238244    mov     eax, [rbp-64h]
4238247    mov     edx, [rbp-54h]
4238250    or      eax, edx
4238252    and     eax, [rbp-60h]
4238255    mov     edx, [rbp-64h]
4238258    mov     ecx, [rbp-54h]
4238261    and     edx, ecx
4238263    or      eax, edx
4238265    mov     ecx, eax
4238267    mov     edx, [rbp-4Ch]
4238270    mov     eax, [rbp-20h]
4238273    xor     edx, eax
4238275    mov     eax, [rbp-38h]
4238278    xor     edx, eax
4238280    mov     eax, [rbp-40h]
4238283    xor     eax, edx
4238285    ror     eax, 1Fh
4238288    mov     [rbp-40h], eax
4238291    mov     eax, [rbp-40h]
4238294    lea     edx, [rcx+rax]
4238297    mov     eax, [rbp-58h]
4238300    ror     eax, 1Bh
4238303    add     edx, eax
4238305    mov     eax, [rbp-5Ch]
4238308    add     eax, edx
4238310    sub     eax, 70E44324h
4238315    mov     [rbp-5Ch], eax
4238318    ror     dword [rbp-54h], 2
4238322    mov     eax, [rbp-54h]
4238325    mov     edx, [rbp-58h]
4238328    or      eax, edx
4238330    and     eax, [rbp-64h]
4238333    mov     edx, [rbp-54h]
4238336    mov     ecx, [rbp-58h]
4238339    and     edx, ecx
4238341    or      eax, edx
4238343    mov     ecx, eax
4238345    mov     edx, [rbp-48h]
4238348    mov     eax, [rbp-1Ch]
4238351    xor     edx, eax
4238353    mov     eax, [rbp-34h]
4238356    xor     edx, eax
4238358    mov     eax, [rbp-3Ch]
4238361    xor     eax, edx
4238363    ror     eax, 1Fh
4238366    mov     [rbp-3Ch], eax
4238369    mov     eax, [rbp-3Ch]
4238372    lea     edx, [rcx+rax]
4238375    mov     eax, [rbp-5Ch]
4238378    ror     eax, 1Bh
4238381    add     edx, eax
4238383    mov     eax, [rbp-60h]
4238386    add     eax, edx
4238388    sub     eax, 70E44324h
4238393    mov     [rbp-60h], eax
4238396    ror     dword [rbp-58h], 2
4238400    mov     eax, [rbp-58h]
4238403    mov     edx, [rbp-5Ch]
4238406    or      eax, edx
4238408    and     eax, [rbp-54h]
4238411    mov     edx, [rbp-58h]
4238414    mov     ecx, [rbp-5Ch]
4238417    and     edx, ecx
4238419    or      eax, edx
4238421    mov     ecx, eax
4238423    mov     edx, [rbp-44h]
4238426    mov     eax, [rbp-18h]
4238429    xor     edx, eax
4238431    mov     eax, [rbp-30h]
4238434    xor     edx, eax
4238436    mov     eax, [rbp-38h]
4238439    xor     eax, edx
4238441    ror     eax, 1Fh
4238444    mov     [rbp-38h], eax
4238447    mov     eax, [rbp-38h]
4238450    lea     edx, [rcx+rax]
4238453    mov     eax, [rbp-60h]
4238456    ror     eax, 1Bh
4238459    add     edx, eax
4238461    mov     eax, [rbp-64h]
4238464    add     eax, edx
4238466    sub     eax, 70E44324h
4238471    mov     [rbp-64h], eax
4238474    ror     dword [rbp-5Ch], 2
4238478    mov     eax, [rbp-5Ch]
4238481    mov     edx, [rbp-60h]
4238484    or      eax, edx
4238486    and     eax, [rbp-58h]
4238489    mov     edx, [rbp-5Ch]
4238492    mov     ecx, [rbp-60h]
4238495    and     edx, ecx
4238497    or      eax, edx
4238499    mov     ecx, eax
4238501    mov     edx, [rbp-40h]
4238504    mov     eax, [rbp-14h]
4238507    xor     edx, eax
4238509    mov     eax, [rbp-2Ch]
4238512    xor     edx, eax
4238514    mov     eax, [rbp-34h]
4238517    xor     eax, edx
4238519    ror     eax, 1Fh
4238522    mov     [rbp-34h], eax
4238525    mov     eax, [rbp-34h]
4238528    lea     edx, [rcx+rax]
4238531    mov     eax, [rbp-64h]
4238534    ror     eax, 1Bh
4238537    add     edx, eax
4238539    mov     eax, [rbp-54h]
4238542    add     eax, edx
4238544    sub     eax, 70E44324h
4238549    mov     [rbp-54h], eax
4238552    ror     dword [rbp-60h], 2
4238556    mov     eax, [rbp-60h]
4238559    mov     edx, [rbp-64h]
4238562    or      eax, edx
4238564    and     eax, [rbp-5Ch]
4238567    mov     edx, [rbp-60h]
4238570    mov     ecx, [rbp-64h]
4238573    and     edx, ecx
4238575    or      eax, edx
4238577    mov     ecx, eax
4238579    mov     edx, [rbp-3Ch]
4238582    mov     eax, [rbp-50h]
4238585    xor     edx, eax
4238587    mov     eax, [rbp-28h]
4238590    xor     edx, eax
4238592    mov     eax, [rbp-30h]
4238595    xor     eax, edx
4238597    ror     eax, 1Fh
4238600    mov     [rbp-30h], eax
4238603    mov     eax, [rbp-30h]
4238606    lea     edx, [rcx+rax]
4238609    mov     eax, [rbp-54h]
4238612    ror     eax, 1Bh
4238615    add     edx, eax
4238617    mov     eax, [rbp-58h]
4238620    add     eax, edx
4238622    sub     eax, 70E44324h
4238627    mov     [rbp-58h], eax
4238630    ror     dword [rbp-64h], 2
4238634    mov     eax, [rbp-64h]
4238637    mov     edx, [rbp-54h]
4238640    or      eax, edx
4238642    and     eax, [rbp-60h]
4238645    mov     edx, [rbp-64h]
4238648    mov     ecx, [rbp-54h]
4238651    and     edx, ecx
4238653    or      eax, edx
4238655    mov     ecx, eax
4238657    mov     edx, [rbp-38h]
4238660    mov     eax, [rbp-4Ch]
4238663    xor     edx, eax
4238665    mov     eax, [rbp-24h]
4238668    xor     edx, eax
4238670    mov     eax, [rbp-2Ch]
4238673    xor     eax, edx
4238675    ror     eax, 1Fh
4238678    mov     [rbp-2Ch], eax
4238681    mov     eax, [rbp-2Ch]
4238684    lea     edx, [rcx+rax]
4238687    mov     eax, [rbp-58h]
4238690    ror     eax, 1Bh
4238693    add     edx, eax
4238695    mov     eax, [rbp-5Ch]
4238698    add     eax, edx
4238700    sub     eax, 70E44324h
4238705    mov     [rbp-5Ch], eax
4238708    ror     dword [rbp-54h], 2
4238712    mov     eax, [rbp-54h]
4238715    mov     edx, [rbp-58h]
4238718    or      eax, edx
4238720    and     eax, [rbp-64h]
4238723    mov     edx, [rbp-54h]
4238726    mov     ecx, [rbp-58h]
4238729    and     edx, ecx
4238731    or      eax, edx
4238733    mov     ecx, eax
4238735    mov     edx, [rbp-34h]
4238738    mov     eax, [rbp-48h]
4238741    xor     edx, eax
4238743    mov     eax, [rbp-20h]
4238746    xor     edx, eax
4238748    mov     eax, [rbp-28h]
4238751    xor     eax, edx
4238753    ror     eax, 1Fh
4238756    mov     [rbp-28h], eax
4238759    mov     eax, [rbp-28h]
4238762    lea     edx, [rcx+rax]
4238765    mov     eax, [rbp-5Ch]
4238768    ror     eax, 1Bh
4238771    add     edx, eax
4238773    mov     eax, [rbp-60h]
4238776    add     eax, edx
4238778    sub     eax, 70E44324h
4238783    mov     [rbp-60h], eax
4238786    ror     dword [rbp-58h], 2
4238790    mov     eax, [rbp-58h]
4238793    mov     edx, [rbp-5Ch]
4238796    or      eax, edx
4238798    and     eax, [rbp-54h]
4238801    mov     edx, [rbp-58h]
4238804    mov     ecx, [rbp-5Ch]
4238807    and     edx, ecx
4238809    or      eax, edx
4238811    mov     ecx, eax
4238813    mov     edx, [rbp-30h]
4238816    mov     eax, [rbp-44h]
4238819    xor     edx, eax
4238821    mov     eax, [rbp-1Ch]
4238824    xor     edx, eax
4238826    mov     eax, [rbp-24h]
4238829    xor     eax, edx
4238831    ror     eax, 1Fh
4238834    mov     [rbp-24h], eax
4238837    mov     eax, [rbp-24h]
4238840    lea     edx, [rcx+rax]
4238843    mov     eax, [rbp-60h]
4238846    ror     eax, 1Bh
4238849    add     edx, eax
4238851    mov     eax, [rbp-64h]
4238854    add     eax, edx
4238856    sub     eax, 70E44324h
4238861    mov     [rbp-64h], eax
4238864    ror     dword [rbp-5Ch], 2
4238868    mov     eax, [rbp-5Ch]
4238871    mov     edx, [rbp-60h]
4238874    xor     eax, edx
4238876    xor     eax, [rbp-58h]
4238879    mov     edx, eax
4238881    mov     ecx, [rbp-2Ch]
4238884    mov     eax, [rbp-40h]
4238887    xor     ecx, eax
4238889    mov     eax, [rbp-18h]
4238892    xor     ecx, eax
4238894    mov     eax, [rbp-20h]
4238897    xor     eax, ecx
4238899    ror     eax, 1Fh
4238902    mov     [rbp-20h], eax
4238905    mov     eax, [rbp-20h]
4238908    add     edx, eax
4238910    mov     eax, [rbp-64h]
4238913    ror     eax, 1Bh
4238916    add     edx, eax
4238918    mov     eax, [rbp-54h]
4238921    add     eax, edx
4238923    sub     eax, 359D3E2Ah
4238928    mov     [rbp-54h], eax
4238931    ror     dword [rbp-60h], 2
4238935    mov     eax, [rbp-60h]
4238938    mov     edx, [rbp-64h]
4238941    xor     eax, edx
4238943    xor     eax, [rbp-5Ch]
4238946    mov     edx, eax
4238948    mov     ecx, [rbp-28h]
4238951    mov     eax, [rbp-3Ch]
4238954    xor     ecx, eax
4238956    mov     eax, [rbp-14h]
4238959    xor     ecx, eax
4238961    mov     eax, [rbp-1Ch]
4238964    xor     eax, ecx
4238966    ror     eax, 1Fh
4238969    mov     [rbp-1Ch], eax
4238972    mov     eax, [rbp-1Ch]
4238975    add     edx, eax
4238977    mov     eax, [rbp-54h]
4238980    ror     eax, 1Bh
4238983    add     edx, eax
4238985    mov     eax, [rbp-58h]
4238988    add     eax, edx
4238990    sub     eax, 359D3E2Ah
4238995    mov     [rbp-58h], eax
4238998    ror     dword [rbp-64h], 2
4239002    mov     eax, [rbp-64h]
4239005    mov     edx, [rbp-54h]
4239008    xor     eax, edx
4239010    xor     eax, [rbp-60h]
4239013    mov     edx, eax
4239015    mov     ecx, [rbp-24h]
4239018    mov     eax, [rbp-38h]
4239021    xor     ecx, eax
4239023    mov     eax, [rbp-50h]
4239026    xor     ecx, eax
4239028    mov     eax, [rbp-18h]
4239031    xor     eax, ecx
4239033    ror     eax, 1Fh
4239036    mov     [rbp-18h], eax
4239039    mov     eax, [rbp-18h]
4239042    add     edx, eax
4239044    mov     eax, [rbp-58h]
4239047    ror     eax, 1Bh
4239050    add     edx, eax
4239052    mov     eax, [rbp-5Ch]
4239055    add     eax, edx
4239057    sub     eax, 359D3E2Ah
4239062    mov     [rbp-5Ch], eax
4239065    ror     dword [rbp-54h], 2
4239069    mov     eax, [rbp-54h]
4239072    mov     edx, [rbp-58h]
4239075    xor     eax, edx
4239077    xor     eax, [rbp-64h]
4239080    mov     edx, eax
4239082    mov     ecx, [rbp-20h]
4239085    mov     eax, [rbp-34h]
4239088    xor     ecx, eax
4239090    mov     eax, [rbp-4Ch]
4239093    xor     ecx, eax
4239095    mov     eax, [rbp-14h]
4239098    xor     eax, ecx
4239100    ror     eax, 1Fh
4239103    mov     [rbp-14h], eax
4239106    mov     eax, [rbp-14h]
4239109    add     edx, eax
4239111    mov     eax, [rbp-5Ch]
4239114    ror     eax, 1Bh
4239117    add     edx, eax
4239119    mov     eax, [rbp-60h]
4239122    add     eax, edx
4239124    sub     eax, 359D3E2Ah
4239129    mov     [rbp-60h], eax
4239132    ror     dword [rbp-58h], 2
4239136    mov     eax, [rbp-58h]
4239139    mov     edx, [rbp-5Ch]
4239142    xor     eax, edx
4239144    xor     eax, [rbp-54h]
4239147    mov     edx, eax
4239149    mov     ecx, [rbp-1Ch]
4239152    mov     eax, [rbp-30h]
4239155    xor     ecx, eax
4239157    mov     eax, [rbp-48h]
4239160    xor     ecx, eax
4239162    mov     eax, [rbp-50h]
4239165    xor     eax, ecx
4239167    ror     eax, 1Fh
4239170    mov     [rbp-50h], eax
4239173    mov     eax, [rbp-50h]
4239176    add     edx, eax
4239178    mov     eax, [rbp-60h]
4239181    ror     eax, 1Bh
4239184    add     edx, eax
4239186    mov     eax, [rbp-64h]
4239189    add     eax, edx
4239191    sub     eax, 359D3E2Ah
4239196    mov     [rbp-64h], eax
4239199    ror     dword [rbp-5Ch], 2
4239203    mov     eax, [rbp-5Ch]
4239206    mov     edx, [rbp-60h]
4239209    xor     eax, edx
4239211    xor     eax, [rbp-58h]
4239214    mov     edx, eax
4239216    mov     ecx, [rbp-18h]
4239219    mov     eax, [rbp-2Ch]
4239222    xor     ecx, eax
4239224    mov     eax, [rbp-44h]
4239227    xor     ecx, eax
4239229    mov     eax, [rbp-4Ch]
4239232    xor     eax, ecx
4239234    ror     eax, 1Fh
4239237    mov     [rbp-4Ch], eax
4239240    mov     eax, [rbp-4Ch]
4239243    add     edx, eax
4239245    mov     eax, [rbp-64h]
4239248    ror     eax, 1Bh
4239251    add     edx, eax
4239253    mov     eax, [rbp-54h]
4239256    add     eax, edx
4239258    sub     eax, 359D3E2Ah
4239263    mov     [rbp-54h], eax
4239266    ror     dword [rbp-60h], 2
4239270    mov     eax, [rbp-60h]
4239273    mov     edx, [rbp-64h]
4239276    xor     eax, edx
4239278    xor     eax, [rbp-5Ch]
4239281    mov     edx, eax
4239283    mov     ecx, [rbp-14h]
4239286    mov     eax, [rbp-28h]
4239289    xor     ecx, eax
4239291    mov     eax, [rbp-40h]
4239294    xor     ecx, eax
4239296    mov     eax, [rbp-48h]
4239299    xor     eax, ecx
4239301    ror     eax, 1Fh
4239304    mov     [rbp-48h], eax
4239307    mov     eax, [rbp-48h]
4239310    add     edx, eax
4239312    mov     eax, [rbp-54h]
4239315    ror     eax, 1Bh
4239318    add     edx, eax
4239320    mov     eax, [rbp-58h]
4239323    add     eax, edx
4239325    sub     eax, 359D3E2Ah
4239330    mov     [rbp-58h], eax
4239333    ror     dword [rbp-64h], 2
4239337    mov     eax, [rbp-64h]
4239340    mov     edx, [rbp-54h]
4239343    xor     eax, edx
4239345    xor     eax, [rbp-60h]
4239348    mov     edx, eax
4239350    mov     ecx, [rbp-50h]
4239353    mov     eax, [rbp-24h]
4239356    xor     ecx, eax
4239358    mov     eax, [rbp-3Ch]
4239361    xor     ecx, eax
4239363    mov     eax, [rbp-44h]
4239366    xor     eax, ecx
4239368    ror     eax, 1Fh
4239371    mov     [rbp-44h], eax
4239374    mov     eax, [rbp-44h]
4239377    add     edx, eax
4239379    mov     eax, [rbp-58h]
4239382    ror     eax, 1Bh
4239385    add     edx, eax
4239387    mov     eax, [rbp-5Ch]
4239390    add     eax, edx
4239392    sub     eax, 359D3E2Ah
4239397    mov     [rbp-5Ch], eax
4239400    ror     dword [rbp-54h], 2
4239404    mov     eax, [rbp-54h]
4239407    mov     edx, [rbp-58h]
4239410    xor     eax, edx
4239412    xor     eax, [rbp-64h]
4239415    mov     edx, eax
4239417    mov     ecx, [rbp-4Ch]
4239420    mov     eax, [rbp-20h]
4239423    xor     ecx, eax
4239425    mov     eax, [rbp-38h]
4239428    xor     ecx, eax
4239430    mov     eax, [rbp-40h]
4239433    xor     eax, ecx
4239435    ror     eax, 1Fh
4239438    mov     [rbp-40h], eax
4239441    mov     eax, [rbp-40h]
4239444    add     edx, eax
4239446    mov     eax, [rbp-5Ch]
4239449    ror     eax, 1Bh
4239452    add     edx, eax
4239454    mov     eax, [rbp-60h]
4239457    add     eax, edx
4239459    sub     eax, 359D3E2Ah
4239464    mov     [rbp-60h], eax
4239467    ror     dword [rbp-58h], 2
4239471    mov     eax, [rbp-58h]
4239474    mov     edx, [rbp-5Ch]
4239477    xor     eax, edx
4239479    xor     eax, [rbp-54h]
4239482    mov     edx, eax
4239484    mov     ecx, [rbp-48h]
4239487    mov     eax, [rbp-1Ch]
4239490    xor     ecx, eax
4239492    mov     eax, [rbp-34h]
4239495    xor     ecx, eax
4239497    mov     eax, [rbp-3Ch]
4239500    xor     eax, ecx
4239502    ror     eax, 1Fh
4239505    mov     [rbp-3Ch], eax
4239508    mov     eax, [rbp-3Ch]
4239511    add     edx, eax
4239513    mov     eax, [rbp-60h]
4239516    ror     eax, 1Bh
4239519    add     edx, eax
4239521    mov     eax, [rbp-64h]
4239524    add     eax, edx
4239526    sub     eax, 359D3E2Ah
4239531    mov     [rbp-64h], eax
4239534    ror     dword [rbp-5Ch], 2
4239538    mov     eax, [rbp-5Ch]
4239541    mov     edx, [rbp-60h]
4239544    xor     eax, edx
4239546    xor     eax, [rbp-58h]
4239549    mov     edx, eax
4239551    mov     ecx, [rbp-44h]
4239554    mov     eax, [rbp-18h]
4239557    xor     ecx, eax
4239559    mov     eax, [rbp-30h]
4239562    xor     ecx, eax
4239564    mov     eax, [rbp-38h]
4239567    xor     eax, ecx
4239569    ror     eax, 1Fh
4239572    mov     [rbp-38h], eax
4239575    mov     eax, [rbp-38h]
4239578    add     edx, eax
4239580    mov     eax, [rbp-64h]
4239583    ror     eax, 1Bh
4239586    add     edx, eax
4239588    mov     eax, [rbp-54h]
4239591    add     eax, edx
4239593    sub     eax, 359D3E2Ah
4239598    mov     [rbp-54h], eax
4239601    ror     dword [rbp-60h], 2
4239605    mov     eax, [rbp-60h]
4239608    mov     edx, [rbp-64h]
4239611    xor     eax, edx
4239613    xor     eax, [rbp-5Ch]
4239616    mov     edx, eax
4239618    mov     ecx, [rbp-40h]
4239621    mov     eax, [rbp-14h]
4239624    xor     ecx, eax
4239626    mov     eax, [rbp-2Ch]
4239629    xor     ecx, eax
4239631    mov     eax, [rbp-34h]
4239634    xor     eax, ecx
4239636    ror     eax, 1Fh
4239639    mov     [rbp-34h], eax
4239642    mov     eax, [rbp-34h]
4239645    add     edx, eax
4239647    mov     eax, [rbp-54h]
4239650    ror     eax, 1Bh
4239653    add     edx, eax
4239655    mov     eax, [rbp-58h]
4239658    add     eax, edx
4239660    sub     eax, 359D3E2Ah
4239665    mov     [rbp-58h], eax
4239668    ror     dword [rbp-64h], 2
4239672    mov     eax, [rbp-64h]
4239675    mov     edx, [rbp-54h]
4239678    xor     eax, edx
4239680    xor     eax, [rbp-60h]
4239683    mov     edx, eax
4239685    mov     ecx, [rbp-3Ch]
4239688    mov     eax, [rbp-50h]
4239691    xor     ecx, eax
4239693    mov     eax, [rbp-28h]
4239696    xor     ecx, eax
4239698    mov     eax, [rbp-30h]
4239701    xor     eax, ecx
4239703    ror     eax, 1Fh
4239706    mov     [rbp-30h], eax
4239709    mov     eax, [rbp-30h]
4239712    add     edx, eax
4239714    mov     eax, [rbp-58h]
4239717    ror     eax, 1Bh
4239720    add     edx, eax
4239722    mov     eax, [rbp-5Ch]
4239725    add     eax, edx
4239727    sub     eax, 359D3E2Ah
4239732    mov     [rbp-5Ch], eax
4239735    ror     dword [rbp-54h], 2
4239739    mov     eax, [rbp-54h]
4239742    mov     edx, [rbp-58h]
4239745    xor     eax, edx
4239747    xor     eax, [rbp-64h]
4239750    mov     edx, eax
4239752    mov     ecx, [rbp-38h]
4239755    mov     eax, [rbp-4Ch]
4239758    xor     ecx, eax
4239760    mov     eax, [rbp-24h]
4239763    xor     ecx, eax
4239765    mov     eax, [rbp-2Ch]
4239768    xor     eax, ecx
4239770    ror     eax, 1Fh
4239773    mov     [rbp-2Ch], eax
4239776    mov     eax, [rbp-2Ch]
4239779    add     edx, eax
4239781    mov     eax, [rbp-5Ch]
4239784    ror     eax, 1Bh
4239787    add     edx, eax
4239789    mov     eax, [rbp-60h]
4239792    add     eax, edx
4239794    sub     eax, 359D3E2Ah
4239799    mov     [rbp-60h], eax
4239802    ror     dword [rbp-58h], 2
4239806    mov     eax, [rbp-58h]
4239809    mov     edx, [rbp-5Ch]
4239812    xor     eax, edx
4239814    xor     eax, [rbp-54h]
4239817    mov     edx, eax
4239819    mov     ecx, [rbp-34h]
4239822    mov     eax, [rbp-48h]
4239825    xor     ecx, eax
4239827    mov     eax, [rbp-20h]
4239830    xor     ecx, eax
4239832    mov     eax, [rbp-28h]
4239835    xor     eax, ecx
4239837    ror     eax, 1Fh
4239840    mov     [rbp-28h], eax
4239843    mov     eax, [rbp-28h]
4239846    add     edx, eax
4239848    mov     eax, [rbp-60h]
4239851    ror     eax, 1Bh
4239854    add     edx, eax
4239856    mov     eax, [rbp-64h]
4239859    add     eax, edx
4239861    sub     eax, 359D3E2Ah
4239866    mov     [rbp-64h], eax
4239869    ror     dword [rbp-5Ch], 2
4239873    mov     eax, [rbp-5Ch]
4239876    mov     edx, [rbp-60h]
4239879    xor     eax, edx
4239881    xor     eax, [rbp-58h]
4239884    mov     edx, eax
4239886    mov     ecx, [rbp-30h]
4239889    mov     eax, [rbp-44h]
4239892    xor     ecx, eax
4239894    mov     eax, [rbp-1Ch]
4239897    xor     ecx, eax
4239899    mov     eax, [rbp-24h]
4239902    xor     eax, ecx
4239904    ror     eax, 1Fh
4239907    mov     [rbp-24h], eax
4239910    mov     eax, [rbp-24h]
4239913    add     edx, eax
4239915    mov     eax, [rbp-64h]
4239918    ror     eax, 1Bh
4239921    add     edx, eax
4239923    mov     eax, [rbp-54h]
4239926    add     eax, edx
4239928    sub     eax, 359D3E2Ah
4239933    mov     [rbp-54h], eax
4239936    ror     dword [rbp-60h], 2
4239940    mov     eax, [rbp-60h]
4239943    mov     edx, [rbp-64h]
4239946    xor     eax, edx
4239948    xor     eax, [rbp-5Ch]
4239951    mov     edx, eax
4239953    mov     ecx, [rbp-2Ch]
4239956    mov     eax, [rbp-40h]
4239959    xor     ecx, eax
4239961    mov     eax, [rbp-18h]
4239964    xor     ecx, eax
4239966    mov     eax, [rbp-20h]
4239969    xor     eax, ecx
4239971    ror     eax, 1Fh
4239974    mov     [rbp-20h], eax
4239977    mov     eax, [rbp-20h]
4239980    add     edx, eax
4239982    mov     eax, [rbp-54h]
4239985    ror     eax, 1Bh
4239988    add     edx, eax
4239990    mov     eax, [rbp-58h]
4239993    add     eax, edx
4239995    sub     eax, 359D3E2Ah
4240000    mov     [rbp-58h], eax
4240003    ror     dword [rbp-64h], 2
4240007    mov     eax, [rbp-64h]
4240010    mov     edx, [rbp-54h]
4240013    xor     eax, edx
4240015    xor     eax, [rbp-60h]
4240018    mov     edx, eax
4240020    mov     ecx, [rbp-28h]
4240023    mov     eax, [rbp-3Ch]
4240026    xor     ecx, eax
4240028    mov     eax, [rbp-14h]
4240031    xor     ecx, eax
4240033    mov     eax, [rbp-1Ch]
4240036    xor     eax, ecx
4240038    ror     eax, 1Fh
4240041    mov     [rbp-1Ch], eax
4240044    mov     eax, [rbp-1Ch]
4240047    add     edx, eax
4240049    mov     eax, [rbp-58h]
4240052    ror     eax, 1Bh
4240055    add     edx, eax
4240057    mov     eax, [rbp-5Ch]
4240060    add     eax, edx
4240062    sub     eax, 359D3E2Ah
4240067    mov     [rbp-5Ch], eax
4240070    ror     dword [rbp-54h], 2
4240074    mov     eax, [rbp-54h]
4240077    mov     edx, [rbp-58h]
4240080    xor     eax, edx
4240082    xor     eax, [rbp-64h]
4240085    mov     edx, eax
4240087    mov     ecx, [rbp-24h]
4240090    mov     eax, [rbp-38h]
4240093    xor     ecx, eax
4240095    mov     eax, [rbp-50h]
4240098    xor     ecx, eax
4240100    mov     eax, [rbp-18h]
4240103    xor     eax, ecx
4240105    ror     eax, 1Fh
4240108    mov     [rbp-18h], eax
4240111    mov     eax, [rbp-18h]
4240114    add     edx, eax
4240116    mov     eax, [rbp-5Ch]
4240119    ror     eax, 1Bh
4240122    add     edx, eax
4240124    mov     eax, [rbp-60h]
4240127    add     eax, edx
4240129    sub     eax, 359D3E2Ah
4240134    mov     [rbp-60h], eax
4240137    ror     dword [rbp-58h], 2
4240141    mov     eax, [rbp-58h]
4240144    mov     edx, [rbp-5Ch]
4240147    xor     eax, edx
4240149    xor     eax, [rbp-54h]
4240152    mov     edx, eax
4240154    mov     ecx, [rbp-20h]
4240157    mov     eax, [rbp-34h]
4240160    xor     ecx, eax
4240162    mov     eax, [rbp-4Ch]
4240165    xor     ecx, eax
4240167    mov     eax, [rbp-14h]
4240170    xor     eax, ecx
4240172    ror     eax, 1Fh
4240175    mov     [rbp-14h], eax
4240178    mov     eax, [rbp-14h]
4240181    add     edx, eax
4240183    mov     eax, [rbp-60h]
4240186    ror     eax, 1Bh
4240189    add     edx, eax
4240191    mov     eax, [rbp-64h]
4240194    add     eax, edx
4240196    sub     eax, 359D3E2Ah
4240201    mov     [rbp-64h], eax
4240204    ror     dword [rbp-5Ch], 2
4240208    mov     rax, [rbp-78h]
4240212    mov     edx, [rax]
4240214    mov     eax, [rbp-64h]
4240217    add     edx, eax
4240219    mov     rax, [rbp-78h]
4240223    mov     [rax], edx
4240225    mov     rax, [rbp-78h]
4240229    add     rax, 4
4240233    mov     rdx, [rbp-78h]
4240237    add     rdx, 4
4240241    mov     ecx, [rdx]
4240243    mov     edx, [rbp-60h]
4240246    add     edx, ecx
4240248    mov     [rax], edx
4240250    mov     rax, [rbp-78h]
4240254    add     rax, 8
4240258    mov     rdx, [rbp-78h]
4240262    add     rdx, 8
4240266    mov     ecx, [rdx]
4240268    mov     edx, [rbp-5Ch]
4240271    add     edx, ecx
4240273    mov     [rax], edx
4240275    mov     rax, [rbp-78h]
4240279    add     rax, 0Ch
4240283    mov     rdx, [rbp-78h]
4240287    add     rdx, 0Ch
4240291    mov     ecx, [rdx]
4240293    mov     edx, [rbp-58h]
4240296    add     edx, ecx
4240298    mov     [rax], edx
4240300    mov     rax, [rbp-78h]
4240304    add     rax, 10h
4240308    mov     rdx, [rbp-78h]
4240312    add     rdx, 10h
4240316    mov     ecx, [rdx]
4240318    mov     edx, [rbp-54h]
4240321    add     edx, ecx
4240323    mov     [rax], edx
4240325    lea     rax, [rbp-50h]
4240329    mov     edx, 40h
4240334    mov     esi, 0
4240339    mov     rdi, rax
4240342    call    _memset
4240347    mov     dword [rbp-54h], 0
4240354    mov     eax, [rbp-54h]
4240357    mov     [rbp-58h], eax
4240360    mov     eax, [rbp-58h]
4240363    mov     [rbp-5Ch], eax
4240366    mov     eax, [rbp-5Ch]
4240369    mov     [rbp-60h], eax
4240372    mov     eax, [rbp-60h]
4240375    mov     [rbp-64h], eax
4240378    add     rsp, 78h
4240382    pop     rbx
4240383    pop     rbp
4240384    retn    
USE32

section .text

global _SHA1Init

_SHA1Init:
4240385    push    rbp
4240386    mov     rbp, rsp
4240389    sub     rsp, 8
4240393    call    _mcount
4240398    mov     [rbp-8], rdi
4240402    mov     rax, [rbp-8]
4240406    mov     dword [rax], 67452301h
4240412    mov     rax, [rbp-8]
4240416    mov     dword [rax+4], 0EFCDAB89h
4240423    mov     rax, [rbp-8]
4240427    mov     dword [rax+8], 98BADCFEh
4240434    mov     rax, [rbp-8]
4240438    mov     dword [rax+0Ch], 10325476h
4240445    mov     rax, [rbp-8]
4240449    mov     dword [rax+10h], 0C3D2E1F0h
4240456    mov     rax, [rbp-8]
4240460    mov     dword [rax+18h], 0
4240467    mov     rax, [rbp-8]
4240471    mov     edx, [rax+18h]
4240474    mov     rax, [rbp-8]
4240478    mov     [rax+14h], edx
4240481    leave   
4240482    retn    
USE32

section .text

global _SHA1Update

_SHA1Update:
4240483    push    rbp
4240484    mov     rbp, rsp
4240487    sub     rsp, 30h
4240491    call    _mcount
4240496    mov     [rbp-18h], rdi
4240500    mov     [rbp-20h], rsi
4240504    mov     [rbp-28h], rdx
4240508    mov     rax, [rbp-18h]
4240512    mov     eax, [rax+14h]
4240515    mov     eax, eax
4240517    mov     [rbp-8], rax
4240521    mov     rax, [rbp-18h]
4240525    mov     eax, [rax+14h]
4240528    mov     rdx, [rbp-28h]
4240532    shl     edx, 3
4240535    add     edx, eax
4240537    mov     rax, [rbp-18h]
4240541    mov     [rax+14h], edx
4240544    mov     rax, [rbp-18h]
4240548    mov     eax, [rax+14h]
4240551    mov     eax, eax
4240553    cmp     rax, [rbp-8]
4240557    jnb     loc_40B4C0
4240559    mov     rax, [rbp-18h]
4240563    mov     eax, [rax+18h]
4240566    lea     edx, [rax+1]
4240569    mov     rax, [rbp-18h]
4240573    mov     [rax+18h], edx
loc_40B4C0:
4240576    mov     rax, [rbp-18h]
4240580    mov     edx, [rax+18h]
4240583    mov     rax, [rbp-28h]
4240587    shr     rax, 1Dh
4240591    add     edx, eax
4240593    mov     rax, [rbp-18h]
4240597    mov     [rax+18h], edx
4240600    mov     rax, [rbp-8]
4240604    shr     rax, 3
4240608    and     eax, 3Fh
4240611    mov     [rbp-8], rax
4240615    mov     rax, [rbp-28h]
4240619    mov     rdx, [rbp-8]
4240623    add     rax, rdx
4240626    cmp     rax, 3Fh
4240630    jbe     loc_40B57F
4240636    mov     eax, 40h
4240641    sub     rax, [rbp-8]
4240645    mov     [rbp-10h], rax
4240649    mov     rax, [rbp-8]
4240653    lea     rdx, [rax+10h]
4240657    mov     rax, [rbp-18h]
4240661    add     rax, rdx
4240664    lea     rcx, [rax+0Ch]
4240668    mov     rdx, [rbp-10h]
4240672    mov     rax, [rbp-20h]
4240676    mov     rsi, rax
4240679    mov     rdi, rcx
4240682    call    _memcpy
4240687    mov     rax, [rbp-18h]
4240691    lea     rdx, [rax+1Ch]
4240695    mov     rax, [rbp-18h]
4240699    mov     rsi, rdx
4240702    mov     rdi, rax
4240705    call    _SHA1Transform
4240710    jmp     loc_40B567
loc_40B548:
4240712    mov     rax, [rbp-10h]
4240716    mov     rdx, [rbp-20h]
4240720    add     rdx, rax
4240723    mov     rax, [rbp-18h]
4240727    mov     rsi, rdx
4240730    mov     rdi, rax
4240733    call    _SHA1Transform
4240738    add     qword [rbp-10h], 40h
loc_40B567:
4240743    mov     rax, [rbp-10h]
4240747    add     rax, 3Fh
4240751    cmp     rax, [rbp-28h]
4240755    jb      loc_40B548
4240757    mov     qword [rbp-8], 0
4240765    jmp     loc_40B587
loc_40B57F:
4240767    mov     qword [rbp-10h], 0
loc_40B587:
4240775    mov     rax, [rbp-10h]
4240779    mov     rdx, [rbp-28h]
4240783    sub     rdx, rax
4240786    mov     rax, [rbp-10h]
4240790    mov     rcx, [rbp-20h]
4240794    add     rcx, rax
4240797    mov     rax, [rbp-8]
4240801    lea     rsi, [rax+10h]
4240805    mov     rax, [rbp-18h]
4240809    add     rax, rsi
4240812    add     rax, 0Ch
4240816    mov     rsi, rcx
4240819    mov     rdi, rax
4240822    call    _memcpy
4240827    leave   
4240828    retn    
USE32

section .text

global _SHA1Final

_SHA1Final:
4240829    push    rbp
4240830    mov     rbp, rsp
4240833    sub     rsp, 30h
4240837    call    _mcount
4240842    mov     [rbp-28h], rdi
4240846    mov     [rbp-30h], rsi
4240850    mov     rax, [fs:28h]
4240859    mov     [rbp-8], rax
4240863    xor     eax, eax
4240865    mov     dword [rbp-14h], 0
4240872    jmp     loc_40B621
loc_40B5EA:
4240874    cmp     dword [rbp-14h], 3
4240878    setbe   al
4240881    movzx   edx, al
4240884    mov     rax, [rbp-30h]
4240888    movsxd  rdx, edx
4240891    add     rdx, 4
4240895    mov     edx, [rax+rdx*4+4]
4240899    mov     eax, [rbp-14h]
4240902    not     eax
4240904    and     eax, 3
4240907    shl     eax, 3
4240910    mov     ecx, eax
4240912    shr     edx, cl
4240914    mov     eax, edx
4240916    mov     edx, eax
4240918    mov     eax, [rbp-14h]
4240921    mov     [rbp+rax-10h], dl
4240925    add     dword [rbp-14h], 1
loc_40B621:
4240929    cmp     dword [rbp-14h], 7
4240933    jbe     loc_40B5EA
4240935    mov     byte [rbp-15h], 80h
4240939    lea     rcx, [rbp-15h]
4240943    mov     rax, [rbp-30h]
4240947    mov     edx, 1
4240952    mov     rsi, rcx
4240955    mov     rdi, rax
4240958    call    _SHA1Update
4240963    jmp     loc_40B661
loc_40B645:
4240965    mov     byte [rbp-15h], 0
4240969    lea     rcx, [rbp-15h]
4240973    mov     rax, [rbp-30h]
4240977    mov     edx, 1
4240982    mov     rsi, rcx
4240985    mov     rdi, rax
4240988    call    _SHA1Update
loc_40B661:
4240993    mov     rax, [rbp-30h]
4240997    mov     eax, [rax+14h]
4241000    and     eax, 1F8h
4241005    cmp     eax, 1C0h
4241010    jnz     loc_40B645
4241012    lea     rcx, [rbp-10h]
4241016    mov     rax, [rbp-30h]
4241020    mov     edx, 8
4241025    mov     rsi, rcx
4241028    mov     rdi, rax
4241031    call    _SHA1Update
4241036    mov     dword [rbp-14h], 0
4241043    jmp     loc_40B6C8
loc_40B695:
4241045    mov     edx, [rbp-14h]
4241048    mov     rax, [rbp-28h]
4241052    lea     rsi, [rdx+rax]
4241056    mov     eax, [rbp-14h]
4241059    shr     eax, 2
4241062    mov     edx, eax
4241064    mov     rax, [rbp-30h]
4241068    mov     edx, edx
4241070    mov     edx, [rax+rdx*4]
4241073    mov     eax, [rbp-14h]
4241076    not     eax
4241078    and     eax, 3
4241081    shl     eax, 3
4241084    mov     ecx, eax
4241086    shr     edx, cl
4241088    mov     eax, edx
4241090    mov     [rsi], al
4241092    add     dword [rbp-14h], 1
loc_40B6C8:
4241096    cmp     dword [rbp-14h], 13h
4241100    jbe     loc_40B695
4241102    mov     rax, [rbp-30h]
4241106    mov     edx, 5Ch
4241111    mov     esi, 0
4241116    mov     rdi, rax
4241119    call    _memset
4241124    lea     rax, [rbp-10h]
4241128    mov     edx, 8
4241133    mov     esi, 0
4241138    mov     rdi, rax
4241141    call    _memset
4241146    mov     rax, [rbp-8]
4241150    xor     rax, [fs:28h]
4241159    jz      locret_40B70E
4241161    call    ___stack_chk_fail
locret_40B70E:
4241166    leave   
4241167    retn    
USE32

section .text

global _base64_encode

_base64_encode:
4241168    push    rbp
4241169    mov     rbp, rsp
4241172    sub     rsp, 38h
4241176    call    _mcount
4241181    mov     [rbp-28h], rdi
4241185    mov     [rbp-2Ch], esi
4241188    mov     [rbp-38h], rdx
4241192    mov     dword [rbp-10h], 0
4241199    mov     eax, [rbp-10h]
4241202    mov     [rbp-14h], eax
4241205    jmp     loc_40B885
loc_40B73A:
4241210    mov     eax, [rbp-14h]
4241213    movsxd  rdx, eax
4241216    mov     rax, [rbp-28h]
4241220    add     rax, rdx
4241223    movzx   eax, byte [rax]
4241226    movzx   eax, al
4241229    mov     [rbp-0Ch], eax
4241232    mov     eax, [rbp-14h]
4241235    add     eax, 1
4241238    cmp     eax, [rbp-2Ch]
4241241    jge     loc_40B773
4241243    mov     eax, [rbp-14h]
4241246    cdqe    
4241248    lea     rdx, [rax+1]
4241252    mov     rax, [rbp-28h]
4241256    add     rax, rdx
4241259    movzx   eax, byte [rax]
4241262    movzx   eax, al
4241265    jmp     loc_40B778
loc_40B773:
4241267    mov     eax, 0
loc_40B778:
4241272    mov     [rbp-8], eax
4241275    mov     eax, [rbp-14h]
4241278    add     eax, 2
4241281    cmp     eax, [rbp-2Ch]
4241284    jge     loc_40B79E
4241286    mov     eax, [rbp-14h]
4241289    cdqe    
4241291    lea     rdx, [rax+2]
4241295    mov     rax, [rbp-28h]
4241299    add     rax, rdx
4241302    movzx   eax, byte [rax]
4241305    movzx   eax, al
4241308    jmp     loc_40B7A3
loc_40B79E:
4241310    mov     eax, 0
loc_40B7A3:
4241315    mov     [rbp-4], eax
4241318    mov     eax, [rbp-10h]
4241321    lea     edx, [rax+1]
4241324    mov     [rbp-10h], edx
4241327    movsxd  rdx, eax
4241330    mov     rax, [rbp-38h]
4241334    add     rdx, rax
4241337    mov     rcx, [cs:b64_6601]
4241344    mov     eax, [rbp-0Ch]
4241347    sar     eax, 2
4241350    cdqe    
4241352    add     rax, rcx
4241355    movzx   eax, byte [rax]
4241358    mov     [rdx], al
4241360    mov     eax, [rbp-10h]
4241363    lea     edx, [rax+1]
4241366    mov     [rbp-10h], edx
4241369    movsxd  rdx, eax
4241372    mov     rax, [rbp-38h]
4241376    add     rdx, rax
4241379    mov     rcx, [cs:b64_6601]
4241386    mov     eax, [rbp-0Ch]
4241389    and     eax, 3
4241392    shl     eax, 4
4241395    mov     esi, eax
4241397    mov     eax, [rbp-8]
4241400    sar     eax, 4
4241403    or      eax, esi
4241405    cdqe    
4241407    add     rax, rcx
4241410    movzx   eax, byte [rax]
4241413    mov     [rdx], al
4241415    mov     eax, [rbp-14h]
4241418    add     eax, 1
4241421    cmp     eax, [rbp-2Ch]
4241424    jge     loc_40B84B
4241426    mov     eax, [rbp-10h]
4241429    lea     edx, [rax+1]
4241432    mov     [rbp-10h], edx
4241435    movsxd  rdx, eax
4241438    mov     rax, [rbp-38h]
4241442    add     rdx, rax
4241445    mov     rcx, [cs:b64_6601]
4241452    mov     eax, [rbp-8]
4241455    and     eax, 0Fh
4241458    lea     esi, 0[rax*4]
4241465    mov     eax, [rbp-4]
4241468    sar     eax, 6
4241471    or      eax, esi
4241473    cdqe    
4241475    add     rax, rcx
4241478    movzx   eax, byte [rax]
4241481    mov     [rdx], al
loc_40B84B:
4241483    mov     eax, [rbp-14h]
4241486    add     eax, 2
4241489    cmp     eax, [rbp-2Ch]
4241492    jge     loc_40B881
4241494    mov     eax, [rbp-10h]
4241497    lea     edx, [rax+1]
4241500    mov     [rbp-10h], edx
4241503    movsxd  rdx, eax
4241506    mov     rax, [rbp-38h]
4241510    add     rdx, rax
4241513    mov     rax, [cs:b64_6601]
4241520    mov     ecx, [rbp-4]
4241523    movsxd  rcx, ecx
4241526    and     ecx, 3Fh
4241529    add     rax, rcx
4241532    movzx   eax, byte [rax]
4241535    mov     [rdx], al
loc_40B881:
4241537    add     dword [rbp-14h], 3
loc_40B885:
4241541    mov     eax, [rbp-14h]
4241544    cmp     eax, [rbp-2Ch]
4241547    jl      loc_40B73A
4241553    jmp     loc_40B8A9
loc_40B893:
4241555    mov     eax, [rbp-10h]
4241558    lea     edx, [rax+1]
4241561    mov     [rbp-10h], edx
4241564    movsxd  rdx, eax
4241567    mov     rax, [rbp-38h]
4241571    add     rax, rdx
4241574    mov     byte [rax], 3Dh
loc_40B8A9:
4241577    mov     eax, [rbp-10h]
4241580    and     eax, 3
4241583    test    eax, eax
4241585    jnz     loc_40B893
4241587    mov     eax, [rbp-10h]
4241590    lea     edx, [rax+1]
4241593    mov     [rbp-10h], edx
4241596    movsxd  rdx, eax
4241599    mov     rax, [rbp-38h]
4241603    add     rax, rdx
4241606    mov     byte [rax], 0
4241609    leave   
4241610    retn    
USE32

section .text

global _send_websocket_handshake

_send_websocket_handshake:
4241611    push    rbp
4241612    mov     rbp, rsp
4241615    sub     rsp, 2C0h
4241622    call    _mcount
4241627    mov     [rbp-2B8h], rdi
4241634    mov     [rbp-2C0h], rsi
4241641    mov     rax, [fs:28h]
4241650    mov     [rbp-8], rax
4241654    xor     eax, eax
4241656    mov     rcx, [cs:magic_6617]
4241663    mov     rdx, [rbp-2C0h]
4241670    lea     rax, [rbp-200h]
4241677    mov     r8, rcx
4241680    mov     rcx, rdx
4241683    mov     edx, aSS_2
4241688    mov     esi, 1F4h
4241693    mov     rdi, rax
4241696    mov     eax, 0
4241701    call    _mg_snprintf
4241706    lea     rax, [rbp-260h]
4241713    mov     rdi, rax
4241716    call    _SHA1Init
4241721    lea     rax, [rbp-200h]
4241728    mov     rdi, rax
4241731    call    _strlen
4241736    mov     rdx, rax
4241739    lea     rcx, [rbp-200h]
4241746    lea     rax, [rbp-260h]
4241753    mov     rsi, rcx
4241756    mov     rdi, rax
4241759    call    _SHA1Update
4241764    lea     rdx, [rbp-260h]
4241771    lea     rax, [rbp-2B0h]
4241778    mov     rsi, rdx
4241781    mov     rdi, rax
4241784    call    _SHA1Final
4241789    lea     rdx, [rbp-290h]
4241796    lea     rax, [rbp-2B0h]
4241803    mov     esi, 14h
4241808    mov     rdi, rax
4241811    call    _base64_encode
4241816    lea     rdx, [rbp-290h]
4241823    lea     rax, [rbp-200h]
4241830    mov     r9d, asc_4160CC
4241836    mov     r8, rdx
4241839    mov     ecx, aHttp1_1101Swit
4241844    mov     edx, aSSS_0
4241849    mov     esi, 1F4h
4241854    mov     rdi, rax
4241857    mov     eax, 0
4241862    call    _mg_snprintf
4241867    lea     rax, [rbp-200h]
4241874    mov     rdi, rax
4241877    call    _strlen
4241882    mov     rdx, rax
4241885    lea     rcx, [rbp-200h]
4241892    mov     rax, [rbp-2B8h]
4241899    mov     rsi, rcx
4241902    mov     rdi, rax
4241905    call    _mg_write
4241910    mov     rax, [rbp-8]
4241914    xor     rax, [fs:28h]
4241923    jz      locret_40BA0A
4241925    call    ___stack_chk_fail
locret_40BA0A:
4241930    leave   
4241931    retn    
USE32

section .text

global _deliver_websocket_frame

_deliver_websocket_frame:
4241932    push    rbp
4241933    mov     rbp, rsp
4241936    push    rbx
4241937    sub     rsp, 68h
4241941    call    _mcount
4241946    mov     [rbp-68h], rdi
4241950    mov     rax, [rbp-68h]
4241954    mov     rax, [rax]
4241957    mov     rax, [rax+38h]
4241961    mov     [rbp-38h], rax
4241965    mov     rax, [rbp-68h]
4241969    mov     rax, [rax]
4241972    mov     rax, [rax+40h]
4241976    mov     [rbp-30h], rax
4241980    mov     qword [rbp-28h], 0
4241988    mov     qword [rbp-50h], 0
4241996    mov     qword [rbp-48h], 0
4242004    mov     qword [rbp-40h], 0
4242012    mov     qword [rbp-20h], 0
4242020    cmp     qword [rbp-30h], 1
4242025    jbe     loc_40BB68
4242031    mov     rax, [rbp-38h]
4242035    add     rax, 1
4242039    movzx   eax, byte [rax]
4242042    movzx   eax, al
4242045    and     eax, 7Fh
4242048    mov     [rbp-18h], rax
4242052    mov     rax, [rbp-38h]
4242056    add     rax, 1
4242060    movzx   eax, byte [rax]
4242063    test    al, al
4242065    jns     loc_40BA9A
4242067    mov     eax, 4
4242072    jmp     loc_40BA9F
loc_40BA9A:
4242074    mov     eax, 0
loc_40BA9F:
4242079    mov     [rbp-50h], rax
4242083    cmp     qword [rbp-18h], 7Dh
4242088    ja      loc_40BACD
4242090    mov     rax, [rbp-30h]
4242094    cmp     rax, [rbp-50h]
4242098    jb      loc_40BACD
4242100    mov     rax, [rbp-18h]
4242104    mov     [rbp-40h], rax
4242108    mov     rax, [rbp-50h]
4242112    add     rax, 2
4242116    mov     [rbp-48h], rax
4242120    jmp     loc_40BB68
loc_40BACD:
4242125    cmp     qword [rbp-18h], 7Eh
4242130    jnz     loc_40BB1A
4242132    mov     rax, [rbp-50h]
4242136    add     rax, 4
4242140    cmp     rax, [rbp-30h]
4242144    ja      loc_40BB1A
4242146    mov     rax, [rbp-50h]
4242150    add     rax, 4
4242154    mov     [rbp-48h], rax
4242158    mov     rax, [rbp-38h]
4242162    add     rax, 2
4242166    movzx   eax, byte [rax]
4242169    movzx   eax, al
4242172    shl     rax, 8
4242176    mov     rdx, rax
4242179    mov     rax, [rbp-38h]
4242183    add     rax, 3
4242187    movzx   eax, byte [rax]
4242190    movzx   eax, al
4242193    add     rax, rdx
4242196    mov     [rbp-40h], rax
4242200    jmp     loc_40BB68
loc_40BB1A:
4242202    mov     rax, [rbp-50h]
4242206    add     rax, 0Ah
4242210    cmp     rax, [rbp-30h]
4242214    ja      loc_40BB68
4242216    mov     rax, [rbp-50h]
4242220    add     rax, 0Ah
4242224    mov     [rbp-48h], rax
4242228    mov     rax, [rbp-38h]
4242232    add     rax, 2
4242236    mov     eax, [rax]
4242238    mov     edi, eax
4242240    call    _htonl
4242245    mov     eax, eax
4242247    shl     rax, 20h
4242251    mov     rbx, rax
4242254    mov     rax, [rbp-38h]
4242258    add     rax, 6
4242262    mov     eax, [rax]
4242264    mov     edi, eax
4242266    call    _htonl
4242271    mov     eax, eax
4242273    add     rax, rbx
4242276    mov     [rbp-40h], rax
loc_40BB68:
4242280    mov     rax, [rbp-40h]
4242284    mov     rdx, [rbp-48h]
4242288    add     rax, rdx
4242291    mov     [rbp-28h], rax
4242295    cmp     qword [rbp-28h], 0
4242300    jz      loc_40BB8F
4242302    mov     rax, [rbp-28h]
4242306    cmp     rax, [rbp-30h]
4242310    ja      loc_40BB8F
4242312    mov     eax, 1
4242317    jmp     loc_40BB94
loc_40BB8F:
4242319    mov     eax, 0
loc_40BB94:
4242324    cdqe    
4242326    mov     [rbp-20h], rax
4242330    cmp     qword [rbp-20h], 0
4242335    jz      loc_40BC94
4242341    mov     rax, [rbp-68h]
4242345    mov     rdx, [rbp-40h]
4242349    mov     [rax+278h], rdx
4242356    mov     rax, [rbp-48h]
4242360    mov     rdx, [rbp-38h]
4242364    add     rdx, rax
4242367    mov     rax, [rbp-68h]
4242371    mov     [rax+270h], rdx
4242378    mov     rax, [rbp-38h]
4242382    movzx   eax, byte [rax]
4242385    movzx   edx, al
4242388    mov     rax, [rbp-68h]
4242392    mov     [rax+288h], edx
4242398    cmp     qword [rbp-50h], 0
4242403    jz      loc_40BC48
4242405    mov     qword [rbp-58h], 0
4242413    jmp     loc_40BC3E
loc_40BBEF:
4242415    mov     rax, [rbp-48h]
4242419    mov     rdx, [rbp-58h]
4242423    add     rdx, rax
4242426    mov     rax, [rbp-38h]
4242430    add     rdx, rax
4242433    mov     rax, [rbp-48h]
4242437    mov     rcx, [rbp-58h]
4242441    add     rcx, rax
4242444    mov     rax, [rbp-38h]
4242448    add     rax, rcx
4242451    movzx   ecx, byte [rax]
4242454    mov     rax, [rbp-50h]
4242458    mov     rsi, [rbp-48h]
4242462    sub     rsi, rax
4242465    mov     rax, [rbp-58h]
4242469    and     eax, 3
4242472    add     rsi, rax
4242475    mov     rax, [rbp-38h]
4242479    add     rax, rsi
4242482    movzx   eax, byte [rax]
4242485    xor     eax, ecx
4242487    mov     [rdx], al
4242489    add     qword [rbp-58h], 1
loc_40BC3E:
4242494    mov     rax, [rbp-58h]
4242498    cmp     rax, [rbp-40h]
4242502    jb      loc_40BBEF
loc_40BC48:
4242504    mov     rax, [rbp-68h]
4242508    mov     esi, 67h
4242513    mov     rdi, rax
4242516    call    _call_user
4242521    test    eax, eax
4242523    jnz     loc_40BC7A
4242525    mov     rax, [rbp-68h]
4242529    mov     rax, [rax]
4242532    mov     rdx, [rbp-68h]
4242536    mov     rdx, [rdx]
4242539    mov     edx, [rdx+98h]
4242545    or      edx, 1
4242548    mov     [rax+98h], edx
loc_40BC7A:
4242554    mov     rax, [rbp-68h]
4242558    mov     rax, [rax]
4242561    lea     rdx, [rax+38h]
4242565    mov     rax, [rbp-28h]
4242569    mov     rsi, rax
4242572    mov     rdi, rdx
4242575    call    _iobuf_remove
loc_40BC94:
4242580    mov     rax, [rbp-20h]
4242584    add     rsp, 68h
4242588    pop     rbx
4242589    pop     rbp
4242590    retn    
USE32

section .text

global _mg_websocket_write

_mg_websocket_write:
4242591    push    rbp
4242592    mov     rbp, rsp
4242595    push    rbx
4242596    sub     rsp, 10B8h
4242603    call    _mcount
4242608    mov     [rbp-10A8h], rdi
4242615    mov     [rbp-10ACh], esi
4242621    mov     [rbp-10B8h], rdx
4242628    mov     [rbp-10C0h], rcx
4242635    mov     rax, [fs:28h]
4242644    mov     [rbp-18h], rax
4242648    xor     eax, eax
4242650    lea     rax, [rbp-1080h]
4242657    mov     [rbp-1090h], rax
4242664    mov     qword [rbp-1088h], 0
4242675    cmp     qword [rbp-10C0h], 0FFFFFFFFFFFFFFF5h
4242683    jbe     loc_40BD07
4242685    mov     eax, 0
4242690    jmp     loc_40BF50
loc_40BD07:
4242695    mov     rax, [rbp-10C0h]
4242702    add     rax, 0Ah
4242706    cmp     rax, 1060h
4242712    jbe     loc_40BD48
4242714    mov     rax, [rbp-10C0h]
4242721    add     rax, 0Ah
4242725    mov     rdi, rax
4242728    call    _malloc
4242733    mov     [rbp-1090h], rax
4242740    cmp     qword [rbp-1090h], 0
4242748    jnz     loc_40BD48
4242750    mov     eax, 0
4242755    jmp     loc_40BF50
loc_40BD48:
4242760    mov     eax, [rbp-10ACh]
4242766    and     eax, 0Fh
4242769    lea     edx, [rax-80h]
4242772    mov     rax, [rbp-1090h]
4242779    mov     [rax], dl
4242781    cmp     qword [rbp-10C0h], 7Dh
4242789    ja      loc_40BDB6
4242791    mov     rax, [rbp-1090h]
4242798    lea     rdx, [rax+1]
4242802    mov     rax, [rbp-10C0h]
4242809    mov     [rdx], al
4242811    mov     rax, [rbp-1090h]
4242818    lea     rcx, [rax+2]
4242822    mov     rdx, [rbp-10C0h]
4242829    mov     rax, [rbp-10B8h]
4242836    mov     rsi, rax
4242839    mov     rdi, rcx
4242842    call    _memcpy
4242847    mov     rax, [rbp-10C0h]
4242854    add     rax, 2
4242858    mov     [rbp-1088h], rax
4242865    jmp     loc_40BEC1
loc_40BDB6:
4242870    cmp     qword [rbp-10C0h], 0FFFFh
4242881    ja      loc_40BE2B
4242883    mov     rax, [rbp-1090h]
4242890    add     rax, 1
4242894    mov     byte [rax], 7Eh
4242897    mov     rax, [rbp-1090h]
4242904    lea     rbx, [rax+2]
4242908    mov     rax, [rbp-10C0h]
4242915    movzx   eax, ax
4242918    mov     edi, eax
4242920    call    _htons
4242925    mov     [rbx], ax
4242928    mov     rax, [rbp-1090h]
4242935    lea     rcx, [rax+4]
4242939    mov     rdx, [rbp-10C0h]
4242946    mov     rax, [rbp-10B8h]
4242953    mov     rsi, rax
4242956    mov     rdi, rcx
4242959    call    _memcpy
4242964    mov     rax, [rbp-10C0h]
4242971    add     rax, 4
4242975    mov     [rbp-1088h], rax
4242982    jmp     loc_40BEC1
loc_40BE2B:
4242987    mov     rax, [rbp-10C0h]
4242994    shr     rax, 20h
4242998    mov     edi, eax
4243000    call    _htonl
4243005    mov     [rbp-1098h], eax
4243011    mov     rax, [rbp-10C0h]
4243018    mov     edi, eax
4243020    call    _htonl
4243025    mov     [rbp-1094h], eax
4243031    mov     rax, [rbp-1090h]
4243038    add     rax, 1
4243042    mov     byte [rax], 7Fh
4243045    mov     rax, [rbp-1090h]
4243052    lea     rdx, [rax+2]
4243056    mov     eax, [rbp-1098h]
4243062    mov     [rdx], eax
4243064    mov     rax, [rbp-1090h]
4243071    lea     rdx, [rax+6]
4243075    mov     eax, [rbp-1094h]
4243081    mov     [rdx], eax
4243083    mov     rax, [rbp-1090h]
4243090    lea     rcx, [rax+0Ah]
4243094    mov     rdx, [rbp-10C0h]
4243101    mov     rax, [rbp-10B8h]
4243108    mov     rsi, rax
4243111    mov     rdi, rcx
4243114    call    _memcpy
4243119    mov     rax, [rbp-10C0h]
4243126    add     rax, 0Ah
4243130    mov     [rbp-1088h], rax
loc_40BEC1:
4243137    cmp     qword [rbp-1088h], 0
4243145    jz      loc_40BEEB
4243147    mov     rdx, [rbp-1088h]
4243154    mov     rcx, [rbp-1090h]
4243161    mov     rax, [rbp-10A8h]
4243168    mov     rsi, rcx
4243171    mov     rdi, rax
4243174    call    _mg_write
loc_40BEEB:
4243179    lea     rax, [rbp-1080h]
4243186    cmp     [rbp-1090h], rax
4243193    jz      loc_40BF0A
4243195    mov     rax, [rbp-1090h]
4243202    mov     rdi, rax
4243205    call    _free
loc_40BF0A:
4243210    cmp     dword [rbp-10ACh], 8
4243217    jnz     loc_40BF3E
4243219    mov     rax, [rbp-10A8h]
4243226    sub     rax, 8
4243230    mov     rax, [rax]
4243233    mov     rdx, [rbp-10A8h]
4243240    sub     rdx, 8
4243244    mov     rdx, [rdx]
4243247    mov     edx, [rdx+98h]
4243253    or      edx, 1
4243256    mov     [rax+98h], edx
loc_40BF3E:
4243262    mov     rax, [rbp-10A8h]
4243269    sub     rax, 8
4243273    mov     rax, [rax]
4243276    mov     rax, [rax+58h]
loc_40BF50:
4243280    mov     rbx, [rbp-18h]
4243284    xor     rbx, [fs:28h]
4243293    jz      loc_40BF64
4243295    call    ___stack_chk_fail
loc_40BF64:
4243300    add     rsp, 10B8h
4243307    pop     rbx
4243308    pop     rbp
4243309    retn    
USE32

section .text

global _mg_websocket_printf

_mg_websocket_printf:
4243310    push    rbp
4243311    mov     rbp, rsp
4243314    push    rbx
4243315    sub     rsp, 1178h
4243322    call    _mcount
4243327    mov     [rbp-1168h], rdi
4243334    mov     [rbp-116Ch], esi
4243340    mov     [rbp-0A8h], rcx
4243347    mov     [rbp-0A0h], r8
4243354    mov     [rbp-98h], r9
4243361    test    al, al
4243363    jz      loc_40BFC8
4243365    movaps  xmmword [rbp-90h], xmm0
4243372    movaps  xmmword [rbp-80h], xmm1
4243376    movaps  xmmword [rbp-70h], xmm2
4243380    movaps  xmmword [rbp-60h], xmm3
4243384    movaps  xmmword [rbp-50h], xmm4
4243388    movaps  xmmword [rbp-40h], xmm5
4243392    movaps  xmmword [rbp-30h], xmm6
4243396    movaps  xmmword [rbp-20h], xmm7
loc_40BFC8:
4243400    mov     [rbp-1178h], rdx
4243407    mov     rax, [fs:28h]
4243416    mov     [rbp-0C8h], rax
4243423    xor     eax, eax
4243425    lea     rax, [rbp-1130h]
4243432    mov     [rbp-1150h], rax
4243439    mov     dword [rbp-1148h], 18h
4243449    mov     dword [rbp-1144h], 30h
4243459    lea     rax, [rbp+10h]
4243463    mov     [rbp-1140h], rax
4243470    lea     rax, [rbp-0C0h]
4243477    mov     [rbp-1138h], rax
4243484    lea     rcx, [rbp-1148h]
4243491    mov     rdx, [rbp-1178h]
4243498    lea     rax, [rbp-1150h]
4243505    mov     esi, 1060h
4243510    mov     rdi, rax
4243513    call    _ns_avprintf
4243518    mov     [rbp-1154h], eax
4243524    cmp     dword [rbp-1154h], 0
4243531    jle     loc_40C072
4243533    mov     eax, [rbp-1154h]
4243539    movsxd  rcx, eax
4243542    mov     rdx, [rbp-1150h]
4243549    mov     esi, [rbp-116Ch]
4243555    mov     rax, [rbp-1168h]
4243562    mov     rdi, rax
4243565    call    _mg_websocket_write
loc_40C072:
4243570    mov     rdx, [rbp-1150h]
4243577    lea     rax, [rbp-1130h]
4243584    cmp     rdx, rax
4243587    jz      loc_40C0A0
4243589    mov     rax, [rbp-1150h]
4243596    test    rax, rax
4243599    jz      loc_40C0A0
4243601    mov     rax, [rbp-1150h]
4243608    mov     rdi, rax
4243611    call    _free
loc_40C0A0:
4243616    mov     rax, [rbp-1168h]
4243623    sub     rax, 8
4243627    mov     rax, [rax]
4243630    mov     rax, [rax+58h]
4243634    mov     rbx, [rbp-0C8h]
4243641    xor     rbx, [fs:28h]
4243650    jz      loc_40C0C9
4243652    call    ___stack_chk_fail
loc_40C0C9:
4243657    add     rsp, 1178h
4243664    pop     rbx
4243665    pop     rbp
4243666    retn    
USE32

section .text

global _send_websocket_handshake_if_requested

_send_websocket_handshake_if_requested:
4243667    push    rbp
4243668    mov     rbp, rsp
4243671    sub     rsp, 20h
4243675    call    _mcount
4243680    mov     [rbp-18h], rdi
4243684    mov     rax, [rbp-18h]
4243688    mov     esi, aSecWebsocketVe
4243693    mov     rdi, rax
4243696    call    _mg_get_header
4243701    mov     [rbp-10h], rax
4243705    mov     rax, [rbp-18h]
4243709    mov     esi, aSecWebsocketKe
4243714    mov     rdi, rax
4243717    call    _mg_get_header
4243722    mov     [rbp-8], rax
4243726    cmp     qword [rbp-10h], 0
4243731    jz      locret_40C16B
4243733    cmp     qword [rbp-8], 0
4243738    jz      locret_40C16B
4243740    mov     rax, [rbp-18h]
4243744    mov     dword [rax+278h], 1
4243754    mov     rax, [rbp-18h]
4243758    sub     rax, 8
4243762    mov     esi, 6Bh
4243767    mov     rdi, rax
4243770    call    _call_user
4243775    test    eax, eax
4243777    jnz     loc_40C156
4243779    mov     rdx, [rbp-8]
4243783    mov     rax, [rbp-18h]
4243787    mov     rsi, rdx
4243790    mov     rdi, rax
4243793    call    _send_websocket_handshake
loc_40C156:
4243798    mov     rax, [rbp-18h]
4243802    sub     rax, 8
4243806    mov     esi, 6Ch
4243811    mov     rdi, rax
4243814    call    _call_user
locret_40C16B:
4243819    leave   
4243820    retn    
USE32

section .text

global _ping_idle_websocket_connection

_ping_idle_websocket_connection:
4243821    push    rbp
4243822    mov     rbp, rsp
4243825    sub     rsp, 10h
4243829    call    _mcount
4243834    mov     [rbp-8], rdi
4243838    mov     [rbp-10h], rsi
4243842    mov     rax, [rbp-8]
4243846    mov     rax, [rax]
4243849    mov     rax, [rax+88h]
4243856    mov     rdx, [rbp-10h]
4243860    sub     rdx, rax
4243863    mov     rax, rdx
4243866    cmp     rax, 5
4243870    jle     locret_40C1BF
4243872    mov     rax, [rbp-8]
4243876    add     rax, 8
4243880    mov     ecx, 0
4243885    mov     edx, unk_414196
4243890    mov     esi, 9
4243895    mov     rdi, rax
4243898    call    _mg_websocket_write
locret_40C1BF:
4243903    leave   
4243904    retn    
USE32

section .text

global _write_terminating_chunk

_write_terminating_chunk:
4243905    push    rbp
4243906    mov     rbp, rsp
4243909    sub     rsp, 10h
4243913    call    _mcount
4243918    mov     [rbp-8], rdi
4243922    mov     rax, [rbp-8]
4243926    add     rax, 8
4243930    mov     edx, 5
4243935    mov     esi, a0
4243940    mov     rdi, rax
4243943    call    _mg_write
4243948    leave   
4243949    retn    
USE32

section .text

global _call_request_handler

_call_request_handler:
4243950    push    rbp
4243951    mov     rbp, rsp
4243954    sub     rsp, 20h
4243958    call    _mcount
4243963    mov     [rbp-18h], rdi
4243967    mov     rax, [rbp-18h]
4243971    mov     rax, [rax]
4243974    mov     rdx, [rax+38h]
4243978    mov     rax, [rbp-18h]
4243982    mov     [rax+270h], rdx
4243989    mov     rax, [rbp-18h]
4243993    mov     esi, 67h
4243998    mov     rdi, rax
4244001    call    _call_user
4244006    mov     [rbp-4], eax
4244009    cmp     dword [rbp-4], 1
4244013    jnz     loc_40C26D
4244015    mov     rax, [rbp-18h]
4244019    mov     rax, [rax]
4244022    mov     eax, [rax+98h]
4244028    and     eax, 200000h
4244033    test    eax, eax
4244035    jz      loc_40C261
4244037    mov     rax, [rbp-18h]
4244041    add     rax, 8
4244045    mov     rdi, rax
4244048    call    _terminate_headers
4244053    mov     rax, [rbp-18h]
4244057    mov     rdi, rax
4244060    call    _write_terminating_chunk
loc_40C261:
4244065    mov     rax, [rbp-18h]
4244069    mov     rdi, rax
4244072    call    _close_local_endpoint
loc_40C26D:
4244077    mov     eax, [rbp-4]
4244080    leave   
4244081    retn    
USE32

section .text

global _mg_get_mime_type

_mg_get_mime_type:
4244082    push    rbp
4244083    mov     rbp, rsp
4244086    sub     rsp, 30h
4244090    call    _mcount
4244095    mov     [rbp-28h], rdi
4244099    mov     [rbp-30h], rsi
4244103    mov     rax, [rbp-28h]
4244107    mov     rdi, rax
4244110    call    _strlen
4244115    mov     [rbp-10h], rax
4244119    mov     qword [rbp-18h], 0
4244127    jmp     loc_40C340
loc_40C2A4:
4244132    mov     rdx, [rbp-18h]
4244136    mov     rax, rdx
4244139    add     rax, rax
4244142    add     rax, rdx
4244145    shl     rax, 3
4244149    add     rax, 4146E0h
4244155    mov     rax, [rax+8]
4244159    mov     rdx, [rbp-10h]
4244163    sub     rdx, rax
4244166    mov     rax, [rbp-28h]
4244170    add     rax, rdx
4244173    mov     [rbp-8], rax
4244177    mov     rdx, [rbp-18h]
4244181    mov     rax, rdx
4244184    add     rax, rax
4244187    add     rax, rdx
4244190    shl     rax, 3
4244194    add     rax, 4146E0h
4244200    mov     rax, [rax+8]
4244204    cmp     rax, [rbp-10h]
4244208    jnb     loc_40C33B
4244210    mov     rdx, [rbp-18h]
4244214    mov     rax, rdx
4244217    add     rax, rax
4244220    add     rax, rdx
4244223    shl     rax, 3
4244227    add     rax, 4146E0h
4244233    mov     rdx, [rax]
4244236    mov     rax, [rbp-8]
4244240    mov     rsi, rdx
4244243    mov     rdi, rax
4244246    call    _mg_strcasecmp
4244251    test    eax, eax
4244253    jnz     loc_40C33B
4244255    mov     rdx, [rbp-18h]
4244259    mov     rax, rdx
4244262    add     rax, rax
4244265    add     rax, rdx
4244268    shl     rax, 3
4244272    add     rax, 4146F0h
4244278    mov     rax, [rax]
4244281    jmp     locret_40C367
loc_40C33B:
4244283    add     qword [rbp-18h], 1
loc_40C340:
4244288    mov     rdx, [rbp-18h]
4244292    mov     rax, rdx
4244295    add     rax, rax
4244298    add     rax, rdx
4244301    shl     rax, 3
4244305    add     rax, 4146E0h
4244311    mov     rax, [rax]
4244314    test    rax, rax
4244317    jnz     loc_40C2A4
4244323    mov     rax, [rbp-30h]
locret_40C367:
4244327    leave   
4244328    retn    
USE32

section .text

global _get_month_index

_get_month_index:
4244329    push    rbp
4244330    mov     rbp, rsp
4244333    sub     rsp, 20h
4244337    call    _mcount
4244342    mov     [rbp-18h], rdi
4244346    mov     dword [rbp-4], 0
4244353    jmp     loc_40C3AC
loc_40C383:
4244355    mov     eax, [rbp-4]
4244358    cdqe    
4244360    mov     rdx, qword month_names_6686[rax*8]
4244368    mov     rax, [rbp-18h]
4244372    mov     rsi, rdx
4244375    mov     rdi, rax
4244378    call    _strcmp
4244383    test    eax, eax
4244385    jnz     loc_40C3A8
4244387    mov     eax, [rbp-4]
4244390    jmp     locret_40C3B7
loc_40C3A8:
4244392    add     dword [rbp-4], 1
loc_40C3AC:
4244396    cmp     dword [rbp-4], 0Bh
4244400    jle     loc_40C383
4244402    mov     eax, 0FFFFFFFFh
locret_40C3B7:
4244407    leave   
4244408    retn    
USE32

section .text

global _num_leap_years

_num_leap_years:
4244409    push    rbp
4244410    mov     rbp, rsp
4244413    sub     rsp, 8
4244417    call    _mcount
4244422    mov     [rbp-4], edi
4244425    mov     eax, [rbp-4]
4244428    lea     edx, [rax+3]
4244431    test    eax, eax
4244433    cmovs   eax, edx
4244436    sar     eax, 2
4244439    mov     esi, eax
4244441    mov     ecx, [rbp-4]
4244444    mov     edx, 51EB851Fh
4244449    mov     eax, ecx
4244451    imul    edx
4244453    sar     edx, 5
4244456    mov     eax, ecx
4244458    sar     eax, 1Fh
4244461    sub     edx, eax
4244463    mov     eax, edx
4244465    sub     esi, eax
4244467    mov     ecx, [rbp-4]
4244470    mov     edx, 51EB851Fh
4244475    mov     eax, ecx
4244477    imul    edx
4244479    sar     edx, 7
4244482    mov     eax, ecx
4244484    sar     eax, 1Fh
4244487    sub     edx, eax
4244489    mov     eax, edx
4244491    add     eax, esi
4244493    leave   
4244494    retn    
USE32

section .text

global _parse_date_string

_parse_date_string:
4244495    push    rbp
4244496    mov     rbp, rsp
4244499    push    rbx
4244500    sub     rsp, 88h
4244507    call    _mcount
4244512    mov     [rbp-78h], rdi
4244516    mov     rax, [fs:28h]
4244525    mov     [rbp-18h], rax
4244529    xor     eax, eax
4244531    mov     qword [rbp-48h], 0
4244539    lea     r8, [rbp-60h]
4244543    lea     rdi, [rbp-58h]
4244547    lea     rcx, [rbp-40h]
4244551    lea     rdx, [rbp-5Ch]
4244555    mov     rax, [rbp-78h]
4244559    lea     rsi, [rbp-68h]
4244563    mov     [rsp+8], rsi
4244568    lea     rsi, [rbp-64h]
4244572    mov     [rsp], rsi
4244576    mov     r9, r8
4244579    mov     r8, rdi
4244582    mov     esi, aD3sDDDD
4244587    mov     rdi, rax
4244590    mov     eax, 0
4244595    call    ___isoc99_sscanf
4244600    cmp     eax, 6
4244603    jz      loc_40C54F
4244609    lea     r8, [rbp-60h]
4244613    lea     rdi, [rbp-58h]
4244617    lea     rcx, [rbp-40h]
4244621    lea     rdx, [rbp-5Ch]
4244625    mov     rax, [rbp-78h]
4244629    lea     rsi, [rbp-68h]
4244633    mov     [rsp+8], rsi
4244638    lea     rsi, [rbp-64h]
4244642    mov     [rsp], rsi
4244646    mov     r9, r8
4244649    mov     r8, rdi
4244652    mov     esi, aD3sDDDD_0
4244657    mov     rdi, rax
4244660    mov     eax, 0
4244665    call    ___isoc99_sscanf
4244670    cmp     eax, 6
4244673    jz      loc_40C54F
4244679    lea     r8, [rbp-60h]
4244683    lea     rdi, [rbp-58h]
4244687    lea     rcx, [rbp-40h]
4244691    lea     rdx, [rbp-5Ch]
4244695    mov     rax, [rbp-78h]
4244699    lea     rsi, [rbp-68h]
4244703    mov     [rsp+8], rsi
4244708    lea     rsi, [rbp-64h]
4244712    mov     [rsp], rsi
4244716    mov     r9, r8
4244719    mov     r8, rdi
4244722    mov     esi, a3sD3sDDDD
4244727    mov     rdi, rax
4244730    mov     eax, 0
4244735    call    ___isoc99_sscanf
4244740    cmp     eax, 6
4244743    jz      loc_40C54F
4244745    lea     r8, [rbp-60h]
4244749    lea     rdi, [rbp-58h]
4244753    lea     rcx, [rbp-40h]
4244757    lea     rdx, [rbp-5Ch]
4244761    mov     rax, [rbp-78h]
4244765    lea     rsi, [rbp-68h]
4244769    mov     [rsp+8], rsi
4244774    lea     rsi, [rbp-64h]
4244778    mov     [rsp], rsi
4244782    mov     r9, r8
4244785    mov     r8, rdi
4244788    mov     esi, aD3sDDDD_1
4244793    mov     rdi, rax
4244796    mov     eax, 0
4244801    call    ___isoc99_sscanf
4244806    cmp     eax, 6
4244809    jnz     loc_40C5F9
loc_40C54F:
4244815    mov     eax, [rbp-58h]
4244818    cmp     eax, 7B2h
4244823    jle     loc_40C5F9
4244829    lea     rax, [rbp-40h]
4244833    mov     rdi, rax
4244836    call    _get_month_index
4244841    mov     [rbp-54h], eax
4244844    cmp     dword [rbp-54h], 0FFFFFFFFh
4244848    jz      loc_40C5F9
4244854    mov     eax, [rbp-58h]
4244857    mov     edi, eax
4244859    call    _num_leap_years
4244864    mov     ebx, eax
4244866    mov     edi, 7B2h
4244871    call    _num_leap_years
4244876    sub     ebx, eax
4244878    mov     eax, ebx
4244880    mov     [rbp-50h], eax
4244883    mov     eax, [rbp-58h]
4244886    sub     eax, 7B2h
4244891    mov     [rbp-58h], eax
4244894    mov     eax, [rbp-58h]
4244897    imul    edx, eax
4244903    mov     eax, [rbp-54h]
4244906    cdqe    
4244908    movzx   eax, word [days_before_month_6697+rax+rax]
4244916    movzx   eax, ax
4244919    add     edx, eax
4244921    mov     eax, [rbp-5Ch]
4244924    sub     eax, 1
4244927    add     edx, eax
4244929    mov     eax, [rbp-50h]
4244932    add     eax, edx
4244934    mov     [rbp-4Ch], eax
4244937    mov     eax, [rbp-4Ch]
4244940    imul    edx, eax
4244946    mov     eax, [rbp-60h]
4244949    imul    eax, eax
4244955    add     edx, eax
4244957    mov     eax, [rbp-64h]
4244960    shl     eax, 2
4244963    mov     ecx, eax
4244965    shl     ecx, 4
4244968    sub     ecx, eax
4244970    mov     eax, ecx
4244972    add     edx, eax
4244974    mov     eax, [rbp-68h]
4244977    add     eax, edx
4244979    cdqe    
4244981    mov     [rbp-48h], rax
loc_40C5F9:
4244985    mov     rax, [rbp-48h]
4244989    mov     rbx, [rbp-18h]
4244993    xor     rbx, [fs:28h]
4245002    jz      loc_40C611
4245004    call    ___stack_chk_fail
loc_40C611:
4245009    add     rsp, 88h
4245016    pop     rbx
4245017    pop     rbp
4245018    retn    
USE32

section .text

global _get_mime_type

_get_mime_type:
4245019    push    rbp
4245020    mov     rbp, rsp
4245023    sub     rsp, 60h
4245027    call    _mcount
4245032    mov     [rbp-48h], rdi
4245036    mov     [rbp-50h], rsi
4245040    mov     [rbp-58h], rdx
4245044    mov     rax, [rbp-50h]
4245048    mov     rdi, rax
4245051    call    _strlen
4245056    mov     [rbp-30h], rax
4245060    mov     rax, [rbp-48h]
4245064    mov     rax, [rax+88h]
4245071    mov     [rbp-38h], rax
4245075    jmp     loc_40C69B
loc_40C655:
4245077    mov     rax, [rbp-18h]
4245081    mov     rdx, [rbp-30h]
4245085    sub     rdx, rax
4245088    mov     rax, [rbp-50h]
4245092    add     rax, rdx
4245095    mov     [rbp-28h], rax
4245099    mov     rdx, [rbp-18h]
4245103    mov     rcx, [rbp-20h]
4245107    mov     rax, [rbp-28h]
4245111    mov     rsi, rcx
4245114    mov     rdi, rax
4245117    call    _mg_strncasecmp
4245122    test    eax, eax
4245124    jnz     loc_40C69B
4245126    mov     rcx, [rbp-58h]
4245130    mov     rax, [rbp-10h]
4245134    mov     rdx, [rbp-8]
4245138    mov     [rcx], rax
4245141    mov     [rcx+8], rdx
4245145    jmp     locret_40C6EC
loc_40C69B:
4245147    lea     rdx, [rbp-10h]
4245151    lea     rcx, [rbp-20h]
4245155    mov     rax, [rbp-38h]
4245159    mov     rsi, rcx
4245162    mov     rdi, rax
4245165    call    _next_option
4245170    mov     [rbp-38h], rax
4245174    cmp     qword [rbp-38h], 0
4245179    jnz     loc_40C655
4245181    mov     rax, [rbp-50h]
4245185    mov     esi, aTextPlain
4245190    mov     rdi, rax
4245193    call    _mg_get_mime_type
4245198    mov     rdx, [rbp-58h]
4245202    mov     [rdx], rax
4245205    mov     rax, [rbp-58h]
4245209    mov     rax, [rax]
4245212    mov     rdi, rax
4245215    call    _strlen
4245220    mov     rdx, [rbp-58h]
4245224    mov     [rdx+8], rax
locret_40C6EC:
4245228    leave   
4245229    retn    
USE32

section .text

global _suggest_connection_header

_suggest_connection_header:
4245230    push    rbp
4245231    mov     rbp, rsp
4245234    sub     rsp, 10h
4245238    call    _mcount
4245243    mov     [rbp-8], rdi
4245247    mov     rax, [rbp-8]
4245251    mov     rdi, rax
4245254    call    _should_keep_alive
4245259    test    eax, eax
4245261    jz      loc_40C716
4245263    mov     eax, aKeepAlive
4245268    jmp     locret_40C71B
loc_40C716:
4245270    mov     eax, aClose
locret_40C71B:
4245275    leave   
4245276    retn    
USE32

section .text

global _construct_etag

_construct_etag:
4245277    push    rbp
4245278    mov     rbp, rsp
4245281    sub     rsp, 20h
4245285    call    _mcount
4245290    mov     [rbp-8], rdi
4245294    mov     [rbp-10h], rsi
4245298    mov     [rbp-18h], rdx
4245302    mov     rax, [rbp-18h]
4245306    mov     rcx, [rax+30h]
4245310    mov     rax, [rbp-18h]
4245314    mov     rax, [rax+58h]
4245318    mov     rdx, rax
4245321    mov     rsi, [rbp-10h]
4245325    mov     rax, [rbp-8]
4245329    mov     r8, rcx
4245332    mov     rcx, rdx
4245335    mov     edx, aLx_Ld
4245340    mov     rdi, rax
4245343    mov     eax, 0
4245348    call    _mg_snprintf
4245353    leave   
4245354    retn    
USE32

section .text

global _is_not_modified

_is_not_modified:
4245355    push    rbp
4245356    mov     rbp, rsp
4245359    push    rbx
4245360    sub     rsp, 78h
4245364    call    _mcount
4245369    mov     [rbp-78h], rdi
4245373    mov     [rbp-80h], rsi
4245377    mov     rax, [fs:28h]
4245386    mov     [rbp-18h], rax
4245390    xor     eax, eax
4245392    mov     rax, [rbp-78h]
4245396    add     rax, 8
4245400    mov     esi, aIfModifiedSinc
4245405    mov     rdi, rax
4245408    call    _mg_get_header
4245413    mov     [rbp-70h], rax
4245417    mov     rax, [rbp-78h]
4245421    add     rax, 8
4245425    mov     esi, aIfNoneMatch
4245430    mov     rdi, rax
4245433    call    _mg_get_header
4245438    mov     [rbp-68h], rax
4245442    mov     rdx, [rbp-80h]
4245446    lea     rax, [rbp-60h]
4245450    mov     esi, 40h
4245455    mov     rdi, rax
4245458    call    _construct_etag
4245463    cmp     qword [rbp-68h], 0
4245468    jz      loc_40C7F5
4245470    mov     rdx, [rbp-68h]
4245474    lea     rax, [rbp-60h]
4245478    mov     rsi, rdx
4245481    mov     rdi, rax
4245484    call    _mg_strcasecmp
4245489    test    eax, eax
4245491    jz      loc_40C815
loc_40C7F5:
4245493    cmp     qword [rbp-70h], 0
4245498    jz      loc_40C81C
4245500    mov     rax, [rbp-80h]
4245504    mov     rbx, [rax+58h]
4245508    mov     rax, [rbp-70h]
4245512    mov     rdi, rax
4245515    call    _parse_date_string
4245520    cmp     rbx, rax
4245523    jg      loc_40C81C
loc_40C815:
4245525    mov     eax, 1
4245530    jmp     loc_40C821
loc_40C81C:
4245532    mov     eax, 0
loc_40C821:
4245537    mov     rcx, [rbp-18h]
4245541    xor     rcx, [fs:28h]
4245550    jz      loc_40C835
4245552    call    ___stack_chk_fail
loc_40C835:
4245557    add     rsp, 78h
4245561    pop     rbx
4245562    pop     rbp
4245563    retn    
USE32

section .text

global _find_index_file

_find_index_file:
4245564    push    rbp
4245565    mov     rbp, rsp
4245568    sub     rsp, 0E0h
4245575    call    _mcount
4245580    mov     [rbp-0C8h], rdi
4245587    mov     [rbp-0D0h], rsi
4245594    mov     [rbp-0D8h], rdx
4245601    mov     [rbp-0E0h], rcx
4245608    mov     rax, [rbp-0C8h]
4245615    mov     rax, [rax+2A8h]
4245622    mov     rax, [rax+0A8h]
4245629    mov     [rbp-0B0h], rax
4245636    mov     rax, [rbp-0D0h]
4245643    mov     rdi, rax
4245646    call    _strlen
4245651    mov     [rbp-0A8h], rax
4245658    mov     dword [rbp-0B4h], 0
4245668    jmp     loc_40C8AE
loc_40C8A6:
4245670    sub     qword [rbp-0A8h], 1
loc_40C8AE:
4245678    cmp     qword [rbp-0A8h], 0
4245686    jz      loc_40C8D4
4245688    mov     rax, [rbp-0A8h]
4245695    lea     rdx, [rax-1]
4245699    mov     rax, [rbp-0D0h]
4245706    add     rax, rdx
4245709    movzx   eax, byte [rax]
4245712    cmp     al, 2Fh
4245714    jz      loc_40C8A6
loc_40C8D4:
4245716    mov     rax, [rbp-0A8h]
4245723    mov     rdx, [rbp-0D0h]
4245730    add     rax, rdx
4245733    mov     byte [rax], 2Fh
4245736    jmp     loc_40C9C7
loc_40C8ED:
4245741    mov     rax, [rbp-0A8h]
4245748    add     rax, 2
4245752    cmp     rax, [rbp-0D8h]
4245759    jb      loc_40C906
4245761    jmp     loc_40C9C7
loc_40C906:
4245766    mov     rax, [rbp-98h]
4245773    mov     rdx, [rbp-0A8h]
4245780    mov     rcx, [rbp-0D8h]
4245787    sub     rcx, rdx
4245790    mov     rdx, rcx
4245793    sub     rdx, 2
4245797    cmp     rax, rdx
4245800    jbe     loc_40C92F
4245802    jmp     loc_40C9C7
loc_40C92F:
4245807    mov     rdx, [rbp-98h]
4245814    mov     rax, [rbp-0A0h]
4245821    mov     rcx, [rbp-0A8h]
4245828    lea     rsi, [rcx+1]
4245832    mov     rcx, [rbp-0D0h]
4245839    add     rcx, rsi
4245842    mov     rsi, rax
4245845    mov     rdi, rcx
4245848    call    _strncpy
4245853    mov     rdx, [rbp-98h]
4245860    mov     rax, [rbp-0A8h]
4245867    add     rax, rdx
4245870    lea     rdx, [rax+1]
4245874    mov     rax, [rbp-0D0h]
4245881    add     rax, rdx
4245884    mov     byte [rax], 0
4245887    lea     rdx, [rbp-90h]
4245894    mov     rax, [rbp-0D0h]
4245901    mov     rsi, rdx
4245904    mov     rdi, rax
4245907    call    _stat64
4245912    test    eax, eax
4245914    jnz     loc_40C9C7
4245916    mov     rax, [rbp-0E0h]
4245923    mov     rdx, rax
4245926    lea     rsi, [rbp-90h]
4245933    mov     eax, 12h
4245938    mov     rdi, rdx
4245941    mov     rcx, rax
4245944    rep movsq
4245947    mov     dword [rbp-0B4h], 1
4245957    jmp     loc_40C9FA
loc_40C9C7:
4245959    lea     rcx, [rbp-0A0h]
4245966    mov     rax, [rbp-0B0h]
4245973    mov     edx, 0
4245978    mov     rsi, rcx
4245981    mov     rdi, rax
4245984    call    _next_option
4245989    mov     [rbp-0B0h], rax
4245996    cmp     qword [rbp-0B0h], 0
4246004    jnz     loc_40C8ED
loc_40C9FA:
4246010    cmp     dword [rbp-0B4h], 0
4246017    jnz     loc_40CA17
4246019    mov     rax, [rbp-0A8h]
4246026    mov     rdx, [rbp-0D0h]
4246033    add     rax, rdx
4246036    mov     byte [rax], 0
loc_40CA17:
4246039    mov     eax, [rbp-0B4h]
4246045    leave   
4246046    retn    
USE32

section .text

global _parse_range_header

_parse_range_header:
4246047    push    rbp
4246048    mov     rbp, rsp
4246051    sub     rsp, 20h
4246055    call    _mcount
4246060    mov     [rbp-8], rdi
4246064    mov     [rbp-10h], rsi
4246068    mov     [rbp-18h], rdx
4246072    mov     rcx, [rbp-18h]
4246076    mov     rdx, [rbp-10h]
4246080    mov     rax, [rbp-8]
4246084    mov     esi, aBytesLdLd
4246089    mov     rdi, rax
4246092    mov     eax, 0
4246097    call    ___isoc99_sscanf
4246102    leave   
4246103    retn    
USE32

section .text

global _gmt_time_string

_gmt_time_string:
4246104    push    rbp
4246105    mov     rbp, rsp
4246108    sub     rsp, 20h
4246112    call    _mcount
4246117    mov     [rbp-8], rdi
4246121    mov     [rbp-10h], rsi
4246125    mov     [rbp-18h], rdx
4246129    mov     rax, [rbp-18h]
4246133    mov     rdi, rax
4246136    call    _gmtime
4246141    mov     rdx, rax
4246144    mov     rsi, [rbp-10h]
4246148    mov     rax, [rbp-8]
4246152    mov     rcx, rdx
4246155    mov     edx, aADBYHMSGmt
4246160    mov     rdi, rax
4246163    call    _strftime
4246168    leave   
4246169    retn    
USE32

section .text

global _open_file_endpoint

_open_file_endpoint:
4246170    push    rbp
4246171    mov     rbp, rsp
4246174    push    rbx
4246175    sub     rsp, 5A8h
4246182    call    _mcount
4246187    mov     [rbp-548h], rdi
4246194    mov     [rbp-550h], rsi
4246201    mov     [rbp-558h], rdx
4246208    mov     [rbp-560h], rcx
4246215    mov     rax, [fs:28h]
4246224    mov     [rbp-18h], rax
4246228    xor     eax, eax
4246230    mov     qword [rbp-520h], aOk
4246241    mov     edi, 0
4246246    call    _time
4246251    mov     [rbp-538h], rax
4246258    mov     rax, [rbp-548h]
4246265    mov     dword [rax+2B8h], 1
4246275    mov     rax, [rbp-548h]
4246282    mov     eax, [rax+2B0h]
4246288    mov     edi, eax
4246290    call    _ns_set_close_on_exec
4246295    mov     rax, [rbp-548h]
4246302    mov     dword [rax+284h], 0C8h
4246312    mov     rax, [rbp-548h]
4246319    mov     rax, [rax+2A8h]
4246326    lea     rdx, [rbp-510h]
4246333    mov     rcx, [rbp-550h]
4246340    mov     rsi, rcx
4246343    mov     rdi, rax
4246346    call    _get_mime_type
4246351    mov     rax, [rbp-558h]
4246358    mov     rdx, [rax+30h]
4246362    mov     rax, [rbp-548h]
4246369    mov     [rax+2D8h], rdx
4246376    mov     byte [rbp-440h], 0
4246383    mov     qword [rbp-528h], 0
4246394    mov     rax, [rbp-528h]
4246401    mov     [rbp-530h], rax
4246408    mov     rax, [rbp-548h]
4246415    add     rax, 8
4246419    mov     esi, aRange
4246424    mov     rdi, rax
4246427    call    _mg_get_header
4246432    mov     [rbp-518h], rax
4246439    cmp     qword [rbp-518h], 0
4246447    jz      loc_40CCFD
4246453    lea     rdx, [rbp-528h]
4246460    lea     rcx, [rbp-530h]
4246467    mov     rax, [rbp-518h]
4246474    mov     rsi, rcx
4246477    mov     rdi, rax
4246480    call    _parse_range_header
4246485    mov     [rbp-53Ch], eax
4246491    cmp     dword [rbp-53Ch], 0
4246498    jle     loc_40CCFD
4246504    mov     rax, [rbp-530h]
4246511    test    rax, rax
4246514    js      loc_40CCFD
4246520    mov     rax, [rbp-528h]
4246527    test    rax, rax
4246530    js      loc_40CCFD
4246536    mov     rax, [rbp-548h]
4246543    mov     dword [rax+284h], 0CEh
4246553    cmp     dword [rbp-53Ch], 2
4246560    jnz     loc_40CC51
4246562    mov     rax, [rbp-548h]
4246569    mov     rdx, [rax+2D8h]
4246576    mov     rax, [rbp-528h]
4246583    cmp     rdx, rax
4246586    cmovg   rdx, rax
4246590    mov     rax, [rbp-530h]
4246597    sub     rdx, rax
4246600    mov     rax, rdx
4246603    add     rax, 1
4246607    jmp     loc_40CC6C
loc_40CC51:
4246609    mov     rax, [rbp-548h]
4246616    mov     rdx, [rax+2D8h]
4246623    mov     rax, [rbp-530h]
4246630    sub     rdx, rax
4246633    mov     rax, rdx
loc_40CC6C:
4246636    mov     rdx, [rbp-548h]
4246643    mov     [rdx+2D8h], rax
4246650    mov     rax, [rbp-558h]
4246657    mov     rcx, [rax+30h]
4246661    mov     rax, [rbp-548h]
4246668    mov     rdx, [rax+2D8h]
4246675    mov     rax, [rbp-530h]
4246682    add     rax, rdx
4246685    lea     rsi, [rax-1]
4246689    mov     rdx, [rbp-530h]
4246696    lea     rax, [rbp-440h]
4246703    mov     r9, rcx
4246706    mov     r8, rsi
4246709    mov     rcx, rdx
4246712    mov     edx, aContentRangeBy
4246717    mov     esi, 40h
4246722    mov     rdi, rax
4246725    mov     eax, 0
4246730    call    _mg_snprintf
4246735    mov     qword [rbp-520h], aPartialContent
4246746    mov     rcx, [rbp-530h]
4246753    mov     rax, [rbp-548h]
4246760    mov     eax, [rax+2B0h]
4246766    mov     edx, 0
4246771    mov     rsi, rcx
4246774    mov     edi, eax
4246776    call    _lseek64
loc_40CCFD:
4246781    lea     rdx, [rbp-538h]
4246788    lea     rax, [rbp-500h]
4246795    mov     esi, 40h
4246800    mov     rdi, rax
4246803    call    _gmt_time_string
4246808    mov     rax, [rbp-558h]
4246815    lea     rdx, [rax+58h]
4246819    lea     rax, [rbp-4C0h]
4246826    mov     esi, 40h
4246831    mov     rdi, rax
4246834    call    _gmt_time_string
4246839    mov     rdx, [rbp-558h]
4246846    lea     rax, [rbp-480h]
4246853    mov     esi, 40h
4246858    mov     rdi, rax
4246861    call    _construct_etag
4246866    cmp     qword [rbp-560h], 0
4246874    jz      loc_40CD65
4246876    mov     rbx, [rbp-560h]
4246883    jmp     loc_40CD6A
loc_40CD65:
4246885    mov     ebx, unk_414196
loc_40CD6A:
4246890    mov     rax, [rbp-548h]
4246897    add     rax, 8
4246901    mov     rdi, rax
4246904    call    _suggest_connection_header
4246909    mov     rdx, [rbp-548h]
4246916    mov     r8, [rdx+2D8h]
4246923    mov     rsi, [rbp-510h]
4246930    mov     rdx, [rbp-508h]
4246937    mov     ecx, edx
4246939    mov     rdx, [rbp-548h]
4246946    mov     edx, [rdx+284h]
4246952    lea     r11, [rbp-500h]
4246959    mov     r10, [rbp-520h]
4246966    lea     rdi, [rbp-400h]
4246973    mov     qword [rsp+40h], unk_414196
4246982    mov     [rsp+38h], rbx
4246987    lea     r9, [rbp-440h]
4246994    mov     [rsp+30h], r9
4246999    mov     [rsp+28h], rax
4247004    mov     [rsp+20h], r8
4247009    mov     [rsp+18h], rsi
4247014    mov     [rsp+10h], ecx
4247018    lea     rax, [rbp-480h]
4247025    mov     [rsp+8], rax
4247030    lea     rax, [rbp-4C0h]
4247037    mov     [rsp], rax
4247041    mov     r9, r11
4247044    mov     r8, r10
4247047    mov     ecx, edx
4247049    mov     edx, aHttp1_1DSDateS
4247054    mov     esi, 3E8h
4247059    mov     eax, 0
4247064    call    _mg_snprintf
4247069    mov     [rbp-53Ch], eax
4247075    mov     eax, [rbp-53Ch]
4247081    movsxd  rdx, eax
4247084    mov     rax, [rbp-548h]
4247091    mov     rax, [rax]
4247094    lea     rcx, [rbp-400h]
4247101    mov     rsi, rcx
4247104    mov     rdi, rax
4247107    call    _ns_send
4247112    mov     rax, [rbp-548h]
4247119    mov     rax, [rax+8]
4247123    mov     esi, aHead
4247128    mov     rdi, rax
4247131    call    _strcmp
4247136    test    eax, eax
4247138    jnz     loc_40CEAC
4247140    mov     rax, [rbp-548h]
4247147    mov     rax, [rax]
4247150    mov     rdx, [rbp-548h]
4247157    mov     rdx, [rdx]
4247160    mov     edx, [rdx+98h]
4247166    or      edx, 1
4247169    mov     [rax+98h], edx
4247175    mov     rax, [rbp-548h]
4247182    mov     eax, [rax+2B0h]
4247188    mov     edi, eax
4247190    call    _close
4247195    mov     rax, [rbp-548h]
4247202    mov     dword [rax+2B8h], 0
loc_40CEAC:
4247212    mov     rax, [rbp-18h]
4247216    xor     rax, [fs:28h]
4247225    jz      loc_40CEC0
4247227    call    ___stack_chk_fail
loc_40CEC0:
4247232    add     rsp, 5A8h
4247239    pop     rbx
4247240    pop     rbp
4247241    retn    
USE32

section .text

global _mg_send_file_data

_mg_send_file_data:
4247242    push    rbp
4247243    mov     rbp, rsp
4247246    sub     rsp, 20h
4247250    call    _mcount
4247255    mov     [rbp-18h], rdi
4247259    mov     [rbp-1Ch], esi
4247262    mov     rax, [rbp-18h]
4247266    sub     rax, 8
4247270    mov     [rbp-8], rax
4247274    mov     rax, [rbp-8]
4247278    mov     dword [rax+2B8h], 1
4247288    mov     rax, [rbp-8]
4247292    mov     edx, [rbp-1Ch]
4247295    mov     [rax+2B0h], edx
4247301    mov     rax, [rbp-8]
4247305    mov     eax, [rax+2B0h]
4247311    mov     edi, eax
4247313    call    _ns_set_close_on_exec
4247318    leave   
4247319    retn    
USE32

section .text

global _call_request_handler_if_data_is_buffered

_call_request_handler_if_data_is_buffered:
4247320    push    rbp
4247321    mov     rbp, rsp
4247324    sub     rsp, 10h
4247328    call    _mcount
4247333    mov     [rbp-8], rdi
4247337    mov     rax, [rbp-8]
4247341    mov     eax, [rax+280h]
4247347    test    eax, eax
4247349    jz      loc_40CF4A
loc_40CF37:
4247351    mov     rax, [rbp-8]
4247355    mov     rdi, rax
4247358    call    _deliver_websocket_frame
4247363    test    rax, rax
4247366    jnz     loc_40CF37
4247368    jmp     locret_40CF94
loc_40CF4A:
4247370    mov     rax, [rbp-8]
4247374    mov     rdx, [rax+2D0h]
4247381    mov     rax, [rbp-8]
4247385    mov     rcx, [rax+2D8h]
4247392    mov     rax, [rbp-8]
4247396    mov     rax, [rax+2E0h]
4247403    add     rax, rcx
4247406    cmp     rdx, rax
4247409    jl      locret_40CF94
4247411    mov     rax, [rbp-8]
4247415    mov     rdi, rax
4247418    call    _call_request_handler
4247423    test    eax, eax
4247425    jnz     locret_40CF94
4247427    mov     rax, [rbp-8]
4247431    mov     esi, 1
4247436    mov     rdi, rax
4247439    call    _open_local_endpoint
locret_40CF94:
4247444    leave   
4247445    retn    
USE32

section .text

global _scan_directory

_scan_directory:
4247446    push    rbp
4247447    mov     rbp, rsp
4247450    push    rbx
4247451    sub     rsp, 2068h
4247458    call    _mcount
4247463    mov     [rbp-2058h], rdi
4247470    mov     [rbp-2060h], rsi
4247477    mov     [rbp-2068h], rdx
4247484    mov     rax, [fs:28h]
4247493    mov     [rbp-18h], rax
4247497    xor     eax, eax
4247499    mov     dword [rbp-2044h], 0
4247509    mov     dword [rbp-2040h], 0
4247519    mov     dword [rbp-203Ch], 64h
4247529    mov     rax, [rbp-2068h]
4247536    mov     qword [rax], 0
4247543    mov     rax, [rbp-2060h]
4247550    mov     rdi, rax
4247553    call    _opendir
4247558    mov     [rbp-2038h], rax
4247565    cmp     qword [rbp-2038h], 0
4247573    jnz     loc_40D021
4247575    mov     eax, 0
4247580    jmp     loc_40D27C
loc_40D021:
4247585    jmp     loc_40D243
loc_40D026:
4247590    mov     rax, [rbp-2030h]
4247597    add     rax, 13h
4247601    mov     esi, a_
4247606    mov     rdi, rax
4247609    call    _strcmp
4247614    test    eax, eax
4247616    jz      loc_40D07F
4247618    mov     rax, [rbp-2030h]
4247625    add     rax, 13h
4247629    mov     esi, a__
4247634    mov     rdi, rax
4247637    call    _strcmp
4247642    test    eax, eax
4247644    jz      loc_40D07F
4247646    mov     rax, [rbp-2030h]
4247653    lea     rdx, [rax+13h]
4247657    mov     rax, [rbp-2058h]
4247664    mov     rsi, rdx
4247667    mov     rdi, rax
4247670    call    _must_hide_file
4247675    test    eax, eax
4247677    jz      loc_40D084
loc_40D07F:
4247679    jmp     loc_40D243
loc_40D084:
4247684    mov     rax, [rbp-2030h]
4247691    lea     rcx, [rax+13h]
4247695    mov     rdx, [rbp-2060h]
4247702    lea     rax, [rbp-2020h]
4247709    mov     r9, rcx
4247712    mov     r8d, 2Fh
4247718    mov     rcx, rdx
4247721    mov     edx, aSCS
4247726    mov     esi, 2000h
4247731    mov     rdi, rax
4247734    mov     eax, 0
4247739    call    _mg_snprintf
4247744    mov     eax, [rbp-2040h]
4247750    cmp     eax, [rbp-2044h]
4247756    jl      loc_40D185
4247762    mov     eax, [rbp-2044h]
4247768    mov     edx, [rbp-203Ch]
4247774    add     eax, edx
4247776    movsxd  rdx, eax
4247779    mov     rax, rdx
4247782    shl     rax, 2
4247786    add     rax, rdx
4247789    shl     rax, 5
4247793    mov     rdx, rax
4247796    mov     rax, [rbp-2068h]
4247803    mov     rax, [rax]
4247806    mov     rsi, rdx
4247809    mov     rdi, rax
4247812    call    _realloc
4247817    mov     [rbp-2028h], rax
4247824    cmp     qword [rbp-2028h], 0
4247832    jz      loc_40D185
4247834    mov     eax, [rbp-203Ch]
4247840    movsxd  rdx, eax
4247843    mov     rax, rdx
4247846    shl     rax, 2
4247850    add     rax, rdx
4247853    shl     rax, 5
4247857    mov     rcx, rax
4247860    mov     eax, [rbp-2044h]
4247866    movsxd  rdx, eax
4247869    mov     rax, rdx
4247872    shl     rax, 2
4247876    add     rax, rdx
4247879    shl     rax, 5
4247883    mov     rdx, rax
4247886    mov     rax, [rbp-2028h]
4247893    add     rax, rdx
4247896    mov     rdx, rcx
4247899    mov     esi, 0
4247904    mov     rdi, rax
4247907    call    _memset
4247912    mov     rax, [rbp-2068h]
4247919    mov     rdx, [rbp-2028h]
4247926    mov     [rax], rdx
4247929    mov     eax, [rbp-203Ch]
4247935    add     [rbp-2044h], eax
loc_40D185:
4247941    mov     eax, [rbp-2040h]
4247947    cmp     eax, [rbp-2044h]
4247953    jge     loc_40D243
4247959    mov     rax, [rbp-2068h]
4247966    mov     rcx, [rax]
4247969    mov     eax, [rbp-2040h]
4247975    movsxd  rdx, eax
4247978    mov     rax, rdx
4247981    shl     rax, 2
4247985    add     rax, rdx
4247988    shl     rax, 5
4247992    lea     rdx, [rcx+rax]
4247996    mov     rax, [rbp-2058h]
4248003    mov     [rdx], rax
4248006    mov     rax, [rbp-2068h]
4248013    mov     rcx, [rax]
4248016    mov     eax, [rbp-2040h]
4248022    movsxd  rdx, eax
4248025    mov     rax, rdx
4248028    shl     rax, 2
4248032    add     rax, rdx
4248035    shl     rax, 5
4248039    lea     rbx, [rcx+rax]
4248043    mov     rax, [rbp-2030h]
4248050    add     rax, 13h
4248054    mov     rdi, rax
4248057    call    _strdup
4248062    mov     [rbx+8], rax
4248066    mov     rax, [rbp-2068h]
4248073    mov     rcx, [rax]
4248076    mov     eax, [rbp-2040h]
4248082    movsxd  rdx, eax
4248085    mov     rax, rdx
4248088    shl     rax, 2
4248092    add     rax, rdx
4248095    shl     rax, 5
4248099    add     rax, rcx
4248102    lea     rdx, [rax+10h]
4248106    lea     rax, [rbp-2020h]
4248113    mov     rsi, rdx
4248116    mov     rdi, rax
4248119    call    _stat64
4248124    add     dword [rbp-2040h], 1
loc_40D243:
4248131    mov     rax, [rbp-2038h]
4248138    mov     rdi, rax
4248141    call    _readdir64
4248146    mov     [rbp-2030h], rax
4248153    cmp     qword [rbp-2030h], 0
4248161    jnz     loc_40D026
4248167    mov     rax, [rbp-2038h]
4248174    mov     rdi, rax
4248177    call    _closedir
4248182    mov     eax, [rbp-2040h]
loc_40D27C:
4248188    mov     rbx, [rbp-18h]
4248192    xor     rbx, [fs:28h]
4248201    jz      loc_40D290
4248203    call    ___stack_chk_fail
loc_40D290:
4248208    add     rsp, 2068h
4248215    pop     rbx
4248216    pop     rbp
4248217    retn    
USE32

section .text

global _mg_url_encode

_mg_url_encode:
4248218    push    rbp
4248219    mov     rbp, rsp
4248222    sub     rsp, 30h
4248226    call    _mcount
4248231    mov     [rbp-18h], rdi
4248235    mov     [rbp-20h], rsi
4248239    mov     [rbp-28h], rdx
4248243    mov     [rbp-30h], rcx
4248247    mov     qword [rbp-10h], 0
4248255    mov     qword [rbp-8], 0
4248263    mov     qword [rbp-8], 0
4248271    mov     rax, [rbp-8]
4248275    mov     [rbp-10h], rax
4248279    jmp     loc_40D3DE
loc_40D2DC:
4248284    call    ___ctype_b_loc
4248289    mov     rax, [rax]
4248292    mov     rdx, [rbp-10h]
4248296    mov     rcx, [rbp-18h]
4248300    add     rdx, rcx
4248303    movzx   edx, byte [rdx]
4248306    movzx   edx, dl
4248309    add     rdx, rdx
4248312    add     rax, rdx
4248315    movzx   eax, word [rax]
4248318    movzx   eax, ax
4248321    and     eax, 8
4248324    test    eax, eax
4248326    jnz     loc_40D32F
4248328    mov     rax, [rbp-10h]
4248332    mov     rdx, [rbp-18h]
4248336    add     rax, rdx
4248339    movzx   eax, byte [rax]
4248342    movzx   edx, al
4248345    mov     rax, [cs:dont_escape_6812]
4248352    mov     esi, edx
4248354    mov     rdi, rax
4248357    call    _strchr
4248362    test    rax, rax
4248365    jz      loc_40D34F
loc_40D32F:
4248367    mov     rax, [rbp-8]
4248371    mov     rdx, [rbp-28h]
4248375    add     rdx, rax
4248378    mov     rax, [rbp-10h]
4248382    mov     rcx, [rbp-18h]
4248386    add     rax, rcx
4248389    movzx   eax, byte [rax]
4248392    mov     [rdx], al
4248394    jmp     loc_40D3D4
loc_40D34F:
4248399    mov     rax, [rbp-8]
4248403    add     rax, 3
4248407    cmp     rax, [rbp-30h]
4248411    jnb     loc_40D3D4
4248413    mov     rax, [rbp-8]
4248417    mov     rdx, [rbp-28h]
4248421    add     rax, rdx
4248424    mov     byte [rax], 25h
4248427    mov     rax, [rbp-8]
4248431    lea     rdx, [rax+1]
4248435    mov     rax, [rbp-28h]
4248439    add     rdx, rax
4248442    mov     rcx, [cs:hex_6813]
4248449    mov     rax, [rbp-10h]
4248453    mov     rsi, [rbp-18h]
4248457    add     rax, rsi
4248460    movzx   eax, byte [rax]
4248463    shr     al, 4
4248466    movzx   eax, al
4248469    add     rax, rcx
4248472    movzx   eax, byte [rax]
4248475    mov     [rdx], al
4248477    mov     rax, [rbp-8]
4248481    lea     rdx, [rax+2]
4248485    mov     rax, [rbp-28h]
4248489    add     rdx, rax
4248492    mov     rax, [cs:hex_6813]
4248499    mov     rcx, [rbp-10h]
4248503    mov     rsi, [rbp-18h]
4248507    add     rcx, rsi
4248510    movzx   ecx, byte [rcx]
4248513    movzx   ecx, cl
4248516    and     ecx, 0Fh
4248519    add     rax, rcx
4248522    movzx   eax, byte [rax]
4248525    mov     [rdx], al
4248527    add     qword [rbp-8], 2
loc_40D3D4:
4248532    add     qword [rbp-10h], 1
4248537    add     qword [rbp-8], 1
loc_40D3DE:
4248542    cmp     qword [rbp-30h], 0
4248547    jz      loc_40D408
4248549    mov     rax, [rbp-10h]
4248553    cmp     rax, [rbp-20h]
4248557    jnb     loc_40D408
4248559    mov     rax, [rbp-8]
4248563    lea     rdx, [rax+2]
4248567    mov     rax, [rbp-30h]
4248571    sub     rax, 1
4248575    cmp     rdx, rax
4248578    jb      loc_40D2DC
loc_40D408:
4248584    mov     rax, [rbp-8]
4248588    mov     rdx, [rbp-28h]
4248592    add     rax, rdx
4248595    mov     byte [rax], 0
4248598    mov     rax, [rbp-8]
4248602    leave   
4248603    retn    
USE32

section .text

global _print_dir_entry

_print_dir_entry:
4248604    push    rbp
4248605    mov     rbp, rsp
4248608    sub     rsp, 60D0h
4248615    call    _mcount
4248620    mov     [rbp-60B8h], rdi
4248627    mov     rax, [fs:28h]
4248636    mov     [rbp-8], rax
4248640    xor     eax, eax
4248642    mov     rax, [rbp-60B8h]
4248649    mov     rax, [rax+40h]
4248653    mov     [rbp-60A0h], rax
4248660    mov     rax, [rbp-60B8h]
4248667    mov     eax, [rax+28h]
4248670    and     eax, 0F000h
4248675    cmp     eax, 4000h
4248680    setz    al
4248683    movzx   eax, al
4248686    mov     [rbp-60A4h], eax
4248692    cmp     dword [rbp-60A4h], 0
4248699    jz      loc_40D484
4248701    mov     eax, reject
4248706    jmp     loc_40D489
loc_40D484:
4248708    mov     eax, unk_414196
loc_40D489:
4248713    mov     [rbp-6098h], rax
4248720    cmp     dword [rbp-60A4h], 0
4248727    jz      loc_40D4C1
4248729    lea     rax, [rbp-6090h]
4248736    mov     ecx, aDirectory
4248741    mov     edx, aS_2
4248746    mov     esi, 40h
4248751    mov     rdi, rax
4248754    mov     eax, 0
4248759    call    _mg_snprintf
4248764    jmp     loc_40D5B3
loc_40D4C1:
4248769    cmp     qword [rbp-60A0h], 3FFh
4248780    jg      loc_40D4FC
4248782    mov     rax, [rbp-60A0h]
4248789    mov     edx, eax
4248791    lea     rax, [rbp-6090h]
4248798    mov     ecx, edx
4248800    mov     edx, aD
4248805    mov     esi, 40h
4248810    mov     rdi, rax
4248813    mov     eax, 0
4248818    call    _mg_snprintf
4248823    jmp     loc_40D5B3
loc_40D4FC:
4248828    cmp     qword [rbp-60A0h], 0FFFFFh
4248839    jg      loc_40D53E
4248841    cvtsi2sd xmm0, qword [rbp-60A0h]
4248850    movsd   xmm1, [cs:qword_416D48]
4248858    divsd   xmm0, xmm1
4248862    lea     rax, [rbp-6090h]
4248869    mov     edx, a_1fk
4248874    mov     esi, 40h
4248879    mov     rdi, rax
4248882    mov     eax, 1
4248887    call    _mg_snprintf
4248892    jmp     loc_40D5B3
loc_40D53E:
4248894    cmp     qword [rbp-60A0h], 3FFFFFFFh
4248905    jg      loc_40D580
4248907    cvtsi2sd xmm0, qword [rbp-60A0h]
4248916    movsd   xmm1, [cs:qword_416D50]
4248924    divsd   xmm0, xmm1
4248928    lea     rax, [rbp-6090h]
4248935    mov     edx, a_1fm
4248940    mov     esi, 40h
4248945    mov     rdi, rax
4248948    mov     eax, 1
4248953    call    _mg_snprintf
4248958    jmp     loc_40D5B3
loc_40D580:
4248960    cvtsi2sd xmm0, qword [rbp-60A0h]
4248969    movsd   xmm1, [cs:qword_416D58]
4248977    divsd   xmm0, xmm1
4248981    lea     rax, [rbp-6090h]
4248988    mov     edx, a_1fg
4248993    mov     esi, 40h
4248998    mov     rdi, rax
4249001    mov     eax, 1
4249006    call    _mg_snprintf
loc_40D5B3:
4249011    mov     rax, [rbp-60B8h]
4249018    add     rax, 68h
4249022    mov     rdi, rax
4249025    call    _localtime
4249030    mov     rdx, rax
4249033    lea     rax, [rbp-6050h]
4249040    mov     rcx, rdx
4249043    mov     edx, aDBYHM
4249048    mov     esi, 40h
4249053    mov     rdi, rax
4249056    call    _strftime
4249061    mov     rax, [rbp-60B8h]
4249068    mov     rax, [rax+8]
4249072    mov     rdi, rax
4249075    call    _strlen
4249080    mov     rsi, rax
4249083    mov     rax, [rbp-60B8h]
4249090    mov     rax, [rax+8]
4249094    lea     rdx, [rbp-6010h]
4249101    mov     ecx, 6000h
4249106    mov     rdi, rax
4249109    call    _mg_url_encode
4249114    mov     rax, [rbp-60B8h]
4249121    mov     rsi, [rax+8]
4249125    mov     rax, [rbp-60B8h]
4249132    mov     rax, [rax]
4249135    lea     rdi, [rax+8]
4249139    mov     r8, [rbp-6098h]
4249146    mov     rdx, [rbp-6098h]
4249153    lea     rax, [rbp-6010h]
4249160    lea     rcx, [rbp-6090h]
4249167    mov     [rsp+8], rcx
4249172    lea     rcx, [rbp-6050h]
4249179    mov     [rsp], rcx
4249183    mov     r9, r8
4249186    mov     r8, rsi
4249189    mov     rcx, rdx
4249192    mov     rdx, rax
4249195    mov     esi, aTrTdAHrefSSSSA
4249200    mov     eax, 0
4249205    call    _mg_printf_data
4249210    mov     rax, [rbp-8]
4249214    xor     rax, [fs:28h]
4249223    jz      locret_40D68E
4249225    call    ___stack_chk_fail
locret_40D68E:
4249230    leave   
4249231    retn    
USE32

section .text

global _compare_dir_entries

_compare_dir_entries:
4249232    push    rbp
4249233    mov     rbp, rsp
4249236    sub     rsp, 30h
4249240    call    _mcount
4249245    mov     [rbp-28h], rdi
4249249    mov     [rbp-30h], rsi
4249253    mov     rax, [rbp-28h]
4249257    mov     [rbp-18h], rax
4249261    mov     rax, [rbp-30h]
4249265    mov     [rbp-10h], rax
4249269    mov     rax, [rbp-18h]
4249273    mov     rax, [rax]
4249276    mov     rax, [rax+20h]
4249280    test    rax, rax
4249283    jz      loc_40D6D2
4249285    mov     rax, [rbp-18h]
4249289    mov     rax, [rax]
4249292    mov     rax, [rax+20h]
4249296    jmp     loc_40D6D7
loc_40D6D2:
4249298    mov     eax, aNa
loc_40D6D7:
4249303    mov     [rbp-8], rax
4249307    mov     dword [rbp-1Ch], 0
4249314    mov     rax, [rbp-18h]
4249318    mov     eax, [rax+28h]
4249321    and     eax, 0F000h
4249326    cmp     eax, 4000h
4249331    jnz     loc_40D712
4249333    mov     rax, [rbp-10h]
4249337    mov     eax, [rax+28h]
4249340    and     eax, 0F000h
4249345    cmp     eax, 4000h
4249350    jz      loc_40D712
4249352    mov     eax, 0FFFFFFFFh
4249357    jmp     locret_40D821
loc_40D712:
4249362    mov     rax, [rbp-18h]
4249366    mov     eax, [rax+28h]
4249369    and     eax, 0F000h
4249374    cmp     eax, 4000h
4249379    jz      loc_40D742
4249381    mov     rax, [rbp-10h]
4249385    mov     eax, [rax+28h]
4249388    and     eax, 0F000h
4249393    cmp     eax, 4000h
4249398    jnz     loc_40D742
4249400    mov     eax, 1
4249405    jmp     locret_40D821
loc_40D742:
4249410    mov     rax, [rbp-8]
4249414    movzx   eax, byte [rax]
4249417    cmp     al, 6Eh
4249419    jnz     loc_40D770
4249421    mov     rax, [rbp-10h]
4249425    mov     rdx, [rax+8]
4249429    mov     rax, [rbp-18h]
4249433    mov     rax, [rax+8]
4249437    mov     rsi, rdx
4249440    mov     rdi, rax
4249443    call    _strcmp
4249448    mov     [rbp-1Ch], eax
4249451    jmp     loc_40D808
loc_40D770:
4249456    mov     rax, [rbp-8]
4249460    movzx   eax, byte [rax]
4249463    cmp     al, 73h
4249465    jnz     loc_40D7BD
4249467    mov     rax, [rbp-18h]
4249471    mov     rdx, [rax+40h]
4249475    mov     rax, [rbp-10h]
4249479    mov     rax, [rax+40h]
4249483    cmp     rdx, rax
4249486    jz      loc_40D7B3
4249488    mov     rax, [rbp-18h]
4249492    mov     rdx, [rax+40h]
4249496    mov     rax, [rbp-10h]
4249500    mov     rax, [rax+40h]
4249504    cmp     rdx, rax
4249507    jle     loc_40D7AC
4249509    mov     eax, 1
4249514    jmp     loc_40D7B8
loc_40D7AC:
4249516    mov     eax, 0FFFFFFFFh
4249521    jmp     loc_40D7B8
loc_40D7B3:
4249523    mov     eax, 0
loc_40D7B8:
4249528    mov     [rbp-1Ch], eax
4249531    jmp     loc_40D808
loc_40D7BD:
4249533    mov     rax, [rbp-8]
4249537    movzx   eax, byte [rax]
4249540    cmp     al, 64h
4249542    jnz     loc_40D808
4249544    mov     rax, [rbp-18h]
4249548    mov     rdx, [rax+68h]
4249552    mov     rax, [rbp-10h]
4249556    mov     rax, [rax+68h]
4249560    cmp     rdx, rax
4249563    jz      loc_40D800
4249565    mov     rax, [rbp-18h]
4249569    mov     rdx, [rax+68h]
4249573    mov     rax, [rbp-10h]
4249577    mov     rax, [rax+68h]
4249581    cmp     rdx, rax
4249584    jle     loc_40D7F9
4249586    mov     eax, 1
4249591    jmp     loc_40D805
loc_40D7F9:
4249593    mov     eax, 0FFFFFFFFh
4249598    jmp     loc_40D805
loc_40D800:
4249600    mov     eax, 0
loc_40D805:
4249605    mov     [rbp-1Ch], eax
loc_40D808:
4249608    mov     rax, [rbp-8]
4249612    add     rax, 1
4249616    movzx   eax, byte [rax]
4249619    cmp     al, 64h
4249621    jnz     loc_40D81E
4249623    mov     eax, [rbp-1Ch]
4249626    neg     eax
4249628    jmp     locret_40D821
loc_40D81E:
4249630    mov     eax, [rbp-1Ch]
locret_40D821:
4249633    leave   
4249634    retn    
USE32

section .text

global _send_directory_listing

_send_directory_listing:
4249635    push    rbp
4249636    mov     rbp, rsp
4249639    sub     rsp, 40h
4249643    call    _mcount
4249648    mov     [rbp-28h], rdi
4249652    mov     [rbp-30h], rsi
4249656    mov     qword [rbp-8], 0
4249664    mov     rax, [rbp-28h]
4249668    mov     rax, [rax+20h]
4249672    test    rax, rax
4249675    jz      loc_40D867
4249677    mov     rax, [rbp-28h]
4249681    mov     rax, [rax+20h]
4249685    add     rax, 1
4249689    movzx   eax, byte [rax]
4249692    cmp     al, 64h
4249694    jnz     loc_40D867
4249696    mov     eax, 61h
4249701    jmp     loc_40D86C
loc_40D867:
4249703    mov     eax, 64h
loc_40D86C:
4249708    mov     [rbp-10h], eax
4249711    mov     rax, [rbp-28h]
4249715    add     rax, 8
4249719    mov     edx, aChunked
4249724    mov     esi, aTransferEncodi
4249729    mov     rdi, rax
4249732    call    _mg_send_header
4249737    mov     rax, [rbp-28h]
4249741    add     rax, 8
4249745    mov     edx, aTextHtmlCharse
4249750    mov     esi, aContentType
4249755    mov     rdi, rax
4249758    call    _mg_send_header
4249763    mov     rax, [rbp-28h]
4249767    mov     rdx, [rax+10h]
4249771    mov     rax, [rbp-28h]
4249775    mov     rax, [rax+10h]
4249779    mov     rcx, [rbp-28h]
4249783    lea     rdi, [rcx+8]
4249787    mov     r8d, [rbp-10h]
4249791    mov     esi, [rbp-10h]
4249794    mov     ecx, [rbp-10h]
4249797    mov     [rsp], ecx
4249800    mov     r9d, r8d
4249803    mov     r8d, esi
4249806    mov     rcx, rdx
4249809    mov     rdx, rax
4249812    mov     esi, aHtmlHeadTitleI
4249817    mov     eax, 0
4249822    call    _mg_printf_data
4249827    lea     rdx, [rbp-8]
4249831    mov     rcx, [rbp-30h]
4249835    mov     rax, [rbp-28h]
4249839    mov     rsi, rcx
4249842    mov     rdi, rax
4249845    call    _scan_directory
4249850    mov     [rbp-0Ch], eax
4249853    mov     eax, [rbp-0Ch]
4249856    movsxd  rsi, eax
4249859    mov     rax, [rbp-8]
4249863    mov     ecx, compare_dir_entries
4249868    mov     edx, 0A0h
4249873    mov     rdi, rax
4249876    call    _qsort
4249881    mov     dword [rbp-14h], 0
4249888    jmp     loc_40D970
loc_40D922:
4249890    mov     rcx, [rbp-8]
4249894    mov     eax, [rbp-14h]
4249897    movsxd  rdx, eax
4249900    mov     rax, rdx
4249903    shl     rax, 2
4249907    add     rax, rdx
4249910    shl     rax, 5
4249914    add     rax, rcx
4249917    mov     rdi, rax
4249920    call    _print_dir_entry
4249925    mov     rcx, [rbp-8]
4249929    mov     eax, [rbp-14h]
4249932    movsxd  rdx, eax
4249935    mov     rax, rdx
4249938    shl     rax, 2
4249942    add     rax, rdx
4249945    shl     rax, 5
4249949    add     rax, rcx
4249952    mov     rax, [rax+8]
4249956    mov     rdi, rax
4249959    call    _free
4249964    add     dword [rbp-14h], 1
loc_40D970:
4249968    mov     eax, [rbp-14h]
4249971    cmp     eax, [rbp-0Ch]
4249974    jl      loc_40D922
4249976    mov     rax, [rbp-8]
4249980    mov     rdi, rax
4249983    call    _free
4249988    mov     rax, [rbp-28h]
4249992    mov     rdi, rax
4249995    call    _write_terminating_chunk
4250000    mov     rax, [rbp-28h]
4250004    mov     rdi, rax
4250007    call    _close_local_endpoint
4250012    leave   
4250013    retn    
USE32

section .text

global _print_props

_print_props:
4250014    push    rbp
4250015    mov     rbp, rsp
4250018    sub     rsp, 70h
4250022    call    _mcount
4250027    mov     [rbp-58h], rdi
4250031    mov     [rbp-60h], rsi
4250035    mov     [rbp-68h], rdx
4250039    mov     rax, [fs:28h]
4250048    mov     [rbp-8], rax
4250052    xor     eax, eax
4250054    mov     rax, [rbp-68h]
4250058    lea     rdx, [rax+58h]
4250062    lea     rax, [rbp-50h]
4250066    mov     esi, 40h
4250071    mov     rdi, rax
4250074    call    _gmt_time_string
4250079    mov     rax, [rbp-68h]
4250083    mov     rcx, [rax+30h]
4250087    mov     rax, [rbp-68h]
4250091    mov     eax, [rax+18h]
4250094    and     eax, 0F000h
4250099    cmp     eax, 4000h
4250104    jnz     loc_40DA01
4250106    mov     eax, aDCollection
4250111    jmp     loc_40DA06
loc_40DA01:
4250113    mov     eax, unk_414196
loc_40DA06:
4250118    mov     rdx, [rbp-58h]
4250122    lea     rdi, [rdx+8]
4250126    lea     rsi, [rbp-50h]
4250130    mov     rdx, [rbp-60h]
4250134    mov     r9, rsi
4250137    mov     r8, rcx
4250140    mov     rcx, rax
4250143    mov     esi, aDResponseDHref
4250148    mov     eax, 0
4250153    call    _mg_printf
4250158    mov     rax, [rbp-8]
4250162    xor     rax, [fs:28h]
4250171    jz      locret_40DA42
4250173    call    ___stack_chk_fail
locret_40DA42:
4250178    leave   
4250179    retn    
USE32

section .text

global _handle_propfind

_handle_propfind:
4250180    push    rbp
4250181    mov     rbp, rsp
4250184    sub     rsp, 6060h
4250191    call    _mcount
4250196    mov     [rbp-6048h], rdi
4250203    mov     [rbp-6050h], rsi
4250210    mov     [rbp-6058h], rdx
4250217    mov     [rbp-605Ch], ecx
4250223    mov     rax, [fs:28h]
4250232    mov     [rbp-8], rax
4250236    xor     eax, eax
4250238    mov     rax, [rbp-6048h]
4250245    add     rax, 8
4250249    mov     esi, aDepth
4250254    mov     rdi, rax
4250257    call    _mg_get_header
4250262    mov     [rbp-6028h], rax
4250269    mov     rax, [rbp-6048h]
4250276    mov     rax, [rax+2A8h]
4250283    mov     rax, [rax+78h]
4250287    mov     [rbp-6020h], rax
4250294    mov     rax, [rbp-6048h]
4250301    mov     dword [rax+284h], 0CFh
4250311    cmp     dword [rbp-605Ch], 0
4250318    jnz     loc_40DB08
4250320    mov     rax, [rbp-6048h]
4250327    mov     dword [rax+284h], 194h
4250337    mov     rax, [rbp-6048h]
4250344    add     rax, 8
4250348    mov     edx, aHttp1_1404NotF
4250353    mov     esi, aS_2
4250358    mov     rdi, rax
4250361    mov     eax, 0
4250366    call    _mg_printf
4250371    jmp     loc_40DD06
loc_40DB08:
4250376    mov     rax, [rbp-6058h]
4250383    mov     eax, [rax+18h]
4250386    and     eax, 0F000h
4250391    cmp     eax, 4000h
4250396    jnz     loc_40DB6E
4250398    mov     rax, [rbp-6020h]
4250405    mov     esi, aYes
4250410    mov     rdi, rax
4250413    call    _mg_strcasecmp
4250418    test    eax, eax
4250420    jz      loc_40DB6E
4250422    mov     rax, [rbp-6048h]
4250429    mov     dword [rax+284h], 193h
4250439    mov     rax, [rbp-6048h]
4250446    add     rax, 8
4250450    mov     edx, aHttp1_1403Dire
4250455    mov     esi, aS_2
4250460    mov     rdi, rax
4250463    mov     eax, 0
4250468    call    _mg_printf
4250473    jmp     loc_40DD06
loc_40DB6E:
4250478    mov     rax, [rbp-6048h]
4250485    mov     rax, [rax]
4250488    mov     edx, 9Ch
4250493    mov     esi, header_6859
4250498    mov     rdi, rax
4250501    call    _ns_send
4250506    mov     rax, [rbp-6048h]
4250513    mov     rcx, [rax+10h]
4250517    mov     rdx, [rbp-6058h]
4250524    mov     rax, [rbp-6048h]
4250531    mov     rsi, rcx
4250534    mov     rdi, rax
4250537    call    _print_props
4250542    mov     rax, [rbp-6058h]
4250549    mov     eax, [rax+18h]
4250552    and     eax, 0F000h
4250557    cmp     eax, 4000h
4250562    jnz     loc_40DCEA
4250568    cmp     qword [rbp-6028h], 0
4250576    jz      loc_40DBEE
4250578    mov     rax, [rbp-6028h]
4250585    mov     esi, a0_0
4250590    mov     rdi, rax
4250593    call    _strcmp
4250598    test    eax, eax
4250600    jz      loc_40DCEA
loc_40DBEE:
4250606    mov     qword [rbp-6030h], 0
4250617    lea     rdx, [rbp-6030h]
4250624    mov     rcx, [rbp-6050h]
4250631    mov     rax, [rbp-6048h]
4250638    mov     rsi, rcx
4250641    mov     rdi, rax
4250644    call    _scan_directory
4250649    mov     [rbp-6034h], eax
4250655    mov     dword [rbp-6038h], 0
4250665    jmp     loc_40DCC9
loc_40DC2E:
4250670    mov     rcx, [rbp-6030h]
4250677    mov     eax, [rbp-6038h]
4250683    movsxd  rdx, eax
4250686    mov     rax, rdx
4250689    shl     rax, 2
4250693    add     rax, rdx
4250696    shl     rax, 5
4250700    add     rax, rcx
4250703    mov     [rbp-6018h], rax
4250710    mov     rax, [rbp-6018h]
4250717    mov     rax, [rax+8]
4250721    mov     rdi, rax
4250724    call    _strlen
4250729    mov     rsi, rax
4250732    mov     rax, [rbp-6018h]
4250739    mov     rax, [rax+8]
4250743    lea     rdx, [rbp-6010h]
4250750    mov     ecx, 6000h
4250755    mov     rdi, rax
4250758    call    _mg_url_encode
4250763    mov     rax, [rbp-6018h]
4250770    lea     rdx, [rax+10h]
4250774    lea     rcx, [rbp-6010h]
4250781    mov     rax, [rbp-6048h]
4250788    mov     rsi, rcx
4250791    mov     rdi, rax
4250794    call    _print_props
4250799    mov     rax, [rbp-6018h]
4250806    mov     rax, [rax+8]
4250810    mov     rdi, rax
4250813    call    _free
4250818    add     dword [rbp-6038h], 1
loc_40DCC9:
4250825    mov     eax, [rbp-6038h]
4250831    cmp     eax, [rbp-6034h]
4250837    jl      loc_40DC2E
4250843    mov     rax, [rbp-6030h]
4250850    mov     rdi, rax
4250853    call    _free
loc_40DCEA:
4250858    mov     rax, [rbp-6048h]
4250865    mov     rax, [rax]
4250868    mov     edx, 10h
4250873    mov     esi, footer_6860
4250878    mov     rdi, rax
4250881    call    _ns_send
loc_40DD06:
4250886    mov     rax, [rbp-6048h]
4250893    mov     rdi, rax
4250896    call    _close_local_endpoint
4250901    mov     rax, [rbp-8]
4250905    xor     rax, [fs:28h]
4250914    jz      locret_40DD29
4250916    call    ___stack_chk_fail
locret_40DD29:
4250921    leave   
4250922    retn    
USE32

section .text

global _handle_mkcol

_handle_mkcol:
4250923    push    rbp
4250924    mov     rbp, rsp
4250927    sub     rsp, 20h
4250931    call    _mcount
4250936    mov     [rbp-18h], rdi
4250940    mov     [rbp-20h], rsi
4250944    mov     dword [rbp-4], 1F4h
4250951    mov     rax, [rbp-18h]
4250955    mov     rax, [rax+278h]
4250962    test    rax, rax
4250965    jz      loc_40DD60
4250967    mov     dword [rbp-4], 19Fh
4250974    jmp     loc_40DDBB
loc_40DD60:
4250976    mov     rax, [rbp-20h]
4250980    mov     esi, 1EDh
4250985    mov     rdi, rax
4250988    call    _mkdir
4250993    test    eax, eax
4250995    jnz     loc_40DD7E
4250997    mov     dword [rbp-4], 0C9h
4251004    jmp     loc_40DDBB
loc_40DD7E:
4251006    call    ___errno_location
4251011    mov     eax, [rax]
4251013    cmp     eax, 11h
4251016    jnz     loc_40DD93
4251018    mov     dword [rbp-4], 195h
4251025    jmp     loc_40DDBB
loc_40DD93:
4251027    call    ___errno_location
4251032    mov     eax, [rax]
4251034    cmp     eax, 0Dh
4251037    jnz     loc_40DDA8
4251039    mov     dword [rbp-4], 193h
4251046    jmp     loc_40DDBB
loc_40DDA8:
4251048    call    ___errno_location
4251053    mov     eax, [rax]
4251055    cmp     eax, 2
4251058    jnz     loc_40DDBB
4251060    mov     dword [rbp-4], 199h
loc_40DDBB:
4251067    mov     ecx, [rbp-4]
4251070    mov     rax, [rbp-18h]
4251074    mov     edx, 0
4251079    mov     esi, ecx
4251081    mov     rdi, rax
4251084    mov     eax, 0
4251089    call    _send_http_error
4251094    leave   
4251095    retn    
USE32

section .text

global _remove_directory

_remove_directory:
4251096    push    rbp
4251097    mov     rbp, rsp
4251100    push    rbx
4251101    sub     rsp, 20C8h
4251108    call    _mcount
4251113    mov     [rbp-20C8h], rdi
4251120    mov     rax, [fs:28h]
4251129    mov     [rbp-18h], rax
4251133    xor     eax, eax
4251135    mov     rax, [rbp-20C8h]
4251142    mov     rdi, rax
4251145    call    _opendir
4251150    mov     [rbp-20C0h], rax
4251157    cmp     qword [rbp-20C0h], 0
4251165    jnz     loc_40DE29
4251167    mov     eax, 0
4251172    jmp     loc_40DF39
loc_40DE29:
4251177    jmp     loc_40DEF2
loc_40DE2E:
4251182    mov     rax, [rbp-20B8h]
4251189    add     rax, 13h
4251193    mov     esi, a_
4251198    mov     rdi, rax
4251201    call    _strcmp
4251206    test    eax, eax
4251208    jz      loc_40DE66
4251210    mov     rax, [rbp-20B8h]
4251217    add     rax, 13h
4251221    mov     esi, a__
4251226    mov     rdi, rax
4251229    call    _strcmp
4251234    test    eax, eax
4251236    jnz     loc_40DE6B
loc_40DE66:
4251238    jmp     loc_40DEF2
loc_40DE6B:
4251243    mov     rax, [rbp-20B8h]
4251250    lea     rcx, [rax+13h]
4251254    mov     rdx, [rbp-20C8h]
4251261    lea     rax, [rbp-2020h]
4251268    mov     r9, rcx
4251271    mov     r8d, 2Fh
4251277    mov     rcx, rdx
4251280    mov     edx, aSCS
4251285    mov     esi, 2000h
4251290    mov     rdi, rax
4251293    mov     eax, 0
4251298    call    _mg_snprintf
4251303    lea     rdx, [rbp-20B0h]
4251310    lea     rax, [rbp-2020h]
4251317    mov     rsi, rdx
4251320    mov     rdi, rax
4251323    call    _stat64
4251328    mov     eax, [rbp-2098h]
4251334    and     eax, 0F000h
4251339    cmp     eax, 4000h
4251344    jnz     loc_40DEE3
4251346    lea     rax, [rbp-2020h]
4251353    mov     rdi, rax
4251356    call    _remove_directory
4251361    jmp     loc_40DEF2
loc_40DEE3:
4251363    lea     rax, [rbp-2020h]
4251370    mov     rdi, rax
4251373    call    _remove
loc_40DEF2:
4251378    mov     rax, [rbp-20C0h]
4251385    mov     rdi, rax
4251388    call    _readdir64
4251393    mov     [rbp-20B8h], rax
4251400    cmp     qword [rbp-20B8h], 0
4251408    jnz     loc_40DE2E
4251414    mov     rax, [rbp-20C0h]
4251421    mov     rdi, rax
4251424    call    _closedir
4251429    mov     rax, [rbp-20C8h]
4251436    mov     rdi, rax
4251439    call    _rmdir
4251444    mov     eax, 1
loc_40DF39:
4251449    mov     rbx, [rbp-18h]
4251453    xor     rbx, [fs:28h]
4251462    jz      loc_40DF4D
4251464    call    ___stack_chk_fail
loc_40DF4D:
4251469    add     rsp, 20C8h
4251476    pop     rbx
4251477    pop     rbp
4251478    retn    
USE32

section .text

global _handle_delete

_handle_delete:
4251479    push    rbp
4251480    mov     rbp, rsp
4251483    sub     rsp, 0A0h
4251490    call    _mcount
4251495    mov     [rbp-98h], rdi
4251502    mov     [rbp-0A0h], rsi
4251509    lea     rdx, [rbp-90h]
4251516    mov     rax, [rbp-0A0h]
4251523    mov     rsi, rdx
4251526    mov     rdi, rax
4251529    call    _stat64
4251534    test    eax, eax
4251536    jz      loc_40DFB5
4251538    mov     rax, [rbp-98h]
4251545    mov     edx, 0
4251550    mov     esi, 194h
4251555    mov     rdi, rax
4251558    mov     eax, 0
4251563    call    _send_http_error
4251568    jmp     locret_40E044
loc_40DFB5:
4251573    mov     eax, [rbp-78h]
4251576    and     eax, 0F000h
4251581    cmp     eax, 4000h
4251586    jnz     loc_40DFF3
4251588    mov     rax, [rbp-0A0h]
4251595    mov     rdi, rax
4251598    call    _remove_directory
4251603    mov     rax, [rbp-98h]
4251610    mov     edx, 0
4251615    mov     esi, 0CCh
4251620    mov     rdi, rax
4251623    mov     eax, 0
4251628    call    _send_http_error
4251633    jmp     locret_40E044
loc_40DFF3:
4251635    mov     rax, [rbp-0A0h]
4251642    mov     rdi, rax
4251645    call    _remove
4251650    test    eax, eax
4251652    jnz     loc_40E026
4251654    mov     rax, [rbp-98h]
4251661    mov     edx, 0
4251666    mov     esi, 0CCh
4251671    mov     rdi, rax
4251674    mov     eax, 0
4251679    call    _send_http_error
4251684    jmp     locret_40E044
loc_40E026:
4251686    mov     rax, [rbp-98h]
4251693    mov     edx, 0
4251698    mov     esi, 1A7h
4251703    mov     rdi, rax
4251706    mov     eax, 0
4251711    call    _send_http_error
locret_40E044:
4251716    leave   
4251717    retn    
USE32

section .text

global _put_dir

_put_dir:
4251718    push    rbp
4251719    mov     rbp, rsp
4251722    push    rbx
4251723    sub     rsp, 20C8h
4251730    call    _mcount
4251735    mov     [rbp-20C8h], rdi
4251742    mov     rax, [fs:28h]
4251751    mov     [rbp-18h], rax
4251755    xor     eax, eax
4251757    mov     rax, [rbp-20C8h]
4251764    add     rax, 1
4251768    mov     [rbp-20B8h], rax
4251775    mov     rax, [rbp-20B8h]
4251782    mov     [rbp-20C0h], rax
4251789    jmp     loc_40E16F
loc_40E092:
4251794    mov     rdx, [rbp-20B8h]
4251801    mov     rax, [rbp-20C8h]
4251808    sub     rdx, rax
4251811    mov     rax, rdx
4251814    cmp     rax, 1FFFh
4251820    jle     loc_40E0B8
4251822    mov     eax, 0FFFFFFFFh
4251827    jmp     loc_40E19D
loc_40E0B8:
4251832    mov     rdx, [rbp-20B8h]
4251839    mov     rax, [rbp-20C8h]
4251846    sub     rdx, rax
4251849    mov     rax, rdx
4251852    mov     rdx, rax
4251855    mov     rcx, [rbp-20C8h]
4251862    lea     rax, [rbp-2020h]
4251869    mov     rsi, rcx
4251872    mov     rdi, rax
4251875    call    _memcpy
4251880    mov     rdx, [rbp-20B8h]
4251887    mov     rax, [rbp-20C8h]
4251894    sub     rdx, rax
4251897    mov     rax, rdx
4251900    mov     byte [rbp+rax-2020h], 0
4251908    lea     rdx, [rbp-20B0h]
4251915    lea     rax, [rbp-2020h]
4251922    mov     rsi, rdx
4251925    mov     rdi, rax
4251928    call    _stat64
4251933    test    eax, eax
4251935    jz      loc_40E140
4251937    lea     rax, [rbp-2020h]
4251944    mov     esi, 1EDh
4251949    mov     rdi, rax
4251952    call    _mkdir
4251957    test    eax, eax
4251959    jz      loc_40E140
4251961    mov     eax, 0FFFFFFFFh
4251966    jmp     loc_40E19D
loc_40E140:
4251968    mov     rax, [rbp-20B8h]
4251975    add     rax, 1
4251979    movzx   eax, byte [rax]
4251982    test    al, al
4251984    jnz     loc_40E159
4251986    mov     eax, 0
4251991    jmp     loc_40E19D
loc_40E159:
4251993    add     qword [rbp-20B8h], 1
4252001    mov     rax, [rbp-20B8h]
4252008    mov     [rbp-20C0h], rax
loc_40E16F:
4252015    mov     rax, [rbp-20C0h]
4252022    mov     esi, 2Fh
4252027    mov     rdi, rax
4252030    call    _strchr
4252035    mov     [rbp-20B8h], rax
4252042    cmp     qword [rbp-20B8h], 0
4252050    jnz     loc_40E092
4252056    mov     eax, 1
loc_40E19D:
4252061    mov     rbx, [rbp-18h]
4252065    xor     rbx, [fs:28h]
4252074    jz      loc_40E1B1
4252076    call    ___stack_chk_fail
loc_40E1B1:
4252081    add     rsp, 20C8h
4252088    pop     rbx
4252089    pop     rbp
4252090    retn    
USE32

section .text

global _handle_put

_handle_put:
4252091    push    rbp
4252092    mov     rbp, rsp
4252095    sub     rsp, 0D0h
4252102    call    _mcount
4252107    mov     [rbp-0C8h], rdi
4252114    mov     [rbp-0D0h], rsi
4252121    mov     rax, [rbp-0C8h]
4252128    add     rax, 8
4252132    mov     esi, aContentLength
4252137    mov     rdi, rax
4252140    call    _mg_get_header
4252145    mov     [rbp-0A0h], rax
4252152    lea     rdx, [rbp-90h]
4252159    mov     rax, [rbp-0D0h]
4252166    mov     rsi, rdx
4252169    mov     rdi, rax
4252172    call    _stat64
4252177    test    eax, eax
4252179    jnz     loc_40E21C
4252181    mov     eax, 0C8h
4252186    jmp     loc_40E221
loc_40E21C:
4252188    mov     eax, 0C9h
loc_40E221:
4252193    mov     rdx, [rbp-0C8h]
4252200    mov     [rdx+284h], eax
4252206    mov     rax, [rbp-0D0h]
4252213    mov     rdi, rax
4252216    call    _put_dir
4252221    mov     [rbp-0B4h], eax
4252227    cmp     dword [rbp-0B4h], 0
4252234    jnz     loc_40E28C
4252236    mov     rax, [rbp-0C8h]
4252243    mov     eax, [rax+284h]
4252249    mov     rdx, [rbp-0C8h]
4252256    lea     rcx, [rdx+8]
4252260    mov     edx, eax
4252262    mov     esi, aHttp1_1DOk
4252267    mov     rdi, rcx
4252270    mov     eax, 0
4252275    call    _mg_printf
4252280    mov     rax, [rbp-0C8h]
4252287    mov     rdi, rax
4252290    call    _close_local_endpoint
4252295    jmp     locret_40E4E6
loc_40E28C:
4252300    cmp     dword [rbp-0B4h], 0FFFFFFFFh
4252307    jnz     loc_40E2CC
4252309    call    ___errno_location
4252314    mov     eax, [rax]
4252316    mov     edi, eax
4252318    call    _strerror
4252323    mov     rdx, rax
4252326    mov     rax, [rbp-0C8h]
4252333    mov     rcx, rdx
4252336    mov     edx, aPut_dirS
4252341    mov     esi, 1F4h
4252346    mov     rdi, rax
4252349    mov     eax, 0
4252354    call    _send_http_error
4252359    jmp     locret_40E4E6
loc_40E2CC:
4252364    cmp     qword [rbp-0A0h], 0
4252372    jnz     loc_40E2F9
4252374    mov     rax, [rbp-0C8h]
4252381    mov     edx, 0
4252386    mov     esi, 19Bh
4252391    mov     rdi, rax
4252394    mov     eax, 0
4252399    call    _send_http_error
4252404    jmp     locret_40E4E6
loc_40E2F9:
4252409    mov     rax, [rbp-0D0h]
4252416    mov     edx, 1A4h
4252421    mov     esi, 242h
4252426    mov     rdi, rax
4252429    mov     eax, 0
4252434    call    _open64
4252439    mov     rdx, [rbp-0C8h]
4252446    mov     [rdx+2B0h], eax
4252452    mov     rax, [rbp-0C8h]
4252459    mov     eax, [rax+2B0h]
4252465    test    eax, eax
4252467    jns     loc_40E376
4252469    call    ___errno_location
4252474    mov     eax, [rax]
4252476    mov     edi, eax
4252478    call    _strerror
4252483    mov     rcx, rax
4252486    mov     rdx, [rbp-0D0h]
4252493    mov     rax, [rbp-0C8h]
4252500    mov     r8, rcx
4252503    mov     rcx, rdx
4252506    mov     edx, aOpenSS
4252511    mov     esi, 1F4h
4252516    mov     rdi, rax
4252519    mov     eax, 0
4252524    call    _send_http_error
4252529    jmp     locret_40E4E6
loc_40E376:
4252534    mov     rax, [rbp-0C8h]
4252541    mov     dword [rax+2B8h], 4
4252551    mov     rax, [rbp-0C8h]
4252558    mov     eax, [rax+2B0h]
4252564    mov     edi, eax
4252566    call    _ns_set_close_on_exec
4252571    mov     rax, [rbp-0C8h]
4252578    add     rax, 8
4252582    mov     esi, aContentRange
4252587    mov     rdi, rax
4252590    call    _mg_get_header
4252595    mov     [rbp-98h], rax
4252602    mov     rax, [rbp-0A0h]
4252609    mov     edx, 0Ah
4252614    mov     esi, 0
4252619    mov     rdi, rax
4252622    call    _strtoll
4252627    mov     rdx, [rbp-0C8h]
4252634    mov     [rdx+2D8h], rax
4252641    mov     qword [rbp-0A8h], 0
4252652    mov     rax, [rbp-0A8h]
4252659    mov     [rbp-0B0h], rax
4252666    cmp     qword [rbp-98h], 0
4252674    jz      loc_40E4BA
4252680    lea     rdx, [rbp-0A8h]
4252687    lea     rcx, [rbp-0B0h]
4252694    mov     rax, [rbp-98h]
4252701    mov     rsi, rcx
4252704    mov     rdi, rax
4252707    call    _parse_range_header
4252712    test    eax, eax
4252714    jle     loc_40E4BA
4252720    mov     rax, [rbp-0C8h]
4252727    mov     dword [rax+284h], 0CEh
4252737    mov     rcx, [rbp-0B0h]
4252744    mov     rax, [rbp-0C8h]
4252751    mov     eax, [rax+2B0h]
4252757    mov     edx, 0
4252762    mov     rsi, rcx
4252765    mov     edi, eax
4252767    call    _lseek64
4252772    mov     rdx, [rbp-0A8h]
4252779    mov     rax, [rbp-0B0h]
4252786    cmp     rdx, rax
4252789    jle     loc_40E491
4252791    mov     rdx, [rbp-0A8h]
4252798    mov     rax, [rbp-0B0h]
4252805    sub     rdx, rax
4252808    mov     rax, rdx
4252811    add     rax, 1
4252815    jmp     loc_40E4AC
loc_40E491:
4252817    mov     rax, [rbp-0C8h]
4252824    mov     rdx, [rax+2D8h]
4252831    mov     rax, [rbp-0B0h]
4252838    sub     rdx, rax
4252841    mov     rax, rdx
loc_40E4AC:
4252844    mov     rdx, [rbp-0C8h]
4252851    mov     [rdx+2D8h], rax
loc_40E4BA:
4252858    mov     rax, [rbp-0C8h]
4252865    mov     eax, [rax+284h]
4252871    mov     rdx, [rbp-0C8h]
4252878    lea     rcx, [rdx+8]
4252882    mov     edx, eax
4252884    mov     esi, aHttp1_1DOkCont
4252889    mov     rdi, rcx
4252892    mov     eax, 0
4252897    call    _mg_printf
locret_40E4E6:
4252902    leave   
4252903    retn    
USE32

section .text

global _forward_put_data

_forward_put_data:
4252904    push    rbp
4252905    mov     rbp, rsp
4252908    sub     rsp, 30h
4252912    call    _mcount
4252917    mov     [rbp-28h], rdi
4252921    mov     rax, [rbp-28h]
4252925    mov     rax, [rax]
4252928    add     rax, 38h
4252932    mov     [rbp-18h], rax
4252936    mov     rax, [rbp-18h]
4252940    mov     rax, [rax+8]
4252944    mov     rdx, rax
4252947    mov     rax, [rbp-28h]
4252951    mov     rax, [rax+2D8h]
4252958    cmp     rdx, rax
4252961    cmovle  rax, rdx
4252965    mov     [rbp-10h], rax
4252969    mov     rax, [rbp-18h]
4252973    mov     rcx, [rax]
4252976    mov     rax, [rbp-28h]
4252980    mov     eax, [rax+2B0h]
4252986    mov     rdx, [rbp-10h]
4252990    mov     rsi, rcx
4252993    mov     edi, eax
4252995    call    _write
4253000    mov     [rbp-8], rax
4253004    cmp     qword [rbp-8], 0
4253009    jz      loc_40E583
4253011    mov     rdx, [rbp-8]
4253015    mov     rax, [rbp-18h]
4253019    mov     rsi, rdx
4253022    mov     rdi, rax
4253025    call    _iobuf_remove
4253030    mov     rax, [rbp-28h]
4253034    mov     rax, [rax+2D8h]
4253041    sub     rax, [rbp-8]
4253045    mov     rdx, rax
4253048    mov     rax, [rbp-28h]
4253052    mov     [rax+2D8h], rdx
loc_40E583:
4253059    mov     rax, [rbp-28h]
4253063    mov     rax, [rax+2D8h]
4253070    test    rax, rax
4253073    jg      locret_40E59F
4253075    mov     rax, [rbp-28h]
4253079    mov     rdi, rax
4253082    call    _close_local_endpoint
locret_40E59F:
4253087    leave   
4253088    retn    
USE32

section .text

global _send_options

_send_options:
4253089    push    rbp
4253090    mov     rbp, rsp
4253093    sub     rsp, 10h
4253097    call    _mcount
4253102    mov     [rbp-8], rdi
4253106    mov     rax, [rbp-8]
4253110    mov     dword [rax+284h], 0C8h
4253120    mov     rax, [rbp-8]
4253124    add     rax, 8
4253128    mov     edx, aHttp1_1200OkAl
4253133    mov     esi, aS_2
4253138    mov     rdi, rax
4253141    mov     eax, 0
4253146    call    _mg_printf
4253151    mov     rax, [rbp-8]
4253155    mov     rdi, rax
4253158    call    _close_local_endpoint
4253163    leave   
4253164    retn    
USE32

section .text

global _mg_send_digest_auth_request

_mg_send_digest_auth_request:
4253165    push    rbp
4253166    mov     rbp, rsp
4253169    sub     rsp, 20h
4253173    call    _mcount
4253178    mov     [rbp-18h], rdi
4253182    mov     rax, [rbp-18h]
4253186    sub     rax, 8
4253190    mov     [rbp-8], rax
4253194    mov     rax, [rbp-18h]
4253198    mov     dword [rax+27Ch], 191h
4253208    mov     edi, 0
4253213    call    _time
4253218    mov     rcx, rax
4253221    mov     rax, [rbp-8]
4253225    mov     rax, [rax+2A8h]
4253232    mov     rdx, [rax+48h]
4253236    mov     rax, [rbp-18h]
4253240    mov     esi, aHttp1_1401Unau
4253245    mov     rdi, rax
4253248    mov     eax, 0
4253253    call    _mg_printf
4253258    mov     rax, [rbp-8]
4253262    mov     rdi, rax
4253265    call    _close_local_endpoint
4253270    leave   
4253271    retn    
USE32

section .text

global _open_auth_file

_open_auth_file:
4253272    push    rbp
4253273    mov     rbp, rsp
4253276    push    rbx
4253277    sub     rsp, 2058h
4253284    call    _mcount
4253289    mov     [rbp-2048h], rdi
4253296    mov     [rbp-2050h], rsi
4253303    mov     [rbp-2054h], edx
4253309    mov     rax, [fs:28h]
4253318    mov     [rbp-18h], rax
4253322    xor     eax, eax
4253324    mov     rax, [rbp-2048h]
4253331    mov     rax, [rax+2A8h]
4253338    mov     rax, [rax+90h]
4253345    mov     [rbp-2028h], rax
4253352    mov     qword [rbp-2030h], 0
4253363    cmp     qword [rbp-2028h], 0
4253371    jz      loc_40E6DD
4253373    mov     rax, [rbp-2028h]
4253380    mov     esi, aR_0
4253385    mov     rdi, rax
4253388    call    _fopen64
4253393    mov     [rbp-2030h], rax
4253400    jmp     loc_40E7D6
loc_40E6DD:
4253405    cmp     dword [rbp-2054h], 0
4253412    jz      loc_40E73A
4253414    mov     rdx, [rbp-2050h]
4253421    lea     rax, [rbp-2020h]
4253428    mov     r9d, a_htpasswd_0
4253434    mov     r8d, 2Fh
4253440    mov     rcx, rdx
4253443    mov     edx, aSCS
4253448    mov     esi, 2000h
4253453    mov     rdi, rax
4253456    mov     eax, 0
4253461    call    _mg_snprintf
4253466    lea     rax, [rbp-2020h]
4253473    mov     esi, aR_0
4253478    mov     rdi, rax
4253481    call    _fopen64
4253486    mov     [rbp-2030h], rax
4253493    jmp     loc_40E7D6
loc_40E73A:
4253498    mov     rax, [rbp-2050h]
4253505    mov     esi, 2Fh
4253510    mov     rdi, rax
4253513    call    _strrchr
4253518    mov     [rbp-2038h], rax
4253525    cmp     qword [rbp-2038h], 0
4253533    jnz     loc_40E76D
4253535    mov     rax, [rbp-2050h]
4253542    mov     [rbp-2038h], rax
loc_40E76D:
4253549    mov     rdx, [rbp-2038h]
4253556    mov     rax, [rbp-2050h]
4253563    sub     rdx, rax
4253566    mov     rax, rdx
4253569    mov     edx, eax
4253571    mov     rcx, [rbp-2050h]
4253578    lea     rax, [rbp-2020h]
4253585    mov     qword [rsp], a_htpasswd_0
4253593    mov     r9d, 2Fh
4253599    mov     r8, rcx
4253602    mov     ecx, edx
4253604    mov     edx, a_SCS_0
4253609    mov     esi, 2000h
4253614    mov     rdi, rax
4253617    mov     eax, 0
4253622    call    _mg_snprintf
4253627    lea     rax, [rbp-2020h]
4253634    mov     esi, aR_0
4253639    mov     rdi, rax
4253642    call    _fopen64
4253647    mov     [rbp-2030h], rax
loc_40E7D6:
4253654    mov     rax, [rbp-2030h]
4253661    mov     rbx, [rbp-18h]
4253665    xor     rbx, [fs:28h]
4253674    jz      loc_40E7F1
4253676    call    ___stack_chk_fail
loc_40E7F1:
4253681    add     rsp, 2058h
4253688    pop     rbx
4253689    pop     rbp
4253690    retn    
USE32

section .text

global _byteReverse

_byteReverse:
4253691    push    rbp
4253692    mov     rbp, rsp
4253695    sub     rsp, 20h
4253699    call    _mcount
4253704    mov     [rbp-18h], rdi
4253708    mov     [rbp-1Ch], esi
4253711    call    _is_big_endian
4253716    test    eax, eax
4253718    jz      locret_40E87C
loc_40E818:
4253720    mov     rax, [rbp-18h]
4253724    add     rax, 3
4253728    movzx   eax, byte [rax]
4253731    movzx   eax, al
4253734    shl     eax, 8
4253737    mov     edx, eax
4253739    mov     rax, [rbp-18h]
4253743    add     rax, 2
4253747    movzx   eax, byte [rax]
4253750    movzx   eax, al
4253753    or      eax, edx
4253755    shl     eax, 10h
4253758    mov     edx, eax
4253760    mov     rax, [rbp-18h]
4253764    add     rax, 1
4253768    movzx   eax, byte [rax]
4253771    movzx   eax, al
4253774    shl     eax, 8
4253777    mov     ecx, eax
4253779    mov     rax, [rbp-18h]
4253783    movzx   eax, byte [rax]
4253786    movzx   eax, al
4253789    or      eax, ecx
4253791    or      eax, edx
4253793    mov     [rbp-4], eax
4253796    mov     rax, [rbp-18h]
4253800    mov     edx, [rbp-4]
4253803    mov     [rax], edx
4253805    add     qword [rbp-18h], 4
4253810    sub     dword [rbp-1Ch], 1
4253814    cmp     dword [rbp-1Ch], 0
4253818    jnz     loc_40E818
locret_40E87C:
4253820    leave   
4253821    retn    
USE32

section .text

global _MD5Init

_MD5Init:
4253822    push    rbp
4253823    mov     rbp, rsp
4253826    sub     rsp, 8
4253830    call    _mcount
4253835    mov     [rbp-8], rdi
4253839    mov     rax, [rbp-8]
4253843    mov     dword [rax], 67452301h
4253849    mov     rax, [rbp-8]
4253853    mov     dword [rax+4], 0EFCDAB89h
4253860    mov     rax, [rbp-8]
4253864    mov     dword [rax+8], 98BADCFEh
4253871    mov     rax, [rbp-8]
4253875    mov     dword [rax+0Ch], 10325476h
4253882    mov     rax, [rbp-8]
4253886    mov     dword [rax+10h], 0
4253893    mov     rax, [rbp-8]
4253897    mov     dword [rax+14h], 0
4253904    leave   
4253905    retn    
USE32

section .text

global _MD5Transform

_MD5Transform:
4253906    push    rbp
4253907    mov     rbp, rsp
4253910    push    r14
4253912    push    r13
4253914    push    r12
4253916    push    rbx
4253917    sub     rsp, 10h
4253921    call    _mcount
4253926    mov     [rbp-28h], rdi
4253930    mov     [rbp-30h], rsi
4253934    mov     rax, [rbp-28h]
4253938    mov     r14d, [rax]
4253941    mov     rax, [rbp-28h]
4253945    mov     r13d, [rax+4]
4253949    mov     rax, [rbp-28h]
4253953    mov     r12d, [rax+8]
4253957    mov     rax, [rbp-28h]
4253961    mov     ebx, [rax+0Ch]
4253964    mov     eax, r12d
4253967    xor     eax, ebx
4253969    and     eax, r13d
4253972    xor     eax, ebx
4253974    mov     edx, eax
4253976    mov     rax, [rbp-30h]
4253980    mov     eax, [rax]
4253982    add     eax, edx
4253984    add     eax, r14d
4253987    lea     r14d, [rax-28955B88h]
4253994    ror     r14d, 19h
4253998    add     r14d, r13d
4254001    mov     eax, r13d
4254004    xor     eax, r12d
4254007    and     eax, r14d
4254010    xor     eax, r12d
4254013    mov     edx, eax
4254015    mov     rax, [rbp-30h]
4254019    add     rax, 4
4254023    mov     eax, [rax]
4254025    add     eax, edx
4254027    add     eax, ebx
4254029    lea     ebx, [rax-173848AAh]
4254035    ror     ebx, 14h
4254038    add     ebx, r14d
4254041    mov     eax, r14d
4254044    xor     eax, r13d
4254047    and     eax, ebx
4254049    xor     eax, r13d
4254052    mov     edx, eax
4254054    mov     rax, [rbp-30h]
4254058    add     rax, 8
4254062    mov     eax, [rax]
4254064    add     eax, edx
4254066    add     eax, r12d
4254069    lea     r12d, [rax+242070DBh]
4254076    ror     r12d, 0Fh
4254080    add     r12d, ebx
4254083    mov     eax, ebx
4254085    xor     eax, r14d
4254088    and     eax, r12d
4254091    xor     eax, r14d
4254094    mov     edx, eax
4254096    mov     rax, [rbp-30h]
4254100    add     rax, 0Ch
4254104    mov     eax, [rax]
4254106    add     eax, edx
4254108    add     eax, r13d
4254111    lea     r13d, [rax-3E423112h]
4254118    ror     r13d, 0Ah
4254122    add     r13d, r12d
4254125    mov     eax, r12d
4254128    xor     eax, ebx
4254130    and     eax, r13d
4254133    xor     eax, ebx
4254135    mov     edx, eax
4254137    mov     rax, [rbp-30h]
4254141    add     rax, 10h
4254145    mov     eax, [rax]
4254147    add     eax, edx
4254149    add     eax, r14d
4254152    lea     r14d, [rax-0A83F051h]
4254159    ror     r14d, 19h
4254163    add     r14d, r13d
4254166    mov     eax, r13d
4254169    xor     eax, r12d
4254172    and     eax, r14d
4254175    xor     eax, r12d
4254178    mov     edx, eax
4254180    mov     rax, [rbp-30h]
4254184    add     rax, 14h
4254188    mov     eax, [rax]
4254190    add     eax, edx
4254192    add     eax, ebx
4254194    lea     ebx, [rax+4787C62Ah]
4254200    ror     ebx, 14h
4254203    add     ebx, r14d
4254206    mov     eax, r14d
4254209    xor     eax, r13d
4254212    and     eax, ebx
4254214    xor     eax, r13d
4254217    mov     edx, eax
4254219    mov     rax, [rbp-30h]
4254223    add     rax, 18h
4254227    mov     eax, [rax]
4254229    add     eax, edx
4254231    add     eax, r12d
4254234    lea     r12d, [rax-57CFB9EDh]
4254241    ror     r12d, 0Fh
4254245    add     r12d, ebx
4254248    mov     eax, ebx
4254250    xor     eax, r14d
4254253    and     eax, r12d
4254256    xor     eax, r14d
4254259    mov     edx, eax
4254261    mov     rax, [rbp-30h]
4254265    add     rax, 1Ch
4254269    mov     eax, [rax]
4254271    add     eax, edx
4254273    add     eax, r13d
4254276    lea     r13d, [rax-2B96AFFh]
4254283    ror     r13d, 0Ah
4254287    add     r13d, r12d
4254290    mov     eax, r12d
4254293    xor     eax, ebx
4254295    and     eax, r13d
4254298    xor     eax, ebx
4254300    mov     edx, eax
4254302    mov     rax, [rbp-30h]
4254306    add     rax, 20h
4254310    mov     eax, [rax]
4254312    add     eax, edx
4254314    add     eax, r14d
4254317    lea     r14d, [rax+698098D8h]
4254324    ror     r14d, 19h
4254328    add     r14d, r13d
4254331    mov     eax, r13d
4254334    xor     eax, r12d
4254337    and     eax, r14d
4254340    xor     eax, r12d
4254343    mov     edx, eax
4254345    mov     rax, [rbp-30h]
4254349    add     rax, 24h
4254353    mov     eax, [rax]
4254355    add     eax, edx
4254357    add     eax, ebx
4254359    lea     ebx, [rax-74BB0851h]
4254365    ror     ebx, 14h
4254368    add     ebx, r14d
4254371    mov     eax, r14d
4254374    xor     eax, r13d
4254377    and     eax, ebx
4254379    xor     eax, r13d
4254382    mov     edx, eax
4254384    mov     rax, [rbp-30h]
4254388    add     rax, 28h
4254392    mov     eax, [rax]
4254394    add     eax, edx
4254396    add     eax, r12d
4254399    lea     r12d, [rax-0A44Fh]
4254406    ror     r12d, 0Fh
4254410    add     r12d, ebx
4254413    mov     eax, ebx
4254415    xor     eax, r14d
4254418    and     eax, r12d
4254421    xor     eax, r14d
4254424    mov     edx, eax
4254426    mov     rax, [rbp-30h]
4254430    add     rax, 2Ch
4254434    mov     eax, [rax]
4254436    add     eax, edx
4254438    add     eax, r13d
4254441    lea     r13d, [rax-76A32842h]
4254448    ror     r13d, 0Ah
4254452    add     r13d, r12d
4254455    mov     eax, r12d
4254458    xor     eax, ebx
4254460    and     eax, r13d
4254463    xor     eax, ebx
4254465    mov     edx, eax
4254467    mov     rax, [rbp-30h]
4254471    add     rax, 30h
4254475    mov     eax, [rax]
4254477    add     eax, edx
4254479    add     eax, r14d
4254482    lea     r14d, [rax+6B901122h]
4254489    ror     r14d, 19h
4254493    add     r14d, r13d
4254496    mov     eax, r13d
4254499    xor     eax, r12d
4254502    and     eax, r14d
4254505    xor     eax, r12d
4254508    mov     edx, eax
4254510    mov     rax, [rbp-30h]
4254514    add     rax, 34h
4254518    mov     eax, [rax]
4254520    add     eax, edx
4254522    add     eax, ebx
4254524    lea     ebx, [rax-2678E6Dh]
4254530    ror     ebx, 14h
4254533    add     ebx, r14d
4254536    mov     eax, r14d
4254539    xor     eax, r13d
4254542    and     eax, ebx
4254544    xor     eax, r13d
4254547    mov     edx, eax
4254549    mov     rax, [rbp-30h]
4254553    add     rax, 38h
4254557    mov     eax, [rax]
4254559    add     eax, edx
4254561    add     eax, r12d
4254564    lea     r12d, [rax-5986BC72h]
4254571    ror     r12d, 0Fh
4254575    add     r12d, ebx
4254578    mov     eax, ebx
4254580    xor     eax, r14d
4254583    and     eax, r12d
4254586    xor     eax, r14d
4254589    mov     edx, eax
4254591    mov     rax, [rbp-30h]
4254595    add     rax, 3Ch
4254599    mov     eax, [rax]
4254601    add     eax, edx
4254603    add     eax, r13d
4254606    lea     r13d, [rax+49B40821h]
4254613    ror     r13d, 0Ah
4254617    add     r13d, r12d
4254620    mov     eax, r13d
4254623    xor     eax, r12d
4254626    and     eax, ebx
4254628    xor     eax, r12d
4254631    mov     edx, eax
4254633    mov     rax, [rbp-30h]
4254637    add     rax, 4
4254641    mov     eax, [rax]
4254643    add     eax, edx
4254645    add     eax, r14d
4254648    lea     r14d, [rax-9E1DA9Eh]
4254655    ror     r14d, 1Bh
4254659    add     r14d, r13d
4254662    mov     eax, r14d
4254665    xor     eax, r13d
4254668    and     eax, r12d
4254671    xor     eax, r13d
4254674    mov     edx, eax
4254676    mov     rax, [rbp-30h]
4254680    add     rax, 18h
4254684    mov     eax, [rax]
4254686    add     eax, edx
4254688    add     eax, ebx
4254690    lea     ebx, [rax-3FBF4CC0h]
4254696    ror     ebx, 17h
4254699    add     ebx, r14d
4254702    mov     eax, ebx
4254704    xor     eax, r14d
4254707    and     eax, r13d
4254710    xor     eax, r14d
4254713    mov     edx, eax
4254715    mov     rax, [rbp-30h]
4254719    add     rax, 2Ch
4254723    mov     eax, [rax]
4254725    add     eax, edx
4254727    add     eax, r12d
4254730    lea     r12d, [rax+265E5A51h]
4254737    ror     r12d, 12h
4254741    add     r12d, ebx
4254744    mov     eax, r12d
4254747    xor     eax, ebx
4254749    and     eax, r14d
4254752    xor     eax, ebx
4254754    mov     edx, eax
4254756    mov     rax, [rbp-30h]
4254760    mov     eax, [rax]
4254762    add     eax, edx
4254764    add     eax, r13d
4254767    lea     r13d, [rax-16493856h]
4254774    ror     r13d, 0Ch
4254778    add     r13d, r12d
4254781    mov     eax, r13d
4254784    xor     eax, r12d
4254787    and     eax, ebx
4254789    xor     eax, r12d
4254792    mov     edx, eax
4254794    mov     rax, [rbp-30h]
4254798    add     rax, 14h
4254802    mov     eax, [rax]
4254804    add     eax, edx
4254806    add     eax, r14d
4254809    lea     r14d, [rax-29D0EFA3h]
4254816    ror     r14d, 1Bh
4254820    add     r14d, r13d
4254823    mov     eax, r14d
4254826    xor     eax, r13d
4254829    and     eax, r12d
4254832    xor     eax, r13d
4254835    mov     edx, eax
4254837    mov     rax, [rbp-30h]
4254841    add     rax, 28h
4254845    mov     eax, [rax]
4254847    add     eax, edx
4254849    add     eax, ebx
4254851    lea     ebx, [rax+2441453h]
4254857    ror     ebx, 17h
4254860    add     ebx, r14d
4254863    mov     eax, ebx
4254865    xor     eax, r14d
4254868    and     eax, r13d
4254871    xor     eax, r14d
4254874    mov     edx, eax
4254876    mov     rax, [rbp-30h]
4254880    add     rax, 3Ch
4254884    mov     eax, [rax]
4254886    add     eax, edx
4254888    add     eax, r12d
4254891    lea     r12d, [rax-275E197Fh]
4254898    ror     r12d, 12h
4254902    add     r12d, ebx
4254905    mov     eax, r12d
4254908    xor     eax, ebx
4254910    and     eax, r14d
4254913    xor     eax, ebx
4254915    mov     edx, eax
4254917    mov     rax, [rbp-30h]
4254921    add     rax, 10h
4254925    mov     eax, [rax]
4254927    add     eax, edx
4254929    add     eax, r13d
4254932    lea     r13d, [rax-182C0438h]
4254939    ror     r13d, 0Ch
4254943    add     r13d, r12d
4254946    mov     eax, r13d
4254949    xor     eax, r12d
4254952    and     eax, ebx
4254954    xor     eax, r12d
4254957    mov     edx, eax
4254959    mov     rax, [rbp-30h]
4254963    add     rax, 24h
4254967    mov     eax, [rax]
4254969    add     eax, edx
4254971    add     eax, r14d
4254974    lea     r14d, [rax+21E1CDE6h]
4254981    ror     r14d, 1Bh
4254985    add     r14d, r13d
4254988    mov     eax, r14d
4254991    xor     eax, r13d
4254994    and     eax, r12d
4254997    xor     eax, r13d
4255000    mov     edx, eax
4255002    mov     rax, [rbp-30h]
4255006    add     rax, 38h
4255010    mov     eax, [rax]
4255012    add     eax, edx
4255014    add     eax, ebx
4255016    lea     ebx, [rax-3CC8F82Ah]
4255022    ror     ebx, 17h
4255025    add     ebx, r14d
4255028    mov     eax, ebx
4255030    xor     eax, r14d
4255033    and     eax, r13d
4255036    xor     eax, r14d
4255039    mov     edx, eax
4255041    mov     rax, [rbp-30h]
4255045    add     rax, 0Ch
4255049    mov     eax, [rax]
4255051    add     eax, edx
4255053    add     eax, r12d
4255056    lea     r12d, [rax-0B2AF279h]
4255063    ror     r12d, 12h
4255067    add     r12d, ebx
4255070    mov     eax, r12d
4255073    xor     eax, ebx
4255075    and     eax, r14d
4255078    xor     eax, ebx
4255080    mov     edx, eax
4255082    mov     rax, [rbp-30h]
4255086    add     rax, 20h
4255090    mov     eax, [rax]
4255092    add     eax, edx
4255094    add     eax, r13d
4255097    lea     r13d, [rax+455A14EDh]
4255104    ror     r13d, 0Ch
4255108    add     r13d, r12d
4255111    mov     eax, r13d
4255114    xor     eax, r12d
4255117    and     eax, ebx
4255119    xor     eax, r12d
4255122    mov     edx, eax
4255124    mov     rax, [rbp-30h]
4255128    add     rax, 34h
4255132    mov     eax, [rax]
4255134    add     eax, edx
4255136    add     eax, r14d
4255139    lea     r14d, [rax-561C16FBh]
4255146    ror     r14d, 1Bh
4255150    add     r14d, r13d
4255153    mov     eax, r14d
4255156    xor     eax, r13d
4255159    and     eax, r12d
4255162    xor     eax, r13d
4255165    mov     edx, eax
4255167    mov     rax, [rbp-30h]
4255171    add     rax, 8
4255175    mov     eax, [rax]
4255177    add     eax, edx
4255179    add     eax, ebx
4255181    lea     ebx, [rax-3105C08h]
4255187    ror     ebx, 17h
4255190    add     ebx, r14d
4255193    mov     eax, ebx
4255195    xor     eax, r14d
4255198    and     eax, r13d
4255201    xor     eax, r14d
4255204    mov     edx, eax
4255206    mov     rax, [rbp-30h]
4255210    add     rax, 1Ch
4255214    mov     eax, [rax]
4255216    add     eax, edx
4255218    add     eax, r12d
4255221    lea     r12d, [rax+676F02D9h]
4255228    ror     r12d, 12h
4255232    add     r12d, ebx
4255235    mov     eax, r12d
4255238    xor     eax, ebx
4255240    and     eax, r14d
4255243    xor     eax, ebx
4255245    mov     edx, eax
4255247    mov     rax, [rbp-30h]
4255251    add     rax, 30h
4255255    mov     eax, [rax]
4255257    add     eax, edx
4255259    add     eax, r13d
4255262    lea     r13d, [rax-72D5B376h]
4255269    ror     r13d, 0Ch
4255273    add     r13d, r12d
4255276    mov     eax, r13d
4255279    xor     eax, r12d
4255282    xor     eax, ebx
4255284    mov     edx, eax
4255286    mov     rax, [rbp-30h]
4255290    add     rax, 14h
4255294    mov     eax, [rax]
4255296    add     eax, edx
4255298    add     eax, r14d
4255301    lea     r14d, [rax-5C6BEh]
4255308    ror     r14d, 1Ch
4255312    add     r14d, r13d
4255315    mov     eax, r14d
4255318    xor     eax, r13d
4255321    xor     eax, r12d
4255324    mov     edx, eax
4255326    mov     rax, [rbp-30h]
4255330    add     rax, 20h
4255334    mov     eax, [rax]
4255336    add     eax, edx
4255338    add     eax, ebx
4255340    lea     ebx, [rax-788E097Fh]
4255346    ror     ebx, 15h
4255349    add     ebx, r14d
4255352    mov     eax, ebx
4255354    xor     eax, r14d
4255357    xor     eax, r13d
4255360    mov     edx, eax
4255362    mov     rax, [rbp-30h]
4255366    add     rax, 2Ch
4255370    mov     eax, [rax]
4255372    add     eax, edx
4255374    add     eax, r12d
4255377    lea     r12d, [rax+6D9D6122h]
4255384    ror     r12d, 10h
4255388    add     r12d, ebx
4255391    mov     eax, r12d
4255394    xor     eax, ebx
4255396    xor     eax, r14d
4255399    mov     edx, eax
4255401    mov     rax, [rbp-30h]
4255405    add     rax, 38h
4255409    mov     eax, [rax]
4255411    add     eax, edx
4255413    add     eax, r13d
4255416    lea     r13d, [rax-21AC7F4h]
4255423    ror     r13d, 9
4255427    add     r13d, r12d
4255430    mov     eax, r13d
4255433    xor     eax, r12d
4255436    xor     eax, ebx
4255438    mov     edx, eax
4255440    mov     rax, [rbp-30h]
4255444    add     rax, 4
4255448    mov     eax, [rax]
4255450    add     eax, edx
4255452    add     eax, r14d
4255455    lea     r14d, [rax-5B4115BCh]
4255462    ror     r14d, 1Ch
4255466    add     r14d, r13d
4255469    mov     eax, r14d
4255472    xor     eax, r13d
4255475    xor     eax, r12d
4255478    mov     edx, eax
4255480    mov     rax, [rbp-30h]
4255484    add     rax, 10h
4255488    mov     eax, [rax]
4255490    add     eax, edx
4255492    add     eax, ebx
4255494    lea     ebx, [rax+4BDECFA9h]
4255500    ror     ebx, 15h
4255503    add     ebx, r14d
4255506    mov     eax, ebx
4255508    xor     eax, r14d
4255511    xor     eax, r13d
4255514    mov     edx, eax
4255516    mov     rax, [rbp-30h]
4255520    add     rax, 1Ch
4255524    mov     eax, [rax]
4255526    add     eax, edx
4255528    add     eax, r12d
4255531    lea     r12d, [rax-944B4A0h]
4255538    ror     r12d, 10h
4255542    add     r12d, ebx
4255545    mov     eax, r12d
4255548    xor     eax, ebx
4255550    xor     eax, r14d
4255553    mov     edx, eax
4255555    mov     rax, [rbp-30h]
4255559    add     rax, 28h
4255563    mov     eax, [rax]
4255565    add     eax, edx
4255567    add     eax, r13d
4255570    lea     r13d, [rax-41404390h]
4255577    ror     r13d, 9
4255581    add     r13d, r12d
4255584    mov     eax, r13d
4255587    xor     eax, r12d
4255590    xor     eax, ebx
4255592    mov     edx, eax
4255594    mov     rax, [rbp-30h]
4255598    add     rax, 34h
4255602    mov     eax, [rax]
4255604    add     eax, edx
4255606    add     eax, r14d
4255609    lea     r14d, [rax+289B7EC6h]
4255616    ror     r14d, 1Ch
4255620    add     r14d, r13d
4255623    mov     eax, r14d
4255626    xor     eax, r13d
4255629    xor     eax, r12d
4255632    mov     edx, eax
4255634    mov     rax, [rbp-30h]
4255638    mov     eax, [rax]
4255640    add     eax, edx
4255642    add     eax, ebx
4255644    lea     ebx, [rax-155ED806h]
4255650    ror     ebx, 15h
4255653    add     ebx, r14d
4255656    mov     eax, ebx
4255658    xor     eax, r14d
4255661    xor     eax, r13d
4255664    mov     edx, eax
4255666    mov     rax, [rbp-30h]
4255670    add     rax, 0Ch
4255674    mov     eax, [rax]
4255676    add     eax, edx
4255678    add     eax, r12d
4255681    lea     r12d, [rax-2B10CF7Bh]
4255688    ror     r12d, 10h
4255692    add     r12d, ebx
4255695    mov     eax, r12d
4255698    xor     eax, ebx
4255700    xor     eax, r14d
4255703    mov     edx, eax
4255705    mov     rax, [rbp-30h]
4255709    add     rax, 18h
4255713    mov     eax, [rax]
4255715    add     eax, edx
4255717    add     eax, r13d
4255720    lea     r13d, [rax+4881D05h]
4255727    ror     r13d, 9
4255731    add     r13d, r12d
4255734    mov     eax, r13d
4255737    xor     eax, r12d
4255740    xor     eax, ebx
4255742    mov     edx, eax
4255744    mov     rax, [rbp-30h]
4255748    add     rax, 24h
4255752    mov     eax, [rax]
4255754    add     eax, edx
4255756    add     eax, r14d
4255759    lea     r14d, [rax-262B2FC7h]
4255766    ror     r14d, 1Ch
4255770    add     r14d, r13d
4255773    mov     eax, r14d
4255776    xor     eax, r13d
4255779    xor     eax, r12d
4255782    mov     edx, eax
4255784    mov     rax, [rbp-30h]
4255788    add     rax, 30h
4255792    mov     eax, [rax]
4255794    add     eax, edx
4255796    add     eax, ebx
4255798    lea     ebx, [rax-1924661Bh]
4255804    ror     ebx, 15h
4255807    add     ebx, r14d
4255810    mov     eax, ebx
4255812    xor     eax, r14d
4255815    xor     eax, r13d
4255818    mov     edx, eax
4255820    mov     rax, [rbp-30h]
4255824    add     rax, 3Ch
4255828    mov     eax, [rax]
4255830    add     eax, edx
4255832    add     eax, r12d
4255835    lea     r12d, [rax+1FA27CF8h]
4255842    ror     r12d, 10h
4255846    add     r12d, ebx
4255849    mov     eax, r12d
4255852    xor     eax, ebx
4255854    xor     eax, r14d
4255857    mov     edx, eax
4255859    mov     rax, [rbp-30h]
4255863    add     rax, 8
4255867    mov     eax, [rax]
4255869    add     eax, edx
4255871    add     eax, r13d
4255874    lea     r13d, [rax-3B53A99Bh]
4255881    ror     r13d, 9
4255885    add     r13d, r12d
4255888    mov     eax, ebx
4255890    not     eax
4255892    or      eax, r13d
4255895    xor     eax, r12d
4255898    mov     edx, eax
4255900    mov     rax, [rbp-30h]
4255904    mov     eax, [rax]
4255906    add     eax, edx
4255908    add     eax, r14d
4255911    lea     r14d, [rax-0BD6DDBCh]
4255918    ror     r14d, 1Ah
4255922    add     r14d, r13d
4255925    mov     eax, r12d
4255928    not     eax
4255930    or      eax, r14d
4255933    xor     eax, r13d
4255936    mov     edx, eax
4255938    mov     rax, [rbp-30h]
4255942    add     rax, 1Ch
4255946    mov     eax, [rax]
4255948    add     eax, edx
4255950    add     eax, ebx
4255952    lea     ebx, [rax+432AFF97h]
4255958    ror     ebx, 16h
4255961    add     ebx, r14d
4255964    mov     eax, r13d
4255967    not     eax
4255969    or      eax, ebx
4255971    xor     eax, r14d
4255974    mov     edx, eax
4255976    mov     rax, [rbp-30h]
4255980    add     rax, 38h
4255984    mov     eax, [rax]
4255986    add     eax, edx
4255988    add     eax, r12d
4255991    lea     r12d, [rax-546BDC59h]
4255998    ror     r12d, 11h
4256002    add     r12d, ebx
4256005    mov     eax, r14d
4256008    not     eax
4256010    or      eax, r12d
4256013    xor     eax, ebx
4256015    mov     edx, eax
4256017    mov     rax, [rbp-30h]
4256021    add     rax, 14h
4256025    mov     eax, [rax]
4256027    add     eax, edx
4256029    add     eax, r13d
4256032    lea     r13d, [rax-36C5FC7h]
4256039    ror     r13d, 0Bh
4256043    add     r13d, r12d
4256046    mov     eax, ebx
4256048    not     eax
4256050    or      eax, r13d
4256053    xor     eax, r12d
4256056    mov     edx, eax
4256058    mov     rax, [rbp-30h]
4256062    add     rax, 30h
4256066    mov     eax, [rax]
4256068    add     eax, edx
4256070    add     eax, r14d
4256073    lea     r14d, [rax+655B59C3h]
4256080    ror     r14d, 1Ah
4256084    add     r14d, r13d
4256087    mov     eax, r12d
4256090    not     eax
4256092    or      eax, r14d
4256095    xor     eax, r13d
4256098    mov     edx, eax
4256100    mov     rax, [rbp-30h]
4256104    add     rax, 0Ch
4256108    mov     eax, [rax]
4256110    add     eax, edx
4256112    add     eax, ebx
4256114    lea     ebx, [rax-70F3336Eh]
4256120    ror     ebx, 16h
4256123    add     ebx, r14d
4256126    mov     eax, r13d
4256129    not     eax
4256131    or      eax, ebx
4256133    xor     eax, r14d
4256136    mov     edx, eax
4256138    mov     rax, [rbp-30h]
4256142    add     rax, 28h
4256146    mov     eax, [rax]
4256148    add     eax, edx
4256150    add     eax, r12d
4256153    lea     r12d, [rax-100B83h]
4256160    ror     r12d, 11h
4256164    add     r12d, ebx
4256167    mov     eax, r14d
4256170    not     eax
4256172    or      eax, r12d
4256175    xor     eax, ebx
4256177    mov     edx, eax
4256179    mov     rax, [rbp-30h]
4256183    add     rax, 4
4256187    mov     eax, [rax]
4256189    add     eax, edx
4256191    add     eax, r13d
4256194    lea     r13d, [rax-7A7BA22Fh]
4256201    ror     r13d, 0Bh
4256205    add     r13d, r12d
4256208    mov     eax, ebx
4256210    not     eax
4256212    or      eax, r13d
4256215    xor     eax, r12d
4256218    mov     edx, eax
4256220    mov     rax, [rbp-30h]
4256224    add     rax, 20h
4256228    mov     eax, [rax]
4256230    add     eax, edx
4256232    add     eax, r14d
4256235    lea     r14d, [rax+6FA87E4Fh]
4256242    ror     r14d, 1Ah
4256246    add     r14d, r13d
4256249    mov     eax, r12d
4256252    not     eax
4256254    or      eax, r14d
4256257    xor     eax, r13d
4256260    mov     edx, eax
4256262    mov     rax, [rbp-30h]
4256266    add     rax, 3Ch
4256270    mov     eax, [rax]
4256272    add     eax, edx
4256274    add     eax, ebx
4256276    lea     ebx, [rax-1D31920h]
4256282    ror     ebx, 16h
4256285    add     ebx, r14d
4256288    mov     eax, r13d
4256291    not     eax
4256293    or      eax, ebx
4256295    xor     eax, r14d
4256298    mov     edx, eax
4256300    mov     rax, [rbp-30h]
4256304    add     rax, 18h
4256308    mov     eax, [rax]
4256310    add     eax, edx
4256312    add     eax, r12d
4256315    lea     r12d, [rax-5CFEBCECh]
4256322    ror     r12d, 11h
4256326    add     r12d, ebx
4256329    mov     eax, r14d
4256332    not     eax
4256334    or      eax, r12d
4256337    xor     eax, ebx
4256339    mov     edx, eax
4256341    mov     rax, [rbp-30h]
4256345    add     rax, 34h
4256349    mov     eax, [rax]
4256351    add     eax, edx
4256353    add     eax, r13d
4256356    lea     r13d, [rax+4E0811A1h]
4256363    ror     r13d, 0Bh
4256367    add     r13d, r12d
4256370    mov     eax, ebx
4256372    not     eax
4256374    or      eax, r13d
4256377    xor     eax, r12d
4256380    mov     edx, eax
4256382    mov     rax, [rbp-30h]
4256386    add     rax, 10h
4256390    mov     eax, [rax]
4256392    add     eax, edx
4256394    add     eax, r14d
4256397    lea     r14d, [rax-8AC817Eh]
4256404    ror     r14d, 1Ah
4256408    add     r14d, r13d
4256411    mov     eax, r12d
4256414    not     eax
4256416    or      eax, r14d
4256419    xor     eax, r13d
4256422    mov     edx, eax
4256424    mov     rax, [rbp-30h]
4256428    add     rax, 2Ch
4256432    mov     eax, [rax]
4256434    add     eax, edx
4256436    add     eax, ebx
4256438    lea     ebx, [rax-42C50DCBh]
4256444    ror     ebx, 16h
4256447    add     ebx, r14d
4256450    mov     eax, r13d
4256453    not     eax
4256455    or      eax, ebx
4256457    xor     eax, r14d
4256460    mov     edx, eax
4256462    mov     rax, [rbp-30h]
4256466    add     rax, 8
4256470    mov     eax, [rax]
4256472    add     eax, edx
4256474    add     eax, r12d
4256477    lea     r12d, [rax+2AD7D2BBh]
4256484    ror     r12d, 11h
4256488    add     r12d, ebx
4256491    mov     eax, r14d
4256494    not     eax
4256496    or      eax, r12d
4256499    xor     eax, ebx
4256501    mov     edx, eax
4256503    mov     rax, [rbp-30h]
4256507    add     rax, 24h
4256511    mov     eax, [rax]
4256513    add     eax, edx
4256515    add     eax, r13d
4256518    lea     r13d, [rax-14792C6Fh]
4256525    ror     r13d, 0Bh
4256529    add     r13d, r12d
4256532    mov     rax, [rbp-28h]
4256536    mov     eax, [rax]
4256538    lea     edx, [rax+r14]
4256542    mov     rax, [rbp-28h]
4256546    mov     [rax], edx
4256548    mov     rax, [rbp-28h]
4256552    add     rax, 4
4256556    mov     rdx, [rbp-28h]
4256560    add     rdx, 4
4256564    mov     edx, [rdx]
4256566    add     edx, r13d
4256569    mov     [rax], edx
4256571    mov     rax, [rbp-28h]
4256575    add     rax, 8
4256579    mov     rdx, [rbp-28h]
4256583    add     rdx, 8
4256587    mov     edx, [rdx]
4256589    add     edx, r12d
4256592    mov     [rax], edx
4256594    mov     rax, [rbp-28h]
4256598    add     rax, 0Ch
4256602    mov     rdx, [rbp-28h]
4256606    add     rdx, 0Ch
4256610    mov     edx, [rdx]
4256612    add     edx, ebx
4256614    mov     [rax], edx
4256616    add     rsp, 10h
4256620    pop     rbx
4256621    pop     r12
4256623    pop     r13
4256625    pop     r14
4256627    pop     rbp
4256628    retn    
USE32

section .text

global _MD5Update

_MD5Update:
4256629    push    rbp
4256630    mov     rbp, rsp
4256633    sub     rsp, 30h
4256637    call    _mcount
4256642    mov     [rbp-18h], rdi
4256646    mov     [rbp-20h], rsi
4256650    mov     [rbp-24h], edx
4256653    mov     rax, [rbp-18h]
4256657    mov     eax, [rax+10h]
4256660    mov     [rbp-0Ch], eax
4256663    mov     eax, [rbp-24h]
4256666    lea     edx, 0[rax*8]
4256673    mov     eax, [rbp-0Ch]
4256676    add     edx, eax
4256678    mov     rax, [rbp-18h]
4256682    mov     [rax+10h], edx
4256685    mov     rax, [rbp-18h]
4256689    mov     eax, [rax+10h]
4256692    cmp     eax, [rbp-0Ch]
4256695    jnb     loc_40F3CA
4256697    mov     rax, [rbp-18h]
4256701    mov     eax, [rax+14h]
4256704    lea     edx, [rax+1]
4256707    mov     rax, [rbp-18h]
4256711    mov     [rax+14h], edx
loc_40F3CA:
4256714    mov     rax, [rbp-18h]
4256718    mov     eax, [rax+14h]
4256721    mov     edx, [rbp-24h]
4256724    shr     edx, 1Dh
4256727    add     edx, eax
4256729    mov     rax, [rbp-18h]
4256733    mov     [rax+14h], edx
4256736    mov     eax, [rbp-0Ch]
4256739    shr     eax, 3
4256742    and     eax, 3Fh
4256745    mov     [rbp-0Ch], eax
4256748    cmp     dword [rbp-0Ch], 0
4256752    jz      loc_40F48B
4256758    mov     eax, [rbp-0Ch]
4256761    lea     rdx, [rax+10h]
4256765    mov     rax, [rbp-18h]
4256769    add     rax, rdx
4256772    add     rax, 8
4256776    mov     [rbp-8], rax
4256780    mov     eax, 40h
4256785    sub     eax, [rbp-0Ch]
4256788    mov     [rbp-0Ch], eax
4256791    mov     eax, [rbp-24h]
4256794    cmp     eax, [rbp-0Ch]
4256797    jnb     loc_40F43A
4256799    mov     edx, [rbp-24h]
4256802    mov     rcx, [rbp-20h]
4256806    mov     rax, [rbp-8]
4256810    mov     rsi, rcx
4256813    mov     rdi, rax
4256816    call    _memcpy
4256821    jmp     locret_40F4FE
loc_40F43A:
4256826    mov     edx, [rbp-0Ch]
4256829    mov     rcx, [rbp-20h]
4256833    mov     rax, [rbp-8]
4256837    mov     rsi, rcx
4256840    mov     rdi, rax
4256843    call    _memcpy
4256848    mov     rax, [rbp-18h]
4256852    add     rax, 18h
4256856    mov     esi, 10h
4256861    mov     rdi, rax
4256864    call    _byteReverse
4256869    mov     rax, [rbp-18h]
4256873    lea     rdx, [rax+18h]
4256877    mov     rax, [rbp-18h]
4256881    mov     rsi, rdx
4256884    mov     rdi, rax
4256887    call    _MD5Transform
4256892    mov     eax, [rbp-0Ch]
4256895    add     [rbp-20h], rax
4256899    mov     eax, [rbp-0Ch]
4256902    sub     [rbp-24h], eax
4256905    jmp     loc_40F4DE
loc_40F48B:
4256907    jmp     loc_40F4DE
loc_40F48D:
4256909    mov     rax, [rbp-18h]
4256913    lea     rcx, [rax+18h]
4256917    mov     rax, [rbp-20h]
4256921    mov     edx, 40h
4256926    mov     rsi, rax
4256929    mov     rdi, rcx
4256932    call    _memcpy
4256937    mov     rax, [rbp-18h]
4256941    add     rax, 18h
4256945    mov     esi, 10h
4256950    mov     rdi, rax
4256953    call    _byteReverse
4256958    mov     rax, [rbp-18h]
4256962    lea     rdx, [rax+18h]
4256966    mov     rax, [rbp-18h]
4256970    mov     rsi, rdx
4256973    mov     rdi, rax
4256976    call    _MD5Transform
4256981    add     qword [rbp-20h], 40h
4256986    sub     dword [rbp-24h], 40h
loc_40F4DE:
4256990    cmp     dword [rbp-24h], 3Fh
4256994    ja      loc_40F48D
4256996    mov     edx, [rbp-24h]
4256999    mov     rax, [rbp-18h]
4257003    lea     rcx, [rax+18h]
4257007    mov     rax, [rbp-20h]
4257011    mov     rsi, rax
4257014    mov     rdi, rcx
4257017    call    _memcpy
locret_40F4FE:
4257022    leave   
4257023    retn    
USE32

section .text

global _MD5Final

_MD5Final:
4257024    push    rbp
4257025    mov     rbp, rsp
4257028    sub     rsp, 30h
4257032    call    _mcount
4257037    mov     [rbp-28h], rdi
4257041    mov     [rbp-30h], rsi
4257045    mov     rax, [rbp-30h]
4257049    mov     eax, [rax+10h]
4257052    shr     eax, 3
4257055    and     eax, 3Fh
4257058    mov     [rbp-14h], eax
4257061    mov     eax, [rbp-14h]
4257064    lea     rdx, [rax+10h]
4257068    mov     rax, [rbp-30h]
4257072    add     rax, rdx
4257075    add     rax, 8
4257079    mov     [rbp-10h], rax
4257083    mov     rax, [rbp-10h]
4257087    lea     rdx, [rax+1]
4257091    mov     [rbp-10h], rdx
4257095    mov     byte [rax], 80h
4257098    mov     eax, 3Fh
4257103    sub     eax, [rbp-14h]
4257106    mov     [rbp-14h], eax
4257109    cmp     dword [rbp-14h], 7
4257113    ja      loc_40F5B7
4257115    mov     edx, [rbp-14h]
4257118    mov     rax, [rbp-10h]
4257122    mov     esi, 0
4257127    mov     rdi, rax
4257130    call    _memset
4257135    mov     rax, [rbp-30h]
4257139    add     rax, 18h
4257143    mov     esi, 10h
4257148    mov     rdi, rax
4257151    call    _byteReverse
4257156    mov     rax, [rbp-30h]
4257160    lea     rdx, [rax+18h]
4257164    mov     rax, [rbp-30h]
4257168    mov     rsi, rdx
4257171    mov     rdi, rax
4257174    call    _MD5Transform
4257179    mov     rax, [rbp-30h]
4257183    add     rax, 18h
4257187    mov     edx, 38h
4257192    mov     esi, 0
4257197    mov     rdi, rax
4257200    call    _memset
4257205    jmp     loc_40F5D0
loc_40F5B7:
4257207    mov     eax, [rbp-14h]
4257210    sub     eax, 8
4257213    mov     edx, eax
4257215    mov     rax, [rbp-10h]
4257219    mov     esi, 0
4257224    mov     rdi, rax
4257227    call    _memset
loc_40F5D0:
4257232    mov     rax, [rbp-30h]
4257236    add     rax, 18h
4257240    mov     esi, 0Eh
4257245    mov     rdi, rax
4257248    call    _byteReverse
4257253    mov     rax, [rbp-30h]
4257257    add     rax, 18h
4257261    mov     [rbp-8], rax
4257265    mov     rax, [rbp-8]
4257269    lea     rdx, [rax+38h]
4257273    mov     rax, [rbp-30h]
4257277    mov     eax, [rax+10h]
4257280    mov     [rdx], eax
4257282    mov     rax, [rbp-8]
4257286    lea     rdx, [rax+3Ch]
4257290    mov     rax, [rbp-30h]
4257294    mov     eax, [rax+14h]
4257297    mov     [rdx], eax
4257299    mov     rax, [rbp-30h]
4257303    lea     rdx, [rax+18h]
4257307    mov     rax, [rbp-30h]
4257311    mov     rsi, rdx
4257314    mov     rdi, rax
4257317    call    _MD5Transform
4257322    mov     rax, [rbp-30h]
4257326    mov     esi, 4
4257331    mov     rdi, rax
4257334    call    _byteReverse
4257339    mov     rcx, [rbp-30h]
4257343    mov     rax, [rbp-28h]
4257347    mov     edx, 10h
4257352    mov     rsi, rcx
4257355    mov     rdi, rax
4257358    call    _memcpy
4257363    mov     rax, [rbp-30h]
4257367    mov     edx, 58h
4257372    mov     esi, 0
4257377    mov     rdi, rax
4257380    call    _memset
4257385    leave   
4257386    retn    
USE32

section .text

global _bin2str

_bin2str:
4257387    push    rbp
4257388    mov     rbp, rsp
4257391    sub     rsp, 18h
4257395    call    _mcount
4257400    mov     [rbp-8], rdi
4257404    mov     [rbp-10h], rsi
4257408    mov     [rbp-18h], rdx
4257412    jmp     loc_40F6DB
loc_40F686:
4257414    mov     rax, [rbp-8]
4257418    lea     rdx, [rax+1]
4257422    mov     [rbp-8], rdx
4257426    mov     rcx, [cs:hex_6978]
4257433    mov     rdx, [rbp-10h]
4257437    movzx   edx, byte [rdx]
4257440    shr     dl, 4
4257443    movzx   edx, dl
4257446    add     rdx, rcx
4257449    movzx   edx, byte [rdx]
4257452    mov     [rax], dl
4257454    mov     rax, [rbp-8]
4257458    lea     rdx, [rax+1]
4257462    mov     [rbp-8], rdx
4257466    mov     rcx, [cs:hex_6978]
4257473    mov     rdx, [rbp-10h]
4257477    movzx   edx, byte [rdx]
4257480    movzx   edx, dl
4257483    and     edx, 0Fh
4257486    add     rdx, rcx
4257489    movzx   edx, byte [rdx]
4257492    mov     [rax], dl
4257494    add     qword [rbp-10h], 1
loc_40F6DB:
4257499    mov     rax, [rbp-18h]
4257503    lea     rdx, [rax-1]
4257507    mov     [rbp-18h], rdx
4257511    test    rax, rax
4257514    jnz     loc_40F686
4257516    mov     rax, [rbp-8]
4257520    mov     byte [rax], 0
4257523    leave   
4257524    retn    
USE32

section .text

global _mg_md5

_mg_md5:
4257525    push    rbp
4257526    mov     rbp, rsp
4257529    push    rbx
4257530    sub     rsp, 158h
4257537    call    _mcount
4257542    mov     [rbp-0B8h], rsi
4257549    mov     [rbp-0B0h], rdx
4257556    mov     [rbp-0A8h], rcx
4257563    mov     [rbp-0A0h], r8
4257570    mov     [rbp-98h], r9
4257577    test    al, al
4257579    jz      loc_40F750
4257581    movaps  xmmword [rbp-90h], xmm0
4257588    movaps  xmmword [rbp-80h], xmm1
4257592    movaps  xmmword [rbp-70h], xmm2
4257596    movaps  xmmword [rbp-60h], xmm3
4257600    movaps  xmmword [rbp-50h], xmm4
4257604    movaps  xmmword [rbp-40h], xmm5
4257608    movaps  xmmword [rbp-30h], xmm6
4257612    movaps  xmmword [rbp-20h], xmm7
loc_40F750:
4257616    mov     [rbp-158h], rdi
4257623    mov     rax, [fs:28h]
4257632    mov     [rbp-0C8h], rax
4257639    xor     eax, eax
4257641    lea     rax, [rbp-120h]
4257648    mov     rdi, rax
4257651    call    _MD5Init
4257656    mov     dword [rbp-148h], 8
4257666    mov     dword [rbp-144h], 30h
4257676    lea     rax, [rbp+10h]
4257680    mov     [rbp-140h], rax
4257687    lea     rax, [rbp-0C0h]
4257694    mov     [rbp-138h], rax
4257701    jmp     loc_40F7D1
loc_40F7A7:
4257703    mov     rax, [rbp-150h]
4257710    mov     rdi, rax
4257713    call    _strlen
4257718    mov     edx, eax
4257720    mov     rcx, [rbp-150h]
4257727    lea     rax, [rbp-120h]
4257734    mov     rsi, rcx
4257737    mov     rdi, rax
4257740    call    _MD5Update
loc_40F7D1:
4257745    mov     eax, [rbp-148h]
4257751    cmp     eax, 30h
4257754    jnb     loc_40F7FF
4257756    mov     rdx, [rbp-138h]
4257763    mov     eax, [rbp-148h]
4257769    mov     eax, eax
4257771    add     rax, rdx
4257774    mov     edx, [rbp-148h]
4257780    add     edx, 8
4257783    mov     [rbp-148h], edx
4257789    jmp     loc_40F814
loc_40F7FF:
4257791    mov     rdx, [rbp-140h]
4257798    mov     rax, rdx
4257801    add     rdx, 8
4257805    mov     [rbp-140h], rdx
loc_40F814:
4257812    mov     rax, [rax]
4257815    mov     [rbp-150h], rax
4257822    cmp     qword [rbp-150h], 0
4257830    jnz     loc_40F7A7
4257836    lea     rdx, [rbp-120h]
4257843    lea     rax, [rbp-130h]
4257850    mov     rsi, rdx
4257853    mov     rdi, rax
4257856    call    _MD5Final
4257861    lea     rcx, [rbp-130h]
4257868    mov     rax, [rbp-158h]
4257875    mov     edx, 10h
4257880    mov     rsi, rcx
4257883    mov     rdi, rax
4257886    call    _bin2str
4257891    mov     rax, [rbp-158h]
4257898    mov     rbx, [rbp-0C8h]
4257905    xor     rbx, [fs:28h]
4257914    jz      loc_40F881
4257916    call    ___stack_chk_fail
loc_40F881:
4257921    add     rsp, 158h
4257928    pop     rbx
4257929    pop     rbp
4257930    retn    
USE32

section .text

global _check_password

_check_password:
4257931    push    rbp
4257932    mov     rbp, rsp
4257935    push    rbx
4257936    sub     rsp, 0E8h
4257943    call    _mcount
4257948    mov     [rbp-78h], rdi
4257952    mov     [rbp-80h], rsi
4257956    mov     [rbp-88h], rdx
4257963    mov     [rbp-90h], rcx
4257970    mov     [rbp-98h], r8
4257977    mov     [rbp-0A0h], r9
4257984    mov     rax, [rbp+10h]
4257988    mov     [rbp-0A8h], rax
4257995    mov     rax, [rbp+18h]
4257999    mov     [rbp-0B0h], rax
4258006    mov     rax, [fs:28h]
4258015    mov     [rbp-18h], rax
4258019    xor     eax, eax
4258021    mov     rdx, [rbp-88h]
4258028    mov     rsi, [rbp-78h]
4258032    lea     rax, [rbp-70h]
4258036    mov     r8d, 0
4258042    mov     rcx, rdx
4258045    mov     edx, asc_414194
4258050    mov     rdi, rax
4258053    mov     eax, 0
4258058    call    _mg_md5
4258063    mov     rdi, [rbp-98h]
4258070    mov     rdx, [rbp-90h]
4258077    mov     rsi, [rbp-80h]
4258081    lea     rax, [rbp-40h]
4258085    mov     qword [rsp+30h], 0
4258094    lea     rcx, [rbp-70h]
4258098    mov     [rsp+28h], rcx
4258103    mov     qword [rsp+20h], asc_414194
4258112    mov     rcx, [rbp-0A8h]
4258119    mov     [rsp+18h], rcx
4258124    mov     qword [rsp+10h], asc_414194
4258133    mov     rcx, [rbp-0A0h]
4258140    mov     [rsp+8], rcx
4258145    mov     qword [rsp], asc_414194
4258153    mov     r9, rdi
4258156    mov     r8d, asc_414194
4258162    mov     rcx, rdx
4258165    mov     edx, asc_414194
4258170    mov     rdi, rax
4258173    mov     eax, 0
4258178    call    _mg_md5
4258183    lea     rdx, [rbp-40h]
4258187    mov     rax, [rbp-0B0h]
4258194    mov     rsi, rdx
4258197    mov     rdi, rax
4258200    call    _mg_strcasecmp
4258205    test    eax, eax
4258207    setz    al
4258210    movzx   eax, al
4258213    mov     rbx, [rbp-18h]
4258217    xor     rbx, [fs:28h]
4258226    jz      loc_40F9B9
4258228    call    ___stack_chk_fail
loc_40F9B9:
4258233    add     rsp, 0E8h
4258240    pop     rbx
4258241    pop     rbp
4258242    retn    
USE32

section .text

global _mg_authorize_digest

_mg_authorize_digest:
4258243    push    rbp
4258244    mov     rbp, rsp
4258247    push    rbx
4258248    sub     rsp, 46E8h
4258255    call    _mcount
4258260    mov     [rbp-46D8h], rdi
4258267    mov     [rbp-46E0h], rsi
4258274    mov     rax, [fs:28h]
4258283    mov     [rbp-18h], rax
4258287    xor     eax, eax
4258289    mov     rax, [rbp-46D8h]
4258296    sub     rax, 8
4258300    mov     [rbp-46D0h], rax
4258307    cmp     qword [rbp-46D8h], 0
4258315    jz      loc_40FA17
4258317    cmp     qword [rbp-46E0h], 0
4258325    jnz     loc_40FA21
loc_40FA17:
4258327    mov     eax, 0
4258332    jmp     loc_40FCAA
loc_40FA21:
4258337    mov     rax, [rbp-46D8h]
4258344    mov     esi, aAuthorization
4258349    mov     rdi, rax
4258352    call    _mg_get_header
4258357    mov     [rbp-46C8h], rax
4258364    cmp     qword [rbp-46C8h], 0
4258372    jz      loc_40FA63
4258374    mov     rax, [rbp-46C8h]
4258381    mov     edx, 7
4258386    mov     esi, aDigest
4258391    mov     rdi, rax
4258394    call    _mg_strncasecmp
4258399    test    eax, eax
4258401    jz      loc_40FA6D
loc_40FA63:
4258403    mov     eax, 0
4258408    jmp     loc_40FCAA
loc_40FA6D:
4258413    lea     rdx, [rbp-46C0h]
4258420    mov     rax, [rbp-46C8h]
4258427    mov     ecx, 64h
4258432    mov     esi, aUsername
4258437    mov     rdi, rax
4258440    call    _mg_parse_header
4258445    test    eax, eax
4258447    jnz     loc_40FA9B
4258449    mov     eax, 0
4258454    jmp     loc_40FCAA
loc_40FA9B:
4258459    lea     rdx, [rbp-45E0h]
4258466    mov     rax, [rbp-46C8h]
4258473    mov     ecx, 64h
4258478    mov     esi, aCnonce
4258483    mov     rdi, rax
4258486    call    _mg_parse_header
4258491    test    eax, eax
4258493    jnz     loc_40FAC9
4258495    mov     eax, 0
4258500    jmp     loc_40FCAA
loc_40FAC9:
4258505    lea     rdx, [rbp-4570h]
4258512    mov     rax, [rbp-46C8h]
4258519    mov     ecx, 64h
4258524    mov     esi, aResponse
4258529    mov     rdi, rax
4258532    call    _mg_parse_header
4258537    test    eax, eax
4258539    jnz     loc_40FAF7
4258541    mov     eax, 0
4258546    jmp     loc_40FCAA
loc_40FAF7:
4258551    lea     rdx, [rbp-4020h]
4258558    mov     rax, [rbp-46C8h]
4258565    mov     ecx, 4000h
4258570    mov     esi, aUri
4258575    mov     rdi, rax
4258578    call    _mg_parse_header
4258583    test    eax, eax
4258585    jnz     loc_40FB25
4258587    mov     eax, 0
4258592    jmp     loc_40FCAA
loc_40FB25:
4258597    lea     rdx, [rbp-4500h]
4258604    mov     rax, [rbp-46C8h]
4258611    mov     ecx, 64h
4258616    mov     esi, aQop
4258621    mov     rdi, rax
4258624    call    _mg_parse_header
4258629    test    eax, eax
4258631    jnz     loc_40FB53
4258633    mov     eax, 0
4258638    jmp     loc_40FCAA
loc_40FB53:
4258643    lea     rdx, [rbp-4490h]
4258650    mov     rax, [rbp-46C8h]
4258657    mov     ecx, 64h
4258662    mov     esi, aNc
4258667    mov     rdi, rax
4258670    call    _mg_parse_header
4258675    test    eax, eax
4258677    jnz     loc_40FB81
4258679    mov     eax, 0
4258684    jmp     loc_40FCAA
loc_40FB81:
4258689    lea     rdx, [rbp-4650h]
4258696    mov     rax, [rbp-46C8h]
4258703    mov     ecx, 64h
4258708    mov     esi, aNonce
4258713    mov     rdi, rax
4258716    call    _mg_parse_header
4258721    test    eax, eax
4258723    jnz     loc_40FBAF
4258725    mov     eax, 0
4258730    jmp     loc_40FCAA
loc_40FBAF:
4258735    jmp     loc_40FC81
loc_40FBB4:
4258740    lea     rsi, [rbp-4220h]
4258747    lea     rcx, [rbp-4120h]
4258754    lea     rdx, [rbp-4320h]
4258761    lea     rax, [rbp-4420h]
4258768    mov     r8, rsi
4258771    mov     esi, aS_5
4258776    mov     rdi, rax
4258779    mov     eax, 0
4258784    call    ___isoc99_sscanf
4258789    cmp     eax, 3
4258792    jnz     loc_40FC81
4258798    lea     rdx, [rbp-4320h]
4258805    lea     rax, [rbp-46C0h]
4258812    mov     rsi, rdx
4258815    mov     rdi, rax
4258818    call    _strcmp
4258823    test    eax, eax
4258825    jnz     loc_40FC81
4258827    mov     rax, [rbp-46D0h]
4258834    mov     rax, [rax+2A8h]
4258841    mov     rax, [rax+48h]
4258845    lea     rdx, [rbp-4120h]
4258852    mov     rsi, rdx
4258855    mov     rdi, rax
4258858    call    _strcmp
4258863    test    eax, eax
4258865    jnz     loc_40FC81
4258867    mov     rax, [rbp-46D8h]
4258874    mov     rax, [rax]
4258877    lea     r9, [rbp-45E0h]
4258884    lea     r8, [rbp-4490h]
4258891    lea     rcx, [rbp-4650h]
4258898    lea     rdx, [rbp-4020h]
4258905    lea     rsi, [rbp-4220h]
4258912    lea     rdi, [rbp-4570h]
4258919    mov     [rsp+8], rdi
4258924    lea     rdi, [rbp-4500h]
4258931    mov     [rsp], rdi
4258935    mov     rdi, rax
4258938    call    _check_password
4258943    jmp     loc_40FCAA
loc_40FC81:
4258945    mov     rdx, [rbp-46E0h]
4258952    lea     rax, [rbp-4420h]
4258959    mov     esi, 100h
4258964    mov     rdi, rax
4258967    call    _fgets
4258972    test    rax, rax
4258975    jnz     loc_40FBB4
4258981    mov     eax, 0
loc_40FCAA:
4258986    mov     rbx, [rbp-18h]
4258990    xor     rbx, [fs:28h]
4258999    jz      loc_40FCBE
4259001    call    ___stack_chk_fail
loc_40FCBE:
4259006    add     rsp, 46E8h
4259013    pop     rbx
4259014    pop     rbp
4259015    retn    
USE32

section .text

global _is_authorized

_is_authorized:
4259016    push    rbp
4259017    mov     rbp, rsp
4259020    sub     rsp, 30h
4259024    call    _mcount
4259029    mov     [rbp-18h], rdi
4259033    mov     [rbp-20h], rsi
4259037    mov     [rbp-24h], edx
4259040    mov     dword [rbp-0Ch], 1
4259047    mov     edx, [rbp-24h]
4259050    mov     rcx, [rbp-20h]
4259054    mov     rax, [rbp-18h]
4259058    mov     rsi, rcx
4259061    mov     rdi, rax
4259064    call    _open_auth_file
4259069    mov     [rbp-8], rax
4259073    cmp     qword [rbp-8], 0
4259078    jz      loc_40FD2E
4259080    mov     rax, [rbp-18h]
4259084    lea     rdx, [rax+8]
4259088    mov     rax, [rbp-8]
4259092    mov     rsi, rax
4259095    mov     rdi, rdx
4259098    call    _mg_authorize_digest
4259103    mov     [rbp-0Ch], eax
4259106    mov     rax, [rbp-8]
4259110    mov     rdi, rax
4259113    call    _fclose
loc_40FD2E:
4259118    mov     eax, [rbp-0Ch]
4259121    leave   
4259122    retn    
USE32

section .text

global _is_authorized_for_dav

_is_authorized_for_dav:
4259123    push    rbp
4259124    mov     rbp, rsp
4259127    sub     rsp, 30h
4259131    call    _mcount
4259136    mov     [rbp-28h], rdi
4259140    mov     rax, [rbp-28h]
4259144    mov     rax, [rax+2A8h]
4259151    mov     rax, [rax+60h]
4259155    mov     [rbp-18h], rax
4259159    mov     rax, [rbp-28h]
4259163    mov     rax, [rax+8]
4259167    mov     [rbp-10h], rax
4259171    mov     dword [rbp-1Ch], 0
4259178    cmp     qword [rbp-10h], 0
4259183    jz      loc_40FD96
4259185    mov     rax, [rbp-10h]
4259189    mov     esi, aPropfind
4259194    mov     rdi, rax
4259197    call    _strcmp
4259202    test    eax, eax
4259204    jnz     loc_40FD96
4259206    cmp     qword [rbp-18h], 0
4259211    jnz     loc_40FD96
4259213    mov     dword [rbp-1Ch], 1
4259220    jmp     loc_40FDDF
loc_40FD96:
4259222    cmp     qword [rbp-18h], 0
4259227    jz      loc_40FDDF
4259229    mov     rax, [rbp-18h]
4259233    mov     esi, aR_0
4259238    mov     rdi, rax
4259241    call    _fopen64
4259246    mov     [rbp-8], rax
4259250    cmp     qword [rbp-8], 0
4259255    jz      loc_40FDDF
4259257    mov     rax, [rbp-28h]
4259261    lea     rdx, [rax+8]
4259265    mov     rax, [rbp-8]
4259269    mov     rsi, rax
4259272    mov     rdi, rdx
4259275    call    _mg_authorize_digest
4259280    mov     [rbp-1Ch], eax
4259283    mov     rax, [rbp-8]
4259287    mov     rdi, rax
4259290    call    _fclose
loc_40FDDF:
4259295    mov     eax, [rbp-1Ch]
4259298    leave   
4259299    retn    
USE32

section .text

global _parse_header

_parse_header:
4259300    push    rbp
4259301    mov     rbp, rsp
4259304    sub     rsp, 60h
4259308    call    _mcount
4259313    mov     [rbp-38h], rdi
4259317    mov     [rbp-40h], rsi
4259321    mov     [rbp-48h], rdx
4259325    mov     [rbp-50h], rcx
4259329    mov     [rbp-58h], r8
4259333    mov     dword [rbp-2Ch], 20h
4259340    mov     dword [rbp-28h], 2Ch
4259347    mov     dword [rbp-24h], 0
4259354    mov     rax, [rbp-48h]
4259358    mov     rdi, rax
4259361    call    _strlen
4259366    mov     [rbp-10h], rax
4259370    mov     rax, [rbp-40h]
4259374    mov     rdx, [rbp-38h]
4259378    add     rax, rdx
4259381    mov     [rbp-8], rax
4259385    mov     qword [rbp-18h], 0
4259393    cmp     qword [rbp-50h], 0
4259398    jz      loc_40FE56
4259400    cmp     qword [rbp-58h], 0
4259405    jz      loc_40FE56
4259407    mov     rax, [rbp-50h]
4259411    mov     byte [rax], 0
loc_40FE56:
4259414    mov     rax, [rbp-38h]
4259418    mov     [rbp-18h], rax
4259422    jmp     loc_40FEC4
loc_40FE60:
4259424    mov     rax, [rbp-18h]
4259428    cmp     rax, [rbp-38h]
4259432    jz      loc_40FE90
4259434    mov     rax, [rbp-18h]
4259438    sub     rax, 1
4259442    movzx   eax, byte [rax]
4259445    movsx   eax, al
4259448    cmp     eax, [rbp-2Ch]
4259451    jz      loc_40FE90
4259453    mov     rax, [rbp-18h]
4259457    sub     rax, 1
4259461    movzx   eax, byte [rax]
4259464    movsx   eax, al
4259467    cmp     eax, [rbp-28h]
4259470    jnz     loc_40FEBF
loc_40FE90:
4259472    mov     rax, [rbp-10h]
4259476    mov     rdx, [rbp-18h]
4259480    add     rax, rdx
4259483    movzx   eax, byte [rax]
4259486    cmp     al, 3Dh
4259488    jnz     loc_40FEBF
4259490    mov     rdx, [rbp-10h]
4259494    mov     rcx, [rbp-48h]
4259498    mov     rax, [rbp-18h]
4259502    mov     rsi, rcx
4259505    mov     rdi, rax
4259508    call    _memcmp
4259513    test    eax, eax
4259515    jnz     loc_40FEBF
4259517    jmp     loc_40FEDC
loc_40FEBF:
4259519    add     qword [rbp-18h], 1
loc_40FEC4:
4259524    cmp     qword [rbp-18h], 0
4259529    jz      loc_40FEDC
4259531    mov     rax, [rbp-10h]
4259535    mov     rdx, [rbp-18h]
4259539    add     rax, rdx
4259542    cmp     rax, [rbp-8]
4259546    jb      loc_40FE60
loc_40FEDC:
4259548    cmp     qword [rbp-18h], 0
4259553    jz      loc_410045
4259559    mov     rax, [rbp-10h]
4259563    lea     rdx, [rax+1]
4259567    mov     rax, [rbp-18h]
4259571    add     rax, rdx
4259574    cmp     rax, [rbp-8]
4259578    jnb     loc_410045
4259584    mov     rax, [rbp-10h]
4259588    add     rax, 1
4259592    add     [rbp-18h], rax
4259596    mov     rax, [rbp-18h]
4259600    movzx   eax, byte [rax]
4259603    cmp     al, 22h
4259605    jz      loc_40FF22
4259607    mov     rax, [rbp-18h]
4259611    movzx   eax, byte [rax]
4259614    cmp     al, 27h
4259616    jnz     loc_40FF3D
loc_40FF22:
4259618    mov     rax, [rbp-18h]
4259622    lea     rdx, [rax+1]
4259626    mov     [rbp-18h], rdx
4259630    movzx   eax, byte [rax]
4259633    movsx   eax, al
4259636    mov     [rbp-28h], eax
4259639    mov     eax, [rbp-28h]
4259642    mov     [rbp-2Ch], eax
loc_40FF3D:
4259645    mov     rax, [rbp-18h]
4259649    mov     [rbp-20h], rax
4259653    jmp     loc_40FF97
loc_40FF47:
4259655    mov     eax, [rbp-2Ch]
4259658    cmp     eax, [rbp-28h]
4259661    jnz     loc_40FF72
4259663    mov     rax, [rbp-20h]
4259667    movzx   eax, byte [rax]
4259670    cmp     al, 5Ch
4259672    jnz     loc_40FF72
4259674    mov     rax, [rbp-20h]
4259678    add     rax, 1
4259682    movzx   eax, byte [rax]
4259685    movsx   eax, al
4259688    cmp     eax, [rbp-2Ch]
4259691    jnz     loc_40FF72
4259693    add     qword [rbp-20h], 1
loc_40FF72:
4259698    mov     eax, [rbp-24h]
4259701    lea     edx, [rax+1]
4259704    mov     [rbp-24h], edx
4259707    movsxd  rdx, eax
4259710    mov     rax, [rbp-50h]
4259714    lea     rcx, [rdx+rax]
4259718    mov     rax, [rbp-20h]
4259722    lea     rdx, [rax+1]
4259726    mov     [rbp-20h], rdx
4259730    movzx   eax, byte [rax]
4259733    mov     [rcx], al
loc_40FF97:
4259735    mov     rax, [rbp-20h]
4259739    cmp     rax, [rbp-8]
4259743    jnb     loc_40FFCC
4259745    mov     rax, [rbp-20h]
4259749    movzx   eax, byte [rax]
4259752    movsx   eax, al
4259755    cmp     eax, [rbp-2Ch]
4259758    jz      loc_40FFCC
4259760    mov     rax, [rbp-20h]
4259764    movzx   eax, byte [rax]
4259767    movsx   eax, al
4259770    cmp     eax, [rbp-28h]
4259773    jz      loc_40FFCC
4259775    mov     rax, [rbp-58h]
4259779    cmp     eax, [rbp-24h]
4259782    jg      loc_40FF47
loc_40FFCC:
4259788    mov     rax, [rbp-58h]
4259792    cmp     eax, [rbp-24h]
4259795    jle     loc_40FFEA
4259797    cmp     dword [rbp-2Ch], 20h
4259801    jz      loc_40FFF3
4259803    mov     rax, [rbp-20h]
4259807    movzx   eax, byte [rax]
4259810    movsx   eax, al
4259813    cmp     eax, [rbp-2Ch]
4259816    jz      loc_40FFF3
loc_40FFEA:
4259818    mov     dword [rbp-24h], 0
4259825    jmp     loc_410045
loc_40FFF3:
4259827    cmp     dword [rbp-24h], 0
4259831    jle     loc_410014
4259833    mov     eax, [rbp-24h]
4259836    cdqe    
4259838    lea     rdx, [rax-1]
4259842    mov     rax, [rbp-18h]
4259846    add     rax, rdx
4259849    movzx   eax, byte [rax]
4259852    cmp     al, 2Ch
4259854    jnz     loc_410014
4259856    sub     dword [rbp-24h], 1
loc_410014:
4259860    cmp     dword [rbp-24h], 0
4259864    jle     loc_410035
4259866    mov     eax, [rbp-24h]
4259869    cdqe    
4259871    lea     rdx, [rax-1]
4259875    mov     rax, [rbp-18h]
4259879    add     rax, rdx
4259882    movzx   eax, byte [rax]
4259885    cmp     al, 3Bh
4259887    jnz     loc_410035
4259889    sub     dword [rbp-24h], 1
loc_410035:
4259893    mov     eax, [rbp-24h]
4259896    movsxd  rdx, eax
4259899    mov     rax, [rbp-50h]
4259903    add     rax, rdx
4259906    mov     byte [rax], 0
loc_410045:
4259909    mov     eax, [rbp-24h]
4259912    leave   
4259913    retn    
USE32

section .text

global _mg_parse_header

_mg_parse_header:
4259914    push    rbp
4259915    mov     rbp, rsp
4259918    sub     rsp, 20h
4259922    call    _mcount
4259927    mov     [rbp-8], rdi
4259931    mov     [rbp-10h], rsi
4259935    mov     [rbp-18h], rdx
4259939    mov     [rbp-20h], rcx
4259943    cmp     qword [rbp-8], 0
4259948    jz      loc_41007C
4259950    mov     rax, [rbp-8]
4259954    mov     rdi, rax
4259957    call    _strlen
4259962    jmp     loc_410081
loc_41007C:
4259964    mov     eax, 0
loc_410081:
4259969    mov     rsi, [rbp-20h]
4259973    mov     rcx, [rbp-18h]
4259977    mov     rdx, [rbp-10h]
4259981    mov     rdi, [rbp-8]
4259985    mov     r8, rsi
4259988    mov     rsi, rax
4259991    call    _parse_header
4259996    leave   
4259997    retn    
USE32

section .text

global _send_file_data

_send_file_data:
4259998    push    rbp
4259999    mov     rbp, rsp
4260002    sub     rsp, 2030h
4260009    call    _mcount
4260014    mov     [rbp-2028h], rdi
4260021    mov     [rbp-2030h], rsi
4260028    mov     rax, [fs:28h]
4260037    mov     [rbp-8], rax
4260041    xor     eax, eax
4260043    jmp     loc_4100ED
loc_4100CD:
4260045    mov     rdx, [rbp-2018h]
4260052    lea     rcx, [rbp-2010h]
4260059    mov     rax, [rbp-2028h]
4260066    mov     rsi, rcx
4260069    mov     rdi, rax
4260072    call    _mg_write
loc_4100ED:
4260077    mov     rdx, [rbp-2030h]
4260084    lea     rax, [rbp-2010h]
4260091    mov     rcx, rdx
4260094    mov     edx, 2000h
4260099    mov     esi, 1
4260104    mov     rdi, rax
4260107    call    _fread
4260112    mov     [rbp-2018h], rax
4260119    cmp     qword [rbp-2018h], 0
4260127    jnz     loc_4100CD
4260129    mov     rax, [rbp-8]
4260133    xor     rax, [fs:28h]
4260142    jz      locret_410135
4260144    call    ___stack_chk_fail
locret_410135:
4260149    leave   
4260150    retn    
USE32

section .text

global _do_ssi_include

_do_ssi_include:
4260151    push    rbp
4260152    mov     rbp, rsp
4260155    push    rbx
4260156    sub     rsp, 4058h
4260163    call    _mcount
4260168    mov     [rbp-4048h], rdi
4260175    mov     [rbp-4050h], rsi
4260182    mov     [rbp-4058h], rdx
4260189    mov     [rbp-405Ch], ecx
4260195    mov     rax, [fs:28h]
4260204    mov     [rbp-18h], rax
4260208    xor     eax, eax
4260210    mov     rax, [rbp-4048h]
4260217    sub     rax, 8
4260221    mov     rax, [rax+2A8h]
4260228    add     rax, 38h
4260232    mov     [rbp-4038h], rax
4260239    lea     rdx, [rbp-4020h]
4260246    mov     rax, [rbp-4058h]
4260253    mov     esi, aVirtual
4260258    mov     rdi, rax
4260261    mov     eax, 0
4260266    call    ___isoc99_sscanf
4260271    cmp     eax, 1
4260274    jnz     loc_4101F8
4260276    mov     rax, [rbp-4038h]
4260283    add     rax, 38h
4260287    mov     rdx, [rax]
4260290    lea     rcx, [rbp-4020h]
4260297    lea     rax, [rbp-2020h]
4260304    mov     r9, rcx
4260307    mov     r8d, 2Fh
4260313    mov     rcx, rdx
4260316    mov     edx, aSCS
4260321    mov     esi, 2000h
4260326    mov     rdi, rax
4260329    mov     eax, 0
4260334    call    _mg_snprintf
4260339    jmp     loc_41036A
loc_4101F8:
4260344    lea     rdx, [rbp-4020h]
4260351    mov     rax, [rbp-4058h]
4260358    mov     esi, aAbspath
4260363    mov     rdi, rax
4260366    mov     eax, 0
4260371    call    ___isoc99_sscanf
4260376    cmp     eax, 1
4260379    jnz     loc_41024A
4260381    lea     rdx, [rbp-4020h]
4260388    lea     rax, [rbp-2020h]
4260395    mov     rcx, rdx
4260398    mov     edx, aS_2
4260403    mov     esi, 2000h
4260408    mov     rdi, rax
4260411    mov     eax, 0
4260416    call    _mg_snprintf
4260421    jmp     loc_41036A
loc_41024A:
4260426    lea     rdx, [rbp-4020h]
4260433    mov     rax, [rbp-4058h]
4260440    mov     esi, aFile
4260445    mov     rdi, rax
4260448    mov     eax, 0
4260453    call    ___isoc99_sscanf
4260458    cmp     eax, 1
4260461    jz      loc_410298
4260463    lea     rdx, [rbp-4020h]
4260470    mov     rax, [rbp-4058h]
4260477    mov     esi, asc_4167B0
4260482    mov     rdi, rax
4260485    mov     eax, 0
4260490    call    ___isoc99_sscanf
4260495    cmp     eax, 1
4260498    jnz     loc_410345
loc_410298:
4260504    mov     rdx, [rbp-4050h]
4260511    lea     rax, [rbp-2020h]
4260518    mov     rcx, rdx
4260521    mov     edx, aS_2
4260526    mov     esi, 2000h
4260531    mov     rdi, rax
4260534    mov     eax, 0
4260539    call    _mg_snprintf
4260544    lea     rax, [rbp-2020h]
4260551    mov     esi, 2Fh
4260556    mov     rdi, rax
4260559    call    _strrchr
4260564    mov     [rbp-4030h], rax
4260571    cmp     qword [rbp-4030h], 0
4260579    jz      loc_4102F3
4260581    mov     rax, [rbp-4030h]
4260588    add     rax, 1
4260592    mov     byte [rax], 0
loc_4102F3:
4260595    lea     rax, [rbp-2020h]
4260602    mov     rdi, rax
4260605    call    _strlen
4260610    mov     edx, 2000h
4260615    mov     rbx, rdx
4260618    sub     rbx, rax
4260621    lea     rax, [rbp-2020h]
4260628    mov     rdi, rax
4260631    call    _strlen
4260636    lea     rdx, [rbp-2020h]
4260643    lea     rdi, [rdx+rax]
4260647    lea     rax, [rbp-4020h]
4260654    mov     rcx, rax
4260657    mov     edx, aS_2
4260662    mov     rsi, rbx
4260665    mov     eax, 0
4260670    call    _mg_snprintf
4260675    jmp     loc_41036A
loc_410345:
4260677    mov     rdx, [rbp-4058h]
4260684    mov     rax, [rbp-4048h]
4260691    mov     esi, aBadSsiIncludeS
4260696    mov     rdi, rax
4260699    mov     eax, 0
4260704    call    _mg_printf
4260709    jmp     loc_410476
loc_41036A:
4260714    lea     rax, [rbp-2020h]
4260721    mov     esi, aRb
4260726    mov     rdi, rax
4260729    call    _fopen64
4260734    mov     [rbp-4028h], rax
4260741    cmp     qword [rbp-4028h], 0
4260749    jnz     loc_4103CF
4260751    call    ___errno_location
4260756    mov     eax, [rax]
4260758    mov     edi, eax
4260760    call    _strerror
4260765    mov     rsi, rax
4260768    lea     rcx, [rbp-2020h]
4260775    mov     rdx, [rbp-4058h]
4260782    mov     rax, [rbp-4048h]
4260789    mov     r8, rsi
4260792    mov     esi, aCannotOpenSsiI
4260797    mov     rdi, rax
4260800    mov     eax, 0
4260805    call    _mg_printf
4260810    jmp     loc_410476
loc_4103CF:
4260815    mov     rax, [rbp-4028h]
4260822    mov     rdi, rax
4260825    call    _fileno
4260830    mov     edi, eax
4260832    call    _ns_set_close_on_exec
4260837    mov     rax, [rbp-4038h]
4260844    add     rax, 88h
4260850    mov     rax, [rax]
4260853    mov     rdi, rax
4260856    call    _strlen
4260861    mov     rcx, rax
4260864    mov     rax, [rbp-4038h]
4260871    add     rax, 88h
4260877    mov     rax, [rax]
4260880    lea     rdx, [rbp-2020h]
4260887    mov     rsi, rcx
4260890    mov     rdi, rax
4260893    call    _mg_match_prefix
4260898    test    eax, eax
4260900    jle     loc_41044E
4260902    mov     eax, [rbp-405Ch]
4260908    lea     ecx, [rax+1]
4260911    mov     rdx, [rbp-4028h]
4260918    lea     rsi, [rbp-2020h]
4260925    mov     rax, [rbp-4048h]
4260932    mov     rdi, rax
4260935    call    _send_ssi_file
4260940    jmp     loc_410467
loc_41044E:
4260942    mov     rdx, [rbp-4028h]
4260949    mov     rax, [rbp-4048h]
4260956    mov     rsi, rdx
4260959    mov     rdi, rax
4260962    call    _send_file_data
loc_410467:
4260967    mov     rax, [rbp-4028h]
4260974    mov     rdi, rax
4260977    call    _fclose
loc_410476:
4260982    mov     rax, [rbp-18h]
4260986    xor     rax, [fs:28h]
4260995    jz      loc_41048A
4260997    call    ___stack_chk_fail
loc_41048A:
4261002    add     rsp, 4058h
4261009    pop     rbx
4261010    pop     rbp
4261011    retn    
USE32

section .text

global _do_ssi_exec

_do_ssi_exec:
4261012    push    rbp
4261013    mov     rbp, rsp
4261016    sub     rsp, 2030h
4261023    call    _mcount
4261028    mov     [rbp-2028h], rdi
4261035    mov     [rbp-2030h], rsi
4261042    mov     rax, [fs:28h]
4261051    mov     [rbp-8], rax
4261055    xor     eax, eax
4261057    lea     rdx, [rbp-2010h]
4261064    mov     rax, [rbp-2030h]
4261071    mov     esi, asc_4167B0
4261076    mov     rdi, rax
4261079    mov     eax, 0
4261084    call    ___isoc99_sscanf
4261089    cmp     eax, 1
4261092    jz      loc_41050B
4261094    mov     rdx, [rbp-2030h]
4261101    mov     rax, [rbp-2028h]
4261108    mov     esi, aBadSsiExecS
4261113    mov     rdi, rax
4261116    mov     eax, 0
4261121    call    _mg_printf
4261126    jmp     loc_41058B
loc_41050B:
4261131    lea     rax, [rbp-2010h]
4261138    mov     esi, aR_0
4261143    mov     rdi, rax
4261146    call    _popen
4261151    mov     [rbp-2018h], rax
4261158    cmp     qword [rbp-2018h], 0
4261166    jnz     loc_410563
4261168    call    ___errno_location
4261173    mov     eax, [rax]
4261175    mov     edi, eax
4261177    call    _strerror
4261182    mov     rcx, rax
4261185    lea     rdx, [rbp-2010h]
4261192    mov     rax, [rbp-2028h]
4261199    mov     esi, aCannotSsiExecS
4261204    mov     rdi, rax
4261207    mov     eax, 0
4261212    call    _mg_printf
4261217    jmp     loc_41058B
loc_410563:
4261219    mov     rdx, [rbp-2018h]
4261226    mov     rax, [rbp-2028h]
4261233    mov     rsi, rdx
4261236    mov     rdi, rax
4261239    call    _send_file_data
4261244    mov     rax, [rbp-2018h]
4261251    mov     rdi, rax
4261254    call    _pclose
loc_41058B:
4261259    mov     rax, [rbp-8]
4261263    xor     rax, [fs:28h]
4261272    jz      locret_41059F
4261274    call    ___stack_chk_fail
locret_41059F:
4261279    leave   
4261280    retn    
USE32

section .text

global _send_ssi_file

_send_ssi_file:
4261281    push    rbp
4261282    mov     rbp, rsp
4261285    sub     rsp, 2040h
4261292    call    _mcount
4261297    mov     [rbp-2028h], rdi
4261304    mov     [rbp-2030h], rsi
4261311    mov     [rbp-2038h], rdx
4261318    mov     [rbp-203Ch], ecx
4261324    mov     rax, [fs:28h]
4261333    mov     [rbp-8], rax
4261337    xor     eax, eax
4261339    cmp     dword [rbp-203Ch], 0Ah
4261346    jle     loc_410609
4261348    mov     rdx, [rbp-2030h]
4261355    mov     rax, [rbp-2028h]
4261362    mov     esi, aSsiIncludeLeve
4261367    mov     rdi, rax
4261370    mov     eax, 0
4261375    call    _mg_printf
4261380    jmp     loc_41095C
loc_410609:
4261385    mov     dword [rbp-2018h], 0
4261395    mov     eax, [rbp-2018h]
4261401    mov     [rbp-2020h], eax
4261407    mov     eax, [rbp-2020h]
4261413    mov     [rbp-201Ch], eax
4261419    jmp     loc_41090F
loc_410630:
4261424    cmp     dword [rbp-201Ch], 0
4261431    jz      loc_4107B9
4261437    cmp     dword [rbp-2014h], 3Eh
4261444    jnz     loc_4107B9
4261450    mov     dword [rbp-201Ch], 0
4261460    mov     eax, [rbp-2020h]
4261466    lea     edx, [rax+1]
4261469    mov     [rbp-2020h], edx
4261475    mov     edx, [rbp-2014h]
4261481    cdqe    
4261483    mov     [rbp+rax-2010h], dl
4261490    mov     eax, [rbp-2020h]
4261496    cdqe    
4261498    mov     byte [rbp+rax-2010h], 0
4261506    cmp     dword [rbp-2020h], 2000h
4261516    jle     loc_4106A7
4261518    mov     ecx, __PRETTY_FUNCTION___7106
4261523    mov     edx, 10EBh
4261528    mov     esi, file
4261533    mov     edi, aLenIntSizeofBu
4261538    call    ___assert_fail
loc_4106A7:
4261543    cmp     dword [rbp-2020h], 5
4261550    jle     loc_4106CD
4261552    lea     rax, [rbp-2010h]
4261559    mov     edx, 5
4261564    mov     esi, asc_416875
4261569    mov     rdi, rax
4261572    call    _memcmp
4261577    test    eax, eax
4261579    jz      loc_4106F4
loc_4106CD:
4261581    mov     eax, [rbp-2020h]
4261587    movsxd  rdx, eax
4261590    lea     rcx, [rbp-2010h]
4261597    mov     rax, [rbp-2028h]
4261604    mov     rsi, rcx
4261607    mov     rdi, rax
4261610    call    _mg_write
4261615    jmp     loc_4107AA
loc_4106F4:
4261620    lea     rax, [rbp-2010h]
4261627    add     rax, 5
4261631    mov     edx, 7
4261636    mov     esi, aInclude
4261641    mov     rdi, rax
4261644    call    _memcmp
4261649    test    eax, eax
4261651    jnz     loc_410743
4261653    mov     edx, [rbp-203Ch]
4261659    lea     rax, [rbp-2010h]
4261666    lea     rdi, [rax+0Ch]
4261670    mov     rsi, [rbp-2030h]
4261677    mov     rax, [rbp-2028h]
4261684    mov     ecx, edx
4261686    mov     rdx, rdi
4261689    mov     rdi, rax
4261692    call    _do_ssi_include
4261697    jmp     loc_4107AA
loc_410743:
4261699    lea     rax, [rbp-2010h]
4261706    add     rax, 5
4261710    mov     edx, 4
4261715    mov     esi, aExec
4261720    mov     rdi, rax
4261723    call    _memcmp
4261728    test    eax, eax
4261730    jnz     loc_410783
4261732    lea     rax, [rbp-2010h]
4261739    lea     rdx, [rax+9]
4261743    mov     rax, [rbp-2028h]
4261750    mov     rsi, rdx
4261753    mov     rdi, rax
4261756    call    _do_ssi_exec
4261761    jmp     loc_4107AA
loc_410783:
4261763    lea     rcx, [rbp-2010h]
4261770    mov     rdx, [rbp-2030h]
4261777    mov     rax, [rbp-2028h]
4261784    mov     esi, aSUnknownSsiCom
4261789    mov     rdi, rax
4261792    mov     eax, 0
4261797    call    _mg_printf
loc_4107AA:
4261802    mov     dword [rbp-2020h], 0
4261812    jmp     loc_41090F
loc_4107B9:
4261817    cmp     dword [rbp-201Ch], 0
4261824    jz      loc_410851
4261830    cmp     dword [rbp-2020h], 5
4261837    jnz     loc_4107F8
4261839    lea     rax, [rbp-2010h]
4261846    mov     edx, 5
4261851    mov     esi, asc_416875
4261856    mov     rdi, rax
4261859    call    _memcmp
4261864    test    eax, eax
4261866    jz      loc_4107F8
4261868    mov     dword [rbp-201Ch], 0
4261878    jmp     loc_41082E
loc_4107F8:
4261880    cmp     dword [rbp-2020h], 1FFEh
4261890    jnz     loc_41082E
4261892    mov     rdx, [rbp-2030h]
4261899    mov     rax, [rbp-2028h]
4261906    mov     esi, aSSsiTagIsTooLa
4261911    mov     rdi, rax
4261914    mov     eax, 0
4261919    call    _mg_printf
4261924    mov     dword [rbp-2020h], 0
loc_41082E:
4261934    mov     eax, [rbp-2020h]
4261940    lea     edx, [rax+1]
4261943    mov     [rbp-2020h], edx
4261949    mov     edx, [rbp-2014h]
4261955    cdqe    
4261957    mov     [rbp+rax-2010h], dl
4261964    jmp     loc_41090F
loc_410851:
4261969    cmp     dword [rbp-2014h], 3Ch
4261976    jnz     loc_4108B9
4261978    mov     dword [rbp-201Ch], 1
4261988    cmp     dword [rbp-2020h], 0
4261995    jle     loc_41088F
4261997    mov     eax, [rbp-2020h]
4262003    movsxd  rdx, eax
4262006    lea     rcx, [rbp-2010h]
4262013    mov     rax, [rbp-2028h]
4262020    mov     rsi, rcx
4262023    mov     rdi, rax
4262026    call    _mg_write
loc_41088F:
4262031    mov     dword [rbp-2020h], 0
4262041    mov     eax, [rbp-2020h]
4262047    lea     edx, [rax+1]
4262050    mov     [rbp-2020h], edx
4262056    mov     edx, [rbp-2014h]
4262062    cdqe    
4262064    mov     [rbp+rax-2010h], dl
4262071    jmp     loc_41090F
loc_4108B9:
4262073    mov     eax, [rbp-2020h]
4262079    lea     edx, [rax+1]
4262082    mov     [rbp-2020h], edx
4262088    mov     edx, [rbp-2014h]
4262094    cdqe    
4262096    mov     [rbp+rax-2010h], dl
4262103    cmp     dword [rbp-2020h], 2000h
4262113    jnz     loc_41090F
4262115    mov     eax, [rbp-2020h]
4262121    movsxd  rdx, eax
4262124    lea     rcx, [rbp-2010h]
4262131    mov     rax, [rbp-2028h]
4262138    mov     rsi, rcx
4262141    mov     rdi, rax
4262144    call    _mg_write
4262149    mov     dword [rbp-2020h], 0
loc_41090F:
4262159    mov     rax, [rbp-2038h]
4262166    mov     rdi, rax
4262169    call    _fgetc
4262174    mov     [rbp-2014h], eax
4262180    cmp     dword [rbp-2014h], 0FFFFFFFFh
4262187    jnz     loc_410630
4262193    cmp     dword [rbp-2020h], 0
4262200    jle     loc_41095C
4262202    mov     eax, [rbp-2020h]
4262208    movsxd  rdx, eax
4262211    lea     rcx, [rbp-2010h]
4262218    mov     rax, [rbp-2028h]
4262225    mov     rsi, rcx
4262228    mov     rdi, rax
4262231    call    _mg_write
loc_41095C:
4262236    mov     rax, [rbp-8]
4262240    xor     rax, [fs:28h]
4262249    jz      locret_410970
4262251    call    ___stack_chk_fail
locret_410970:
4262256    leave   
4262257    retn    
USE32

section .text

global _handle_ssi_request

_handle_ssi_request:
4262258    push    rbp
4262259    mov     rbp, rsp
4262262    sub     rsp, 30h
4262266    call    _mcount
4262271    mov     [rbp-28h], rdi
4262275    mov     [rbp-30h], rsi
4262279    mov     rax, [rbp-30h]
4262283    mov     esi, aRb
4262288    mov     rdi, rax
4262291    call    _fopen64
4262296    mov     [rbp-18h], rax
4262300    cmp     qword [rbp-18h], 0
4262305    jnz     loc_4109DE
4262307    call    ___errno_location
4262312    mov     eax, [rax]
4262314    mov     edi, eax
4262316    call    _strerror
4262321    mov     rcx, rax
4262324    mov     rdx, [rbp-30h]
4262328    mov     rax, [rbp-28h]
4262332    mov     r8, rcx
4262335    mov     rcx, rdx
4262338    mov     edx, aFopenSS
4262343    mov     esi, 1F4h
4262348    mov     rdi, rax
4262351    mov     eax, 0
4262356    call    _send_http_error
4262361    jmp     locret_410A84
loc_4109DE:
4262366    mov     rax, [rbp-18h]
4262370    mov     rdi, rax
4262373    call    _fileno
4262378    mov     edi, eax
4262380    call    _ns_set_close_on_exec
4262385    mov     rax, [rbp-28h]
4262389    mov     rax, [rax+2A8h]
4262396    lea     rdx, [rbp-10h]
4262400    mov     rcx, [rbp-30h]
4262404    mov     rsi, rcx
4262407    mov     rdi, rax
4262410    call    _get_mime_type
4262415    mov     rax, [rbp-28h]
4262419    mov     dword [rax+284h], 0C8h
4262429    mov     rcx, [rbp-10h]
4262433    mov     rax, [rbp-8]
4262437    mov     edx, eax
4262439    mov     rax, [rbp-28h]
4262443    mov     eax, [rax+284h]
4262449    mov     rsi, [rbp-28h]
4262453    lea     rdi, [rsi+8]
4262457    mov     r8, rcx
4262460    mov     ecx, edx
4262462    mov     edx, eax
4262464    mov     esi, aHttp1_1DOkCo_0
4262469    mov     eax, 0
4262474    call    _mg_printf
4262479    mov     rax, [rbp-28h]
4262483    lea     rdi, [rax+8]
4262487    mov     rdx, [rbp-18h]
4262491    mov     rax, [rbp-30h]
4262495    mov     ecx, 0
4262500    mov     rsi, rax
4262503    call    _send_ssi_file
4262508    mov     rax, [rbp-18h]
4262512    mov     rdi, rax
4262515    call    _fclose
4262520    mov     rax, [rbp-28h]
4262524    mov     rdi, rax
4262527    call    _close_local_endpoint
locret_410A84:
4262532    leave   
4262533    retn    
USE32

section .text

global _proxy_request

_proxy_request:
4262534    push    rbp
4262535    mov     rbp, rsp
4262538    sub     rsp, 30h
4262542    call    _mcount
4262547    mov     [rbp-18h], rdi
4262551    mov     [rbp-20h], rsi
4262555    mov     dword [rbp-4], 0
4262562    mov     rax, [rbp-20h]
4262566    mov     r8, [rax+10h]
4262570    mov     rax, [rbp-20h]
4262574    mov     rax, [rax+18h]
4262578    test    rax, rax
4262581    jz      loc_410AC1
4262583    mov     rax, [rbp-20h]
4262587    mov     rdx, [rax+18h]
4262591    jmp     loc_410AC6
loc_410AC1:
4262593    mov     edx, unk_414196
loc_410AC6:
4262598    mov     rax, [rbp-20h]
4262602    mov     rax, [rax+18h]
4262606    test    rax, rax
4262609    jz      loc_410ADA
4262611    mov     eax, a?
4262616    jmp     loc_410ADF
loc_410ADA:
4262618    mov     eax, unk_414196
loc_410ADF:
4262623    mov     rcx, [rbp-20h]
4262627    mov     rcx, [rcx+8]
4262631    mov     rsi, [rbp-20h]
4262635    mov     rsi, [rsi]
4262638    mov     rdi, [rbp-18h]
4262642    mov     [rsp], r8
4262646    mov     r9, rdx
4262649    mov     r8, rax
4262652    mov     rdx, rsi
4262655    mov     esi, aSSSSHttpS
4262660    mov     eax, 0
4262665    call    _ns_printf
4262670    mov     dword [rbp-8], 0
4262677    jmp     loc_410BC2
loc_410B1A:
4262682    mov     rax, [rbp-20h]
4262686    mov     edx, [rbp-8]
4262689    movsxd  rdx, edx
4262692    add     rdx, 8
4262696    shl     rdx, 4
4262700    add     rax, rdx
4262703    add     rax, 8
4262707    mov     rax, [rax]
4262710    mov     esi, aConnection
4262715    mov     rdi, rax
4262718    call    _mg_strcasecmp
4262723    test    eax, eax
4262725    jnz     loc_410B70
4262727    mov     rax, [rbp-18h]
4262731    mov     ecx, aClose
4262736    mov     edx, aConnection
4262741    mov     esi, aSS_1
4262746    mov     rdi, rax
4262749    mov     eax, 0
4262754    call    _ns_printf
4262759    mov     dword [rbp-4], 1
4262766    jmp     loc_410BBE
loc_410B70:
4262768    mov     rax, [rbp-20h]
4262772    mov     edx, [rbp-8]
4262775    movsxd  rdx, edx
4262778    add     rdx, 8
4262782    shl     rdx, 4
4262786    add     rax, rdx
4262789    add     rax, 10h
4262793    mov     rcx, [rax]
4262796    mov     rax, [rbp-20h]
4262800    mov     edx, [rbp-8]
4262803    movsxd  rdx, edx
4262806    add     rdx, 8
4262810    shl     rdx, 4
4262814    add     rax, rdx
4262817    add     rax, 8
4262821    mov     rdx, [rax]
4262824    mov     rax, [rbp-18h]
4262828    mov     esi, aSS_1
4262833    mov     rdi, rax
4262836    mov     eax, 0
4262841    call    _ns_printf
loc_410BBE:
4262846    add     dword [rbp-8], 1
loc_410BC2:
4262850    mov     rax, [rbp-20h]
4262854    mov     eax, [rax+84h]
4262860    cmp     eax, [rbp-8]
4262863    jg      loc_410B1A
4262869    cmp     dword [rbp-4], 0
4262873    jnz     loc_410BFB
4262875    mov     rax, [rbp-18h]
4262879    mov     ecx, aClose
4262884    mov     edx, aConnection
4262889    mov     esi, aSS_1
4262894    mov     rdi, rax
4262897    mov     eax, 0
4262902    call    _ns_printf
loc_410BFB:
4262907    mov     rax, [rbp-18h]
4262911    mov     edx, unk_414B63
4262916    mov     esi, aS_2
4262921    mov     rdi, rax
4262924    mov     eax, 0
4262929    call    _ns_printf
4262934    mov     rax, [rbp-20h]
4262938    mov     rdx, [rax+270h]
4262945    mov     rax, [rbp-20h]
4262949    mov     rcx, [rax+268h]
4262956    mov     rax, [rbp-18h]
4262960    mov     rsi, rcx
4262963    mov     rdi, rax
4262966    call    _ns_send
4262971    leave   
4262972    retn    
USE32

section .text

global _mg_forward

_mg_forward:
4262973    push    rbp
4262974    mov     rbp, rsp
4262977    sub     rsp, 20h
4262981    call    _mcount
4262986    mov     [rbp-18h], rdi
4262990    mov     [rbp-20h], rsi
4262994    mov     rax, [rbp-18h]
4262998    sub     rax, 8
4263002    mov     [rbp-10h], rax
4263006    mov     rax, [rbp-10h]
4263010    mov     rax, [rax+2A8h]
4263017    mov     rdx, [rbp-10h]
4263021    mov     rsi, [rbp-20h]
4263025    mov     rcx, rdx
4263028    mov     edx, mg_ev_handler
4263033    mov     rdi, rax
4263036    call    _ns_connect
4263041    mov     [rbp-8], rax
4263045    cmp     qword [rbp-8], 0
4263050    jnz     loc_410CB3
4263052    mov     rax, [rbp-10h]
4263056    mov     rax, [rax]
4263059    mov     rdx, [rbp-10h]
4263063    mov     rdx, [rdx]
4263066    mov     edx, [rdx+98h]
4263072    or      edx, 10h
4263075    mov     [rax+98h], edx
4263081    mov     eax, 0
4263086    jmp     locret_410DA5
loc_410CB3:
4263091    mov     rax, [rbp-8]
4263095    mov     eax, [rax+98h]
4263101    or      eax, 800000h
4263106    mov     edx, eax
4263108    mov     rax, [rbp-8]
4263112    mov     [rax+98h], edx
4263118    mov     rax, [rbp-10h]
4263122    mov     dword [rax+2B8h], 6
4263132    mov     rax, [rbp-10h]
4263136    mov     rdx, [rbp-8]
4263140    mov     [rax+2B0h], rdx
4263147    mov     rax, [rbp-18h]
4263151    mov     rax, [rax]
4263154    mov     esi, aConnect
4263159    mov     rdi, rax
4263162    call    _strcmp
4263167    test    eax, eax
4263169    jnz     loc_410D25
4263171    mov     rax, [rbp-10h]
4263175    mov     rax, [rax]
4263178    mov     eax, [rax+20h]
4263181    mov     ecx, 0
4263186    mov     edx, 13h
4263191    mov     esi, ok_7129
4263196    mov     edi, eax
4263198    call    _send
4263203    jmp     loc_410DA0
loc_410D25:
4263205    mov     rax, [rbp-18h]
4263209    mov     rax, [rax+8]
4263213    mov     edx, 7
4263218    mov     esi, aHttp_0
4263223    mov     rdi, rax
4263226    call    _memcmp
4263231    test    eax, eax
4263233    jnz     loc_410D59
4263235    mov     rax, [rbp-18h]
4263239    mov     rax, [rax+8]
4263243    lea     rdx, [rax+7]
4263247    mov     rax, [rbp-18h]
4263251    mov     [rax+8], rdx
4263255    jmp     loc_410D6F
loc_410D59:
4263257    jmp     loc_410D6F
loc_410D5B:
4263259    mov     rax, [rbp-18h]
4263263    mov     rax, [rax+8]
4263267    lea     rdx, [rax+1]
4263271    mov     rax, [rbp-18h]
4263275    mov     [rax+8], rdx
loc_410D6F:
4263279    mov     rax, [rbp-18h]
4263283    mov     rax, [rax+8]
4263287    movzx   eax, byte [rax]
4263290    test    al, al
4263292    jz      loc_410D8D
4263294    mov     rax, [rbp-18h]
4263298    mov     rax, [rax+8]
4263302    movzx   eax, byte [rax]
4263305    cmp     al, 2Fh
4263307    jnz     loc_410D5B
loc_410D8D:
4263309    mov     rdx, [rbp-18h]
4263313    mov     rax, [rbp-8]
4263317    mov     rsi, rdx
4263320    mov     rdi, rax
4263323    call    _proxy_request
loc_410DA0:
4263328    mov     eax, 1
locret_410DA5:
4263333    leave   
4263334    retn    
USE32

section .text

global _proxify_connection

_proxify_connection:
4263335    push    rbp
4263336    mov     rbp, rsp
4263339    sub     rsp, 830h
4263346    call    _mcount
4263351    mov     [rbp-828h], rdi
4263358    mov     rax, [fs:28h]
4263367    mov     [rbp-8], rax
4263371    xor     eax, eax
4263373    mov     word [rbp-816h], 50h
4263382    mov     rax, [rbp-828h]
4263389    add     rax, 8
4263393    mov     [rbp-810h], rax
4263400    mov     dword [rbp-814h], 0
4263410    mov     rax, [rbp-810h]
4263417    mov     rax, [rax+8]
4263421    mov     [rbp-808h], rax
4263428    mov     byte [rbp-5F0h], 0
4263435    movzx   eax, byte [rbp-5F0h]
4263442    mov     [rbp-7F0h], al
4263448    movzx   eax, byte [rbp-7F0h]
4263455    mov     [rbp-800h], al
4263461    lea     rsi, [rbp-814h]
4263468    lea     rcx, [rbp-816h]
4263475    lea     rdx, [rbp-7F0h]
4263482    mov     rax, [rbp-808h]
4263489    mov     r8, rsi
4263492    mov     esi, a499HuN
4263497    mov     rdi, rax
4263500    mov     eax, 0
4263505    call    ___isoc99_sscanf
4263510    cmp     eax, 2
4263513    jz      loc_410EDF
4263519    lea     rdi, [rbp-814h]
4263526    lea     rsi, [rbp-816h]
4263533    lea     rcx, [rbp-7F0h]
4263540    lea     rdx, [rbp-800h]
4263547    mov     rax, [rbp-808h]
4263554    mov     r9, rdi
4263557    mov     r8, rsi
4263560    mov     esi, a9AZ499HuN
4263565    mov     rdi, rax
4263568    mov     eax, 0
4263573    call    ___isoc99_sscanf
4263578    cmp     eax, 3
4263581    jz      loc_410EDF
4263583    lea     rsi, [rbp-814h]
4263590    lea     rcx, [rbp-7F0h]
4263597    lea     rdx, [rbp-800h]
4263604    mov     rax, [rbp-808h]
4263611    mov     r8, rsi
4263614    mov     esi, a9AZ499N
4263619    mov     rdi, rax
4263622    mov     eax, 0
4263627    call    ___isoc99_sscanf
4263632    cmp     eax, 2
4263635    jz      loc_410EDF
4263637    mov     dword [rbp-814h], 0
loc_410EDF:
4263647    movzx   eax, word [rbp-816h]
4263654    movzx   ecx, ax
4263657    mov     rax, [rbp-828h]
4263664    mov     rax, [rax]
4263667    mov     rax, [rax+68h]
4263671    test    rax, rax
4263674    jz      loc_410F03
4263676    mov     eax, aSsl_0
4263681    jmp     loc_410F08
loc_410F03:
4263683    mov     eax, aTcp_0
loc_410F08:
4263688    lea     rdx, [rbp-7F0h]
4263695    lea     rdi, [rbp-3F0h]
4263702    mov     r9d, ecx
4263705    mov     r8, rdx
4263708    mov     rcx, rax
4263711    mov     edx, aSSHu
4263716    mov     esi, 3E8h
4263721    mov     eax, 0
4263726    call    _snprintf
4263731    mov     eax, [rbp-814h]
4263737    test    eax, eax
4263739    jle     loc_410F5A
4263741    lea     rdx, [rbp-3F0h]
4263748    mov     rax, [rbp-810h]
4263755    mov     rsi, rdx
4263758    mov     rdi, rax
4263761    call    _mg_forward
4263766    test    eax, eax
4263768    jnz     loc_410F7D
loc_410F5A:
4263770    mov     rax, [rbp-828h]
4263777    mov     rax, [rax]
4263780    mov     rdx, [rbp-828h]
4263787    mov     rdx, [rdx]
4263790    mov     edx, [rdx+98h]
4263796    or      edx, 10h
4263799    mov     [rax+98h], edx
loc_410F7D:
4263805    mov     rax, [rbp-8]
4263809    xor     rax, [fs:28h]
4263818    jz      locret_410F91
4263820    call    ___stack_chk_fail
locret_410F91:
4263825    leave   
4263826    retn    
USE32

section .text

global _mg_send_file_internal

_mg_send_file_internal:
4263827    push    rbp
4263828    mov     rbp, rsp
4263831    push    rbx
4263832    sub     rsp, 2068h
4263839    call    _mcount
4263844    mov     [rbp-2048h], rdi
4263851    mov     [rbp-2050h], rsi
4263858    mov     [rbp-2058h], rdx
4263865    mov     [rbp-205Ch], ecx
4263871    mov     [rbp-2068h], r8
4263878    mov     rax, [fs:28h]
4263887    mov     [rbp-18h], rax
4263891    xor     eax, eax
4263893    mov     rax, [rbp-2048h]
4263900    sub     rax, 8
4263904    mov     [rbp-2038h], rax
4263911    mov     rax, [rbp-2058h]
4263918    mov     eax, [rax+18h]
4263921    and     eax, 0F000h
4263926    cmp     eax, 4000h
4263931    setz    al
4263934    movzx   eax, al
4263937    mov     [rbp-203Ch], eax
4263943    mov     rax, [rbp-2038h]
4263950    mov     rax, [rax+2A8h]
4263957    mov     rax, [rax+58h]
4263961    mov     [rbp-2030h], rax
4263968    mov     rax, [rbp-2038h]
4263975    mov     rax, [rax+2A8h]
4263982    mov     rax, [rax+78h]
4263986    mov     [rbp-2028h], rax
4263993    mov     rdx, [rbp-2050h]
4264000    lea     rax, [rbp-2020h]
4264007    mov     rcx, rdx
4264010    mov     edx, aS_2
4264015    mov     esi, 2000h
4264020    mov     rdi, rax
4264023    mov     eax, 0
4264028    call    _mg_snprintf
4264033    cmp     dword [rbp-205Ch], 0
4264040    jz      loc_411087
4264042    lea     rdx, [rbp-2020h]
4264049    mov     rax, [rbp-2038h]
4264056    mov     rsi, rdx
4264059    mov     rdi, rax
4264062    call    _must_hide_file
4264067    test    eax, eax
4264069    jz      loc_4110AA
loc_411087:
4264071    mov     rax, [rbp-2038h]
4264078    mov     edx, 0
4264083    mov     esi, 194h
4264088    mov     rdi, rax
4264091    mov     eax, 0
4264096    call    _send_http_error
4264101    jmp     loc_411335
loc_4110AA:
4264106    cmp     dword [rbp-203Ch], 0
4264113    jz      loc_41112F
4264115    mov     rax, [rbp-2038h]
4264122    mov     rbx, [rax+10h]
4264126    mov     rax, [rbp-2038h]
4264133    mov     rax, [rax+10h]
4264137    mov     rdi, rax
4264140    call    _strlen
4264145    sub     rax, 1
4264149    add     rax, rbx
4264152    movzx   eax, byte [rax]
4264155    cmp     al, 2Fh
4264157    jz      loc_41112F
4264159    mov     rax, [rbp-2038h]
4264166    mov     dword [rax+284h], 12Dh
4264176    mov     rax, [rbp-2038h]
4264183    mov     rax, [rax+10h]
4264187    mov     rdx, [rbp-2038h]
4264194    lea     rcx, [rdx+8]
4264198    mov     rdx, rax
4264201    mov     esi, aHttp1_1301Move
4264206    mov     rdi, rcx
4264209    mov     eax, 0
4264214    call    _mg_printf
4264219    mov     rax, [rbp-2038h]
4264226    mov     rdi, rax
4264229    call    _close_local_endpoint
4264234    jmp     loc_411335
loc_41112F:
4264239    cmp     dword [rbp-203Ch], 0
4264246    jz      loc_4111BE
4264252    mov     rdx, [rbp-2058h]
4264259    lea     rsi, [rbp-2020h]
4264266    mov     rax, [rbp-2038h]
4264273    mov     rcx, rdx
4264276    mov     edx, 2000h
4264281    mov     rdi, rax
4264284    call    _find_index_file
4264289    test    eax, eax
4264291    jnz     loc_4111BE
4264293    mov     rax, [rbp-2028h]
4264300    mov     esi, aYes
4264305    mov     rdi, rax
4264308    call    _mg_strcasecmp
4264313    test    eax, eax
4264315    jnz     loc_41119B
4264317    lea     rdx, [rbp-2020h]
4264324    mov     rax, [rbp-2038h]
4264331    mov     rsi, rdx
4264334    mov     rdi, rax
4264337    call    _send_directory_listing
4264342    jmp     loc_411335
loc_41119B:
4264347    mov     rax, [rbp-2038h]
4264354    mov     edx, 0
4264359    mov     esi, 193h
4264364    mov     rdi, rax
4264367    mov     eax, 0
4264372    call    _send_http_error
4264377    jmp     loc_411335
loc_4111BE:
4264382    mov     rax, [rbp-2030h]
4264389    mov     rdi, rax
4264392    call    _strlen
4264397    mov     rcx, rax
4264400    lea     rdx, [rbp-2020h]
4264407    mov     rax, [rbp-2030h]
4264414    mov     rsi, rcx
4264417    mov     rdi, rax
4264420    call    _mg_match_prefix
4264425    test    eax, eax
4264427    jle     loc_41120B
4264429    lea     rdx, [rbp-2020h]
4264436    mov     rax, [rbp-2038h]
4264443    mov     rsi, rdx
4264446    mov     rdi, rax
4264449    call    _open_cgi_endpoint
4264454    jmp     loc_411335
loc_41120B:
4264459    mov     rax, [rbp-2038h]
4264466    mov     rax, [rax+2A8h]
4264473    mov     rax, [rax+0C0h]
4264480    mov     rdi, rax
4264483    call    _strlen
4264488    mov     rcx, rax
4264491    mov     rax, [rbp-2038h]
4264498    mov     rax, [rax+2A8h]
4264505    mov     rax, [rax+0C0h]
4264512    lea     rdx, [rbp-2020h]
4264519    mov     rsi, rcx
4264522    mov     rdi, rax
4264525    call    _mg_match_prefix
4264530    test    eax, eax
4264532    jle     loc_411274
4264534    lea     rdx, [rbp-2020h]
4264541    mov     rax, [rbp-2038h]
4264548    mov     rsi, rdx
4264551    mov     rdi, rax
4264554    call    _handle_ssi_request
4264559    jmp     loc_411335
loc_411274:
4264564    mov     rdx, [rbp-2058h]
4264571    mov     rax, [rbp-2038h]
4264578    mov     rsi, rdx
4264581    mov     rdi, rax
4264584    call    _is_not_modified
4264589    test    eax, eax
4264591    jz      loc_4112B4
4264593    mov     rax, [rbp-2038h]
4264600    mov     edx, 0
4264605    mov     esi, 130h
4264610    mov     rdi, rax
4264613    mov     eax, 0
4264618    call    _send_http_error
4264623    jmp     loc_411335
loc_4112B4:
4264628    lea     rax, [rbp-2020h]
4264635    mov     edx, 0
4264640    mov     esi, 0
4264645    mov     rdi, rax
4264648    mov     eax, 0
4264653    call    _open64
4264658    mov     rdx, [rbp-2038h]
4264665    mov     [rdx+2B0h], eax
4264671    mov     rax, [rbp-2038h]
4264678    mov     eax, [rax+2B0h]
4264684    cmp     eax, 0FFFFFFFFh
4264687    jz      loc_411317
4264689    mov     rcx, [rbp-2068h]
4264696    mov     rdx, [rbp-2058h]
4264703    lea     rsi, [rbp-2020h]
4264710    mov     rax, [rbp-2038h]
4264717    mov     rdi, rax
4264720    call    _open_file_endpoint
4264725    jmp     loc_411335
loc_411317:
4264727    mov     rax, [rbp-2038h]
4264734    mov     edx, 0
4264739    mov     esi, 194h
4264744    mov     rdi, rax
4264747    mov     eax, 0
4264752    call    _send_http_error
loc_411335:
4264757    mov     rax, [rbp-18h]
4264761    xor     rax, [fs:28h]
4264770    jz      loc_411349
4264772    call    ___stack_chk_fail
loc_411349:
4264777    add     rsp, 2068h
4264784    pop     rbx
4264785    pop     rbp
4264786    retn    
USE32

section .text

global _mg_send_file

_mg_send_file:
4264787    push    rbp
4264788    mov     rbp, rsp
4264791    sub     rsp, 0C0h
4264798    call    _mcount
4264803    mov     [rbp-0A8h], rdi
4264810    mov     [rbp-0B0h], rsi
4264817    mov     [rbp-0B8h], rdx
4264824    lea     rdx, [rbp-90h]
4264831    mov     rax, [rbp-0B0h]
4264838    mov     rsi, rdx
4264841    mov     rdi, rax
4264844    call    _stat64
4264849    test    eax, eax
4264851    setz    al
4264854    movzx   eax, al
4264857    mov     [rbp-94h], eax
4264863    mov     rdi, [rbp-0B8h]
4264870    mov     ecx, [rbp-94h]
4264876    lea     rdx, [rbp-90h]
4264883    mov     rsi, [rbp-0B0h]
4264890    mov     rax, [rbp-0A8h]
4264897    mov     r8, rdi
4264900    mov     rdi, rax
4264903    call    _mg_send_file_internal
4264908    leave   
4264909    retn    
USE32

section .text

global _open_local_endpoint

_open_local_endpoint:
4264910    push    rbp
4264911    mov     rbp, rsp
4264914    sub     rsp, 20C0h
4264921    call    _mcount
4264926    mov     [rbp-20B8h], rdi
4264933    mov     [rbp-20BCh], esi
4264939    mov     rax, [fs:28h]
4264948    mov     [rbp-8], rax
4264952    xor     eax, eax
4264954    mov     dword [rbp-20ACh], 0
4264964    mov     rax, [rbp-20B8h]
4264971    mov     dword [rax+2B8h], 0
4264981    mov     rax, [rbp-20B8h]
4264988    mov     rax, [rax+2A8h]
4264995    mov     rax, [rax+30h]
4264999    test    rax, rax
4265002    jz      loc_41145C
4265004    mov     rax, [rbp-20B8h]
4265011    mov     esi, 66h
4265016    mov     rdi, rax
4265019    call    _call_user
4265024    test    eax, eax
4265026    jnz     loc_41145C
4265028    mov     rax, [rbp-20B8h]
4265035    add     rax, 8
4265039    mov     rdi, rax
4265042    call    _mg_send_digest_auth_request
4265047    jmp     loc_411805
loc_41145C:
4265052    cmp     dword [rbp-20BCh], 0
4265059    jnz     loc_411492
4265061    mov     rax, [rbp-20B8h]
4265068    mov     rax, [rax+2A8h]
4265075    mov     rax, [rax+30h]
4265079    test    rax, rax
4265082    jz      loc_411492
4265084    mov     rax, [rbp-20B8h]
4265091    mov     dword [rax+2B8h], 3
4265101    jmp     loc_411805
loc_411492:
4265106    mov     rax, [rbp-20B8h]
4265113    mov     rax, [rax+8]
4265117    mov     esi, aConnect
4265122    mov     rdi, rax
4265125    call    _strcmp
4265130    test    eax, eax
4265132    jz      loc_4114CF
4265134    mov     rax, [rbp-20B8h]
4265141    mov     rax, [rax+10h]
4265145    mov     edx, 4
4265150    mov     esi, aHttp_1
4265155    mov     rdi, rax
4265158    call    _mg_strncasecmp
4265163    test    eax, eax
4265165    jnz     loc_411544
loc_4114CF:
4265167    mov     rax, [rbp-20B8h]
4265174    mov     rax, [rax+2A8h]
4265181    mov     rax, [rax+80h]
4265188    mov     [rbp-20A8h], rax
4265195    cmp     qword [rbp-20A8h], 0
4265203    jz      loc_41150D
4265205    mov     rax, [rbp-20A8h]
4265212    mov     esi, aYes
4265217    mov     rdi, rax
4265220    call    _strcmp
4265225    test    eax, eax
4265227    jz      loc_411530
loc_41150D:
4265229    mov     rax, [rbp-20B8h]
4265236    mov     edx, 0
4265241    mov     esi, 195h
4265246    mov     rdi, rax
4265249    mov     eax, 0
4265254    call    _send_http_error
4265259    jmp     loc_411805
loc_411530:
4265264    mov     rax, [rbp-20B8h]
4265271    mov     rdi, rax
4265274    call    _proxify_connection
4265279    jmp     loc_411805
loc_411544:
4265284    mov     rax, [rbp-20B8h]
4265291    mov     rax, [rax+8]
4265295    mov     esi, aOptions_0
4265300    mov     rdi, rax
4265303    call    _strcmp
4265308    test    eax, eax
4265310    jnz     loc_411574
4265312    mov     rax, [rbp-20B8h]
4265319    mov     rdi, rax
4265322    call    _send_options
4265327    jmp     loc_411805
loc_411574:
4265332    lea     rdx, [rbp-20A0h]
4265339    lea     rsi, [rbp-2010h]
4265346    mov     rax, [rbp-20B8h]
4265353    mov     rcx, rdx
4265356    mov     edx, 2000h
4265361    mov     rdi, rax
4265364    call    _convert_uri_to_file_name
4265369    mov     [rbp-20ACh], eax
4265375    mov     rax, [rbp-20B8h]
4265382    mov     rax, [rax+8]
4265386    mov     esi, aOptions_0
4265391    mov     rdi, rax
4265394    call    _strcmp
4265399    test    eax, eax
4265401    jnz     loc_4115CF
4265403    mov     rax, [rbp-20B8h]
4265410    mov     rdi, rax
4265413    call    _send_options
4265418    jmp     loc_411805
loc_4115CF:
4265423    mov     rax, [rbp-20B8h]
4265430    mov     rax, [rax+2A8h]
4265437    mov     rax, [rax+70h]
4265441    test    rax, rax
4265444    jnz     loc_411609
4265446    mov     rax, [rbp-20B8h]
4265453    mov     edx, 0
4265458    mov     esi, 194h
4265463    mov     rdi, rax
4265466    mov     eax, 0
4265471    call    _send_http_error
4265476    jmp     loc_411805
loc_411609:
4265481    mov     rax, [rbp-20B8h]
4265488    mov     rdi, rax
4265491    call    _is_dav_request
4265496    test    eax, eax
4265498    jnz     loc_41165F
4265500    cmp     dword [rbp-20ACh], 0
4265507    jz      loc_41163E
4265509    mov     eax, [rbp-2088h]
4265515    and     eax, 0F000h
4265520    cmp     eax, 4000h
4265525    jnz     loc_41163E
4265527    mov     eax, 1
4265532    jmp     loc_411643
loc_41163E:
4265534    mov     eax, 0
loc_411643:
4265539    lea     rsi, [rbp-2010h]
4265546    mov     rcx, [rbp-20B8h]
4265553    mov     edx, eax
4265555    mov     rdi, rcx
4265558    call    _is_authorized
4265563    test    eax, eax
4265565    jz      loc_411685
loc_41165F:
4265567    mov     rax, [rbp-20B8h]
4265574    mov     rdi, rax
4265577    call    _is_dav_request
4265582    test    eax, eax
4265584    jz      loc_4116AC
4265586    mov     rax, [rbp-20B8h]
4265593    mov     rdi, rax
4265596    call    _is_authorized_for_dav
4265601    test    eax, eax
4265603    jnz     loc_4116AC
loc_411685:
4265605    mov     rax, [rbp-20B8h]
4265612    add     rax, 8
4265616    mov     rdi, rax
4265619    call    _mg_send_digest_auth_request
4265624    mov     rax, [rbp-20B8h]
4265631    mov     rdi, rax
4265634    call    _close_local_endpoint
4265639    jmp     loc_411805
loc_4116AC:
4265644    lea     rdx, [rbp-2010h]
4265651    mov     rax, [rbp-20B8h]
4265658    mov     rsi, rdx
4265661    mov     rdi, rax
4265664    call    _must_hide_file
4265669    test    eax, eax
4265671    jz      loc_4116EC
4265673    mov     rax, [rbp-20B8h]
4265680    mov     edx, 0
4265685    mov     esi, 194h
4265690    mov     rdi, rax
4265693    mov     eax, 0
4265698    call    _send_http_error
4265703    jmp     loc_411805
loc_4116EC:
4265708    mov     rax, [rbp-20B8h]
4265715    mov     rax, [rax+8]
4265719    mov     esi, aPropfind
4265724    mov     rdi, rax
4265727    call    _strcmp
4265732    test    eax, eax
4265734    jnz     loc_411730
4265736    mov     ecx, [rbp-20ACh]
4265742    lea     rdx, [rbp-20A0h]
4265749    lea     rsi, [rbp-2010h]
4265756    mov     rax, [rbp-20B8h]
4265763    mov     rdi, rax
4265766    call    _handle_propfind
4265771    jmp     loc_411805
loc_411730:
4265776    mov     rax, [rbp-20B8h]
4265783    mov     rax, [rax+8]
4265787    mov     esi, aMkcol
4265792    mov     rdi, rax
4265795    call    _strcmp
4265800    test    eax, eax
4265802    jnz     loc_41176A
4265804    lea     rdx, [rbp-2010h]
4265811    mov     rax, [rbp-20B8h]
4265818    mov     rsi, rdx
4265821    mov     rdi, rax
4265824    call    _handle_mkcol
4265829    jmp     loc_411805
loc_41176A:
4265834    mov     rax, [rbp-20B8h]
4265841    mov     rax, [rax+8]
4265845    mov     esi, aDelete
4265850    mov     rdi, rax
4265853    call    _strcmp
4265858    test    eax, eax
4265860    jnz     loc_4117A1
4265862    lea     rdx, [rbp-2010h]
4265869    mov     rax, [rbp-20B8h]
4265876    mov     rsi, rdx
4265879    mov     rdi, rax
4265882    call    _handle_delete
4265887    jmp     loc_411805
loc_4117A1:
4265889    mov     rax, [rbp-20B8h]
4265896    mov     rax, [rax+8]
4265900    mov     esi, aPut
4265905    mov     rdi, rax
4265908    call    _strcmp
4265913    test    eax, eax
4265915    jnz     loc_4117D8
4265917    lea     rdx, [rbp-2010h]
4265924    mov     rax, [rbp-20B8h]
4265931    mov     rsi, rdx
4265934    mov     rdi, rax
4265937    call    _handle_put
4265942    jmp     loc_411805
loc_4117D8:
4265944    mov     rax, [rbp-20B8h]
4265951    lea     rdi, [rax+8]
4265955    mov     ecx, [rbp-20ACh]
4265961    lea     rdx, [rbp-20A0h]
4265968    lea     rax, [rbp-2010h]
4265975    mov     r8d, 0
4265981    mov     rsi, rax
4265984    call    _mg_send_file_internal
loc_411805:
4265989    mov     rax, [rbp-8]
4265993    xor     rax, [fs:28h]
4266002    jz      locret_411819
4266004    call    ___stack_chk_fail
locret_411819:
4266009    leave   
4266010    retn    
USE32

section .text

global _send_continue_if_expected

_send_continue_if_expected:
4266011    push    rbp
4266012    mov     rbp, rsp
4266015    sub     rsp, 20h
4266019    call    _mcount
4266024    mov     [rbp-18h], rdi
4266028    mov     rax, [rbp-18h]
4266032    add     rax, 8
4266036    mov     esi, aExpect
4266041    mov     rdi, rax
4266044    call    _mg_get_header
4266049    mov     [rbp-8], rax
4266053    cmp     qword [rbp-8], 0
4266058    jz      locret_41187A
4266060    mov     rax, [rbp-8]
4266064    mov     esi, a100Continue
4266069    mov     rdi, rax
4266072    call    _mg_strcasecmp
4266077    test    eax, eax
4266079    jnz     locret_41187A
4266081    mov     rax, [rbp-18h]
4266085    mov     rax, [rax]
4266088    mov     edx, 19h
4266093    mov     esi, expect_response_7176
4266098    mov     rdi, rax
4266101    call    _ns_send
locret_41187A:
4266106    leave   
4266107    retn    
USE32

section .text

global _is_valid_uri

_is_valid_uri:
4266108    push    rbp
4266109    mov     rbp, rsp
4266112    sub     rsp, 20h
4266116    call    _mcount
4266121    mov     [rbp-18h], rdi
4266125    mov     rax, [rbp-18h]
4266129    movzx   eax, byte [rax]
4266132    cmp     al, 2Fh
4266134    jz      loc_4118E5
4266136    mov     rax, [rbp-18h]
4266140    mov     esi, asc_4169CB
4266145    mov     rdi, rax
4266148    call    _strcmp
4266153    test    eax, eax
4266155    jz      loc_4118E5
4266157    mov     rax, [rbp-18h]
4266161    mov     edx, 4
4266166    mov     esi, aHttp_1
4266171    mov     rdi, rax
4266174    call    _mg_strncasecmp
4266179    test    eax, eax
4266181    jz      loc_4118E5
4266183    lea     rdx, [rbp-2]
4266187    mov     rax, [rbp-18h]
4266191    mov     esi, aHu
4266196    mov     rdi, rax
4266199    mov     eax, 0
4266204    call    ___isoc99_sscanf
4266209    test    eax, eax
4266211    jle     loc_4118EC
loc_4118E5:
4266213    mov     eax, 1
4266218    jmp     locret_4118F1
loc_4118EC:
4266220    mov     eax, 0
locret_4118F1:
4266225    leave   
4266226    retn    
USE32

section .text

global _try_parse

_try_parse:
4266227    push    rbp
4266228    mov     rbp, rsp
4266231    sub     rsp, 20h
4266235    call    _mcount
4266240    mov     [rbp-18h], rdi
4266244    mov     rax, [rbp-18h]
4266248    mov     rax, [rax]
4266251    add     rax, 38h
4266255    mov     [rbp-10h], rax
4266259    mov     rax, [rbp-18h]
4266263    mov     rax, [rax+2E0h]
4266270    test    rax, rax
4266273    jnz     locret_411A77
4266279    mov     rax, [rbp-10h]
4266283    mov     rdx, [rax+8]
4266287    mov     rax, [rbp-10h]
4266291    mov     rax, [rax]
4266294    mov     rsi, rdx
4266297    mov     rdi, rax
4266300    call    _get_request_len
4266305    movsxd  rdx, eax
4266308    mov     rax, [rbp-18h]
4266312    mov     [rax+2E0h], rdx
4266319    mov     rax, [rbp-18h]
4266323    mov     rax, [rax+2E0h]
4266330    test    rax, rax
4266333    jle     locret_411A77
4266339    mov     rax, [rbp-18h]
4266343    mov     rax, [rax+2E0h]
4266350    mov     rdi, rax
4266353    call    _malloc
4266358    mov     rdx, rax
4266361    mov     rax, [rbp-18h]
4266365    mov     [rax+2C8h], rdx
4266372    mov     rax, [rbp-18h]
4266376    mov     rax, [rax+2E0h]
4266383    mov     rdx, rax
4266386    mov     rax, [rbp-10h]
4266390    mov     rcx, [rax]
4266393    mov     rax, [rbp-18h]
4266397    mov     rax, [rax+2C8h]
4266404    mov     rsi, rcx
4266407    mov     rdi, rax
4266410    call    _memcpy
4266415    mov     rax, [rbp-18h]
4266419    mov     rax, [rax+2E0h]
4266426    mov     rdx, rax
4266429    mov     rax, [rbp-10h]
4266433    mov     rsi, rdx
4266436    mov     rdi, rax
4266439    call    _iobuf_remove
4266444    mov     rax, [rbp-18h]
4266448    lea     rdx, [rax+8]
4266452    mov     rax, [rbp-18h]
4266456    mov     rax, [rax+2E0h]
4266463    mov     rcx, rax
4266466    mov     rax, [rbp-18h]
4266470    mov     rax, [rax+2C8h]
4266477    mov     rsi, rcx
4266480    mov     rdi, rax
4266483    call    _parse_http_message
4266488    mov     rdx, rax
4266491    mov     rax, [rbp-18h]
4266495    mov     [rax+2E0h], rdx
4266502    mov     rax, [rbp-18h]
4266506    mov     rax, [rax+2E0h]
4266513    test    rax, rax
4266516    jle     locret_411A77
4266518    mov     rax, [rbp-18h]
4266522    add     rax, 8
4266526    mov     esi, aContentLength
4266531    mov     rdi, rax
4266534    call    _mg_get_header
4266539    mov     [rbp-8], rax
4266543    cmp     qword [rbp-8], 0
4266548    jz      loc_411A4E
4266550    mov     rax, [rbp-8]
4266554    mov     edx, 0Ah
4266559    mov     esi, 0
4266564    mov     rdi, rax
4266567    call    _strtoll
4266572    jmp     loc_411A53
loc_411A4E:
4266574    mov     eax, 0
loc_411A53:
4266579    mov     rdx, [rbp-18h]
4266583    mov     [rdx+2D8h], rax
4266590    mov     rax, [rbp-18h]
4266594    mov     rax, [rax+2D8h]
4266601    mov     rdx, rax
4266604    mov     rax, [rbp-18h]
4266608    mov     [rax+278h], rdx
locret_411A77:
4266615    leave   
4266616    retn    
USE32

section .text

global _do_proxy

_do_proxy:
4266617    push    rbp
4266618    mov     rbp, rsp
4266621    sub     rsp, 10h
4266625    call    _mcount
4266630    mov     [rbp-8], rdi
4266634    mov     rax, [rbp-8]
4266638    mov     rdx, [rax+2B0h]
4266645    mov     rax, [rbp-8]
4266649    mov     rax, [rax]
4266652    mov     rsi, rdx
4266655    mov     rdi, rax
4266658    call    _ns_forward
4266663    leave   
4266664    retn    
USE32

section .text

global _on_recv_data

_on_recv_data:
4266665    push    rbp
4266666    mov     rbp, rsp
4266669    sub     rsp, 20h
4266673    call    _mcount
4266678    mov     [rbp-18h], rdi
4266682    mov     rax, [rbp-18h]
4266686    mov     rax, [rax]
4266689    add     rax, 38h
4266693    mov     [rbp-8], rax
4266697    mov     rax, [rbp-18h]
4266701    mov     eax, [rax+2B8h]
4266707    cmp     eax, 6
4266710    jnz     loc_411AFE
4266712    mov     rax, [rbp-18h]
4266716    mov     rax, [rax+2B0h]
4266723    test    rax, rax
4266726    jz      loc_411AF9
4266728    mov     rax, [rbp-18h]
4266732    mov     rdi, rax
4266735    call    _do_proxy
4266740    jmp     locret_411D51
loc_411AF9:
4266745    jmp     locret_411D51
loc_411AFE:
4266750    mov     rax, [rbp-18h]
4266754    mov     rdi, rax
4266757    call    _try_parse
4266762    mov     rax, [rbp-18h]
4266766    mov     rax, [rax+2E0h]
4266773    test    rax, rax
4266776    js      loc_411B3E
4266778    mov     rax, [rbp-18h]
4266782    mov     rax, [rax+2E0h]
4266789    test    rax, rax
4266792    jle     loc_411B5E
4266794    mov     rax, [rbp-18h]
4266798    mov     rax, [rax+10h]
4266802    mov     rdi, rax
4266805    call    _is_valid_uri
4266810    test    eax, eax
4266812    jnz     loc_411B5E
loc_411B3E:
4266814    mov     rax, [rbp-18h]
4266818    mov     edx, 0
4266823    mov     esi, 190h
4266828    mov     rdi, rax
4266831    mov     eax, 0
4266836    call    _send_http_error
4266841    jmp     loc_411C48
loc_411B5E:
4266846    mov     rax, [rbp-18h]
4266850    mov     rax, [rax+2E0h]
4266857    test    rax, rax
4266860    jnz     loc_411B9E
4266862    mov     rax, [rbp-8]
4266866    mov     rax, [rax+8]
4266870    cmp     rax, 4000h
4266876    jbe     loc_411B9E
4266878    mov     rax, [rbp-18h]
4266882    mov     edx, 0
4266887    mov     esi, 19Dh
4266892    mov     rdi, rax
4266895    mov     eax, 0
4266900    call    _send_http_error
4266905    jmp     loc_411C48
loc_411B9E:
4266910    mov     rax, [rbp-18h]
4266914    mov     rax, [rax+2E0h]
4266921    test    rax, rax
4266924    jle     loc_411BFD
4266926    mov     rax, [rbp-18h]
4266930    mov     rax, [rax+18h]
4266934    mov     esi, a1_0
4266939    mov     rdi, rax
4266942    call    _strcmp
4266947    test    eax, eax
4266949    jz      loc_411BFD
4266951    mov     rax, [rbp-18h]
4266955    mov     rax, [rax+18h]
4266959    mov     esi, a1_1
4266964    mov     rdi, rax
4266967    call    _strcmp
4266972    test    eax, eax
4266974    jz      loc_411BFD
4266976    mov     rax, [rbp-18h]
4266980    mov     edx, 0
4266985    mov     esi, 1F9h
4266990    mov     rdi, rax
4266993    mov     eax, 0
4266998    call    _send_http_error
4267003    jmp     loc_411C48
loc_411BFD:
4267005    mov     rax, [rbp-18h]
4267009    mov     rax, [rax+2E0h]
4267016    test    rax, rax
4267019    jle     loc_411C48
4267021    mov     rax, [rbp-18h]
4267025    mov     eax, [rax+2B8h]
4267031    test    eax, eax
4267033    jnz     loc_411C48
4267035    mov     rax, [rbp-18h]
4267039    add     rax, 8
4267043    mov     rdi, rax
4267046    call    _send_websocket_handshake_if_requested
4267051    mov     rax, [rbp-18h]
4267055    mov     rdi, rax
4267058    call    _send_continue_if_expected
4267063    mov     rax, [rbp-18h]
4267067    mov     esi, 0
4267072    mov     rdi, rax
4267075    call    _open_local_endpoint
loc_411C48:
4267080    mov     rax, [rbp-18h]
4267084    mov     eax, [rax+2B8h]
4267090    cmp     eax, 2
4267093    jnz     loc_411C84
4267095    mov     rax, [rbp-18h]
4267099    mov     rax, [rax+2B0h]
4267106    test    rax, rax
4267109    jz      loc_411C84
4267111    mov     rax, [rbp-18h]
4267115    mov     rdx, [rax+2B0h]
4267122    mov     rax, [rbp-18h]
4267126    mov     rax, [rax]
4267129    mov     rsi, rdx
4267132    mov     rdi, rax
4267135    call    _ns_forward
loc_411C84:
4267140    mov     rax, [rbp-18h]
4267144    mov     eax, [rax+2B8h]
4267150    cmp     eax, 3
4267153    jnz     loc_411D29
4267159    mov     rax, [rbp-8]
4267163    mov     rdx, [rax]
4267166    mov     rax, [rbp-18h]
4267170    mov     [rax+270h], rdx
4267177    mov     rax, [rbp-8]
4267181    mov     rdx, [rax+8]
4267185    mov     rax, [rbp-18h]
4267189    mov     [rax+278h], rdx
4267196    mov     rax, [rbp-18h]
4267200    mov     esi, 69h
4267205    mov     rdi, rax
4267208    call    _call_user
4267213    mov     [rbp-0Ch], eax
4267216    cmp     dword [rbp-0Ch], 0
4267220    jns     loc_411CF5
4267222    mov     rax, [rbp-18h]
4267226    mov     rax, [rax]
4267229    mov     rdx, [rbp-18h]
4267233    mov     rdx, [rdx]
4267236    mov     edx, [rdx+98h]
4267242    or      edx, 1
4267245    mov     [rax+98h], edx
4267251    jmp     loc_411D1D
loc_411CF5:
4267253    mov     eax, [rbp-0Ch]
4267256    movsxd  rdx, eax
4267259    mov     rax, [rbp-8]
4267263    mov     rax, [rax+8]
4267267    cmp     rdx, rax
4267270    ja      loc_411D1D
4267272    mov     eax, [rbp-0Ch]
4267275    movsxd  rdx, eax
4267278    mov     rax, [rbp-8]
4267282    mov     rsi, rdx
4267285    mov     rdi, rax
4267288    call    _iobuf_remove
loc_411D1D:
4267293    mov     rax, [rbp-18h]
4267297    mov     rdi, rax
4267300    call    _call_request_handler_if_data_is_buffered
loc_411D29:
4267305    mov     rax, [rbp-18h]
4267309    mov     eax, [rax+2B8h]
4267315    cmp     eax, 4
4267318    jnz     locret_411D51
4267320    mov     rax, [rbp-8]
4267324    mov     rax, [rax+8]
4267328    test    rax, rax
4267331    jz      locret_411D51
4267333    mov     rax, [rbp-18h]
4267337    mov     rdi, rax
4267340    call    _forward_put_data
locret_411D51:
4267345    leave   
4267346    retn    
USE32

section .text

global _call_http_client_handler

_call_http_client_handler:
4267347    push    rbp
4267348    mov     rbp, rsp
4267351    sub     rsp, 10h
4267355    call    _mcount
4267360    mov     [rbp-8], rdi
4267364    mov     rax, [rbp-8]
4267368    mov     rax, [rax+2D8h]
4267375    test    rax, rax
4267378    jnz     loc_411D8A
4267380    mov     rax, [rbp-8]
4267384    mov     rax, [rax]
4267387    mov     rdx, [rax+40h]
4267391    mov     rax, [rbp-8]
4267395    mov     [rax+278h], rdx
loc_411D8A:
4267402    mov     rax, [rbp-8]
4267406    mov     rax, [rax]
4267409    mov     rdx, [rax+38h]
4267413    mov     rax, [rbp-8]
4267417    mov     [rax+270h], rdx
4267424    mov     rax, [rbp-8]
4267428    mov     esi, 68h
4267433    mov     rdi, rax
4267436    call    _call_user
4267441    test    eax, eax
4267443    jnz     loc_411DD2
4267445    mov     rax, [rbp-8]
4267449    mov     rax, [rax]
4267452    mov     rdx, [rbp-8]
4267456    mov     rdx, [rdx]
4267459    mov     edx, [rdx+98h]
4267465    or      edx, 10h
4267468    mov     [rax+98h], edx
loc_411DD2:
4267474    mov     rax, [rbp-8]
4267478    mov     rax, [rax+278h]
4267485    mov     rdx, [rbp-8]
4267489    mov     rdx, [rdx]
4267492    add     rdx, 38h
4267496    mov     rsi, rax
4267499    mov     rdi, rdx
4267502    call    _iobuf_remove
4267507    mov     rax, [rbp-8]
4267511    mov     dword [rax+284h], 0
4267521    mov     rax, [rbp-8]
4267525    mov     qword [rax+2E0h], 0
4267536    mov     rax, [rbp-8]
4267540    mov     rdx, [rax+2E0h]
4267547    mov     rax, [rbp-8]
4267551    mov     [rax+2D0h], rdx
4267558    mov     rax, [rbp-8]
4267562    mov     rdx, [rax+2D0h]
4267569    mov     rax, [rbp-8]
4267573    mov     [rax+2D8h], rdx
4267580    mov     rax, [rbp-8]
4267584    mov     rax, [rax+2C8h]
4267591    mov     rdi, rax
4267594    call    _free
4267599    mov     rax, [rbp-8]
4267603    mov     qword [rax+2C8h], 0
4267614    leave   
4267615    retn    
USE32

section .text

global _process_response

_process_response:
4267616    push    rbp
4267617    mov     rbp, rsp
4267620    sub     rsp, 20h
4267624    call    _mcount
4267629    mov     [rbp-18h], rdi
4267633    mov     rax, [rbp-18h]
4267637    mov     rax, [rax]
4267640    add     rax, 38h
4267644    mov     [rbp-8], rax
4267648    mov     rax, [rbp-18h]
4267652    mov     rdi, rax
4267655    call    _try_parse
4267660    mov     rax, [rbp-18h]
4267664    mov     rax, [rax+2E0h]
4267671    test    rax, rax
4267674    js      loc_411EBC
4267676    mov     rax, [rbp-18h]
4267680    mov     rax, [rax+2E0h]
4267687    test    rax, rax
4267690    jnz     loc_411ECA
4267692    mov     rax, [rbp-8]
4267696    mov     rax, [rax+8]
4267700    cmp     rax, 4000h
4267706    jbe     loc_411ECA
loc_411EBC:
4267708    mov     rax, [rbp-18h]
4267712    mov     rdi, rax
4267715    call    _call_http_client_handler
4267720    jmp     locret_411EF1
loc_411ECA:
4267722    mov     rax, [rbp-8]
4267726    mov     rax, [rax+8]
4267730    mov     rdx, rax
4267733    mov     rax, [rbp-18h]
4267737    mov     rax, [rax+2D8h]
4267744    cmp     rdx, rax
4267747    jl      locret_411EF1
4267749    mov     rax, [rbp-18h]
4267753    mov     rdi, rax
4267756    call    _call_http_client_handler
locret_411EF1:
4267761    leave   
4267762    retn    
USE32

section .text

global _mg_connect

_mg_connect:
4267763    push    rbp
4267764    mov     rbp, rsp
4267767    sub     rsp, 20h
4267771    call    _mcount
4267776    mov     [rbp-18h], rdi
4267780    mov     [rbp-20h], rsi
4267784    mov     rax, [rbp-18h]
4267788    mov     rsi, [rbp-20h]
4267792    mov     ecx, 0
4267797    mov     edx, mg_ev_handler
4267802    mov     rdi, rax
4267805    call    _ns_connect
4267810    mov     [rbp-10h], rax
4267814    cmp     qword [rbp-10h], 0
4267819    jnz     loc_411F37
4267821    mov     eax, 0
4267826    jmp     locret_411FD1
loc_411F37:
4267831    mov     esi, 2E8h
4267836    mov     edi, 1
4267841    call    _calloc
4267846    mov     [rbp-8], rax
4267850    cmp     qword [rbp-8], 0
4267855    jnz     loc_411F71
4267857    mov     rax, [rbp-10h]
4267861    mov     eax, [rax+98h]
4267867    or      eax, 10h
4267870    mov     edx, eax
4267872    mov     rax, [rbp-10h]
4267876    mov     [rax+98h], edx
4267882    mov     eax, 0
4267887    jmp     locret_411FD1
loc_411F71:
4267889    mov     rax, [rbp-8]
4267893    mov     rdx, [rbp-10h]
4267897    mov     [rax], rdx
4267900    mov     rax, [rbp-10h]
4267904    mov     rdx, [rbp-8]
4267908    mov     [rax+78h], rdx
4267912    mov     rax, [rbp-8]
4267916    mov     rdx, [rbp-18h]
4267920    mov     [rax+2A8h], rdx
4267927    mov     rax, [rbp-8]
4267931    mov     dword [rax+2B8h], 5
4267941    mov     rax, [rbp-18h]
4267945    mov     rdx, [rax+18h]
4267949    mov     rax, [rbp-8]
4267953    mov     [rax+290h], rdx
4267960    mov     rax, [rbp-8]
4267964    mov     rax, [rax]
4267967    mov     dword [rax+98h], 8
4267977    mov     rax, [rbp-8]
4267981    add     rax, 8
locret_411FD1:
4267985    leave   
4267986    retn    
USE32

section .text

global _log_header

_log_header:
4267987    push    rbp
4267988    mov     rbp, rsp
4267991    sub     rsp, 30h
4267995    call    _mcount
4268000    mov     [rbp-18h], rdi
4268004    mov     [rbp-20h], rsi
4268008    mov     [rbp-28h], rdx
4268012    mov     rdx, [rbp-20h]
4268016    mov     rax, [rbp-18h]
4268020    mov     rsi, rdx
4268023    mov     rdi, rax
4268026    call    _mg_get_header
4268031    mov     [rbp-8], rax
4268035    cmp     qword [rbp-8], 0
4268040    jnz     loc_412027
4268042    mov     rax, [rbp-28h]
4268046    mov     rcx, rax
4268049    mov     edx, 2
4268054    mov     esi, 1
4268059    mov     edi, asc_4169DD
4268064    call    _fwrite
4268069    jmp     locret_412041
loc_412027:
4268071    mov     rdx, [rbp-8]
4268075    mov     rax, [rbp-28h]
4268079    mov     esi, aS_6
4268084    mov     rdi, rax
4268087    mov     eax, 0
4268092    call    _fprintf
locret_412041:
4268097    leave   
4268098    retn    
USE32

section .text

global _log_access

_log_access:
4268099    push    rbp
4268100    mov     rbp, rsp
4268103    push    rbx
4268104    sub     rsp, 118h
4268111    call    _mcount
4268116    mov     [rbp-0E8h], rdi
4268123    mov     [rbp-0F0h], rsi
4268130    mov     rax, [fs:28h]
4268139    mov     [rbp-18h], rax
4268143    xor     eax, eax
4268145    mov     rax, [rbp-0E8h]
4268152    add     rax, 8
4268156    mov     [rbp-0D0h], rax
4268163    cmp     qword [rbp-0F0h], 0
4268171    jz      loc_4120A3
4268173    mov     rax, [rbp-0F0h]
4268180    mov     esi, aA_3
4268185    mov     rdi, rax
4268188    call    _fopen64
4268193    jmp     loc_4120A8
loc_4120A3:
4268195    mov     eax, 0
loc_4120A8:
4268200    mov     [rbp-0C8h], rax
4268207    cmp     qword [rbp-0C8h], 0
4268215    jz      loc_4122AB
4268221    mov     edi, 0
4268226    call    _time
4268231    mov     [rbp-0D8h], rax
4268238    lea     rax, [rbp-0D8h]
4268245    mov     rdi, rax
4268248    call    _localtime
4268253    mov     rdx, rax
4268256    lea     rax, [rbp-0C0h]
4268263    mov     rcx, rdx
4268266    mov     edx, aDBYHMSZ
4268271    mov     esi, 40h
4268276    mov     rdi, rax
4268279    call    _strftime
4268284    mov     rax, [rbp-0C8h]
4268291    mov     rdi, rax
4268294    call    _flockfile
4268299    mov     rax, [rbp-0E8h]
4268306    add     rax, 8
4268310    mov     esi, aAuthorization
4268315    mov     rdi, rax
4268318    call    _mg_get_header
4268323    lea     rdx, [rbp-80h]
4268327    mov     ecx, 64h
4268332    mov     esi, aUsername
4268337    mov     rdi, rax
4268340    call    _mg_parse_header
4268345    mov     rax, [rbp-0D0h]
4268352    mov     r9d, [rax+27Ch]
4268359    mov     rax, [rbp-0D0h]
4268366    mov     r8, [rax+10h]
4268370    mov     rax, [rbp-0D0h]
4268377    mov     rax, [rax+18h]
4268381    test    rax, rax
4268384    jz      loc_41216F
4268386    mov     rax, [rbp-0D0h]
4268393    mov     rsi, [rax+18h]
4268397    jmp     loc_412174
loc_41216F:
4268399    mov     esi, unk_414196
loc_412174:
4268404    mov     rax, [rbp-0D0h]
4268411    mov     rax, [rax+18h]
4268415    test    rax, rax
4268418    jz      loc_41218B
4268420    mov     ecx, a?
4268425    jmp     loc_412190
loc_41218B:
4268427    mov     ecx, unk_414196
loc_412190:
4268432    mov     rax, [rbp-0D0h]
4268439    mov     rax, [rax+8]
4268443    test    rax, rax
4268446    jz      loc_4121AD
4268448    mov     rax, [rbp-0D0h]
4268455    mov     rdx, [rax+8]
4268459    jmp     loc_4121B2
loc_4121AD:
4268461    mov     edx, asc_4169FE
loc_4121B2:
4268466    mov     rax, [rbp-0D0h]
4268473    mov     rax, [rax]
4268476    test    rax, rax
4268479    jz      loc_4121CD
4268481    mov     rax, [rbp-0D0h]
4268488    mov     rdi, [rax]
4268491    jmp     loc_4121D2
loc_4121CD:
4268493    mov     edi, asc_4169FE
loc_4121D2:
4268498    movzx   eax, byte [rbp-80h]
4268502    test    al, al
4268504    jz      loc_4121E0
4268506    lea     rax, [rbp-80h]
4268510    jmp     loc_4121E5
loc_4121E0:
4268512    mov     eax, asc_4169FE
loc_4121E5:
4268517    mov     r10, [rbp-0D0h]
4268524    lea     r11, [r10+20h]
4268528    lea     rbx, [rbp-0C0h]
4268535    mov     r10, [rbp-0C8h]
4268542    mov     [rsp+20h], r9d
4268547    mov     [rsp+18h], r8
4268552    mov     [rsp+10h], rsi
4268557    mov     [rsp+8], rcx
4268562    mov     [rsp], rdx
4268566    mov     r9, rdi
4268569    mov     r8, rbx
4268572    mov     rcx, rax
4268575    mov     rdx, r11
4268578    mov     esi, aSSSSSSSHttpSD0
4268583    mov     rdi, r10
4268586    mov     eax, 0
4268591    call    _fprintf
4268596    mov     rdx, [rbp-0C8h]
4268603    mov     rax, [rbp-0D0h]
4268610    mov     esi, aReferer
4268615    mov     rdi, rax
4268618    call    _log_header
4268623    mov     rdx, [rbp-0C8h]
4268630    mov     rax, [rbp-0D0h]
4268637    mov     esi, aUserAgent
4268642    mov     rdi, rax
4268645    call    _log_header
4268650    mov     rax, [rbp-0C8h]
4268657    mov     rsi, rax
4268660    mov     edi, 0Ah
4268665    call    _fputc
4268670    mov     rax, [rbp-0C8h]
4268677    mov     rdi, rax
4268680    call    _fflush
4268685    mov     rax, [rbp-0C8h]
4268692    mov     rdi, rax
4268695    call    _funlockfile
4268700    mov     rax, [rbp-0C8h]
4268707    mov     rdi, rax
4268710    call    _fclose
loc_4122AB:
4268715    mov     rax, [rbp-18h]
4268719    xor     rax, [fs:28h]
4268728    jz      loc_4122BF
4268730    call    ___stack_chk_fail
loc_4122BF:
4268735    add     rsp, 118h
4268742    pop     rbx
4268743    pop     rbp
4268744    retn    
USE32

section .text

global _close_local_endpoint

_close_local_endpoint:
4268745    push    rbp
4268746    mov     rbp, rsp
4268749    sub     rsp, 20h
4268753    call    _mcount
4268758    mov     [rbp-18h], rdi
4268762    mov     rax, [rbp-18h]
4268766    add     rax, 8
4268770    mov     [rbp-8], rax
4268774    mov     rax, [rbp-18h]
4268778    add     rax, 8
4268782    mov     rdi, rax
4268785    call    _should_keep_alive
4268790    test    eax, eax
4268792    jz      loc_41231F
4268794    mov     rax, [rbp-18h]
4268798    mov     eax, [rax+2B8h]
4268804    cmp     eax, 1
4268807    jz      loc_412318
4268809    mov     rax, [rbp-18h]
4268813    mov     eax, [rax+2B8h]
4268819    cmp     eax, 3
4268822    jnz     loc_41231F
loc_412318:
4268824    mov     eax, 1
4268829    jmp     loc_412324
loc_41231F:
4268831    mov     eax, 0
loc_412324:
4268836    mov     [rbp-0Ch], eax
4268839    mov     rax, [rbp-18h]
4268843    mov     eax, [rax+2B8h]
4268849    cmp     eax, 2
4268852    jz      loc_412361
4268854    cmp     eax, 2
4268857    ja      loc_412342
4268859    cmp     eax, 1
4268862    jz      loc_41234E
4268864    jmp     loc_4123AC
loc_412342:
4268866    cmp     eax, 4
4268869    jz      loc_41234E
4268871    cmp     eax, 6
4268874    jz      loc_412361
4268876    jmp     loc_4123AC
loc_41234E:
4268878    mov     rax, [rbp-18h]
4268882    mov     eax, [rax+2B0h]
4268888    mov     edi, eax
4268890    call    _close
4268895    jmp     loc_4123AC
loc_412361:
4268897    mov     rax, [rbp-18h]
4268901    mov     rax, [rax+2B0h]
4268908    test    rax, rax
4268911    jz      loc_4123AB
4268913    mov     rax, [rbp-18h]
4268917    mov     rax, [rax+2B0h]
4268924    mov     rdx, [rbp-18h]
4268928    mov     rdx, [rdx+2B0h]
4268935    mov     edx, [rdx+98h]
4268941    or      edx, 10h
4268944    mov     [rax+98h], edx
4268950    mov     rax, [rbp-18h]
4268954    mov     rax, [rax+2B0h]
4268961    mov     qword [rax+78h], 0
4268969    jmp     $+2
loc_4123AB:
4268971    nop     
loc_4123AC:
4268972    mov     rax, [rbp-8]
4268976    mov     eax, [rax+27Ch]
4268982    test    eax, eax
4268984    jle     loc_4123F8
4268986    mov     rax, [rbp-18h]
4268990    mov     eax, [rax+2B8h]
4268996    cmp     eax, 5
4268999    jz      loc_4123F8
4269001    mov     rax, [rbp-8]
4269005    mov     eax, [rax+27Ch]
4269011    cmp     eax, 190h
4269016    jz      loc_4123F8
4269018    mov     rax, [rbp-18h]
4269022    mov     rax, [rax+2A8h]
4269029    mov     rdx, [rax+40h]
4269033    mov     rax, [rbp-18h]
4269037    mov     rsi, rdx
4269040    mov     rdi, rax
4269043    call    _log_access
loc_4123F8:
4269048    mov     rax, [rbp-18h]
4269052    mov     rax, [rax]
4269055    add     rax, 38h
4269059    mov     rdi, rax
4269062    call    _iobuf_free
4269067    mov     rax, [rbp-18h]
4269071    mov     rax, [rax+2C8h]
4269078    mov     rdi, rax
4269081    call    _free
4269086    mov     rax, [rbp-18h]
4269090    mov     rax, [rax+2C0h]
4269097    mov     rdi, rax
4269100    call    _free
4269105    mov     rax, [rbp-18h]
4269109    mov     qword [rax+2B0h], 0
4269120    mov     rax, [rbp-18h]
4269124    mov     qword [rax+2C0h], 0
4269135    mov     rax, [rbp-18h]
4269139    mov     rdx, [rax+2C0h]
4269146    mov     rax, [rbp-18h]
4269150    mov     [rax+2C8h], rdx
4269157    mov     rax, [rbp-18h]
4269161    mov     dword [rax+2B8h], 0
4269171    mov     rax, [rbp-18h]
4269175    mov     qword [rax+2E0h], 0
4269186    mov     rax, [rbp-18h]
4269190    mov     rdx, [rax+2E0h]
4269197    mov     rax, [rbp-18h]
4269201    mov     [rax+2D0h], rdx
4269208    mov     rax, [rbp-18h]
4269212    mov     rdx, [rax+2D0h]
4269219    mov     rax, [rbp-18h]
4269223    mov     [rax+2D8h], rdx
4269230    mov     rax, [rbp-18h]
4269234    mov     rax, [rax]
4269237    mov     rdx, [rbp-18h]
4269241    mov     rdx, [rdx]
4269244    mov     edx, [rdx+98h]
4269250    and     edx, 0FFCFFFECh
4269256    mov     [rax+98h], edx
4269262    mov     rax, [rbp-8]
4269266    mov     qword [rax+18h], 0
4269274    mov     rax, [rbp-8]
4269278    mov     rdx, [rax+18h]
4269282    mov     rax, [rbp-8]
4269286    mov     [rax+10h], rdx
4269290    mov     rax, [rbp-8]
4269294    mov     rdx, [rax+10h]
4269298    mov     rax, [rbp-8]
4269302    mov     [rax+8], rdx
4269306    mov     rax, [rbp-8]
4269310    mov     rdx, [rax+8]
4269314    mov     rax, [rbp-8]
4269318    mov     [rax], rdx
4269321    mov     rax, [rbp-8]
4269325    mov     qword [rax+270h], 0
4269336    mov     rax, [rbp-8]
4269340    mov     dword [rax+278h], 0
4269350    mov     rax, [rbp-8]
4269354    mov     edx, [rax+278h]
4269360    mov     rax, [rbp-8]
4269364    mov     [rax+27Ch], edx
4269370    mov     rax, [rbp-8]
4269374    mov     edx, [rax+27Ch]
4269380    mov     rax, [rbp-8]
4269384    mov     [rax+84h], edx
4269390    mov     rax, [rbp-8]
4269394    mov     qword [rax+298h], 0
4269405    mov     rax, [rbp-8]
4269409    mov     rdx, [rax+298h]
4269416    mov     rax, [rbp-8]
4269420    mov     [rax+290h], rdx
4269427    cmp     dword [rbp-0Ch], 0
4269431    jz      loc_412587
4269433    mov     rax, [rbp-18h]
4269437    mov     rdi, rax
4269440    call    _on_recv_data
4269445    jmp     locret_4125BF
loc_412587:
4269447    mov     rax, [rbp-18h]
4269451    mov     rdx, [rax]
4269454    mov     rax, [rbp-18h]
4269458    mov     rax, [rax]
4269461    mov     ecx, [rax+98h]
4269467    mov     rax, [rbp-18h]
4269471    mov     rax, [rax]
4269474    mov     rax, [rax+58h]
4269478    test    rax, rax
4269481    jnz     loc_4125B2
4269483    mov     eax, 10h
4269488    jmp     loc_4125B7
loc_4125B2:
4269490    mov     eax, 1
loc_4125B7:
4269495    or      eax, ecx
4269497    mov     [rdx+98h], eax
locret_4125BF:
4269503    leave   
4269504    retn    
USE32

section .text

global _transfer_file_data

_transfer_file_data:
4269505    push    rbp
4269506    mov     rbp, rsp
4269509    sub     rsp, 2030h
4269516    call    _mcount
4269521    mov     [rbp-2028h], rdi
4269528    mov     rax, [fs:28h]
4269537    mov     [rbp-8], rax
4269541    xor     eax, eax
4269543    mov     rax, [rbp-2028h]
4269550    mov     rax, [rax]
4269553    mov     rax, [rax+58h]
4269557    cmp     rax, 4000h
4269563    ja      loc_4126E3
4269569    mov     rax, [rbp-2028h]
4269576    mov     rax, [rax+2D8h]
4269583    cmp     rax, 1FFFh
4269589    jg      loc_412629
4269591    mov     rax, [rbp-2028h]
4269598    mov     rax, [rax+2D8h]
4269605    cdqe    
4269607    jmp     loc_41262E
loc_412629:
4269609    mov     eax, 2000h
loc_41262E:
4269614    mov     rdx, [rbp-2028h]
4269621    mov     ecx, [rdx+2B0h]
4269627    lea     rsi, [rbp-2010h]
4269634    mov     rdx, rax
4269637    mov     edi, ecx
4269639    call    _read
4269644    mov     [rbp-2018h], rax
4269651    cmp     qword [rbp-2018h], 0
4269659    jnz     loc_41266E
4269661    mov     rax, [rbp-2028h]
4269668    mov     rdi, rax
4269671    call    _close_local_endpoint
4269676    jmp     loc_4126E3
loc_41266E:
4269678    cmp     qword [rbp-2018h], 0
4269686    jz      loc_4126E3
4269688    mov     rax, [rbp-2028h]
4269695    mov     rax, [rax+2D8h]
4269702    sub     rax, [rbp-2018h]
4269709    mov     rdx, rax
4269712    mov     rax, [rbp-2028h]
4269719    mov     [rax+2D8h], rdx
4269726    mov     rax, [rbp-2028h]
4269733    mov     rax, [rax]
4269736    mov     rdx, [rbp-2018h]
4269743    lea     rcx, [rbp-2010h]
4269750    mov     rsi, rcx
4269753    mov     rdi, rax
4269756    call    _ns_send
4269761    mov     rax, [rbp-2028h]
4269768    mov     rax, [rax+2D8h]
4269775    test    rax, rax
4269778    jg      loc_4126E3
4269780    mov     rax, [rbp-2028h]
4269787    mov     rdi, rax
4269790    call    _close_local_endpoint
loc_4126E3:
4269795    mov     rax, [rbp-8]
4269799    xor     rax, [fs:28h]
4269808    jz      locret_4126F7
4269810    call    ___stack_chk_fail
locret_4126F7:
4269815    leave   
4269816    retn    
USE32

section .text

global _mg_poll_server

_mg_poll_server:
4269817    push    rbp
4269818    mov     rbp, rsp
4269821    sub     rsp, 10h
4269825    call    _mcount
4269830    mov     [rbp-8], rdi
4269834    mov     [rbp-0Ch], esi
4269837    mov     rax, [rbp-8]
4269841    mov     edx, [rbp-0Ch]
4269844    mov     esi, edx
4269846    mov     rdi, rax
4269849    call    _ns_mgr_poll
4269854    leave   
4269855    retn    
USE32

section .text

global _mg_destroy_server

_mg_destroy_server:
4269856    push    rbp
4269857    mov     rbp, rsp
4269860    sub     rsp, 20h
4269864    call    _mcount
4269869    mov     [rbp-18h], rdi
4269873    cmp     qword [rbp-18h], 0
4269878    jz      locret_4127A0
4269880    mov     rax, [rbp-18h]
4269884    mov     rax, [rax]
4269887    test    rax, rax
4269890    jz      locret_4127A0
4269892    mov     rax, [rbp-18h]
4269896    mov     rax, [rax]
4269899    mov     [rbp-8], rax
4269903    mov     rax, [rbp-8]
4269907    mov     rdi, rax
4269910    call    _ns_mgr_free
4269915    mov     dword [rbp-0Ch], 0
4269922    jmp     loc_412783
loc_412764:
4269924    mov     rax, [rbp-8]
4269928    mov     edx, [rbp-0Ch]
4269931    movsxd  rdx, edx
4269934    add     rdx, 6
4269938    mov     rax, [rax+rdx*8+8]
4269943    mov     rdi, rax
4269946    call    _free
4269951    add     dword [rbp-0Ch], 1
loc_412783:
4269955    cmp     dword [rbp-0Ch], 12h
4269959    jle     loc_412764
4269961    mov     rax, [rbp-8]
4269965    mov     rdi, rax
4269968    call    _free
4269973    mov     rax, [rbp-18h]
4269977    mov     qword [rax], 0
locret_4127A0:
4269984    leave   
4269985    retn    
USE32

section .text

global _mg_next

_mg_next:
4269986    push    rbp
4269987    mov     rbp, rsp
4269990    sub     rsp, 20h
4269994    call    _mcount
4269999    mov     [rbp-18h], rdi
4270003    mov     [rbp-20h], rsi
4270007    cmp     qword [rbp-20h], 0
4270012    jz      loc_4127CB
4270014    mov     rax, [rbp-20h]
4270018    sub     rax, 8
4270022    mov     rax, [rax]
4270025    jmp     loc_4127D0
loc_4127CB:
4270027    mov     eax, 0
loc_4127D0:
4270032    mov     rdx, [rbp-18h]
4270036    mov     rsi, rax
4270039    mov     rdi, rdx
4270042    call    _ns_next
4270047    mov     [rbp-8], rax
4270051    cmp     qword [rbp-8], 0
4270056    jz      loc_412805
4270058    mov     rax, [rbp-8]
4270062    mov     rax, [rax+78h]
4270066    test    rax, rax
4270069    jz      loc_412805
4270071    mov     rax, [rbp-8]
4270075    mov     rax, [rax+78h]
4270079    add     rax, 8
4270083    jmp     locret_41280A
loc_412805:
4270085    mov     eax, 0
locret_41280A:
4270090    leave   
4270091    retn    
USE32

section .text

global _get_var

_get_var:
4270092    push    rbp
4270093    mov     rbp, rsp
4270096    sub     rsp, 60h
4270100    call    _mcount
4270105    mov     [rbp-38h], rdi
4270109    mov     [rbp-40h], rsi
4270113    mov     [rbp-48h], rdx
4270117    mov     [rbp-50h], rcx
4270121    mov     [rbp-58h], r8
4270125    cmp     qword [rbp-50h], 0
4270130    jz      loc_41283B
4270132    cmp     qword [rbp-58h], 0
4270137    jnz     loc_412847
loc_41283B:
4270139    mov     dword [rbp-24h], 0FFFFFFFEh
4270146    jmp     loc_4129B8
loc_412847:
4270151    cmp     qword [rbp-38h], 0
4270156    jz      loc_41285C
4270158    cmp     qword [rbp-48h], 0
4270163    jz      loc_41285C
4270165    cmp     qword [rbp-40h], 0
4270170    jnz     loc_41286F
loc_41285C:
4270172    mov     dword [rbp-24h], 0FFFFFFFFh
4270179    mov     rax, [rbp-50h]
4270183    mov     byte [rax], 0
4270186    jmp     loc_4129B8
loc_41286F:
4270191    mov     rax, [rbp-48h]
4270195    mov     rdi, rax
4270198    call    _strlen
4270203    mov     [rbp-10h], rax
4270207    mov     rax, [rbp-40h]
4270211    mov     rdx, [rbp-38h]
4270215    add     rax, rdx
4270218    mov     [rbp-8], rax
4270222    mov     dword [rbp-24h], 0FFFFFFFFh
4270229    mov     rax, [rbp-50h]
4270233    mov     byte [rax], 0
4270236    mov     rax, [rbp-38h]
4270240    mov     [rbp-20h], rax
4270244    jmp     loc_4129A3
loc_4128A9:
4270249    mov     rax, [rbp-20h]
4270253    cmp     rax, [rbp-38h]
4270257    jz      loc_4128C6
4270259    mov     rax, [rbp-20h]
4270263    sub     rax, 1
4270267    movzx   eax, byte [rax]
4270270    cmp     al, 26h
4270272    jnz     loc_41299E
loc_4128C6:
4270278    mov     rax, [rbp-10h]
4270282    mov     rdx, [rbp-20h]
4270286    add     rax, rdx
4270289    movzx   eax, byte [rax]
4270292    cmp     al, 3Dh
4270294    jnz     loc_41299E
4270300    mov     rdx, [rbp-10h]
4270304    mov     rcx, [rbp-20h]
4270308    mov     rax, [rbp-48h]
4270312    mov     rsi, rcx
4270315    mov     rdi, rax
4270318    call    _mg_strncasecmp
4270323    test    eax, eax
4270325    jnz     loc_41299E
4270331    mov     rax, [rbp-10h]
4270335    add     rax, 1
4270339    add     [rbp-20h], rax
4270343    mov     rdx, [rbp-8]
4270347    mov     rax, [rbp-20h]
4270351    sub     rdx, rax
4270354    mov     rax, rdx
4270357    mov     rdx, rax
4270360    mov     rax, [rbp-20h]
4270364    mov     esi, 26h
4270369    mov     rdi, rax
4270372    call    _memchr
4270377    mov     [rbp-18h], rax
4270381    cmp     qword [rbp-18h], 0
4270386    jnz     loc_41293C
4270388    mov     rax, [rbp-8]
4270392    mov     [rbp-18h], rax
loc_41293C:
4270396    mov     rax, [rbp-18h]
4270400    cmp     rax, [rbp-20h]
4270404    jnb     loc_41295F
4270406    mov     ecx, __PRETTY_FUNCTION___7268
4270411    mov     edx, 1387h
4270416    mov     esi, file
4270421    mov     edi, aSP
4270426    call    ___assert_fail
loc_41295F:
4270431    mov     rdx, [rbp-18h]
4270435    mov     rax, [rbp-20h]
4270439    sub     rdx, rax
4270442    mov     rax, rdx
4270445    mov     rsi, rax
4270448    mov     rcx, [rbp-58h]
4270452    mov     rdx, [rbp-50h]
4270456    mov     rax, [rbp-20h]
4270460    mov     r8d, 1
4270466    mov     rdi, rax
4270469    call    _mg_url_decode
4270474    mov     [rbp-24h], eax
4270477    cmp     dword [rbp-24h], 0FFFFFFFFh
4270481    jnz     loc_41299C
4270483    mov     dword [rbp-24h], 0FFFFFFFEh
4270490    jmp     loc_4129B8
loc_41299C:
4270492    jmp     loc_4129B8
loc_41299E:
4270494    add     qword [rbp-20h], 1
loc_4129A3:
4270499    mov     rax, [rbp-10h]
4270503    mov     rdx, [rbp-20h]
4270507    add     rax, rdx
4270510    cmp     rax, [rbp-8]
4270514    jb      loc_4128A9
loc_4129B8:
4270520    mov     eax, [rbp-24h]
4270523    leave   
4270524    retn    
USE32

section .text

global _mg_get_var

_mg_get_var:
4270525    push    rbp
4270526    mov     rbp, rsp
4270529    sub     rsp, 30h
4270533    call    _mcount
4270538    mov     [rbp-18h], rdi
4270542    mov     [rbp-20h], rsi
4270546    mov     [rbp-28h], rdx
4270550    mov     [rbp-30h], rcx
4270554    mov     rax, [rbp-18h]
4270558    mov     rax, [rax+18h]
4270562    test    rax, rax
4270565    jz      loc_4129F9
4270567    mov     rax, [rbp-18h]
4270571    mov     rax, [rax+18h]
4270575    mov     rdi, rax
4270578    call    _strlen
4270583    jmp     loc_4129FE
loc_4129F9:
4270585    mov     eax, 0
loc_4129FE:
4270590    mov     rdx, [rbp-18h]
4270594    mov     rdi, [rdx+18h]
4270598    mov     rsi, [rbp-30h]
4270602    mov     rcx, [rbp-28h]
4270606    mov     rdx, [rbp-20h]
4270610    mov     r8, rsi
4270613    mov     rsi, rax
4270616    call    _get_var
4270621    mov     [rbp-4], eax
4270624    cmp     dword [rbp-4], 0
4270628    jns     loc_412A56
4270630    mov     rax, [rbp-18h]
4270634    mov     rsi, [rax+270h]
4270641    mov     rax, [rbp-18h]
4270645    mov     rax, [rax+268h]
4270652    mov     rdi, [rbp-30h]
4270656    mov     rcx, [rbp-28h]
4270660    mov     rdx, [rbp-20h]
4270664    mov     r8, rdi
4270667    mov     rdi, rax
4270670    call    _get_var
4270675    mov     [rbp-4], eax
loc_412A56:
4270678    mov     eax, [rbp-4]
4270681    leave   
4270682    retn    
USE32

section .text

global _get_line_len

_get_line_len:
4270683    push    rbp
4270684    mov     rbp, rsp
4270687    sub     rsp, 20h
4270691    call    _mcount
4270696    mov     [rbp-18h], rdi
4270700    mov     [rbp-1Ch], esi
4270703    mov     dword [rbp-4], 0
4270710    jmp     loc_412A7C
loc_412A78:
4270712    add     dword [rbp-4], 1
loc_412A7C:
4270716    mov     eax, [rbp-4]
4270719    cmp     eax, [rbp-1Ch]
4270722    jge     loc_412A98
4270724    mov     eax, [rbp-4]
4270727    movsxd  rdx, eax
4270730    mov     rax, [rbp-18h]
4270734    add     rax, rdx
4270737    movzx   eax, byte [rax]
4270740    cmp     al, 0Ah
4270742    jnz     loc_412A78
loc_412A98:
4270744    mov     eax, [rbp-4]
4270747    movsxd  rdx, eax
4270750    mov     rax, [rbp-18h]
4270754    add     rax, rdx
4270757    movzx   eax, byte [rax]
4270760    cmp     al, 0Ah
4270762    jnz     loc_412AB4
4270764    mov     eax, [rbp-4]
4270767    add     eax, 1
4270770    jmp     locret_412AB9
loc_412AB4:
4270772    mov     eax, 0FFFFFFFFh
locret_412AB9:
4270777    leave   
4270778    retn    
USE32

section .text

global _mg_parse_multipart

_mg_parse_multipart:
4270779    push    rbp
4270780    mov     rbp, rsp
4270783    sub     rsp, 50h
4270787    call    _mcount
4270792    mov     [rbp-28h], rdi
4270796    mov     [rbp-2Ch], esi
4270799    mov     [rbp-38h], rdx
4270803    mov     [rbp-30h], ecx
4270806    mov     [rbp-40h], r8
4270810    mov     [rbp-44h], r9d
4270814    mov     dword [rbp-10h], 15h
4270821    cmp     qword [rbp-28h], 0
4270826    jz      loc_412AF2
4270828    cmp     dword [rbp-2Ch], 0
4270832    jg      loc_412AFC
loc_412AF2:
4270834    mov     eax, 0
4270839    jmp     locret_412D0A
loc_412AFC:
4270844    mov     eax, [rbp-2Ch]
4270847    movsxd  rdx, eax
4270850    mov     rax, [rbp-28h]
4270854    mov     rsi, rdx
4270857    mov     rdi, rax
4270860    call    _get_request_len
4270865    mov     [rbp-0Ch], eax
4270868    cmp     dword [rbp-0Ch], 0
4270872    jg      loc_412B24
4270874    mov     eax, 0
4270879    jmp     locret_412D0A
loc_412B24:
4270884    mov     rax, [rbp-28h]
4270888    movzx   eax, byte [rax]
4270891    cmp     al, 2Dh
4270893    jnz     loc_412B4D
4270895    mov     rax, [rbp-28h]
4270899    add     rax, 1
4270903    movzx   eax, byte [rax]
4270906    cmp     al, 2Dh
4270908    jnz     loc_412B4D
4270910    mov     rax, [rbp-28h]
4270914    add     rax, 2
4270918    movzx   eax, byte [rax]
4270921    cmp     al, 0Ah
4270923    jnz     loc_412B57
loc_412B4D:
4270925    mov     eax, 0
4270930    jmp     locret_412D0A
loc_412B57:
4270935    mov     edx, [rbp-2Ch]
4270938    mov     rax, [rbp-28h]
4270942    mov     esi, edx
4270944    mov     rdi, rax
4270947    call    _get_line_len
4270952    mov     [rbp-8], eax
4270955    mov     rax, [rbp-40h]
4270959    mov     byte [rax], 0
4270962    mov     rax, [rbp-40h]
4270966    movzx   edx, byte [rax]
4270969    mov     rax, [rbp-38h]
4270973    mov     [rax], dl
4270975    mov     eax, [rbp-8]
4270978    mov     [rbp-18h], eax
4270981    jmp     loc_412C44
loc_412B8A:
4270986    mov     eax, [rbp-10h]
4270989    cdqe    
4270991    mov     edx, [rbp-18h]
4270994    movsxd  rcx, edx
4270997    mov     rdx, [rbp-28h]
4271001    add     rcx, rdx
4271004    mov     rdx, rax
4271007    mov     rsi, rcx
4271010    mov     edi, cd_7297
4271015    call    _mg_strncasecmp
4271020    test    eax, eax
4271022    jnz     loc_412C3E
4271028    mov     eax, [rbp-30h]
4271031    movsxd  rcx, eax
4271034    mov     eax, 0FFFFFFFEh
4271039    sub     eax, [rbp-10h]
4271042    mov     edx, eax
4271044    mov     eax, [rbp-4]
4271047    add     eax, edx
4271049    cdqe    
4271051    mov     edx, [rbp-18h]
4271054    movsxd  rsi, edx
4271057    mov     edx, [rbp-10h]
4271060    movsxd  rdx, edx
4271063    add     rsi, rdx
4271066    mov     rdx, [rbp-28h]
4271070    lea     rdi, [rsi+rdx]
4271074    mov     rdx, [rbp-38h]
4271078    mov     r8, rcx
4271081    mov     rcx, rdx
4271084    mov     edx, aName
4271089    mov     rsi, rax
4271092    call    _parse_header
4271097    mov     eax, [rbp-44h]
4271100    movsxd  rcx, eax
4271103    mov     eax, 0FFFFFFFEh
4271108    sub     eax, [rbp-10h]
4271111    mov     edx, eax
4271113    mov     eax, [rbp-4]
4271116    add     eax, edx
4271118    cdqe    
4271120    mov     edx, [rbp-18h]
4271123    movsxd  rsi, edx
4271126    mov     edx, [rbp-10h]
4271129    movsxd  rdx, edx
4271132    add     rsi, rdx
4271135    mov     rdx, [rbp-28h]
4271139    lea     rdi, [rsi+rdx]
4271143    mov     rdx, [rbp-40h]
4271147    mov     r8, rcx
4271150    mov     rcx, rdx
4271153    mov     edx, aFilename
4271158    mov     rsi, rax
4271161    call    _parse_header
loc_412C3E:
4271166    mov     eax, [rbp-4]
4271169    add     [rbp-18h], eax
loc_412C44:
4271172    mov     eax, [rbp-18h]
4271175    mov     edx, [rbp-0Ch]
4271178    sub     edx, eax
4271180    mov     eax, [rbp-18h]
4271183    movsxd  rcx, eax
4271186    mov     rax, [rbp-28h]
4271190    add     rax, rcx
4271193    mov     esi, edx
4271195    mov     rdi, rax
4271198    call    _get_line_len
4271203    mov     [rbp-4], eax
4271206    cmp     dword [rbp-4], 0
4271210    jg      loc_412B8A
4271216    mov     eax, [rbp-0Ch]
4271219    mov     [rbp-14h], eax
4271222    jmp     loc_412CF1
loc_412C78:
4271224    mov     eax, [rbp-14h]
4271227    movsxd  rdx, eax
4271230    mov     rax, [rbp-28h]
4271234    add     rax, rdx
4271237    movzx   eax, byte [rax]
4271240    cmp     al, 2Dh
4271242    jnz     loc_412CED
4271244    mov     eax, [rbp-8]
4271247    sub     eax, 2
4271250    movsxd  rdx, eax
4271253    mov     eax, [rbp-14h]
4271256    movsxd  rcx, eax
4271259    mov     rax, [rbp-28h]
4271263    add     rcx, rax
4271266    mov     rax, [rbp-28h]
4271270    mov     rsi, rcx
4271273    mov     rdi, rax
4271276    call    _memcmp
4271281    test    eax, eax
4271283    jnz     loc_412CED
4271285    cmp     qword [rbp+18h], 0
4271290    jz      loc_412CCD
4271292    mov     eax, [rbp-14h]
4271295    sub     eax, 2
4271298    sub     eax, [rbp-0Ch]
4271301    mov     edx, eax
4271303    mov     rax, [rbp+18h]
4271307    mov     [rax], edx
loc_412CCD:
4271309    cmp     qword [rbp+10h], 0
4271314    jz      loc_412CE8
4271316    mov     eax, [rbp-0Ch]
4271319    movsxd  rdx, eax
4271322    mov     rax, [rbp-28h]
4271326    add     rdx, rax
4271329    mov     rax, [rbp+10h]
4271333    mov     [rax], rdx
loc_412CE8:
4271336    mov     eax, [rbp-14h]
4271339    jmp     locret_412D0A
loc_412CED:
4271341    add     dword [rbp-14h], 1
loc_412CF1:
4271345    mov     eax, [rbp-8]
4271348    lea     edx, [rax-2]
4271351    mov     eax, [rbp-14h]
4271354    add     eax, edx
4271356    cmp     eax, [rbp-2Ch]
4271359    jl      loc_412C78
4271365    mov     eax, 0
locret_412D0A:
4271370    leave   
4271371    retn    
USE32

section .text

global _mg_get_valid_option_names

_mg_get_valid_option_names:
4271372    push    rbp
4271373    mov     rbp, rsp
4271376    call    _mcount
4271381    mov     eax, static_config_options
4271386    pop     rbp
4271387    retn    
USE32

section .text

global _mg_copy_listeners

_mg_copy_listeners:
4271388    push    rbp
4271389    mov     rbp, rsp
4271392    sub     rsp, 20h
4271396    call    _mcount
4271401    mov     [rbp-18h], rdi
4271405    mov     [rbp-20h], rsi
4271409    mov     rax, [rbp-18h]
4271413    mov     esi, 0
4271418    mov     rdi, rax
4271421    call    _ns_next
4271426    mov     [rbp-10h], rax
4271430    jmp     loc_412DC2
loc_412D48:
4271432    mov     rax, [rbp-10h]
4271436    mov     eax, [rax+98h]
4271442    and     eax, 80h
4271447    test    eax, eax
4271449    jz      loc_412DAB
4271451    mov     edi, 0A0h
4271456    call    _malloc
4271461    mov     [rbp-8], rax
4271465    cmp     qword [rbp-8], 0
4271470    jz      loc_412DAB
4271472    mov     rcx, [rbp-10h]
4271476    mov     rax, [rbp-8]
4271480    mov     edx, 0A0h
4271485    mov     rsi, rcx
4271488    mov     rdi, rax
4271491    call    _memcpy
4271496    mov     rdx, [rbp-20h]
4271500    mov     rax, [rbp-8]
4271504    mov     [rax+18h], rdx
4271508    mov     rax, [rbp-8]
4271512    mov     rax, [rax+18h]
4271516    mov     rdx, [rbp-8]
4271520    mov     rsi, rdx
4271523    mov     rdi, rax
4271526    call    _ns_add_conn
loc_412DAB:
4271531    mov     rax, [rbp-18h]
4271535    mov     rdx, [rbp-10h]
4271539    mov     rsi, rdx
4271542    mov     rdi, rax
4271545    call    _ns_next
4271550    mov     [rbp-10h], rax
loc_412DC2:
4271554    cmp     qword [rbp-10h], 0
4271559    jnz     loc_412D48
4271565    leave   
4271566    retn    
USE32

section .text

global _get_option_index

_get_option_index:
4271567    push    rbp
4271568    mov     rbp, rsp
4271571    sub     rsp, 20h
4271575    call    _mcount
4271580    mov     [rbp-18h], rdi
4271584    mov     dword [rbp-4], 0
4271591    jmp     loc_412E14
loc_412DE9:
4271593    mov     eax, [rbp-4]
4271596    add     eax, eax
4271598    cdqe    
4271600    mov     rax, qword static_config_options[rax*8]
4271608    mov     rdx, [rbp-18h]
4271612    mov     rsi, rdx
4271615    mov     rdi, rax
4271618    call    _strcmp
4271623    test    eax, eax
4271625    jnz     loc_412E10
4271627    mov     eax, [rbp-4]
4271630    jmp     locret_412E2D
loc_412E10:
4271632    add     dword [rbp-4], 1
loc_412E14:
4271636    mov     eax, [rbp-4]
4271639    add     eax, eax
4271641    cdqe    
4271643    mov     rax, qword static_config_options[rax*8]
4271651    test    rax, rax
4271654    jnz     loc_412DE9
4271656    mov     eax, 0FFFFFFFFh
locret_412E2D:
4271661    leave   
4271662    retn    
USE32

section .text

global _set_default_option_values

_set_default_option_values:
4271663    push    rbp
4271664    mov     rbp, rsp
4271667    push    rbx
4271668    sub     rsp, 38h
4271672    call    _mcount
4271677    mov     [rbp-38h], rdi
4271681    call    _mg_get_valid_option_names
4271686    mov     [rbp-20h], rax
4271690    mov     dword [rbp-24h], 0
4271697    jmp     loc_412EB9
loc_412E53:
4271699    mov     eax, [rbp-24h]
4271702    cdqe    
4271704    shl     rax, 4
4271708    lea     rdx, [rax+8]
4271712    mov     rax, [rbp-20h]
4271716    add     rax, rdx
4271719    mov     rax, [rax]
4271722    mov     [rbp-18h], rax
4271726    mov     eax, [rbp-24h]
4271729    cdqe    
4271731    lea     rdx, 0[rax*8]
4271739    mov     rax, [rbp-38h]
4271743    add     rax, rdx
4271746    mov     rax, [rax]
4271749    test    rax, rax
4271752    jnz     loc_412EB5
4271754    cmp     qword [rbp-18h], 0
4271759    jz      loc_412EB5
4271761    mov     eax, [rbp-24h]
4271764    cdqe    
4271766    lea     rdx, 0[rax*8]
4271774    mov     rax, [rbp-38h]
4271778    lea     rbx, [rdx+rax]
4271782    mov     rax, [rbp-18h]
4271786    mov     rdi, rax
4271789    call    _mg_strdup
4271794    mov     [rbx], rax
loc_412EB5:
4271797    add     dword [rbp-24h], 1
loc_412EB9:
4271801    mov     eax, [rbp-24h]
4271804    cdqe    
4271806    shl     rax, 4
4271810    mov     rdx, rax
4271813    mov     rax, [rbp-20h]
4271817    add     rax, rdx
4271820    mov     rax, [rax]
4271823    test    rax, rax
4271826    jnz     loc_412E53
4271832    add     rsp, 38h
4271836    pop     rbx
4271837    pop     rbp
4271838    retn    
USE32

section .text

global _mg_set_option

_mg_set_option:
4271839    push    rbp
4271840    mov     rbp, rsp
4271843    push    rbx
4271844    sub     rsp, 3C8h
4271851    call    _mcount
4271856    mov     [rbp-398h], rdi
4271863    mov     [rbp-3A0h], rsi
4271870    mov     [rbp-3A8h], rdx
4271877    mov     rax, [fs:28h]
4271886    mov     [rbp-18h], rax
4271890    xor     eax, eax
4271892    mov     rax, [rbp-3A0h]
4271899    mov     rdi, rax
4271902    call    _get_option_index
4271907    mov     [rbp-37Ch], eax
4271913    mov     qword [rbp-378h], 0
4271924    mov     qword [rbp-368h], 0
4271935    cmp     dword [rbp-37Ch], 0
4271942    jns     loc_412F52
4271944    mov     eax, aNoSuchOption
4271949    jmp     loc_413315
loc_412F52:
4271954    mov     eax, [rbp-37Ch]
4271960    cdqe    
4271962    add     rax, 6
4271966    lea     rdx, 0[rax*8]
4271974    mov     rax, [rbp-398h]
4271981    add     rax, rdx
4271984    add     rax, 8
4271988    mov     [rbp-368h], rax
4271995    mov     rax, [rbp-368h]
4272002    mov     rax, [rax]
4272005    test    rax, rax
4272008    jnz     loc_412F94
4272010    cmp     qword [rbp-3A8h], 0
4272018    jz      loc_412FCD
loc_412F94:
4272020    cmp     qword [rbp-3A8h], 0
4272028    jz      loc_412FD7
4272030    mov     rax, [rbp-368h]
4272037    mov     rax, [rax]
4272040    test    rax, rax
4272043    jz      loc_412FD7
4272045    mov     rax, [rbp-368h]
4272052    mov     rdx, [rax]
4272055    mov     rax, [rbp-3A8h]
4272062    mov     rsi, rdx
4272065    mov     rdi, rax
4272068    call    _strcmp
4272073    test    eax, eax
4272075    jnz     loc_412FD7
loc_412FCD:
4272077    mov     eax, 0
4272082    jmp     loc_413315
loc_412FD7:
4272087    mov     rax, [rbp-368h]
4272094    mov     rax, [rax]
4272097    test    rax, rax
4272100    jz      loc_413006
4272102    mov     rax, [rbp-368h]
4272109    mov     rax, [rax]
4272112    mov     rdi, rax
4272115    call    _free
4272120    mov     rax, [rbp-368h]
4272127    mov     qword [rax], 0
loc_413006:
4272134    cmp     qword [rbp-3A8h], 0
4272142    jz      loc_41301E
4272144    mov     rax, [rbp-3A8h]
4272151    movzx   eax, byte [rax]
4272154    test    al, al
4272156    jnz     loc_413028
loc_41301E:
4272158    mov     eax, 0
4272163    jmp     loc_413315
loc_413028:
4272168    mov     rax, [rbp-3A8h]
4272175    mov     rdi, rax
4272178    call    _mg_strdup
4272183    mov     rdx, [rbp-368h]
4272190    mov     [rdx], rax
4272193    cmp     dword [rbp-37Ch], 0Fh
4272200    jnz     loc_413276
4272206    mov     qword [rbp-210h], 0
4272217    lea     rdx, [rbp-208h]
4272224    mov     eax, 0
4272229    mov     ecx, 3Dh
4272234    mov     rdi, rdx
4272237    rep stosq
4272240    mov     rdx, rdi
4272243    mov     [rdx], eax
4272245    add     rdx, 4
4272249    mov     qword [rbp-370h], 0
4272260    jmp     loc_41320F
loc_413089:
4272265    mov     rsi, [rbp-350h]
4272272    mov     rax, [rbp-398h]
4272279    mov     ecx, 0
4272284    mov     edx, mg_ev_handler
4272289    mov     rdi, rax
4272292    call    _ns_bind
4272297    mov     [rbp-360h], rax
4272304    cmp     qword [rbp-360h], 0
4272312    jnz     loc_4130CA
4272314    mov     qword [rbp-378h], aCannotBindToPo
4272325    jmp     loc_413242
loc_4130CA:
4272330    mov     rax, [rbp-350h]
4272337    lea     r8, [rbp-280h]
4272344    lea     rdi, [rbp-2F0h]
4272351    lea     rcx, [rbp-380h]
4272358    lea     rdx, [rbp-384h]
4272365    lea     rsi, [rbp-340h]
4272372    mov     r9, r8
4272375    mov     r8, rdi
4272378    mov     rdi, rax
4272381    call    _ns_parse_address
4272386    mov     rdx, [rbp-348h]
4272393    mov     rax, [rbp-350h]
4272400    mov     esi, 3Ah
4272405    mov     rdi, rax
4272408    call    _memchr
4272413    test    rax, rax
4272416    jnz     loc_413129
4272418    mov     eax, 2
4272423    jmp     loc_41312E
loc_413129:
4272425    mov     eax, 3
loc_41312E:
4272430    mov     rdx, [rbp-360h]
4272437    mov     edi, [rdx+20h]
4272440    lea     rsi, [rbp-330h]
4272447    mov     ecx, eax
4272449    mov     edx, 32h
4272454    call    _ns_sock_to_str
4272459    movzx   eax, byte [rbp-280h]
4272466    test    al, al
4272468    jz      loc_41315D
4272470    mov     ecx, asc_414194
4272475    jmp     loc_413162
loc_41315D:
4272477    mov     ecx, unk_414196
loc_413162:
4272482    movzx   eax, byte [rbp-2F0h]
4272489    test    al, al
4272491    jz      loc_413174
4272493    mov     edx, asc_414194
4272498    jmp     loc_413179
loc_413174:
4272500    mov     edx, unk_414196
loc_413179:
4272505    mov     eax, [rbp-380h]
4272511    test    eax, eax
4272513    jz      loc_41318A
4272515    mov     esi, aSsl
4272520    jmp     loc_41318F
loc_41318A:
4272522    mov     esi, unk_414196
loc_41318F:
4272527    cmp     qword [rbp-370h], 0
4272535    jz      loc_4131A0
4272537    mov     eax, asc_416A71
4272542    jmp     loc_4131A5
loc_4131A0:
4272544    mov     eax, unk_414196
loc_4131A5:
4272549    mov     edi, 1F4h
4272554    sub     rdi, [rbp-370h]
4272561    lea     r9, [rbp-210h]
4272568    mov     r8, [rbp-370h]
4272575    lea     r10, [r9+r8]
4272579    lea     r9, [rbp-330h]
4272586    lea     r8, [rbp-280h]
4272593    mov     [rsp+18h], r8
4272598    mov     [rsp+10h], rcx
4272603    lea     rcx, [rbp-2F0h]
4272610    mov     [rsp+8], rcx
4272615    mov     [rsp], rdx
4272619    mov     r8, rsi
4272622    mov     rcx, rax
4272625    mov     edx, aSSSSSSS
4272630    mov     rsi, rdi
4272633    mov     rdi, r10
4272636    mov     eax, 0
4272641    call    _snprintf
4272646    cdqe    
4272648    add     [rbp-370h], rax
loc_41320F:
4272655    lea     rcx, [rbp-350h]
4272662    mov     rax, [rbp-3A8h]
4272669    mov     edx, 0
4272674    mov     rsi, rcx
4272677    mov     rdi, rax
4272680    call    _next_option
4272685    mov     [rbp-3A8h], rax
4272692    cmp     qword [rbp-3A8h], 0
4272700    jnz     loc_413089
loc_413242:
4272706    mov     byte [rbp-1Dh], 0
4272710    mov     rax, [rbp-368h]
4272717    mov     rax, [rax]
4272720    mov     rdi, rax
4272723    call    _free
4272728    lea     rax, [rbp-210h]
4272735    mov     rdi, rax
4272738    call    _mg_strdup
4272743    mov     rdx, [rbp-368h]
4272750    mov     [rdx], rax
4272753    jmp     loc_41330E
loc_413276:
4272758    cmp     dword [rbp-37Ch], 0Dh
4272765    jnz     loc_413296
4272767    mov     rax, [rbp-368h]
4272774    mov     rdx, [rax]
4272777    mov     rax, [rbp-398h]
4272784    mov     [rax+8], rdx
4272788    jmp     loc_41330E
loc_413296:
4272790    cmp     dword [rbp-37Ch], 10h
4272797    jnz     loc_41330E
4272799    mov     rax, [rbp-3A8h]
4272806    mov     rdi, rax
4272809    call    _getpwnam
4272814    mov     [rbp-358h], rax
4272821    cmp     qword [rbp-358h], 0
4272829    jnz     loc_4132CC
4272831    mov     qword [rbp-378h], aUnknownUser
4272842    jmp     loc_41330E
loc_4132CC:
4272844    mov     rax, [rbp-358h]
4272851    mov     eax, [rax+14h]
4272854    mov     edi, eax
4272856    call    _setgid
4272861    test    eax, eax
4272863    jz      loc_4132EE
4272865    mov     qword [rbp-378h], aSetgidFailed
4272876    jmp     loc_41330E
loc_4132EE:
4272878    mov     rax, [rbp-358h]
4272885    mov     eax, [rax+10h]
4272888    mov     edi, eax
4272890    call    _setuid
4272895    test    eax, eax
4272897    jz      loc_41330E
4272899    mov     qword [rbp-378h], aSetuidFailed
loc_41330E:
4272910    mov     rax, [rbp-378h]
loc_413315:
4272917    mov     rbx, [rbp-18h]
4272921    xor     rbx, [fs:28h]
4272930    jz      loc_413329
4272932    call    ___stack_chk_fail
loc_413329:
4272937    add     rsp, 3C8h
4272944    pop     rbx
4272945    pop     rbp
4272946    retn    
USE32

section .text

global _set_ips

_set_ips:
4272947    push    rbp
4272948    mov     rbp, rsp
4272951    sub     rsp, 90h
4272958    call    _mcount
4272963    mov     [rbp-88h], rdi
4272970    mov     [rbp-8Ch], esi
4272976    mov     rax, [fs:28h]
4272985    mov     [rbp-8], rax
4272989    xor     eax, eax
4272991    mov     rax, [rbp-88h]
4272998    mov     rax, [rax+78h]
4273002    mov     [rbp-80h], rax
4273006    mov     rax, [rbp-80h]
4273010    add     rax, 8
4273014    mov     [rbp-78h], rax
4273018    cmp     dword [rbp-8Ch], 0
4273025    jz      loc_41338A
4273027    mov     eax, 7
4273032    jmp     loc_41338F
loc_41338A:
4273034    mov     eax, 3
loc_41338F:
4273039    mov     rdx, [rbp-88h]
4273046    mov     edi, [rdx+20h]
4273049    lea     rsi, [rbp-70h]
4273053    mov     ecx, eax
4273055    mov     edx, 64h
4273060    call    _ns_sock_to_str
4273065    cmp     dword [rbp-8Ch], 0
4273072    jz      loc_4133BF
4273074    mov     rax, [rbp-78h]
4273078    lea     rdx, [rax+80h]
4273085    jmp     loc_4133CA
loc_4133BF:
4273087    mov     rax, [rbp-78h]
4273091    lea     rdx, [rax+82h]
loc_4133CA:
4273098    cmp     dword [rbp-8Ch], 0
4273105    jz      loc_4133DD
4273107    mov     rax, [rbp-78h]
4273111    add     rax, 20h
4273115    jmp     loc_4133E5
loc_4133DD:
4273117    mov     rax, [rbp-78h]
4273121    add     rax, 50h
loc_4133E5:
4273125    lea     rdi, [rbp-70h]
4273129    mov     rcx, rdx
4273132    mov     rdx, rax
4273135    mov     esi, a47Hu
4273140    mov     eax, 0
4273145    call    ___isoc99_sscanf
4273150    mov     rax, [rbp-8]
4273154    xor     rax, [fs:28h]
4273163    jz      locret_413412
4273165    call    ___stack_chk_fail
locret_413412:
4273170    leave   
4273171    retn    
USE32

section .text

global _on_accept

_on_accept:
4273172    push    rbp
4273173    mov     rbp, rsp
4273176    sub     rsp, 20h
4273180    call    _mcount
4273185    mov     [rbp-18h], rdi
4273189    mov     [rbp-20h], rsi
4273193    mov     rax, [rbp-18h]
4273197    mov     rax, [rax+18h]
4273201    mov     [rbp-10h], rax
4273205    mov     rax, [rbp-20h]
4273209    add     rax, 4
4273213    mov     eax, [rax]
4273215    mov     edi, eax
4273217    call    _ntohl
4273222    mov     edx, eax
4273224    mov     rax, [rbp-10h]
4273228    mov     rax, [rax+38h]
4273232    mov     esi, edx
4273234    mov     rdi, rax
4273237    call    _check_acl
4273242    test    eax, eax
4273244    jz      loc_413478
4273246    mov     esi, 2E8h
4273251    mov     edi, 1
4273256    call    _calloc
4273261    mov     [rbp-8], rax
4273265    cmp     qword [rbp-8], 0
4273270    jnz     loc_413493
loc_413478:
4273272    mov     rax, [rbp-18h]
4273276    mov     eax, [rax+98h]
4273282    or      eax, 10h
4273285    mov     edx, eax
4273287    mov     rax, [rbp-18h]
4273291    mov     [rax+98h], edx
4273297    jmp     locret_4134F2
loc_413493:
4273299    mov     rax, [rbp-18h]
4273303    mov     rdx, [rbp-8]
4273307    mov     [rax+78h], rdx
4273311    mov     rax, [rbp-8]
4273315    mov     rdx, [rbp-18h]
4273319    mov     [rax], rdx
4273322    mov     rax, [rbp-8]
4273326    mov     rdx, [rbp-10h]
4273330    mov     [rax+2A8h], rdx
4273337    mov     rax, [rbp-18h]
4273341    mov     rax, [rax+18h]
4273345    mov     rdx, [rax+18h]
4273349    mov     rax, [rbp-8]
4273353    mov     [rax+290h], rdx
4273360    mov     rax, [rbp-18h]
4273364    mov     esi, 1
4273369    mov     rdi, rax
4273372    call    _set_ips
4273377    mov     rax, [rbp-18h]
4273381    mov     esi, 0
4273386    mov     rdi, rax
4273389    call    _set_ips
locret_4134F2:
4273394    leave   
4273395    retn    
USE32

section .text

global _process_udp

_process_udp:
4273396    push    rbp
4273397    mov     rbp, rsp
4273400    sub     rsp, 310h
4273407    call    _mcount
4273412    mov     [rbp-308h], rdi
4273419    mov     rax, [fs:28h]
4273428    mov     [rbp-8], rax
4273432    xor     eax, eax
4273434    mov     rax, [rbp-308h]
4273441    add     rax, 38h
4273445    mov     [rbp-2F8h], rax
4273452    lea     rax, [rbp-2F0h]
4273459    mov     edx, 2E8h
4273464    mov     esi, 0
4273469    mov     rdi, rax
4273472    call    _memset
4273477    mov     rax, [rbp-308h]
4273484    mov     [rbp-2F0h], rax
4273491    mov     rax, [rbp-308h]
4273498    mov     rax, [rax+18h]
4273502    mov     [rbp-48h], rax
4273506    mov     rax, [rbp-2F8h]
4273513    mov     rcx, [rax+8]
4273517    mov     rax, [rbp-2F8h]
4273524    mov     rax, [rax]
4273527    lea     rdx, [rbp-2F0h]
4273534    add     rdx, 8
4273538    mov     rsi, rcx
4273541    mov     rdi, rax
4273544    call    _parse_http_message
4273549    mov     [rbp-10h], rax
4273553    lea     rax, [rbp-2F0h]
4273560    mov     rdi, rax
4273563    call    _on_recv_data
4273568    mov     rax, [rbp-8]
4273572    xor     rax, [fs:28h]
4273581    jz      locret_4135B4
4273583    call    ___stack_chk_fail
locret_4135B4:
4273588    leave   
4273589    retn    
USE32

section .text

global _mg_ev_handler

_mg_ev_handler:
4273590    push    rbp
4273591    mov     rbp, rsp
4273594    sub     rsp, 30h
4273598    call    _mcount
4273603    mov     [rbp-18h], rdi
4273607    mov     [rbp-1Ch], esi
4273610    mov     [rbp-28h], rdx
4273614    mov     rax, [rbp-18h]
4273618    mov     rax, [rax+78h]
4273622    mov     [rbp-10h], rax
4273626    cmp     dword [rbp-1Ch], 5
4273630    ja      loc_413978
4273636    mov     eax, [rbp-1Ch]
4273639    mov     rax, off_416AC0[rax*8]
4273647    jmp     rax
loc_4135F1:
4273649    mov     rdx, [rbp-28h]
4273653    mov     rax, [rbp-18h]
4273657    mov     rsi, rdx
4273660    mov     rdi, rax
4273663    call    _on_accept
4273668    jmp     locret_41397C
loc_413609:
4273673    mov     rax, [rbp-18h]
4273677    mov     rax, [rax+78h]
4273681    test    rax, rax
4273684    jz      loc_413638
4273686    mov     rax, [rbp-18h]
4273690    mov     esi, 1
4273695    mov     rdi, rax
4273698    call    _set_ips
4273703    mov     rax, [rbp-18h]
4273707    mov     esi, 0
4273712    mov     rdi, rax
4273715    call    _set_ips
loc_413638:
4273720    mov     rax, [rbp-28h]
4273724    mov     edx, [rax]
4273726    mov     rax, [rbp-10h]
4273730    mov     [rax+284h], edx
4273736    mov     rax, [rbp-10h]
4273740    mov     eax, [rax+284h]
4273746    test    eax, eax
4273748    jnz     loc_41367E
4273750    mov     rax, [rbp-18h]
4273754    mov     eax, [rax+98h]
4273760    and     eax, 800000h
4273765    test    eax, eax
4273767    jnz     loc_41369C
4273769    mov     rax, [rbp-10h]
4273773    mov     esi, 65h
4273778    mov     rdi, rax
4273781    call    _call_user
4273786    test    eax, eax
4273788    jnz     loc_41369C
loc_41367E:
4273790    mov     rax, [rbp-18h]
4273794    mov     eax, [rax+98h]
4273800    or      eax, 10h
4273803    mov     edx, eax
4273805    mov     rax, [rbp-18h]
4273809    mov     [rax+98h], edx
4273815    jmp     locret_41397C
loc_41369C:
4273820    jmp     locret_41397C
loc_4136A1:
4273825    cmp     qword [rbp-10h], 0
4273830    jz      loc_4136C9
4273832    mov     rax, [rbp-10h]
4273836    mov     rdx, [rax+2D0h]
4273843    mov     rax, [rbp-28h]
4273847    mov     eax, [rax]
4273849    cdqe    
4273851    add     rdx, rax
4273854    mov     rax, [rbp-10h]
4273858    mov     [rax+2D0h], rdx
loc_4136C9:
4273865    mov     rax, [rbp-18h]
4273869    mov     eax, [rax+98h]
4273875    and     eax, 100h
4273880    test    eax, eax
4273882    jz      loc_4136ED
4273884    mov     rax, [rbp-18h]
4273888    mov     rdi, rax
4273891    call    _process_udp
4273896    jmp     loc_41376F
loc_4136ED:
4273901    mov     rax, [rbp-18h]
4273905    mov     rax, [rax+10h]
4273909    test    rax, rax
4273912    jz      loc_413708
4273914    mov     rax, [rbp-10h]
4273918    mov     rdi, rax
4273921    call    _on_recv_data
4273926    jmp     loc_41376F
loc_413708:
4273928    mov     rax, [rbp-18h]
4273932    mov     eax, [rax+98h]
4273938    and     eax, 400000h
4273943    test    eax, eax
4273945    jz      loc_413729
4273947    mov     rax, [rbp-18h]
4273951    mov     rdi, rax
4273954    call    _on_cgi_data
4273959    jmp     loc_41376F
loc_413729:
4273961    mov     rax, [rbp-18h]
4273965    mov     eax, [rax+98h]
4273971    and     eax, 800000h
4273976    test    eax, eax
4273978    jz      loc_41375E
4273980    cmp     qword [rbp-10h], 0
4273985    jz      loc_41376F
4273987    mov     rax, [rbp-10h]
4273991    mov     rdx, [rax]
4273994    mov     rax, [rbp-18h]
4273998    mov     rsi, rdx
4274001    mov     rdi, rax
4274004    call    _ns_forward
4274009    jmp     locret_41397C
loc_41375E:
4274014    mov     rax, [rbp-10h]
4274018    mov     rdi, rax
4274021    call    _process_response
4274026    jmp     locret_41397C
loc_41376F:
4274031    jmp     locret_41397C
loc_413774:
4274036    mov     rax, [rbp-18h]
4274040    mov     qword [rax+78h], 0
4274048    mov     rax, [rbp-18h]
4274052    mov     eax, [rax+98h]
4274058    and     eax, 0C00000h
4274063    test    eax, eax
4274065    jz      loc_41381B
4274071    cmp     qword [rbp-10h], 0
4274076    jz      loc_413883
4274082    mov     rax, [rbp-10h]
4274086    mov     rax, [rax]
4274089    test    rax, rax
4274092    jz      loc_413883
4274098    mov     rax, [rbp-10h]
4274102    mov     rax, [rax]
4274105    mov     rdx, [rbp-10h]
4274109    mov     rdx, [rdx]
4274112    mov     edx, [rdx+98h]
4274118    and     edx, 0FFFFFFFDh
4274121    mov     [rax+98h], edx
4274127    mov     rax, [rbp-10h]
4274131    mov     rdx, [rax]
4274134    mov     rax, [rbp-10h]
4274138    mov     rax, [rax]
4274141    mov     ecx, [rax+98h]
4274147    mov     rax, [rbp-10h]
4274151    mov     rax, [rax]
4274154    mov     rax, [rax+58h]
4274158    test    rax, rax
4274161    jz      loc_4137FA
4274163    mov     eax, 1
4274168    jmp     loc_4137FF
loc_4137FA:
4274170    mov     eax, 10h
loc_4137FF:
4274175    or      eax, ecx
4274177    mov     [rdx+98h], eax
4274183    mov     rax, [rbp-10h]
4274187    mov     qword [rax+2B0h], 0
4274198    jmp     locret_41397C
loc_41381B:
4274203    cmp     qword [rbp-10h], 0
4274208    jz      loc_413883
4274210    mov     rax, [rbp-10h]
4274214    mov     eax, [rax+2B8h]
4274220    cmp     eax, 5
4274223    jnz     loc_41384A
4274225    mov     rax, [rbp-18h]
4274229    mov     rax, [rax+40h]
4274233    test    rax, rax
4274236    jz      loc_41384A
4274238    mov     rax, [rbp-10h]
4274242    mov     rdi, rax
4274245    call    _call_http_client_handler
loc_41384A:
4274250    mov     rax, [rbp-10h]
4274254    mov     esi, 6Ah
4274259    mov     rdi, rax
4274262    call    _call_user
4274267    mov     rax, [rbp-10h]
4274271    mov     rdi, rax
4274274    call    _close_local_endpoint
4274279    mov     rax, [rbp-10h]
4274283    mov     qword [rax], 0
4274290    mov     rax, [rbp-10h]
4274294    mov     rdi, rax
4274297    call    _free
4274302    jmp     locret_41397C
loc_413883:
4274307    jmp     locret_41397C
loc_413888:
4274312    cmp     qword [rbp-10h], 0
4274317    jz      loc_4138EE
4274319    mov     rax, [rbp-10h]
4274323    mov     esi, 64h
4274328    mov     rdi, rax
4274331    call    _call_user
4274336    cmp     eax, 1
4274339    jnz     loc_4138D3
4274341    mov     rax, [rbp-10h]
4274345    mov     rax, [rax]
4274348    mov     eax, [rax+98h]
4274354    and     eax, 100000h
4274359    test    eax, eax
4274361    jz      loc_4138C7
4274363    mov     rax, [rbp-10h]
4274367    mov     rdi, rax
4274370    call    _write_terminating_chunk
loc_4138C7:
4274375    mov     rax, [rbp-10h]
4274379    mov     rdi, rax
4274382    call    _close_local_endpoint
loc_4138D3:
4274387    mov     rax, [rbp-10h]
4274391    mov     eax, [rax+2B8h]
4274397    cmp     eax, 1
4274400    jnz     loc_4138EE
4274402    mov     rax, [rbp-10h]
4274406    mov     rdi, rax
4274409    call    _transfer_file_data
loc_4138EE:
4274414    mov     rax, [rbp-28h]
4274418    mov     rax, [rax]
4274421    mov     [rbp-8], rax
4274425    cmp     qword [rbp-10h], 0
4274430    jz      loc_413921
4274432    mov     rax, [rbp-10h]
4274436    mov     eax, [rax+280h]
4274442    test    eax, eax
4274444    jz      loc_413921
4274446    mov     rdx, [rbp-8]
4274450    mov     rax, [rbp-10h]
4274454    mov     rsi, rdx
4274457    mov     rdi, rax
4274460    call    _ping_idle_websocket_connection
loc_413921:
4274465    mov     rax, [rbp-18h]
4274469    mov     rax, [rax+10h]
4274473    test    rax, rax
4274476    jz      loc_413976
4274478    mov     rax, [rbp-18h]
4274482    mov     rax, [rax+88h]
4274489    add     rax, 12Ch
4274495    cmp     rax, [rbp-8]
4274499    jge     loc_413976
4274501    mov     rax, [rbp-18h]
4274505    mov     edx, 0
4274510    mov     esi, 5
4274515    mov     rdi, rax
4274518    call    _mg_ev_handler
4274523    mov     rax, [rbp-18h]
4274527    mov     eax, [rax+98h]
4274533    or      eax, 10h
4274536    mov     edx, eax
4274538    mov     rax, [rbp-18h]
4274542    mov     [rax+98h], edx
4274548    jmp     locret_41397C
loc_413976:
4274550    jmp     locret_41397C
loc_413978:
4274552    nop     
4274553    jmp     locret_41397C
locret_41397C:
4274556    leave   
4274557    retn    
USE32

section .text

global _iter2

_iter2:
4274558    push    rbp
4274559    mov     rbp, rsp
4274562    sub     rsp, 40h
4274566    call    _mcount
4274571    mov     [rbp-28h], rdi
4274575    mov     [rbp-2Ch], esi
4274578    mov     [rbp-38h], rdx
4274582    mov     qword [rbp-18h], 0
4274590    mov     rax, [rbp-28h]
4274594    mov     rax, [rax+78h]
4274598    mov     [rbp-10h], rax
4274602    mov     rax, [rbp-38h]
4274606    mov     [rbp-8], rax
4274610    lea     rcx, [rbp-1Ch]
4274614    lea     rdx, [rbp-18h]
4274618    mov     rax, [rbp-8]
4274622    mov     esi, aPN
4274627    mov     rdi, rax
4274630    mov     eax, 0
4274635    call    ___isoc99_sscanf
4274640    test    eax, eax
4274642    jz      locret_413A12
4274644    mov     rax, [rbp-18h]
4274648    test    rax, rax
4274651    jz      locret_413A12
4274653    cmp     qword [rbp-10h], 0
4274658    jz      locret_413A12
4274660    mov     eax, [rbp-1Ch]
4274663    movsxd  rdx, eax
4274666    mov     rax, [rbp-8]
4274670    add     rdx, rax
4274673    mov     rax, [rbp-10h]
4274677    mov     [rax+2A0h], rdx
4274684    mov     rax, [rbp-18h]
4274688    mov     rdx, [rbp-10h]
4274692    add     rdx, 8
4274696    mov     esi, 64h
4274701    mov     rdi, rdx
4274704    call    rax
locret_413A12:
4274706    leave   
4274707    retn    
USE32

section .text

global _mg_wakeup_server_ex

_mg_wakeup_server_ex:
4274708    push    rbp
4274709    mov     rbp, rsp
4274712    sub     rsp, 2100h
4274719    call    _mcount
4274724    mov     [rbp-20E8h], rdi
4274731    mov     [rbp-20F0h], rsi
4274738    mov     [rbp-98h], rcx
4274745    mov     [rbp-90h], r8
4274752    mov     [rbp-88h], r9
4274759    test    al, al
4274761    jz      loc_413A6B
4274763    movaps  xmmword [rbp-80h], xmm0
4274767    movaps  xmmword [rbp-70h], xmm1
4274771    movaps  xmmword [rbp-60h], xmm2
4274775    movaps  xmmword [rbp-50h], xmm3
4274779    movaps  xmmword [rbp-40h], xmm4
4274783    movaps  xmmword [rbp-30h], xmm5
4274787    movaps  xmmword [rbp-20h], xmm6
4274791    movaps  xmmword [rbp-10h], xmm7
loc_413A6B:
4274795    mov     [rbp-20F8h], rdx
4274802    mov     rax, [fs:28h]
4274811    mov     [rbp-0B8h], rax
4274818    xor     eax, eax
4274820    mov     rdx, [rbp-20F0h]
4274827    lea     rax, [rbp-20C0h]
4274834    mov     rcx, rdx
4274837    mov     edx, aP
4274842    mov     esi, 2000h
4274847    mov     rdi, rax
4274850    mov     eax, 0
4274855    call    _snprintf
4274860    mov     [rbp-20DCh], eax
4274866    mov     dword [rbp-20D8h], 18h
4274876    mov     dword [rbp-20D4h], 30h
4274886    lea     rax, [rbp+10h]
4274890    mov     [rbp-20D0h], rax
4274897    lea     rax, [rbp-0B0h]
4274904    mov     [rbp-20C8h], rax
4274911    mov     eax, [rbp-20DCh]
4274917    cdqe    
4274919    mov     edx, 2000h
4274924    mov     rsi, rdx
4274927    sub     rsi, rax
4274930    mov     eax, [rbp-20DCh]
4274936    cdqe    
4274938    lea     rdx, [rbp-20C0h]
4274945    lea     rdi, [rdx+rax]
4274949    lea     rdx, [rbp-20D8h]
4274956    mov     rax, [rbp-20F8h]
4274963    mov     rcx, rdx
4274966    mov     rdx, rax
4274969    call    _vsnprintf
4274974    add     [rbp-20DCh], eax
4274980    mov     eax, [rbp-20DCh]
4274986    add     eax, 1
4274989    movsxd  rcx, eax
4274992    mov     rax, [rbp-20E8h]
4274999    lea     rdx, [rbp-20C0h]
4275006    mov     esi, iter2
4275011    mov     rdi, rax
4275014    call    _ns_broadcast
4275019    mov     rax, [rbp-0B8h]
4275026    xor     rax, [fs:28h]
4275035    jz      locret_413B62
4275037    call    ___stack_chk_fail
locret_413B62:
4275042    leave   
4275043    retn    
USE32

section .text

global _mg_wakeup_server

_mg_wakeup_server:
4275044    push    rbp
4275045    mov     rbp, rsp
4275048    sub     rsp, 10h
4275052    call    _mcount
4275057    mov     [rbp-8], rdi
4275061    mov     rax, [rbp-8]
4275065    mov     ecx, 0
4275070    mov     edx, unk_414196
4275075    mov     esi, 0
4275080    mov     rdi, rax
4275083    call    _ns_broadcast
4275088    leave   
4275089    retn    
USE32

section .text

global _mg_get_option

_mg_get_option:
4275090    push    rbp
4275091    mov     rbp, rsp
4275094    sub     rsp, 20h
4275098    call    _mcount
4275103    mov     [rbp-18h], rdi
4275107    mov     [rbp-20h], rsi
4275111    mov     rax, [rbp-18h]
4275115    add     rax, 38h
4275119    mov     [rbp-8], rax
4275123    mov     rax, [rbp-20h]
4275127    mov     rdi, rax
4275130    call    _get_option_index
4275135    mov     [rbp-0Ch], eax
4275138    cmp     dword [rbp-0Ch], 0FFFFFFFFh
4275142    jz      loc_413C04
4275144    mov     eax, [rbp-0Ch]
4275147    cdqe    
4275149    lea     rdx, 0[rax*8]
4275157    mov     rax, [rbp-8]
4275161    add     rax, rdx
4275164    mov     rax, [rax]
4275167    test    rax, rax
4275170    jz      loc_413BFD
4275172    mov     eax, [rbp-0Ch]
4275175    cdqe    
4275177    lea     rdx, 0[rax*8]
4275185    mov     rax, [rbp-8]
4275189    add     rax, rdx
4275192    mov     rax, [rax]
4275195    jmp     locret_413C09
loc_413BFD:
4275197    mov     eax, unk_414196
4275202    jmp     locret_413C09
loc_413C04:
4275204    mov     eax, 0
locret_413C09:
4275209    leave   
4275210    retn    
USE32

section .text

global _mg_create_server

_mg_create_server:
4275211    push    rbp
4275212    mov     rbp, rsp
4275215    sub     rsp, 20h
4275219    call    _mcount
4275224    mov     [rbp-18h], rdi
4275228    mov     [rbp-20h], rsi
4275232    mov     esi, 0D0h
4275237    mov     edi, 1
4275242    call    _calloc
4275247    mov     [rbp-8], rax
4275251    mov     rax, [rbp-8]
4275255    mov     rdx, [rbp-18h]
4275259    mov     rsi, rdx
4275262    mov     rdi, rax
4275265    call    _ns_mgr_init
4275270    mov     rax, [rbp-8]
4275274    add     rax, 38h
4275278    mov     rdi, rax
4275281    call    _set_default_option_values
4275286    mov     rax, [rbp-8]
4275290    mov     rdx, [rbp-20h]
4275294    mov     [rax+30h], rdx
4275298    mov     rax, [rbp-8]
4275302    leave   
4275303    retn    
USE32

section .text

global ___libc_csu_init

___libc_csu_init:
4275312    push    r15
4275314    mov     r15d, edi
4275317    push    r14
4275319    mov     r14, rsi
4275322    push    r13
4275324    mov     r13, rdx
4275327    push    r12
4275329    lea     r12, [__frame_dummy_init_array_entry]
4275336    push    rbp
4275337    lea     rbp, [__do_global_dtors_aux_fini_array_entry]
4275344    push    rbx
4275345    sub     rbp, r12
4275348    xor     ebx, ebx
4275350    sar     rbp, 3
4275354    sub     rsp, 8
4275358    call    _init_proc
4275363    test    rbp, rbp
4275366    jz      loc_413CC6
4275368    nop     dword [rax+rax+00000000h]
loc_413CB0:
4275376    mov     rdx, r13
4275379    mov     rsi, r14
4275382    mov     edi, r15d
4275385    call    qword [r12+rbx*8]
4275389    add     rbx, 1
4275393    cmp     rbx, rbp
4275396    jnz     loc_413CB0
loc_413CC6:
4275398    add     rsp, 8
4275402    pop     rbx
4275403    pop     rbp
4275404    pop     r12
4275406    pop     r13
4275408    pop     r14
4275410    pop     r15
4275412    retn    
