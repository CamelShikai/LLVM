/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is false */

#line 139 "/usr/include/bits/types.h"
typedef long __time_t;
#line 141 "/usr/include/bits/types.h"
typedef long __suseconds_t;
#line 172 "/usr/include/bits/types.h"
typedef long __ssize_t;
#line 30 "/usr/include/bits/time.h"
struct timeval {
   __time_t tv_sec ;
   __suseconds_t tv_usec ;
};
#line 54 "/usr/include/sys/select.h"
typedef long __fd_mask;
#line 64 "/usr/include/sys/select.h"
struct __anonstruct_fd_set_3 {
   __fd_mask __fds_bits[1024 / (8 * (int )sizeof(__fd_mask ))] ;
};
#line 64 "/usr/include/sys/select.h"
typedef struct __anonstruct_fd_set_3 fd_set;
#line 216 "/usr/lib/gcc/x86_64-redhat-linux/5.1.1/include/stddef.h"
typedef unsigned long size_t;
#line 109 "/usr/include/sys/types.h"
typedef __ssize_t ssize_t;
#line 12 "telnet_session.h"
struct __anonstruct_telnet_session_t_17 {
   int in_fd ;
   int in_errno ;
   int in_eof ;
   int in_take ;
   int in_add ;
   char in_buf[2048] ;
   int in_buflen ;
   int in_status ;
   int out_fd ;
   int out_errno ;
   int out_eof ;
   int out_take ;
   int out_add ;
   char out_buf[2048] ;
   int out_buflen ;
};
#line 12 "telnet_session.h"
typedef struct __anonstruct_telnet_session_t_17 telnet_session_t;
#line 106 "/usr/include/sys/select.h"
extern int select(int __nfds , fd_set * __restrict  __readfds , fd_set * __restrict  __writefds ,
                  fd_set * __restrict  __exceptfds , struct timeval * __restrict  __timeout ) ;
#line 353 "/usr/include/unistd.h"
extern int close(int __fd ) ;
#line 360
extern ssize_t read(int __fd , void *__buf , size_t __nbytes ) ;
#line 366
extern ssize_t write(int __fd , void const   *__buf , size_t __n ) ;
#line 50 "/usr/include/bits/errno.h"
extern  __attribute__((__nothrow__)) int *( __attribute__((__leaf__)) __errno_location)(void)  __attribute__((__const__)) ;
#line 398 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__nonnull__(1), __leaf__)) strlen)(char const   *__s )  __attribute__((__pure__)) ;
#line 10 "daemon_assert.h"
extern void daemon_assert_fail(char const   *assertion , char const   *file , int line ,
                               char const   *function ) ;
#line 33 "telnet_session.h"
void telnet_session_init(telnet_session_t *t , int in , int out ) ;
#line 34
int telnet_session_print(telnet_session_t *t , char const   *s ) ;
#line 35
int telnet_session_println(telnet_session_t *t , char const   *s ) ;
#line 36
int telnet_session_readln(telnet_session_t *t , char *buf , int buflen ) ;
#line 37
void telnet_session_destroy(telnet_session_t *t ) ;
#line 53 "telnet_session.c"
static int invariant(telnet_session_t const   *t ) ;
#line 54
static void process_data(telnet_session_t *t , int wait_flag ) ;
#line 55
static void read_incoming_data(telnet_session_t *t ) ;
#line 56
static void process_incoming_char(telnet_session_t *t , int c ) ;
#line 57
static void add_incoming_char(telnet_session_t *t , int c ) ;
#line 58
static int use_incoming_char(telnet_session_t *t ) ;
#line 59
static void write_outgoing_data(telnet_session_t *t ) ;
#line 60
static void add_outgoing_char(telnet_session_t *t , int c ) ;
#line 61
static int max_input_read(telnet_session_t *t ) ;
void read_incoming_data_cil_lr_1(telnet_session_t *t , size_t read_ret , char buf[2048] ,
                                 size_t i ) ;
#line 64 "telnet_session.c"
void telnet_session_init(telnet_session_t *t , int in , int out ) 
{ 
  int tmp_ssa_1 ;
  int tmp___0_ssa_1 ;
  int tmp___1_ssa_1 ;
  int __cil_tmp10 ;
  int __cil_tmp11 ;
  int __cil_tmp12 ;
  unsigned char *__cil_tmp13 ;
  int *__cil_tmp14 ;
  unsigned char *__cil_tmp15 ;
  int *__cil_tmp16 ;
  unsigned char *__cil_tmp17 ;
  int *__cil_tmp18 ;
  unsigned char *__cil_tmp19 ;
  int *__cil_tmp20 ;
  unsigned char *__cil_tmp21 ;
  int *__cil_tmp22 ;
  unsigned char *__cil_tmp23 ;
  int *__cil_tmp24 ;
  unsigned char *__cil_tmp25 ;
  int *__cil_tmp26 ;
  unsigned char *__cil_tmp27 ;
  int *__cil_tmp28 ;
  unsigned char *__cil_tmp29 ;
  int *__cil_tmp30 ;
  unsigned char *__cil_tmp31 ;
  int *__cil_tmp32 ;
  unsigned char *__cil_tmp33 ;
  int *__cil_tmp34 ;
  unsigned char *__cil_tmp35 ;
  int *__cil_tmp36 ;

  {
  {
#line 66
  __cil_tmp10 = (unsigned long )t != (unsigned long )((void *)0);
#line 66
  if (! __cil_tmp10) {
    {
#line 66
    daemon_assert_fail("t != ((void *)0)", "telnet_session.c", 66, "telnet_session_init");
    }
  }
  }
  {
#line 67
  __cil_tmp11 = in >= 0;
#line 67
  if (! __cil_tmp11) {
    {
#line 67
    daemon_assert_fail("in >= 0", "telnet_session.c", 67, "telnet_session_init");
    }
  }
  }
  {
#line 68
  __cil_tmp12 = out >= 0;
#line 68
  if (! __cil_tmp12) {
    {
#line 68
    daemon_assert_fail("out >= 0", "telnet_session.c", 68, "telnet_session_init");
    }
  }
  }
  {
#line 70
  *((int *)t) = in;
#line 71
  __cil_tmp13 = (unsigned char *)t + 4;
#line 71
  __cil_tmp14 = (int *)__cil_tmp13;
#line 71
  *__cil_tmp14 = 0;
#line 72
  __cil_tmp15 = (unsigned char *)t + 8;
#line 72
  __cil_tmp16 = (int *)__cil_tmp15;
#line 72
  *__cil_tmp16 = 0;
#line 73
  tmp_ssa_1 = 0;
#line 73
  __cil_tmp17 = (unsigned char *)t + 16;
#line 73
  __cil_tmp18 = (int *)__cil_tmp17;
#line 73
  *__cil_tmp18 = tmp_ssa_1;
#line 73
  __cil_tmp19 = (unsigned char *)t + 12;
#line 73
  __cil_tmp20 = (int *)__cil_tmp19;
#line 73
  *__cil_tmp20 = tmp_ssa_1;
#line 74
  __cil_tmp21 = (unsigned char *)t + 2068;
#line 74
  __cil_tmp22 = (int *)__cil_tmp21;
#line 74
  *__cil_tmp22 = 0;
#line 76
  __cil_tmp23 = (unsigned char *)t + 2072;
#line 76
  __cil_tmp24 = (int *)__cil_tmp23;
#line 76
  *__cil_tmp24 = 0;
#line 78
  __cil_tmp25 = (unsigned char *)t + 2076;
#line 78
  __cil_tmp26 = (int *)__cil_tmp25;
#line 78
  *__cil_tmp26 = out;
#line 79
  __cil_tmp27 = (unsigned char *)t + 2080;
#line 79
  __cil_tmp28 = (int *)__cil_tmp27;
#line 79
  *__cil_tmp28 = 0;
#line 80
  __cil_tmp29 = (unsigned char *)t + 2084;
#line 80
  __cil_tmp30 = (int *)__cil_tmp29;
#line 80
  *__cil_tmp30 = 0;
#line 81
  tmp___0_ssa_1 = 0;
#line 81
  __cil_tmp31 = (unsigned char *)t + 2092;
#line 81
  __cil_tmp32 = (int *)__cil_tmp31;
#line 81
  *__cil_tmp32 = tmp___0_ssa_1;
#line 81
  __cil_tmp33 = (unsigned char *)t + 2088;
#line 81
  __cil_tmp34 = (int *)__cil_tmp33;
#line 81
  *__cil_tmp34 = tmp___0_ssa_1;
#line 82
  __cil_tmp35 = (unsigned char *)t + 4144;
#line 82
  __cil_tmp36 = (int *)__cil_tmp35;
#line 82
  *__cil_tmp36 = 0;
#line 84
  process_data(t, 0);
#line 86
  tmp___1_ssa_1 = invariant((telnet_session_t const   *)t);
  }
#line 86
  if (! tmp___1_ssa_1) {
    {
#line 86
    daemon_assert_fail("invariant(t)", "telnet_session.c", 86, "telnet_session_init");
    }
  }
#line 87
  return;
}
}
#line 90 "telnet_session.c"
int telnet_session_print(telnet_session_t *t , char const   *s ) 
{ 
  int len ;
  int amt_printed ;
  int tmp ;
  size_t tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  int tmp___4 ;

  {
#line 95
  tmp = invariant((telnet_session_t const   *)t);
#line 95
  if (! tmp) {
#line 95
    daemon_assert_fail("invariant(t)", "telnet_session.c", 95, "telnet_session_print");
  }
#line 97
  tmp___0 = strlen(s);
#line 97
  len = (int )tmp___0;
#line 98
  if (len == 0) {
#line 99
    tmp___1 = invariant((telnet_session_t const   *)t);
#line 99
    if (! tmp___1) {
#line 99
      daemon_assert_fail("invariant(t)", "telnet_session.c", 99, "telnet_session_print");
    }
#line 100
    return (1);
  }
#line 103
  amt_printed = 0;
#line 104
  while (1) {
#line 105
    if (t->out_errno != 0) {
#line 105
      goto _L;
    } else
#line 105
    if (t->out_eof != 0) {
      _L: /* CIL Label */ 
#line 106
      tmp___2 = invariant((telnet_session_t const   *)t);
#line 106
      if (! tmp___2) {
#line 106
        daemon_assert_fail("invariant(t)", "telnet_session.c", 106, "telnet_session_print");
      }
#line 107
      return (0);
    }
#line 109
    while (1) {
#line 109
      if (amt_printed < len) {
#line 109
        if (! (t->out_buflen < 2048)) {
#line 109
          break;
        }
      } else {
#line 109
        break;
      }
#line 111
      if (! ((int const   )*(s + amt_printed) != 0)) {
#line 111
        daemon_assert_fail("s[amt_printed] != \'\\0\'", "telnet_session.c", 111, "telnet_session_print");
      }
#line 112
      add_outgoing_char(t, (int )*(s + amt_printed));
#line 113
      amt_printed ++;
    }
#line 115
    process_data(t, 1);
#line 104
    if (! (amt_printed < len)) {
#line 104
      break;
    }
  }
#line 118
  while (t->out_buflen > 0) {
#line 119
    if (t->out_errno != 0) {
#line 119
      goto _L___0;
    } else
#line 119
    if (t->out_eof != 0) {
      _L___0: /* CIL Label */ 
#line 120
      tmp___3 = invariant((telnet_session_t const   *)t);
#line 120
      if (! tmp___3) {
#line 120
        daemon_assert_fail("invariant(t)", "telnet_session.c", 120, "telnet_session_print");
      }
#line 121
      return (0);
    }
#line 123
    process_data(t, 1);
  }
#line 126
  tmp___4 = invariant((telnet_session_t const   *)t);
#line 126
  if (! tmp___4) {
#line 126
    daemon_assert_fail("invariant(t)", "telnet_session.c", 126, "telnet_session_print");
  }
#line 127
  return (1);
}
}
#line 131 "telnet_session.c"
int telnet_session_println(telnet_session_t *t , char const   *s ) 
{ 
  int tmp_ssa_1 ;
  int tmp___1_ssa_1 ;
  int tmp___3_ssa_1 ;
  int tmp___4_ssa_1 ;
  int tmp___2_ssa_1 ;
  int tmp___0_ssa_1 ;

  {
  {
#line 133
  tmp_ssa_1 = invariant((telnet_session_t const   *)t);
  }
#line 133
  if (! tmp_ssa_1) {
    {
#line 133
    daemon_assert_fail("invariant(t)", "telnet_session.c", 133, "telnet_session_println");
    }
  }
  {
#line 134
  tmp___1_ssa_1 = telnet_session_print(t, s);
  }
#line 134
  if (tmp___1_ssa_1) {
    {
#line 138
    tmp___3_ssa_1 = telnet_session_print(t, "\r\n");
    }
#line 138
    if (tmp___3_ssa_1) {
      {
#line 142
      tmp___4_ssa_1 = invariant((telnet_session_t const   *)t);
      }
#line 142
      if (! tmp___4_ssa_1) {
        {
#line 142
        daemon_assert_fail("invariant(t)", "telnet_session.c", 142, "telnet_session_println");
        }
      }
#line 143
      return (1);
    } else {
      {
#line 139
      tmp___2_ssa_1 = invariant((telnet_session_t const   *)t);
      }
#line 139
      if (! tmp___2_ssa_1) {
        {
#line 139
        daemon_assert_fail("invariant(t)", "telnet_session.c", 139, "telnet_session_println");
        }
      }
#line 140
      return (0);
    }
#line 143
    return (1);
  } else {
    {
#line 135
    tmp___0_ssa_1 = invariant((telnet_session_t const   *)t);
    }
#line 135
    if (! tmp___0_ssa_1) {
      {
#line 135
      daemon_assert_fail("invariant(t)", "telnet_session.c", 135, "telnet_session_println");
      }
    }
#line 136
    return (0);
  }
#line 143
  return (1);
}
}
#line 147 "telnet_session.c"
int telnet_session_readln(telnet_session_t *t , char *buf , int buflen ) 
{ 
  int amt_read ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;

  {
#line 151
  tmp = invariant((telnet_session_t const   *)t);
#line 151
  if (! tmp) {
#line 151
    daemon_assert_fail("invariant(t)", "telnet_session.c", 151, "telnet_session_readln");
  }
#line 152
  amt_read = 0;
#line 153
  while (1) {
#line 154
    if (t->in_errno != 0) {
#line 154
      goto _L;
    } else
#line 154
    if (t->in_eof != 0) {
      _L: /* CIL Label */ 
#line 155
      tmp___0 = invariant((telnet_session_t const   *)t);
#line 155
      if (! tmp___0) {
#line 155
        daemon_assert_fail("invariant(t)", "telnet_session.c", 155, "telnet_session_readln");
      }
#line 156
      return (0);
    }
#line 158
    while (t->in_buflen > 0) {
#line 159
      if (amt_read == buflen - 1) {
#line 160
        *(buf + amt_read) = (char )'\000';
#line 161
        tmp___1 = invariant((telnet_session_t const   *)t);
#line 161
        if (! tmp___1) {
#line 161
          daemon_assert_fail("invariant(t)", "telnet_session.c", 161, "telnet_session_readln");
        }
#line 162
        return (1);
      }
#line 164
      if (! (amt_read >= 0)) {
#line 164
        daemon_assert_fail("amt_read >= 0", "telnet_session.c", 164, "telnet_session_readln");
      }
#line 165
      if (! (amt_read < buflen)) {
#line 165
        daemon_assert_fail("amt_read < buflen", "telnet_session.c", 165, "telnet_session_readln");
      }
#line 166
      tmp___2 = use_incoming_char(t);
#line 166
      *(buf + amt_read) = (char )tmp___2;
#line 167
      if ((int )*(buf + amt_read) == 10) {
#line 168
        if (! (amt_read + 1 >= 0)) {
#line 168
          daemon_assert_fail("amt_read+1 >= 0", "telnet_session.c", 168, "telnet_session_readln");
        }
#line 169
        if (! (amt_read + 1 < buflen)) {
#line 169
          daemon_assert_fail("amt_read+1 < buflen", "telnet_session.c", 169, "telnet_session_readln");
        }
#line 170
        *(buf + (amt_read + 1)) = (char )'\000';
#line 171
        tmp___3 = invariant((telnet_session_t const   *)t);
#line 171
        if (! tmp___3) {
#line 171
          daemon_assert_fail("invariant(t)", "telnet_session.c", 171, "telnet_session_readln");
        }
#line 172
        return (1);
      }
#line 174
      amt_read ++;
    }
#line 176
    process_data(t, 1);
  }
}
}
#line 180 "telnet_session.c"
void telnet_session_destroy(telnet_session_t *t ) 
{ 
  int tmp_ssa_1 ;
  int __cil_tmp4 ;
  int __cil_tmp5 ;
  unsigned char *__cil_tmp6 ;
  int *__cil_tmp7 ;
  int __cil_tmp8 ;
  int __cil_tmp9 ;
  unsigned char *__cil_tmp10 ;
  int *__cil_tmp11 ;
  int __cil_tmp12 ;
  unsigned char *__cil_tmp13 ;
  int *__cil_tmp14 ;

  {
  {
#line 182
  tmp_ssa_1 = invariant((telnet_session_t const   *)t);
  }
#line 182
  if (! tmp_ssa_1) {
    {
#line 182
    daemon_assert_fail("invariant(t)", "telnet_session.c", 182, "telnet_session_destroy");
    }
  }
  {
#line 184
  __cil_tmp5 = *((int *)t);
#line 184
  close(__cil_tmp5);
  }
  {
#line 185
  __cil_tmp6 = (unsigned char *)t + 2076;
#line 185
  __cil_tmp7 = (int *)__cil_tmp6;
#line 185
  __cil_tmp8 = *__cil_tmp7;
#line 185
  __cil_tmp9 = *((int *)t);
#line 185
  __cil_tmp4 = __cil_tmp8 != __cil_tmp9;
#line 185
  if (__cil_tmp4) {
    {
#line 186
    __cil_tmp10 = (unsigned char *)t + 2076;
#line 186
    __cil_tmp11 = (int *)__cil_tmp10;
#line 186
    __cil_tmp12 = *__cil_tmp11;
#line 186
    close(__cil_tmp12);
    }
  } else {

  }
  }
  {
#line 188
  *((int *)t) = -1;
#line 189
  __cil_tmp13 = (unsigned char *)t + 2076;
#line 189
  __cil_tmp14 = (int *)__cil_tmp13;
#line 189
  *__cil_tmp14 = -1;
  }
#line 190
  return;
}
}
#line 193 "telnet_session.c"
static void process_data(telnet_session_t *t , int wait_flag ) 
{ 
  fd_set readfds ;
  fd_set writefds ;
  fd_set exceptfds ;
  struct timeval tv_zero ;
  struct timeval *tv ;
  int __d0 ;
  int __d1 ;
  int __d0___0 ;
  int __d1___0 ;
  int __d0___1 ;
  int __d1___1 ;
  int tmp ;
  int tmp___0 ;

  {
#line 202
  while (1) {
#line 202
    __asm__  volatile   ("cld; rep; "
                         "stosq": "=c" (__d0), "=D" (__d1): "a" (0), "0" (sizeof(fd_set ) / sizeof(__fd_mask )),
                         "1" (& readfds.__fds_bits[0]): "memory");
#line 202
    break;
  }
#line 203
  while (1) {
#line 203
    __asm__  volatile   ("cld; rep; "
                         "stosq": "=c" (__d0___0), "=D" (__d1___0): "a" (0), "0" (sizeof(fd_set ) / sizeof(__fd_mask )),
                         "1" (& writefds.__fds_bits[0]): "memory");
#line 203
    break;
  }
#line 204
  while (1) {
#line 204
    __asm__  volatile   ("cld; rep; "
                         "stosq": "=c" (__d0___1), "=D" (__d1___1): "a" (0), "0" (sizeof(fd_set ) / sizeof(__fd_mask )),
                         "1" (& exceptfds.__fds_bits[0]): "memory");
#line 204
    break;
  }
#line 205
  if (wait_flag) {
#line 206
    tv = (struct timeval *)((void *)0);
  } else {
#line 208
    tv_zero.tv_sec = (__time_t )0;
#line 209
    tv_zero.tv_usec = (__suseconds_t )0;
#line 210
    tv = & tv_zero;
  }
#line 214
  if (t->in_errno == 0) {
#line 214
    if (t->in_eof == 0) {
#line 214
      tmp = max_input_read(t);
#line 214
      if (tmp > 0) {
#line 218
        readfds.__fds_bits[t->in_fd / (8 * (int )sizeof(__fd_mask ))] |= (__fd_mask )(1UL << t->in_fd % (8 * (int )sizeof(__fd_mask )));
#line 219
        exceptfds.__fds_bits[t->in_fd / (8 * (int )sizeof(__fd_mask ))] |= (__fd_mask )(1UL << t->in_fd % (8 * (int )sizeof(__fd_mask )));
      }
    }
  }
#line 223
  if (t->out_errno == 0) {
#line 223
    if (t->out_eof == 0) {
#line 223
      if (t->out_buflen > 0) {
#line 224
        writefds.__fds_bits[t->out_fd / (8 * (int )sizeof(__fd_mask ))] |= (__fd_mask )(1UL << t->out_fd % (8 * (int )sizeof(__fd_mask )));
#line 225
        exceptfds.__fds_bits[t->out_fd / (8 * (int )sizeof(__fd_mask ))] |= (__fd_mask )(1UL << t->out_fd % (8 * (int )sizeof(__fd_mask )));
      }
    }
  }
#line 229
  tmp___0 = select(1024, (fd_set */* __restrict  */)(& readfds), (fd_set */* __restrict  */)(& writefds),
                   (fd_set */* __restrict  */)(& exceptfds), (struct timeval */* __restrict  */)tv);
#line 229
  if (tmp___0 > 0) {
#line 231
    if ((exceptfds.__fds_bits[t->in_fd / (8 * (int )sizeof(__fd_mask ))] & (__fd_mask )(1UL << t->in_fd % (8 * (int )sizeof(__fd_mask )))) != 0L) {
#line 232
      t->in_eof = 1;
    } else
#line 233
    if ((readfds.__fds_bits[t->in_fd / (8 * (int )sizeof(__fd_mask ))] & (__fd_mask )(1UL << t->in_fd % (8 * (int )sizeof(__fd_mask )))) != 0L) {
#line 234
      read_incoming_data(t);
    }
#line 237
    if ((exceptfds.__fds_bits[t->out_fd / (8 * (int )sizeof(__fd_mask ))] & (__fd_mask )(1UL << t->out_fd % (8 * (int )sizeof(__fd_mask )))) != 0L) {
#line 238
      t->out_eof = 1;
    } else
#line 239
    if ((writefds.__fds_bits[t->out_fd / (8 * (int )sizeof(__fd_mask ))] & (__fd_mask )(1UL << t->out_fd % (8 * (int )sizeof(__fd_mask )))) != 0L) {
#line 240
      write_outgoing_data(t);
    }
  }
#line 243
  return;
}
}
#line 245 "telnet_session.c"
static void read_incoming_data(telnet_session_t *t ) 
{ 
  char buf[2048] ;
  int tmp_ssa_1 ;
  int tmp___0_ssa_1 ;
  ssize_t tmp___1_ssa_1 ;
  size_t read_ret_ssa_1 ;
  int *tmp___2_ssa_1 ;
  size_t i_ssa_1 ;
  int __cil_tmp15 ;
  int __cil_tmp16 ;
  int __cil_tmp17 ;
  char *__cil_tmp18 ;
  int __cil_tmp19 ;
  unsigned char *__cil_tmp20 ;
  int *__cil_tmp21 ;
  unsigned char *__cil_tmp22 ;
  int *__cil_tmp23 ;

  {
  {
#line 252
  tmp_ssa_1 = max_input_read(t);
  }
  {
#line 252
  __cil_tmp15 = tmp_ssa_1 <= 2048;
#line 252
  if (! __cil_tmp15) {
    {
#line 252
    daemon_assert_fail("max_input_read(t) <= 2048", "telnet_session.c", 252, "read_incoming_data");
    }
  }
  }
  {
#line 253
  tmp___0_ssa_1 = max_input_read(t);
#line 253
  __cil_tmp18 = buf;
#line 253
  __cil_tmp19 = *((int *)t);
#line 253
  tmp___1_ssa_1 = read(__cil_tmp19, (void *)__cil_tmp18, (size_t )tmp___0_ssa_1);
#line 253
  read_ret_ssa_1 = (size_t )tmp___1_ssa_1;
  }
  {
#line 256
  __cil_tmp16 = read_ret_ssa_1 == 0xffffffffffffffffUL;
#line 256
  if (__cil_tmp16) {
    {
#line 257
    tmp___2_ssa_1 = __errno_location();
#line 257
    __cil_tmp20 = (unsigned char *)t + 4;
#line 257
    __cil_tmp21 = (int *)__cil_tmp20;
#line 257
    *__cil_tmp21 = *tmp___2_ssa_1;
    }
  } else {
    {
#line 258
    __cil_tmp17 = read_ret_ssa_1 == 0UL;
#line 258
    if (__cil_tmp17) {
      {
#line 259
      __cil_tmp22 = (unsigned char *)t + 8;
#line 259
      __cil_tmp23 = (int *)__cil_tmp22;
#line 259
      *__cil_tmp23 = 1;
      }
    } else {
      {
#line 261
      i_ssa_1 = (size_t )0;
      }
      {
#line 261
      read_incoming_data_cil_lr_1(t, read_ret_ssa_1, buf, i_ssa_1);
      }
    }
    }
  }
  }
#line 265
  return;
}
}
#line 269 "telnet_session.c"
static void process_incoming_char(telnet_session_t *t , int c ) 
{ 


  {
#line 271
  switch (t->in_status) {
  case 1: 
#line 273
  switch (c) {
  case 251: 
#line 275
  t->in_status = 2;
#line 276
  break;
  case 252: 
#line 278
  t->in_status = 3;
#line 279
  break;
  case 253: 
#line 281
  t->in_status = 4;
#line 282
  break;
  case 254: 
#line 284
  t->in_status = 5;
#line 285
  break;
  case 255: 
#line 287
  add_incoming_char(t, 255);
#line 288
  t->in_status = 0;
#line 289
  break;
  default: 
#line 291
  t->in_status = 0;
  }
#line 293
  break;
  case 2: 
#line 295
  add_outgoing_char(t, 255);
#line 296
  add_outgoing_char(t, 254);
#line 297
  add_outgoing_char(t, c);
#line 298
  t->in_status = 0;
#line 299
  break;
  case 3: 
#line 301
  t->in_status = 0;
#line 302
  break;
  case 4: 
#line 304
  add_outgoing_char(t, 255);
#line 305
  add_outgoing_char(t, 252);
#line 306
  add_outgoing_char(t, c);
#line 307
  t->in_status = 0;
#line 308
  break;
  case 5: 
#line 310
  t->in_status = 0;
#line 311
  break;
  case 6: 
#line 313
  add_incoming_char(t, '\n');
#line 314
  if (c != 10) {
#line 315
    add_incoming_char(t, c);
  }
#line 317
  t->in_status = 0;
#line 318
  break;
  case 0: 
#line 320
  if (c == 255) {
#line 321
    t->in_status = 1;
  } else
#line 322
  if (c == 13) {
#line 323
    t->in_status = 6;
  } else {
#line 325
    add_incoming_char(t, c);
  }
  }
#line 328
  return;
}
}
#line 331 "telnet_session.c"
static void add_incoming_char(telnet_session_t *t , int c ) 
{ 
  int __cil_tmp3 ;
  int __cil_tmp4 ;
  int __cil_tmp5 ;
  int __cil_tmp6 ;
  int __cil_tmp7 ;
  unsigned char *__cil_tmp8 ;
  int *__cil_tmp9 ;
  int __cil_tmp10 ;
  unsigned char *__cil_tmp11 ;
  int *__cil_tmp12 ;
  int __cil_tmp13 ;
  unsigned char *__cil_tmp14 ;
  char (*__cil_tmp15)[2048] ;
  unsigned char *__cil_tmp16 ;
  int *__cil_tmp17 ;
  char *__cil_tmp18 ;
  int __cil_tmp19 ;
  char *__cil_tmp20 ;
  unsigned char *__cil_tmp21 ;
  int *__cil_tmp22 ;
  int __cil_tmp23 ;
  unsigned char *__cil_tmp24 ;
  int *__cil_tmp25 ;
  unsigned char *__cil_tmp26 ;
  int *__cil_tmp27 ;
  int __cil_tmp28 ;
  unsigned char *__cil_tmp29 ;
  int *__cil_tmp30 ;
  unsigned char *__cil_tmp31 ;
  int *__cil_tmp32 ;
  int __cil_tmp33 ;
  unsigned char *__cil_tmp34 ;
  int *__cil_tmp35 ;
  int __cil_tmp36 ;
  unsigned char *__cil_tmp37 ;
  int *__cil_tmp38 ;
  unsigned char *__cil_tmp39 ;
  int *__cil_tmp40 ;
  int __cil_tmp41 ;
  unsigned char *__cil_tmp42 ;
  int *__cil_tmp43 ;
  unsigned char *__cil_tmp44 ;
  int *__cil_tmp45 ;
  int __cil_tmp46 ;
  unsigned char *__cil_tmp47 ;
  int *__cil_tmp48 ;

  {
  {
#line 333
  __cil_tmp8 = (unsigned char *)t + 16;
#line 333
  __cil_tmp9 = (int *)__cil_tmp8;
#line 333
  __cil_tmp10 = *__cil_tmp9;
#line 333
  __cil_tmp3 = __cil_tmp10 >= 0;
#line 333
  if (! __cil_tmp3) {
    {
#line 333
    daemon_assert_fail("t->in_add >= 0", "telnet_session.c", 333, "add_incoming_char");
    }
  }
  }
  {
#line 334
  __cil_tmp11 = (unsigned char *)t + 16;
#line 334
  __cil_tmp12 = (int *)__cil_tmp11;
#line 334
  __cil_tmp13 = *__cil_tmp12;
#line 334
  __cil_tmp4 = __cil_tmp13 < 2048;
#line 334
  if (! __cil_tmp4) {
    {
#line 334
    daemon_assert_fail("t->in_add < 2048", "telnet_session.c", 334, "add_incoming_char");
    }
  }
  }
  {
#line 335
  __cil_tmp14 = (unsigned char *)t + 20;
#line 335
  __cil_tmp15 = (char (*)[2048])__cil_tmp14;
#line 335
  __cil_tmp16 = (unsigned char *)t + 16;
#line 335
  __cil_tmp17 = (int *)__cil_tmp16;
#line 335
  __cil_tmp18 = *__cil_tmp15;
#line 335
  __cil_tmp19 = *__cil_tmp17;
#line 335
  __cil_tmp20 = __cil_tmp18 + __cil_tmp19;
#line 335
  *__cil_tmp20 = (char )c;
#line 336
  __cil_tmp21 = (unsigned char *)t + 16;
#line 336
  __cil_tmp22 = (int *)__cil_tmp21;
#line 336
  __cil_tmp23 = *__cil_tmp22;
#line 336
  __cil_tmp24 = (unsigned char *)t + 16;
#line 336
  __cil_tmp25 = (int *)__cil_tmp24;
#line 336
  *__cil_tmp25 = __cil_tmp23 + 1;
  }
  {
#line 337
  __cil_tmp26 = (unsigned char *)t + 16;
#line 337
  __cil_tmp27 = (int *)__cil_tmp26;
#line 337
  __cil_tmp28 = *__cil_tmp27;
#line 337
  __cil_tmp5 = __cil_tmp28 == 2048;
#line 337
  if (__cil_tmp5) {
    {
#line 338
    __cil_tmp29 = (unsigned char *)t + 16;
#line 338
    __cil_tmp30 = (int *)__cil_tmp29;
#line 338
    *__cil_tmp30 = 0;
    }
  } else {

  }
  }
  {
#line 340
  __cil_tmp31 = (unsigned char *)t + 2068;
#line 340
  __cil_tmp32 = (int *)__cil_tmp31;
#line 340
  __cil_tmp33 = *__cil_tmp32;
#line 340
  __cil_tmp6 = __cil_tmp33 == 2048;
#line 340
  if (__cil_tmp6) {
    {
#line 341
    __cil_tmp34 = (unsigned char *)t + 12;
#line 341
    __cil_tmp35 = (int *)__cil_tmp34;
#line 341
    __cil_tmp36 = *__cil_tmp35;
#line 341
    __cil_tmp37 = (unsigned char *)t + 12;
#line 341
    __cil_tmp38 = (int *)__cil_tmp37;
#line 341
    *__cil_tmp38 = __cil_tmp36 + 1;
    }
    {
#line 342
    __cil_tmp39 = (unsigned char *)t + 12;
#line 342
    __cil_tmp40 = (int *)__cil_tmp39;
#line 342
    __cil_tmp41 = *__cil_tmp40;
#line 342
    __cil_tmp7 = __cil_tmp41 == 2048;
#line 342
    if (__cil_tmp7) {
      {
#line 343
      __cil_tmp42 = (unsigned char *)t + 12;
#line 343
      __cil_tmp43 = (int *)__cil_tmp42;
#line 343
      *__cil_tmp43 = 0;
      }
    } else {

    }
    }
  } else {
    {
#line 346
    __cil_tmp44 = (unsigned char *)t + 2068;
#line 346
    __cil_tmp45 = (int *)__cil_tmp44;
#line 346
    __cil_tmp46 = *__cil_tmp45;
#line 346
    __cil_tmp47 = (unsigned char *)t + 2068;
#line 346
    __cil_tmp48 = (int *)__cil_tmp47;
#line 346
    *__cil_tmp48 = __cil_tmp46 + 1;
    }
  }
  }
#line 348
  return;
}
}
#line 351 "telnet_session.c"
static int use_incoming_char(telnet_session_t *t ) 
{ 
  int c_ssa_1 ;
  int __cil_tmp4 ;
  int __cil_tmp5 ;
  int __cil_tmp6 ;
  unsigned char *__cil_tmp7 ;
  int *__cil_tmp8 ;
  int __cil_tmp9 ;
  unsigned char *__cil_tmp10 ;
  int *__cil_tmp11 ;
  int __cil_tmp12 ;
  unsigned char *__cil_tmp13 ;
  char (*__cil_tmp14)[2048] ;
  unsigned char *__cil_tmp15 ;
  int *__cil_tmp16 ;
  char *__cil_tmp17 ;
  int __cil_tmp18 ;
  char *__cil_tmp19 ;
  char __cil_tmp20 ;
  unsigned char *__cil_tmp21 ;
  int *__cil_tmp22 ;
  int __cil_tmp23 ;
  unsigned char *__cil_tmp24 ;
  int *__cil_tmp25 ;
  unsigned char *__cil_tmp26 ;
  int *__cil_tmp27 ;
  int __cil_tmp28 ;
  unsigned char *__cil_tmp29 ;
  int *__cil_tmp30 ;
  unsigned char *__cil_tmp31 ;
  int *__cil_tmp32 ;
  int __cil_tmp33 ;
  unsigned char *__cil_tmp34 ;
  int *__cil_tmp35 ;

  {
  {
#line 355
  __cil_tmp7 = (unsigned char *)t + 12;
#line 355
  __cil_tmp8 = (int *)__cil_tmp7;
#line 355
  __cil_tmp9 = *__cil_tmp8;
#line 355
  __cil_tmp4 = __cil_tmp9 >= 0;
#line 355
  if (! __cil_tmp4) {
    {
#line 355
    daemon_assert_fail("t->in_take >= 0", "telnet_session.c", 355, "use_incoming_char");
    }
  }
  }
  {
#line 356
  __cil_tmp10 = (unsigned char *)t + 12;
#line 356
  __cil_tmp11 = (int *)__cil_tmp10;
#line 356
  __cil_tmp12 = *__cil_tmp11;
#line 356
  __cil_tmp5 = __cil_tmp12 < 2048;
#line 356
  if (! __cil_tmp5) {
    {
#line 356
    daemon_assert_fail("t->in_take < 2048", "telnet_session.c", 356, "use_incoming_char");
    }
  }
  }
  {
#line 357
  __cil_tmp13 = (unsigned char *)t + 20;
#line 357
  __cil_tmp14 = (char (*)[2048])__cil_tmp13;
#line 357
  __cil_tmp15 = (unsigned char *)t + 12;
#line 357
  __cil_tmp16 = (int *)__cil_tmp15;
#line 357
  __cil_tmp17 = *__cil_tmp14;
#line 357
  __cil_tmp18 = *__cil_tmp16;
#line 357
  __cil_tmp19 = __cil_tmp17 + __cil_tmp18;
#line 357
  __cil_tmp20 = *__cil_tmp19;
#line 357
  c_ssa_1 = (int )__cil_tmp20;
#line 358
  __cil_tmp21 = (unsigned char *)t + 12;
#line 358
  __cil_tmp22 = (int *)__cil_tmp21;
#line 358
  __cil_tmp23 = *__cil_tmp22;
#line 358
  __cil_tmp24 = (unsigned char *)t + 12;
#line 358
  __cil_tmp25 = (int *)__cil_tmp24;
#line 358
  *__cil_tmp25 = __cil_tmp23 + 1;
  }
  {
#line 359
  __cil_tmp26 = (unsigned char *)t + 12;
#line 359
  __cil_tmp27 = (int *)__cil_tmp26;
#line 359
  __cil_tmp28 = *__cil_tmp27;
#line 359
  __cil_tmp6 = __cil_tmp28 == 2048;
#line 359
  if (__cil_tmp6) {
    {
#line 360
    __cil_tmp29 = (unsigned char *)t + 12;
#line 360
    __cil_tmp30 = (int *)__cil_tmp29;
#line 360
    *__cil_tmp30 = 0;
    }
  } else {

  }
  }
  {
#line 362
  __cil_tmp31 = (unsigned char *)t + 2068;
#line 362
  __cil_tmp32 = (int *)__cil_tmp31;
#line 362
  __cil_tmp33 = *__cil_tmp32;
#line 362
  __cil_tmp34 = (unsigned char *)t + 2068;
#line 362
  __cil_tmp35 = (int *)__cil_tmp34;
#line 362
  *__cil_tmp35 = __cil_tmp33 - 1;
  }
#line 364
  return (c_ssa_1);
}
}
#line 368 "telnet_session.c"
static void add_outgoing_char(telnet_session_t *t , int c ) 
{ 
  int __cil_tmp3 ;
  int __cil_tmp4 ;
  int __cil_tmp5 ;
  int __cil_tmp6 ;
  int __cil_tmp7 ;
  unsigned char *__cil_tmp8 ;
  int *__cil_tmp9 ;
  int __cil_tmp10 ;
  unsigned char *__cil_tmp11 ;
  int *__cil_tmp12 ;
  int __cil_tmp13 ;
  unsigned char *__cil_tmp14 ;
  char (*__cil_tmp15)[2048] ;
  unsigned char *__cil_tmp16 ;
  int *__cil_tmp17 ;
  char *__cil_tmp18 ;
  int __cil_tmp19 ;
  char *__cil_tmp20 ;
  unsigned char *__cil_tmp21 ;
  int *__cil_tmp22 ;
  int __cil_tmp23 ;
  unsigned char *__cil_tmp24 ;
  int *__cil_tmp25 ;
  unsigned char *__cil_tmp26 ;
  int *__cil_tmp27 ;
  int __cil_tmp28 ;
  unsigned char *__cil_tmp29 ;
  int *__cil_tmp30 ;
  unsigned char *__cil_tmp31 ;
  int *__cil_tmp32 ;
  int __cil_tmp33 ;
  unsigned char *__cil_tmp34 ;
  int *__cil_tmp35 ;
  int __cil_tmp36 ;
  unsigned char *__cil_tmp37 ;
  int *__cil_tmp38 ;
  unsigned char *__cil_tmp39 ;
  int *__cil_tmp40 ;
  int __cil_tmp41 ;
  unsigned char *__cil_tmp42 ;
  int *__cil_tmp43 ;
  unsigned char *__cil_tmp44 ;
  int *__cil_tmp45 ;
  int __cil_tmp46 ;
  unsigned char *__cil_tmp47 ;
  int *__cil_tmp48 ;

  {
  {
#line 370
  __cil_tmp8 = (unsigned char *)t + 2092;
#line 370
  __cil_tmp9 = (int *)__cil_tmp8;
#line 370
  __cil_tmp10 = *__cil_tmp9;
#line 370
  __cil_tmp3 = __cil_tmp10 >= 0;
#line 370
  if (! __cil_tmp3) {
    {
#line 370
    daemon_assert_fail("t->out_add >= 0", "telnet_session.c", 370, "add_outgoing_char");
    }
  }
  }
  {
#line 371
  __cil_tmp11 = (unsigned char *)t + 2092;
#line 371
  __cil_tmp12 = (int *)__cil_tmp11;
#line 371
  __cil_tmp13 = *__cil_tmp12;
#line 371
  __cil_tmp4 = __cil_tmp13 < 2048;
#line 371
  if (! __cil_tmp4) {
    {
#line 371
    daemon_assert_fail("t->out_add < 2048", "telnet_session.c", 371, "add_outgoing_char");
    }
  }
  }
  {
#line 372
  __cil_tmp14 = (unsigned char *)t + 2096;
#line 372
  __cil_tmp15 = (char (*)[2048])__cil_tmp14;
#line 372
  __cil_tmp16 = (unsigned char *)t + 2092;
#line 372
  __cil_tmp17 = (int *)__cil_tmp16;
#line 372
  __cil_tmp18 = *__cil_tmp15;
#line 372
  __cil_tmp19 = *__cil_tmp17;
#line 372
  __cil_tmp20 = __cil_tmp18 + __cil_tmp19;
#line 372
  *__cil_tmp20 = (char )c;
#line 373
  __cil_tmp21 = (unsigned char *)t + 2092;
#line 373
  __cil_tmp22 = (int *)__cil_tmp21;
#line 373
  __cil_tmp23 = *__cil_tmp22;
#line 373
  __cil_tmp24 = (unsigned char *)t + 2092;
#line 373
  __cil_tmp25 = (int *)__cil_tmp24;
#line 373
  *__cil_tmp25 = __cil_tmp23 + 1;
  }
  {
#line 374
  __cil_tmp26 = (unsigned char *)t + 2092;
#line 374
  __cil_tmp27 = (int *)__cil_tmp26;
#line 374
  __cil_tmp28 = *__cil_tmp27;
#line 374
  __cil_tmp5 = __cil_tmp28 == 2048;
#line 374
  if (__cil_tmp5) {
    {
#line 375
    __cil_tmp29 = (unsigned char *)t + 2092;
#line 375
    __cil_tmp30 = (int *)__cil_tmp29;
#line 375
    *__cil_tmp30 = 0;
    }
  } else {

  }
  }
  {
#line 377
  __cil_tmp31 = (unsigned char *)t + 4144;
#line 377
  __cil_tmp32 = (int *)__cil_tmp31;
#line 377
  __cil_tmp33 = *__cil_tmp32;
#line 377
  __cil_tmp6 = __cil_tmp33 == 2048;
#line 377
  if (__cil_tmp6) {
    {
#line 378
    __cil_tmp34 = (unsigned char *)t + 2088;
#line 378
    __cil_tmp35 = (int *)__cil_tmp34;
#line 378
    __cil_tmp36 = *__cil_tmp35;
#line 378
    __cil_tmp37 = (unsigned char *)t + 2088;
#line 378
    __cil_tmp38 = (int *)__cil_tmp37;
#line 378
    *__cil_tmp38 = __cil_tmp36 + 1;
    }
    {
#line 379
    __cil_tmp39 = (unsigned char *)t + 2088;
#line 379
    __cil_tmp40 = (int *)__cil_tmp39;
#line 379
    __cil_tmp41 = *__cil_tmp40;
#line 379
    __cil_tmp7 = __cil_tmp41 == 2048;
#line 379
    if (__cil_tmp7) {
      {
#line 380
      __cil_tmp42 = (unsigned char *)t + 2088;
#line 380
      __cil_tmp43 = (int *)__cil_tmp42;
#line 380
      *__cil_tmp43 = 0;
      }
    } else {

    }
    }
  } else {
    {
#line 383
    __cil_tmp44 = (unsigned char *)t + 4144;
#line 383
    __cil_tmp45 = (int *)__cil_tmp44;
#line 383
    __cil_tmp46 = *__cil_tmp45;
#line 383
    __cil_tmp47 = (unsigned char *)t + 4144;
#line 383
    __cil_tmp48 = (int *)__cil_tmp47;
#line 383
    *__cil_tmp48 = __cil_tmp46 + 1;
    }
  }
  }
#line 385
  return;
}
}
#line 388 "telnet_session.c"
static void write_outgoing_data(telnet_session_t *t ) 
{ 
  ssize_t tmp_ssa_1 ;
  size_t write_ret_ssa_1 ;
  ssize_t tmp___0_ssa_1 ;
  int *tmp___1_ssa_1 ;
  int __cil_tmp10 ;
  int __cil_tmp11 ;
  int __cil_tmp12 ;
  int __cil_tmp13 ;
  int __cil_tmp14 ;
  int __cil_tmp15 ;
  int __cil_tmp16 ;
  int __cil_tmp17 ;
  int __cil_tmp18 ;
  int __cil_tmp19 ;
  int __cil_tmp20 ;
  unsigned char *__cil_tmp21 ;
  int *__cil_tmp22 ;
  unsigned char *__cil_tmp23 ;
  int *__cil_tmp24 ;
  int __cil_tmp25 ;
  int __cil_tmp26 ;
  unsigned char *__cil_tmp27 ;
  int *__cil_tmp28 ;
  int __cil_tmp29 ;
  unsigned char *__cil_tmp30 ;
  int *__cil_tmp31 ;
  int __cil_tmp32 ;
  unsigned char *__cil_tmp33 ;
  int *__cil_tmp34 ;
  int __cil_tmp35 ;
  unsigned char *__cil_tmp36 ;
  int *__cil_tmp37 ;
  unsigned char *__cil_tmp38 ;
  int *__cil_tmp39 ;
  int __cil_tmp40 ;
  int __cil_tmp41 ;
  int __cil_tmp42 ;
  unsigned char *__cil_tmp43 ;
  int *__cil_tmp44 ;
  unsigned char *__cil_tmp45 ;
  char (*__cil_tmp46)[2048] ;
  unsigned char *__cil_tmp47 ;
  int *__cil_tmp48 ;
  char *__cil_tmp49 ;
  int __cil_tmp50 ;
  char *__cil_tmp51 ;
  unsigned char *__cil_tmp52 ;
  int *__cil_tmp53 ;
  int __cil_tmp54 ;
  int __cil_tmp55 ;
  unsigned char *__cil_tmp56 ;
  int *__cil_tmp57 ;
  int __cil_tmp58 ;
  unsigned char *__cil_tmp59 ;
  int *__cil_tmp60 ;
  int __cil_tmp61 ;
  unsigned char *__cil_tmp62 ;
  int *__cil_tmp63 ;
  int __cil_tmp64 ;
  int __cil_tmp65 ;
  unsigned char *__cil_tmp66 ;
  int *__cil_tmp67 ;
  unsigned char *__cil_tmp68 ;
  char (*__cil_tmp69)[2048] ;
  unsigned char *__cil_tmp70 ;
  int *__cil_tmp71 ;
  char *__cil_tmp72 ;
  int __cil_tmp73 ;
  char *__cil_tmp74 ;
  unsigned char *__cil_tmp75 ;
  int *__cil_tmp76 ;
  int __cil_tmp77 ;
  int __cil_tmp78 ;
  int __cil_tmp79 ;
  unsigned char *__cil_tmp80 ;
  int *__cil_tmp81 ;
  unsigned char *__cil_tmp82 ;
  int *__cil_tmp83 ;
  unsigned char *__cil_tmp84 ;
  int *__cil_tmp85 ;
  int __cil_tmp86 ;
  size_t __cil_tmp87 ;
  size_t __cil_tmp88 ;
  unsigned char *__cil_tmp89 ;
  int *__cil_tmp90 ;
  unsigned char *__cil_tmp91 ;
  int *__cil_tmp92 ;
  int __cil_tmp93 ;
  size_t __cil_tmp94 ;
  size_t __cil_tmp95 ;
  unsigned char *__cil_tmp96 ;
  int *__cil_tmp97 ;
  unsigned char *__cil_tmp98 ;
  int *__cil_tmp99 ;
  int __cil_tmp100 ;
  unsigned char *__cil_tmp101 ;
  int *__cil_tmp102 ;
  int __cil_tmp103 ;
  unsigned char *__cil_tmp104 ;
  int *__cil_tmp105 ;

  {
  {
#line 392
  __cil_tmp21 = (unsigned char *)t + 2088;
#line 392
  __cil_tmp22 = (int *)__cil_tmp21;
#line 392
  __cil_tmp23 = (unsigned char *)t + 2092;
#line 392
  __cil_tmp24 = (int *)__cil_tmp23;
#line 392
  __cil_tmp25 = *__cil_tmp22;
#line 392
  __cil_tmp26 = *__cil_tmp24;
#line 392
  __cil_tmp10 = __cil_tmp25 < __cil_tmp26;
#line 392
  if (__cil_tmp10) {
    {
#line 395
    __cil_tmp27 = (unsigned char *)t + 2088;
#line 395
    __cil_tmp28 = (int *)__cil_tmp27;
#line 395
    __cil_tmp29 = *__cil_tmp28;
#line 395
    __cil_tmp11 = __cil_tmp29 >= 0;
#line 395
    if (! __cil_tmp11) {
      {
#line 395
      daemon_assert_fail("t->out_take >= 0", "telnet_session.c", 395, "write_outgoing_data");
      }
    }
    }
    {
#line 396
    __cil_tmp30 = (unsigned char *)t + 2088;
#line 396
    __cil_tmp31 = (int *)__cil_tmp30;
#line 396
    __cil_tmp32 = *__cil_tmp31;
#line 396
    __cil_tmp12 = __cil_tmp32 < 2048;
#line 396
    if (! __cil_tmp12) {
      {
#line 396
      daemon_assert_fail("t->out_take < 2048", "telnet_session.c", 396, "write_outgoing_data");
      }
    }
    }
    {
#line 397
    __cil_tmp33 = (unsigned char *)t + 4144;
#line 397
    __cil_tmp34 = (int *)__cil_tmp33;
#line 397
    __cil_tmp35 = *__cil_tmp34;
#line 397
    __cil_tmp13 = __cil_tmp35 > 0;
#line 397
    if (! __cil_tmp13) {
      {
#line 397
      daemon_assert_fail("t->out_buflen > 0", "telnet_session.c", 397, "write_outgoing_data");
      }
    }
    }
    {
#line 398
    __cil_tmp36 = (unsigned char *)t + 4144;
#line 398
    __cil_tmp37 = (int *)__cil_tmp36;
#line 398
    __cil_tmp38 = (unsigned char *)t + 2088;
#line 398
    __cil_tmp39 = (int *)__cil_tmp38;
#line 398
    __cil_tmp40 = *__cil_tmp37;
#line 398
    __cil_tmp41 = *__cil_tmp39;
#line 398
    __cil_tmp42 = __cil_tmp40 + __cil_tmp41;
#line 398
    __cil_tmp14 = __cil_tmp42 <= 2048;
#line 398
    if (! __cil_tmp14) {
      {
#line 398
      daemon_assert_fail("t->out_buflen + t->out_take <= 2048", "telnet_session.c",
                         398, "write_outgoing_data");
      }
    }
    }
    {
#line 399
    __cil_tmp43 = (unsigned char *)t + 2076;
#line 399
    __cil_tmp44 = (int *)__cil_tmp43;
#line 399
    __cil_tmp45 = (unsigned char *)t + 2096;
#line 399
    __cil_tmp46 = (char (*)[2048])__cil_tmp45;
#line 399
    __cil_tmp47 = (unsigned char *)t + 2088;
#line 399
    __cil_tmp48 = (int *)__cil_tmp47;
#line 399
    __cil_tmp49 = *__cil_tmp46;
#line 399
    __cil_tmp50 = *__cil_tmp48;
#line 399
    __cil_tmp51 = __cil_tmp49 + __cil_tmp50;
#line 399
    __cil_tmp52 = (unsigned char *)t + 4144;
#line 399
    __cil_tmp53 = (int *)__cil_tmp52;
#line 399
    __cil_tmp54 = *__cil_tmp53;
#line 399
    __cil_tmp55 = *__cil_tmp44;
#line 399
    tmp_ssa_1 = write(__cil_tmp55, (void const   *)__cil_tmp51, (size_t )__cil_tmp54);
#line 399
    write_ret_ssa_1 = (size_t )tmp_ssa_1;
    }
  } else {
    {
#line 403
    __cil_tmp56 = (unsigned char *)t + 2088;
#line 403
    __cil_tmp57 = (int *)__cil_tmp56;
#line 403
    __cil_tmp58 = *__cil_tmp57;
#line 403
    __cil_tmp15 = __cil_tmp58 >= 0;
#line 403
    if (! __cil_tmp15) {
      {
#line 403
      daemon_assert_fail("t->out_take >= 0", "telnet_session.c", 403, "write_outgoing_data");
      }
    }
    }
    {
#line 404
    __cil_tmp59 = (unsigned char *)t + 2088;
#line 404
    __cil_tmp60 = (int *)__cil_tmp59;
#line 404
    __cil_tmp61 = *__cil_tmp60;
#line 404
    __cil_tmp16 = __cil_tmp61 < 2048;
#line 404
    if (! __cil_tmp16) {
      {
#line 404
      daemon_assert_fail("t->out_take < 2048", "telnet_session.c", 404, "write_outgoing_data");
      }
    }
    }
    {
#line 405
    __cil_tmp62 = (unsigned char *)t + 2088;
#line 405
    __cil_tmp63 = (int *)__cil_tmp62;
#line 405
    __cil_tmp64 = *__cil_tmp63;
#line 405
    __cil_tmp65 = 2048 - __cil_tmp64;
#line 405
    __cil_tmp17 = __cil_tmp65 > 0;
#line 405
    if (! __cil_tmp17) {
      {
#line 405
      daemon_assert_fail("(2048 - t->out_take) > 0", "telnet_session.c", 405, "write_outgoing_data");
      }
    }
    }
    {
#line 406
    __cil_tmp66 = (unsigned char *)t + 2076;
#line 406
    __cil_tmp67 = (int *)__cil_tmp66;
#line 406
    __cil_tmp68 = (unsigned char *)t + 2096;
#line 406
    __cil_tmp69 = (char (*)[2048])__cil_tmp68;
#line 406
    __cil_tmp70 = (unsigned char *)t + 2088;
#line 406
    __cil_tmp71 = (int *)__cil_tmp70;
#line 406
    __cil_tmp72 = *__cil_tmp69;
#line 406
    __cil_tmp73 = *__cil_tmp71;
#line 406
    __cil_tmp74 = __cil_tmp72 + __cil_tmp73;
#line 406
    __cil_tmp75 = (unsigned char *)t + 2088;
#line 406
    __cil_tmp76 = (int *)__cil_tmp75;
#line 406
    __cil_tmp77 = *__cil_tmp76;
#line 406
    __cil_tmp78 = 2048 - __cil_tmp77;
#line 406
    __cil_tmp79 = *__cil_tmp67;
#line 406
    tmp___0_ssa_1 = write(__cil_tmp79, (void const   *)__cil_tmp74, (size_t )__cil_tmp78);
#line 406
    write_ret_ssa_1 = (size_t )tmp___0_ssa_1;
    }
  }
  }
  {
#line 412
  __cil_tmp18 = write_ret_ssa_1 == 0xffffffffffffffffUL;
#line 412
  if (__cil_tmp18) {
    {
#line 413
    tmp___1_ssa_1 = __errno_location();
#line 413
    __cil_tmp80 = (unsigned char *)t + 2080;
#line 413
    __cil_tmp81 = (int *)__cil_tmp80;
#line 413
    *__cil_tmp81 = *tmp___1_ssa_1;
    }
  } else {
    {
#line 414
    __cil_tmp19 = write_ret_ssa_1 == 0UL;
#line 414
    if (__cil_tmp19) {
      {
#line 415
      __cil_tmp82 = (unsigned char *)t + 2084;
#line 415
      __cil_tmp83 = (int *)__cil_tmp82;
#line 415
      *__cil_tmp83 = 1;
      }
    } else {
      {
#line 417
      __cil_tmp84 = (unsigned char *)t + 4144;
#line 417
      __cil_tmp85 = (int *)__cil_tmp84;
#line 417
      __cil_tmp86 = *__cil_tmp85;
#line 417
      __cil_tmp87 = (size_t )__cil_tmp86;
#line 417
      __cil_tmp88 = __cil_tmp87 - write_ret_ssa_1;
#line 417
      __cil_tmp89 = (unsigned char *)t + 4144;
#line 417
      __cil_tmp90 = (int *)__cil_tmp89;
#line 417
      *__cil_tmp90 = (int )__cil_tmp88;
#line 418
      __cil_tmp91 = (unsigned char *)t + 2088;
#line 418
      __cil_tmp92 = (int *)__cil_tmp91;
#line 418
      __cil_tmp93 = *__cil_tmp92;
#line 418
      __cil_tmp94 = (size_t )__cil_tmp93;
#line 418
      __cil_tmp95 = __cil_tmp94 + write_ret_ssa_1;
#line 418
      __cil_tmp96 = (unsigned char *)t + 2088;
#line 418
      __cil_tmp97 = (int *)__cil_tmp96;
#line 418
      *__cil_tmp97 = (int )__cil_tmp95;
      }
      {
#line 419
      __cil_tmp98 = (unsigned char *)t + 2088;
#line 419
      __cil_tmp99 = (int *)__cil_tmp98;
#line 419
      __cil_tmp100 = *__cil_tmp99;
#line 419
      __cil_tmp20 = __cil_tmp100 >= 2048;
#line 419
      if (__cil_tmp20) {
        {
#line 420
        __cil_tmp101 = (unsigned char *)t + 2088;
#line 420
        __cil_tmp102 = (int *)__cil_tmp101;
#line 420
        __cil_tmp103 = *__cil_tmp102;
#line 420
        __cil_tmp104 = (unsigned char *)t + 2088;
#line 420
        __cil_tmp105 = (int *)__cil_tmp104;
#line 420
        *__cil_tmp105 = __cil_tmp103 - 2048;
        }
      } else {

      }
      }
    }
    }
  }
  }
#line 423
  return;
}
}
#line 426 "telnet_session.c"
static int max_input_read(telnet_session_t *t ) 
{ 
  int tmp_ssa_1 ;
  int max_in_ssa_1 ;
  int max_out_ssa_1 ;
  int tmp___0_ssa_1 ;
  int tmp___1_ssa_1 ;
  int __cil_tmp12 ;
  int __cil_tmp13 ;
  int __cil_tmp14 ;
  unsigned char *__cil_tmp15 ;
  int *__cil_tmp16 ;
  int __cil_tmp17 ;
  unsigned char *__cil_tmp18 ;
  int *__cil_tmp19 ;
  int __cil_tmp20 ;
  unsigned char *__cil_tmp21 ;
  int *__cil_tmp22 ;
  int __cil_tmp23 ;
  unsigned char *__cil_tmp24 ;
  int *__cil_tmp25 ;
  int __cil_tmp26 ;

  {
  {
#line 431
  tmp_ssa_1 = invariant((telnet_session_t const   *)t);
  }
#line 431
  if (! tmp_ssa_1) {
    {
#line 431
    daemon_assert_fail("invariant(t)", "telnet_session.c", 431, "max_input_read");
    }
  }
  {
#line 434
  __cil_tmp15 = (unsigned char *)t + 2068;
#line 434
  __cil_tmp16 = (int *)__cil_tmp15;
#line 434
  __cil_tmp17 = *__cil_tmp16;
#line 434
  __cil_tmp12 = __cil_tmp17 < 2048;
#line 434
  if (__cil_tmp12) {
    {
#line 435
    __cil_tmp18 = (unsigned char *)t + 2068;
#line 435
    __cil_tmp19 = (int *)__cil_tmp18;
#line 435
    __cil_tmp20 = *__cil_tmp19;
#line 435
    max_in_ssa_1 = 2048 - __cil_tmp20;
    }
  } else {
    {
#line 437
    max_in_ssa_1 = 0;
    }
  }
  }
  {
#line 441
  __cil_tmp21 = (unsigned char *)t + 4144;
#line 441
  __cil_tmp22 = (int *)__cil_tmp21;
#line 441
  __cil_tmp23 = *__cil_tmp22;
#line 441
  __cil_tmp13 = __cil_tmp23 < 2048;
#line 441
  if (__cil_tmp13) {
    {
#line 442
    __cil_tmp24 = (unsigned char *)t + 4144;
#line 442
    __cil_tmp25 = (int *)__cil_tmp24;
#line 442
    __cil_tmp26 = *__cil_tmp25;
#line 442
    max_out_ssa_1 = 2048 - __cil_tmp26;
    }
  } else {
    {
#line 444
    max_out_ssa_1 = 0;
    }
  }
  }
  {
#line 447
  tmp___0_ssa_1 = invariant((telnet_session_t const   *)t);
  }
#line 447
  if (! tmp___0_ssa_1) {
    {
#line 447
    daemon_assert_fail("invariant(t)", "telnet_session.c", 447, "max_input_read");
    }
  }
  {
#line 450
  __cil_tmp14 = max_in_ssa_1 < max_out_ssa_1;
#line 450
  if (__cil_tmp14) {
    {
#line 450
    tmp___1_ssa_1 = max_in_ssa_1;
    }
  } else {
    {
#line 450
    tmp___1_ssa_1 = max_out_ssa_1;
    }
  }
  }
#line 450
  return (tmp___1_ssa_1);
}
}
#line 454 "telnet_session.c"
static int invariant(telnet_session_t const   *t ) 
{ 


  {
#line 456
  if ((unsigned long )t == (unsigned long )((void *)0)) {
#line 457
    return (0);
  }
#line 459
  if (t->in_fd < 0) {
#line 460
    return (0);
  }
#line 462
  if (t->in_take < 0) {
#line 463
    return (0);
  } else
#line 462
  if (t->in_take >= 2048) {
#line 463
    return (0);
  }
#line 465
  if (t->in_add < 0) {
#line 466
    return (0);
  } else
#line 465
  if (t->in_add >= 2048) {
#line 466
    return (0);
  }
#line 468
  if (t->in_buflen < 0) {
#line 469
    return (0);
  } else
#line 468
  if (t->in_buflen > 2048) {
#line 469
    return (0);
  }
#line 472
  switch (t->in_status) {
  case 0: 
#line 474
  break;
  case 1: 
#line 476
  break;
  case 2: 
#line 478
  break;
  case 3: 
#line 480
  break;
  case 4: 
#line 482
  break;
  case 5: 
#line 484
  break;
  case 6: 
#line 486
  break;
  default: 
#line 488
  return (0);
  }
#line 491
  if (t->out_fd < 0) {
#line 492
    return (0);
  }
#line 494
  if (t->out_take < 0) {
#line 495
    return (0);
  } else
#line 494
  if (t->out_take >= 2048) {
#line 495
    return (0);
  }
#line 497
  if (t->out_add < 0) {
#line 498
    return (0);
  } else
#line 497
  if (t->out_add >= 2048) {
#line 498
    return (0);
  }
#line 500
  if (t->out_buflen < 0) {
#line 501
    return (0);
  } else
#line 500
  if (t->out_buflen > 2048) {
#line 501
    return (0);
  }
#line 504
  return (1);
}
}
void read_incoming_data_cil_lr_1(telnet_session_t *t , size_t read_ret , char buf[2048] ,
                                 size_t i ) 
{ 
  size_t i_ssa_1 ;
  int __cil_tmp6 ;
  char *__cil_tmp7 ;
  char __cil_tmp8 ;
  unsigned char __cil_tmp9 ;

  {
  {
#line 261
  __cil_tmp6 = i < read_ret;
#line 261
  if (__cil_tmp6) {
    {
#line 262
    __cil_tmp7 = buf + i;
#line 262
    __cil_tmp8 = *__cil_tmp7;
#line 262
    __cil_tmp9 = (unsigned char )__cil_tmp8;
#line 262
    process_incoming_char(t, (int )__cil_tmp9);
#line 261
    i_ssa_1 = i + 1UL;
    }
    {
    read_incoming_data_cil_lr_1(t, read_ret, buf, i_ssa_1);
    }
    return;
  } else {
    return;
  }
  }
}
}
